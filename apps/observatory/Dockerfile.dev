FROM oven/bun:1.3.5

WORKDIR /app

# Copy workspace configuration
COPY package.json bun.lockb bunfig.toml ./
COPY packages ./packages
COPY apps/observatory ./apps/observatory

# Install dependencies (workspace-aware)
RUN bun install

# Set working directory to observatory
WORKDIR /app/apps/observatory

# Expose port
EXPOSE 6178

# Run the custom server with hot reload in dev mode
CMD ["bun", "run", "dev"]
