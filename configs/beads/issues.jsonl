{"id":"engram-00fb","title":"Test coverage: packages/infra/src/k8s/network-policy.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:04.921661-06:00","updated_at":"2025-12-21T04:07:03.7704-06:00","closed_at":"2025-12-21T04:07:03.7704-06:00"}
{"id":"engram-037a","title":"[Console Redesign] Migrate Alerts page to shadcn","description":"## Overview\nMigrate the Alerts page including alert rules, channels, and alert history.\n\n## Target Page\n- apps/console/app/(dashboard)/alerts/page.tsx\n\n## Components to Migrate\n\n### Alert Rule Cards\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-2\"\u003e\n  {rules.map((rule) =\u003e (\n    \u003cCard key={rule.id}\u003e\n      \u003cCardHeader className=\"flex flex-row items-center justify-between pb-2\"\u003e\n        \u003cdiv className=\"flex items-center gap-2\"\u003e\n          \u003cCardTitle className=\"text-sm font-medium\"\u003e{rule.name}\u003c/CardTitle\u003e\n          \u003cBadge variant={getSeverityVariant(rule.severity)}\u003e\n            {rule.severity}\n          \u003c/Badge\u003e\n        \u003c/div\u003e\n        \u003cSwitch checked={rule.enabled} onCheckedChange={() =\u003e toggleRule(rule.id)} /\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cp className=\"text-xs text-muted-foreground\"\u003e{rule.condition}\u003c/p\u003e\n        \u003cdiv className=\"mt-4 flex gap-2\"\u003e\n          \u003cButton variant=\"outline\" size=\"sm\" onClick={() =\u003e editRule(rule)}\u003e\n            Edit\n          \u003c/Button\u003e\n          \u003cButton variant=\"ghost\" size=\"sm\" onClick={() =\u003e deleteRule(rule.id)}\u003e\n            \u003cTrash className=\"h-4 w-4\" /\u003e\n          \u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  ))}\n\u003c/div\u003e\n```\n\n### Alert Rule Modal (Dialog + Form)\n```tsx\n\u003cDialog open={isOpen} onOpenChange={setIsOpen}\u003e\n  \u003cDialogContent className=\"sm:max-w-[500px]\"\u003e\n    \u003cDialogHeader\u003e\n      \u003cDialogTitle\u003e{editingRule ? 'Edit Rule' : 'Create Alert Rule'}\u003c/DialogTitle\u003e\n    \u003c/DialogHeader\u003e\n    \u003cForm {...form}\u003e\n      \u003cform onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\"\u003e\n        \u003cFormField control={form.control} name=\"name\" render={...} /\u003e\n        \u003cFormField control={form.control} name=\"metric\" render={({ field }) =\u003e (\n          \u003cSelect onValueChange={field.onChange} value={field.value}\u003e\n            \u003cSelectTrigger\u003e\u003cSelectValue placeholder=\"Select metric\" /\u003e\u003c/SelectTrigger\u003e\n            \u003cSelectContent\u003e\n              \u003cSelectItem value=\"error_rate\"\u003eError Rate\u003c/SelectItem\u003e\n              \u003cSelectItem value=\"latency_p99\"\u003eP99 Latency\u003c/SelectItem\u003e\n              \u003cSelectItem value=\"request_rate\"\u003eRequest Rate\u003c/SelectItem\u003e\n            \u003c/SelectContent\u003e\n          \u003c/Select\u003e\n        )} /\u003e\n        \u003cFormField control={form.control} name=\"severity\" render={({ field }) =\u003e (\n          \u003cRadioGroup onValueChange={field.onChange} value={field.value}\u003e\n            \u003cRadioGroupItem value=\"critical\" /\u003e\n            \u003cRadioGroupItem value=\"warning\" /\u003e\n            \u003cRadioGroupItem value=\"info\" /\u003e\n          \u003c/RadioGroup\u003e\n        )} /\u003e\n        \u003cFormField control={form.control} name=\"channels\" render={...} /\u003e\n        \u003cDialogFooter\u003e\n          \u003cButton type=\"submit\"\u003eSave Rule\u003c/Button\u003e\n        \u003c/DialogFooter\u003e\n      \u003c/form\u003e\n    \u003c/Form\u003e\n  \u003c/DialogContent\u003e\n\u003c/Dialog\u003e\n```\n\n### Channel Cards\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-3\"\u003e\n  {channels.map((channel) =\u003e (\n    \u003cCard key={channel.id}\u003e\n      \u003cCardHeader className=\"pb-2\"\u003e\n        \u003cCardTitle className=\"text-sm font-medium flex items-center gap-2\"\u003e\n          \u003cchannel.icon className=\"h-4 w-4\" /\u003e\n          {channel.name}\n        \u003c/CardTitle\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cp className=\"text-xs text-muted-foreground\"\u003e{channel.target}\u003c/p\u003e\n        \u003cdiv className=\"mt-4 flex gap-2\"\u003e\n          \u003cButton variant=\"outline\" size=\"sm\"\u003eTest\u003c/Button\u003e\n          \u003cButton variant=\"ghost\" size=\"sm\"\u003e\u003cTrash className=\"h-4 w-4\" /\u003e\u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  ))}\n\u003c/div\u003e\n```\n\n### Alert History Table\n```tsx\n\u003cTable\u003e\n  \u003cTableHeader\u003e\n    \u003cTableRow\u003e\n      \u003cTableHead\u003eAlert\u003c/TableHead\u003e\n      \u003cTableHead\u003eSeverity\u003c/TableHead\u003e\n      \u003cTableHead\u003eStatus\u003c/TableHead\u003e\n      \u003cTableHead\u003eTriggered At\u003c/TableHead\u003e\n      \u003cTableHead\u003e\u003c/TableHead\u003e\n    \u003c/TableRow\u003e\n  \u003c/TableHeader\u003e\n  \u003cTableBody\u003e\n    {alerts.map((alert) =\u003e (\n      \u003cTableRow key={alert.id}\u003e\n        \u003cTableCell\u003e{alert.ruleName}\u003c/TableCell\u003e\n        \u003cTableCell\u003e\u003cBadge\u003e{alert.severity}\u003c/Badge\u003e\u003c/TableCell\u003e\n        \u003cTableCell\u003e\u003cBadge\u003e{alert.status}\u003c/Badge\u003e\u003c/TableCell\u003e\n        \u003cTableCell\u003e{formatTime(alert.triggeredAt)}\u003c/TableCell\u003e\n        \u003cTableCell\u003e\n          {alert.status === 'firing' \u0026\u0026 (\n            \u003cButton variant=\"outline\" size=\"sm\"\u003eAcknowledge\u003c/Button\u003e\n          )}\n        \u003c/TableCell\u003e\n      \u003c/TableRow\u003e\n    ))}\n  \u003c/TableBody\u003e\n\u003c/Table\u003e\n```\n\n## Components to Use\n- Card (rule/channel cards)\n- Dialog + Form (create/edit modals)\n- Switch (enable/disable rules)\n- Badge (severity: critical/warning/info)\n- RadioGroup (severity selection)\n- Command (channel multi-select combobox)\n- Table (alert history)\n- AlertDialog (delete confirmations)\n\n## Form Validation (react-hook-form + zod)\n```tsx\nconst ruleSchema = z.object({\n  name: z.string().min(1, \"Name is required\"),\n  metric: z.string().min(1, \"Metric is required\"),\n  condition: z.enum([\"gt\", \"lt\", \"eq\"]),\n  threshold: z.number().positive(),\n  duration: z.string(),\n  severity: z.enum([\"critical\", \"warning\", \"info\"]),\n  channels: z.array(z.string()).min(1, \"Select at least one channel\"),\n})\n```\n\n## Acceptance Criteria\n- [ ] Alert rule cards with enable/disable\n- [ ] Create/Edit rule dialog with form validation\n- [ ] Channel cards with test functionality\n- [ ] Alert history table\n- [ ] Acknowledge action\n- [ ] Delete confirmations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:48:20.058602-06:00","updated_at":"2025-12-28T17:40:32.021081-06:00","closed_at":"2025-12-28T17:40:32.021081-06:00","dependencies":[{"issue_id":"engram-037a","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:43.65701-06:00","created_by":"ccheney"}]}
{"id":"engram-03gn","title":"[CRITICAL] Missing null checks in graph repositories","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:37.990037-06:00","updated_at":"2025-12-20T23:45:30.480981-06:00","closed_at":"2025-12-20T23:45:30.480981-06:00"}
{"id":"engram-09g7","title":"[HIGH] Graph connection leak in assembler","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:14.450767-06:00","updated_at":"2025-12-21T00:00:08.276751-06:00","closed_at":"2025-12-21T00:00:08.276751-06:00"}
{"id":"engram-09nr","title":"[HIGH] Unsafe JSON.parse in loadSnapshot","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:14.45708-06:00","updated_at":"2025-12-20T23:59:12.688269-06:00","closed_at":"2025-12-20T23:59:12.688269-06:00"}
{"id":"engram-09vr","title":"Create Summarizer job handler","description":"Create apps/worker/src/jobs/summarizer.ts. Gather member entities and their memories (limit 50/entity, 100 total), call Gemini for summary, update Community node with name/summary/keywords/embedding. Subscribe to engram.jobs.summarization NATS subject.\n\n## Job Flow\n1. Receive community ID needing summarization\n2. Load member entities from MEMBER_OF edges\n3. For each entity, load memories via MENTIONS edges (limit 50)\n4. Deduplicate and sort by recency, limit to 100 total\n5. Call Gemini with community-summary prompt\n6. Update Community node with generated content\n7. Generate embedding for summary text\n\n## Prompt Design\nInput: Entity list + memory excerpts\nOutput: JSON { name, text, keywords }\nConstraints: 2-4 word name, 2-3 sentence summary, 3-5 keywords\n\n## Before Implementation\nUse Context7 MCP: Query '@google/generative-ai' for structured output patterns.\n\nReview prompt engineering for summarization.\n\n## References\n- Gemini client: packages/common/src/clients/gemini.ts\n- Community model: packages/graph/src/models/nodes.ts\n- Embedding generation: apps/search (for consistency)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:58.465302-06:00","updated_at":"2026-01-01T17:10:14.774218-06:00","dependencies":[{"issue_id":"engram-09vr","depends_on_id":"engram-r826","type":"blocks","created_at":"2026-01-01T16:50:46.219649-06:00","created_by":"ccheney"},{"issue_id":"engram-09vr","depends_on_id":"engram-ro19","type":"blocks","created_at":"2026-01-01T16:50:52.045243-06:00","created_by":"ccheney"},{"issue_id":"engram-09vr","depends_on_id":"engram-dtbw","type":"blocks","created_at":"2026-01-01T17:08:45.794487-06:00","created_by":"ccheney"},{"issue_id":"engram-09vr","depends_on_id":"engram-htgl2","type":"blocks","created_at":"2026-01-01T17:08:50.927213-06:00","created_by":"ccheney"}]}
{"id":"engram-0ayr9","title":"Unit tests for decay score calculation","description":"Create apps/worker/src/algorithms/__tests__/decay.test.ts. Test: formula correctness, type weights, recency factor with various ages, access boost with different counts, pinned memories excluded, boundary conditions.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:13.657423-06:00","updated_at":"2026-01-01T16:50:13.657423-06:00","dependencies":[{"issue_id":"engram-0ayr9","depends_on_id":"engram-t1n56","type":"blocks","created_at":"2026-01-01T16:52:22.222204-06:00","created_by":"ccheney"}]}
{"id":"engram-0azz","title":"[Benchmark-Py] Phase 2b: Retrieval Integration","description":"Implement retrieval providers. Sentence-transformers embedder for local models. In-memory ChromaDB for testing. Qdrant async client for production. HTTP client for Engram search-py service. Hybrid search with RRF fusion.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 3: Retrieval)\n\nDeliverables:\n- src/engram_benchmark/providers/embeddings.py - Sentence-transformers wrapper\n- src/engram_benchmark/providers/engram.py - HTTP client for search-py\n- src/engram_benchmark/longmemeval/retriever.py - Retrieval interface\n- ChromaDB in-memory store for tests\n- Qdrant async client\n- Unit tests with mock embeddings\n- Integration tests with Qdrant\n\nDEPENDS ON: [Search-Py] Phase 6: Cutover (for Engram provider)\nCAN BE DEVELOPED IN PARALLEL WITH: [Benchmark-Py] Phase 2a: LLM, Phase 2c: Metrics","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:23:57.816494-06:00","updated_at":"2025-12-20T09:35:34.145299-06:00","closed_at":"2025-12-20T09:35:34.145299-06:00","dependencies":[{"issue_id":"engram-0azz","depends_on_id":"engram-fpr1","type":"blocks","created_at":"2025-12-20T07:25:05.019712-06:00","created_by":"ccheney"},{"issue_id":"engram-0azz","depends_on_id":"engram-684i","type":"blocks","created_at":"2025-12-20T07:25:10.158633-06:00","created_by":"ccheney"}]}
{"id":"engram-0c73","title":"Remove deprecated MOTIVATED_BY edge","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:12:31.974429-05:00","updated_at":"2025-12-24T02:14:38.386975-05:00","closed_at":"2025-12-24T02:14:38.386975-05:00"}
{"id":"engram-0fyb","title":"Test coverage: packages/infra/src/testing.ts (89%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:41.264699-06:00","updated_at":"2025-12-21T04:07:03.760705-06:00","closed_at":"2025-12-21T04:07:03.760705-06:00"}
{"id":"engram-0gie","title":"Create ConflictDetectionConfig","description":"Add configuration interface and defaults to apps/mcp/src/config.ts: enabled, similarityThreshold (0.65), maxCandidates (10), requireConfirmation, verboseLogging","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:09.031801-06:00","updated_at":"2026-01-01T17:33:01.676655-06:00","closed_at":"2026-01-01T17:33:01.676655-06:00"}
{"id":"engram-0kdy","title":"Implement /v1/usage API endpoint","description":"apps/api README.md:18 documents GET /v1/usage for API key usage stats but no route handler exists.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:14:51.447538-06:00","updated_at":"2025-12-20T23:26:06.369632-06:00","closed_at":"2025-12-20T23:26:06.369632-06:00"}
{"id":"engram-0npu","title":"Update packages/infra package.json for OpenTofu","description":"Update npm scripts for OpenTofu workflow.\n\n## Changes to package.json\n```json\n{\n  \"scripts\": {\n    \"init\": \"tofu init\",\n    \"validate\": \"tofu validate\",\n    \"test\": \"tofu test\",\n    \"plan\": \"tofu plan\",\n    \"up\": \"tofu apply -auto-approve\",\n    \"down\": \"tofu destroy -auto-approve\",\n    \"output\": \"tofu output\",\n    \"fmt\": \"tofu fmt -recursive\"\n  }\n}\n```\n\n## Remove old dependencies\n- @pulumi/gcp\n- @pulumi/kubernetes\n- @pulumi/pulumi\n\n## Acceptance Criteria\n- `npm run plan` works\n- `npm run up` provisions infrastructure\n- `npm run test` runs OpenTofu tests","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:50:05.084122-06:00","updated_at":"2025-12-21T15:50:05.084122-06:00","dependencies":[{"issue_id":"engram-0npu","depends_on_id":"engram-nr5u","type":"blocks","created_at":"2025-12-21T15:51:20.927372-06:00","created_by":"ccheney"}]}
{"id":"engram-0ojf","title":"Improve engram_recall tool description","description":"Update apps/mcp/src/tools/recall.ts with improved descriptions. Changes:\n- Main description: 'Search past memories using semantic similarity. Use at session start to prime yourself with relevant prior knowledge, before making decisions to check for existing rationale, or when the user references 'before', 'last time', or 'remember when'.'\n- query param: Guide on being descriptive vs terse\n- filters.type param: Explain when to use each type filter\n\nNote: rerank and rerank_tier descriptions are already good.\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_recall","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:51:53.878558-05:00","updated_at":"2025-12-25T00:58:00.832525-05:00","closed_at":"2025-12-25T00:58:00.832525-05:00"}
{"id":"engram-0p4e","title":"E2E tests for full multi-tenant flow","description":"End-to-end tests for complete multi-tenant workflow.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Testing Strategy section (lines 648-651)\n\n## Test Scenarios\n- Full flow: MCP tool → API → FalkorDB → Qdrant → Response\n- Multi-org scenario with concurrent operations\n- Large tenant shard promotion (Tiered Multitenancy)\n- Device flow auth with org selection\n\n## Files to Create\n- tests/e2e/multi-tenancy.test.ts\n\n## Agent Instructions\nThese are slow tests. Use appropriate timeouts and parallelization.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:09:46.390198-06:00","updated_at":"2025-12-30T00:02:18.430891-06:00","closed_at":"2025-12-30T00:02:18.430891-06:00","dependencies":[{"issue_id":"engram-0p4e","depends_on_id":"engram-jekc","type":"blocks","created_at":"2025-12-29T22:12:56.596174-06:00","created_by":"ccheney"}]}
{"id":"engram-0p9h","title":"Update all Dockerfiles to Bun 1.3.5 runtime","description":"Switch all TypeScript service Dockerfiles from Node.js to Bun runtime.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 9: Dockerfiles to Update\n\n## Dockerfiles to Update\n- apps/ingestion/Dockerfile\n- apps/ingestion/Dockerfile.dev\n- apps/memory/Dockerfile  \n- apps/memory/Dockerfile.dev\n- apps/control/Dockerfile\n- apps/control/Dockerfile.dev\n- apps/observatory/Dockerfile\n- apps/observatory/Dockerfile.dev\n- apps/api/Dockerfile\n- apps/api/Dockerfile.dev\n- apps/mcp/Dockerfile\n- apps/mcp/Dockerfile.dev\n\n## Changes\n- FROM node:* → FROM oven/bun:1.3.5-alpine\n- npm install → bun install\n- npm run → bun run\n- node → bun\n\n## Acceptance Criteria\n- All containers build successfully with Bun\n- Services start and run correctly\n- No Node.js dependencies remain","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:27:55.410387-05:00","updated_at":"2025-12-22T00:39:47.795763-05:00","closed_at":"2025-12-22T00:39:47.795763-05:00"}
{"id":"engram-0v41","title":"Create schema composition (defineSchema)","description":"Implement schema composition in packages/graph/src/schema/schema.ts\n\n## Overview\nThe defineSchema() function combines node and edge definitions into a complete schema object. This schema becomes the single source of truth for all code generation and validation.\n\n## Requirements\n- defineSchema() function combining nodes and edges\n- Schema validation (check edge from/to references exist)\n- Type inference for complete schema structure\n- Export schema type for use in generators\n- Runtime access to schema metadata\n\n## API Design\n```typescript\nimport { defineSchema } from '@engram/graph/schema';\nimport { MemoryNode, SessionNode, TurnNode } from './nodes';\nimport { HasTurn, Mentions, Replaces } from './edges';\n\nexport const schema = defineSchema({\n  nodes: {\n    Memory: MemoryNode,\n    Session: SessionNode,\n    Turn: TurnNode,\n  },\n  edges: {\n    HAS_TURN: HasTurn,\n    MENTIONS: Mentions,\n    REPLACES: Replaces,\n  },\n});\n\n// Inferred types\ntype Schema = typeof schema;\ntype NodeTypes = keyof Schema['nodes']; // 'Memory' | 'Session' | 'Turn'\ntype EdgeTypes = keyof Schema['edges']; // 'HAS_TURN' | 'MENTIONS' | 'REPLACES'\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'schema definition drizzle config')`\n- `query-docs('/prisma/docs', 'prisma schema validation')`\n\nUse web search for:\n- 'TypeScript schema validation at compile time'\n- 'Drizzle drizzleConfig schema composition'\n- 'TypeScript const assertion object inference'\n- 'Zod schema composition patterns'\n\n## Validation Rules\n- All edge 'from' references must exist in nodes\n- All edge 'to' references must exist in nodes\n- Node names must be valid identifiers\n- No duplicate node or edge names\n\n## Files\n- packages/graph/src/schema/schema.ts (NEW)\n- packages/graph/src/schema/index.ts (barrel export)\n\n## References\n- Drizzle schema: https://orm.drizzle.team/docs/sql-schema-declaration\n- Prisma schema: https://www.prisma.io/docs/concepts/components/prisma-schema\n- TypeScript const assertions: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html\n- Plan: docs/plans/compiled-query-layer.md lines 587-594","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:48:59.249432-06:00","updated_at":"2026-01-01T18:00:55.977248-06:00","closed_at":"2026-01-01T18:00:55.977248-06:00","dependencies":[{"issue_id":"engram-0v41","depends_on_id":"engram-kcjg","type":"blocks","created_at":"2026-01-01T16:54:13.061923-06:00","created_by":"ccheney"},{"issue_id":"engram-0v41","depends_on_id":"engram-c5jh","type":"blocks","created_at":"2026-01-01T16:54:18.247162-06:00","created_by":"ccheney"}]}
{"id":"engram-0vhj","title":"Remove unused K8s resource exports from infra","description":"packages/infra index.ts:26-60 exports 12+ K8s resource objects that are never imported. Only endpoint strings are needed.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:16:45.060997-06:00","updated_at":"2025-12-20T23:20:35.227772-06:00","closed_at":"2025-12-20T23:20:35.227772-06:00"}
{"id":"engram-0wlo","title":"Create repository generator (codegen)","description":"Implement repository generation from schema in packages/graph/src/codegen/repository-generator.ts\n\n## Overview\nThe repository generator creates FalkorDB repository implementations for each node type. Repositories provide the data access layer with CRUD operations, temporal queries, and relationship handling.\n\n## Requirements\n- Generate FalkorXXXRepository class for each node type\n- Include standard CRUD operations (create, findById, update, delete)\n- Generate temporal queries (findByIdAt, asOf)\n- Generate relationship traversal methods based on edges\n- Include proper tenant context handling\n- Extend FalkorBaseRepository\n\n## Example Output\n```typescript\n// AUTO-GENERATED - DO NOT EDIT\n\nimport { FalkorBaseRepository } from './falkor-base';\nimport type { Memory, CreateMemoryInput, UpdateMemoryInput } from '../generated/types';\nimport type { TimeTravelOptions } from '../utils/time';\n\nexport class FalkorMemoryRepository extends FalkorBaseRepository {\n  async create(input: CreateMemoryInput): Promise\u003cMemory\u003e {\n    const id = this.generateId();\n    const bitemporal = this.createBitemporal();\n    \n    await this.query(\n      `CREATE (m:Memory {id: $id, ...props, ...bitemporal}) RETURN m`,\n      { id, props: this.camelToSnake(input), ...bitemporal }\n    );\n    \n    return this.findById(id);\n  }\n\n  async findById(id: string): Promise\u003cMemory | null\u003e {\n    const results = await this.query\u003c{ m: FalkorNode\u003cMemory\u003e }\u003e(\n      `MATCH (m:Memory {id: $id}) WHERE m.tt_end = ${this.maxDate} RETURN m`,\n      { id }\n    );\n    return results[0]?.m ? this.mapToMemory(results[0].m) : null;\n  }\n\n  async findByIdAt(id: string, time: TimeTravelOptions): Promise\u003cMemory | null\u003e {\n    const qb = this.createQueryBuilder()\n      .match('(m:Memory {id: $id})')\n      .at(['m'], time)\n      .return('m');\n    // ...\n  }\n\n  async findByType(type: MemoryType): Promise\u003cMemory[]\u003e { ... }\n  async findByTag(tag: string): Promise\u003cMemory[]\u003e { ... }\n  async update(id: string, updates: UpdateMemoryInput): Promise\u003cMemory\u003e { ... }\n  async delete(id: string): Promise\u003cvoid\u003e { ... }\n}\n```\n\n## Research Required\nReview existing repositories:\n- packages/graph/src/repositories/falkor-session.repository.ts\n- packages/graph/src/repositories/falkor-memory.repository.ts\n- packages/graph/src/repositories/falkor-base.ts\n\nUse web search for:\n- 'Repository pattern code generation'\n- 'TypeORM repository generation'\n- 'Prisma client repository methods'\n\n## Technical Considerations\n- Follow existing FalkorBaseRepository patterns\n- Handle snake_case/camelCase conversion\n- Include proper error handling\n- Support both legacy GraphClient and TenantAwareFalkorClient\n\n## Files\n- packages/graph/src/codegen/repository-generator.ts (NEW)\n\n## References\n- Existing repos: packages/graph/src/repositories/\n- Prisma CRUD: https://www.prisma.io/docs/concepts/components/prisma-client/crud\n- Plan: docs/plans/compiled-query-layer.md lines 619-621","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:01.117077-06:00","updated_at":"2026-01-01T17:09:28.378007-06:00","dependencies":[{"issue_id":"engram-0wlo","depends_on_id":"engram-lzgs","type":"blocks","created_at":"2026-01-01T16:55:18.333458-06:00","created_by":"ccheney"}]}
{"id":"engram-0yaq","title":"[HIGH] Kafka consumer never disconnected in apps/control","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:59.145543-06:00","updated_at":"2025-12-20T23:57:48.168365-06:00","closed_at":"2025-12-20T23:57:48.168365-06:00"}
{"id":"engram-1","title":"Add Test Coverage: apps/control","description":"Add comprehensive unit and integration tests for apps/control","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.338777-06:00","closed_at":"2025-12-07T02:05:09.287288-06:00","labels":["apps","control","testing"]}
{"id":"engram-10","title":"LongMemEval Benchmark Adapter","description":"","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T11:33:01.4785-06:00","updated_at":"2025-12-19T15:32:08.343293-06:00","closed_at":"2025-12-18T12:40:54.397026-06:00"}
{"id":"engram-100","title":"Implement VFS Snapshot Logic","description":"Serialize/Compress VFS state to JSON/Gzip. See docs/bitemporal/context/deterministic-execution/implement-vfs-snapshot-logic.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.629537-06:00","updated_at":"2025-12-19T15:32:08.377668-06:00","closed_at":"2025-12-06T22:29:38.265812-06:00","labels":["execution","snapshot","vfs"],"dependencies":[{"issue_id":"engram-100","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.629924-06:00","created_by":"daemon"}]}
{"id":"engram-101","title":"Implement Diff Application Logic","description":"Apply Unified Diffs to VFS files. See docs/bitemporal/context/deterministic-execution/implement-diff-application-logic.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.673244-06:00","updated_at":"2025-12-19T15:32:08.378174-06:00","closed_at":"2025-12-06T22:29:38.292881-06:00","labels":["diff","execution","vfs"],"dependencies":[{"issue_id":"engram-101","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.673664-06:00","created_by":"daemon"}]}
{"id":"engram-102","title":"Implement sparse vector embeddings for hybrid search","description":"The embedSparse() method in search-core/services/text-embedder.ts returns empty {indices: [], values: []}. This makes hybrid search effectively dense-only. Need to implement SPLADE or BM25 sparse embeddings. Ref: TSD 3.3.1, docs/report/feature-parity-analysis.md","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-08T02:05:37.416913-06:00","updated_at":"2025-12-19T15:32:08.37846-06:00","closed_at":"2025-12-08T02:13:54.163104-06:00"}
{"id":"engram-103","title":"Define Wassette Runtime Configuration","description":"Wasm runtime config schema (memory, env, preopens). See docs/bitemporal/context/deterministic-execution/define-wassette-runtime-configuration.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.75718-06:00","updated_at":"2025-12-19T15:32:08.378712-06:00","closed_at":"2025-12-06T22:30:19.573727-06:00","labels":["config","execution","wasm"],"dependencies":[{"issue_id":"engram-103","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.757567-06:00","created_by":"daemon"}]}
{"id":"engram-104","title":"Develop Sandbox Security Policy","description":"Enforce No-Network, Read-Only Sysroot. See docs/bitemporal/context/deterministic-execution/develop-sandbox-security-policy.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.840586-06:00","updated_at":"2025-12-19T15:32:08.379003-06:00","closed_at":"2025-12-06T22:30:19.633306-06:00","labels":["execution","sandbox","security"],"dependencies":[{"issue_id":"engram-104","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.841015-06:00","created_by":"daemon"}]}
{"id":"engram-105","title":"Implement Tool Execution Monitor","description":"Orchestrate Wasm start and timeout monitoring. See docs/bitemporal/context/deterministic-execution/implement-tool-execution-monitor.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.967993-06:00","updated_at":"2025-12-19T15:32:08.379307-06:00","closed_at":"2025-12-06T22:30:52.068873-06:00","labels":["execution","monitor"],"dependencies":[{"issue_id":"engram-105","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.968351-06:00","created_by":"daemon"}]}
{"id":"engram-106","title":"Develop Output Capture","description":"Capture stdout/stderr from Wasm instance. See docs/bitemporal/context/deterministic-execution/develop-output-capture.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:13.012726-06:00","updated_at":"2025-12-19T15:32:08.379607-06:00","closed_at":"2025-12-06T22:30:52.096077-06:00","labels":["execution","io","logs"],"dependencies":[{"issue_id":"engram-106","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:13.013154-06:00","created_by":"daemon"}]}
{"id":"engram-107","title":"CRITICAL: XState guard evaluates stale context - tools never execute","description":"Location: apps/control/src/engine/decision.ts:216-218\n\nThe guard 'requiresTool' reads from context.currentToolCalls which is assigned by the onDone action. In XState v5, guards are evaluated BEFORE actions run. The guard checks the PREVIOUS value of currentToolCalls, not the value from event.output.\n\nImpact: Tool calls are never executed; agent always responds without using tools.\n\nFix: Access event.output in the guard instead of context, or restructure the state machine.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:55:48.646311-06:00","updated_at":"2025-12-19T15:32:08.379922-06:00","closed_at":"2025-12-18T22:17:19.548026-06:00"}
{"id":"engram-108","title":"HIGH: Cypher injection via limit parameter interpolation","description":"Locations:\n- apps/interface/app/api/graphql/schema.ts:88,129\n- apps/interface/lib/graph-queries.ts:479\n- apps/control/src/context/assembler.ts:117-124\n- apps/memory/src/index.ts:406-411\n\nUser-controlled limit parameters are directly interpolated into Cypher queries without sanitization, enabling potential injection attacks.\n\nFix: Use parameterized queries for all values including LIMIT and SKIP.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:16.308652-06:00","updated_at":"2025-12-19T15:32:08.380148-06:00","closed_at":"2025-12-19T00:39:58.198071-06:00"}
{"id":"engram-109","title":"Redesign Soul System Interface with distinctive aesthetic","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-07T02:37:33.885606-06:00","updated_at":"2025-12-19T15:32:08.380358-06:00","closed_at":"2025-12-08T02:59:44.97476-06:00"}
{"id":"engram-11","title":"Milestone 2: Optimized Retrieval","description":"Turn-level granularity indexing, key expansion (fact extraction), time-aware query expansion, hybrid retrieval","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:33:33.557628-06:00","updated_at":"2025-12-19T15:32:08.343585-06:00","closed_at":"2025-12-18T12:13:41.063685-06:00","dependencies":[{"issue_id":"engram-11","depends_on_id":"engram-62","type":"blocks","created_at":"2025-12-18T11:34:04.564238-06:00","created_by":"ccheney"}]}
{"id":"engram-110","title":"Expand GraphQL query execution","description":"GraphQL handler in interface/app/api/graphql/route.ts is minimal. Schema is defined but resolvers need full implementation for session, search, and graph queries. Ref: create-graphql-schema-definition.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T02:06:26.65604-06:00","updated_at":"2025-12-19T15:32:08.380575-06:00","closed_at":"2025-12-08T02:37:25.907356-06:00"}
{"id":"engram-111","title":"Optimize batch graph pruning","description":"GraphPruner uses single-threaded deletion which may be slow on large graphs. Need to implement batched deletion with configurable batch sizes to avoid Redis timeouts. Ref: implement-graph-pruning-strategy.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T02:06:28.17326-06:00","updated_at":"2025-12-19T15:32:08.380811-06:00","closed_at":"2025-12-08T02:39:05.558051-06:00"}
{"id":"engram-112","title":"Implement GCS blob store adapter","description":"GCSBlobStore in storage/src/blob.ts is a stub with console.log only. Need to implement actual GCS operations using @google-cloud/storage for production blob storage. Ref: create-blob-storage-adapter.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T02:06:29.12036-06:00","updated_at":"2025-12-19T15:32:08.381025-06:00","closed_at":"2025-12-08T02:41:05.652671-06:00"}
{"id":"engram-113","title":"Implement Qdrant snapshot recovery","description":"SnapshotManager can list and create snapshots but cannot restore from them. Need to implement restoreSnapshot() method for disaster recovery. Ref: implement-qdrant-snapshot-manager.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T02:06:29.976926-06:00","updated_at":"2025-12-19T15:32:08.381239-06:00","closed_at":"2025-12-08T02:44:01.472982-06:00"}
{"id":"engram-114","title":"HIGH: Cypher injection in GraphWriter label/relationType","description":"Location: packages/memory-core/src/graph.ts:19,39\n\nThe GraphWriter class constructs Cypher queries by directly interpolating the label and relationType parameters into query strings without sanitization.\n\nExample exploitation:\nwriter.writeNode('Session} DETACH DELETE (n) WITH n CREATE (n:Evil', data);\n\nFix: Validate label/type strings against a regex like /^[A-Za-z_][A-Za-z0-9_]*$/","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:17.363826-06:00","updated_at":"2025-12-19T15:32:08.381457-06:00","closed_at":"2025-12-19T00:39:58.197364-06:00"}
{"id":"engram-116","title":"HIGH: Path traversal vulnerability in FileSystemBlobStore","description":"Location: packages/storage/src/blob.ts:26-31\n\nThe load method directly uses the file path from the URI without any validation or sanitization. An attacker could craft a malicious URI like file://../../../etc/passwd to read arbitrary files.\n\nImpact: Arbitrary file read outside intended blob storage directory.\n\nFix: Validate that resolved path is within the basePath directory.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:19.570428-06:00","updated_at":"2025-12-19T15:32:08.381947-06:00","closed_at":"2025-12-19T00:39:58.19682-06:00"}
{"id":"engram-117","title":"Evaluate Hugging Face models for sparse embeddings","description":"Investigate using Hugging Face's SPLADE or other sparse embedding models via transformers.js as an alternative to the current BM25 implementation. Current BM25Sparse uses simple TF-based scoring without IDF. Consider: 1) SPLADE models for learned sparse embeddings 2) FastEmbed integration if available for JS 3) Proper vocabulary-based tokenization instead of hash-based indexing. Ref: text-embedder.ts BM25Sparse class","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T02:15:39.264419-06:00","updated_at":"2025-12-19T15:32:08.382171-06:00","closed_at":"2025-12-08T02:49:37.421264-06:00"}
{"id":"engram-118","title":"Implement UI for Lineage and Replay","description":"Build React components in apps/interface to visualize the lineage graph and session replay data using the new API endpoints.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-07T01:21:25.207222-06:00","updated_at":"2025-12-19T15:32:08.382385-06:00","closed_at":"2025-12-07T01:32:59.460857-06:00"}
{"id":"engram-119","title":"HIGH: Path traversal vulnerability in NodeFileSystem","description":"Location: packages/vfs/src/node-fs.ts\n\nThe NodeFileSystem class directly passes user-supplied paths to fs module functions without any validation, allowing path traversal attacks.\n\nImpact: If used in a web service context where paths come from user input, this is a critical security vulnerability.\n\nFix: Add basePath validation and normalize paths before use.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:20.636638-06:00","updated_at":"2025-12-19T15:32:08.382598-06:00","closed_at":"2025-12-19T00:39:58.195849-06:00"}
{"id":"engram-12","title":"Milestone 3: Optimized Reading","description":"Chain-of-Note implementation, structured JSON prompts, abstention confidence calibration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:33:40.424722-06:00","updated_at":"2025-12-19T15:32:08.344007-06:00","closed_at":"2025-12-18T12:24:41.33083-06:00","dependencies":[{"issue_id":"engram-12","depends_on_id":"engram-11","type":"blocks","created_at":"2025-12-18T11:34:10.87876-06:00","created_by":"ccheney"}]}
{"id":"engram-120","title":"Implement Custom Logger Package","description":"Refactor @the-soul/logger to match the provided reference implementation using pino, redaction, and structured logging. Ensure all apps use it.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-07T01:06:06.999517-06:00","updated_at":"2025-12-19T15:32:08.382812-06:00","closed_at":"2025-12-07T01:08:37.608613-06:00"}
{"id":"engram-121","title":"Refactor Path Aliases","description":"Configure tsconfig paths (@/* or specific aliases) for all apps and packages to simplify imports.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T00:53:12.853766-06:00","updated_at":"2025-12-19T15:32:08.383035-06:00","closed_at":"2025-12-07T00:57:10.48543-06:00"}
{"id":"engram-122","title":"Verify Wasm Tool Execution","description":"the-system-1p4","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T00:36:29.042108-06:00","updated_at":"2025-12-19T15:32:08.383242-06:00","closed_at":"2025-12-07T00:43:53.917833-06:00"}
{"id":"engram-123","title":"HIGH: Rate limiter uses cumulative cost instead of per-request","description":"Location: packages/search-core/src/services/llm-reranker.ts:200-202\n\nThe cost used for rate limiting is the cumulative total cost, not the cost of the current request. getTotalCost() returns the total cost since the client was created.\n\nImpact: Rate limiting/budget tracking is fundamentally broken - records increasingly large costs over time.\n\nFix: Track per-request cost instead of cumulative total.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:21.786467-06:00","updated_at":"2025-12-19T15:32:08.383499-06:00","closed_at":"2025-12-19T00:39:58.199155-06:00"}
{"id":"engram-124","title":"HIGH: App crashes on startup if XAI_API_KEY not set","description":"Location: packages/search-core/src/config/runtime-config.ts:207-213\n\nIf XAI_API_KEY is not set and LLM tier is enabled by default, calling RuntimeConfig.get() will throw.\n\nThe default config has llm.enabled = true. Any code that imports and uses RuntimeConfig.get() will throw if XAI_API_KEY is not set.\n\nFix: Make LLM tier disabled by default, or handle missing key gracefully.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:23.656683-06:00","updated_at":"2025-12-19T15:32:08.38372-06:00","closed_at":"2025-12-19T00:39:58.199518-06:00"}
{"id":"engram-125","title":"Define Virtual File System Structure","description":"In-memory Serializable JSON VFS (Files/Dirs). See docs/bitemporal/context/deterministic-execution/define-virtual-file-system-structure.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.586566-06:00","updated_at":"2025-12-19T15:32:08.383957-06:00","closed_at":"2025-12-06T22:29:38.233359-06:00","labels":["execution","structure","vfs"],"dependencies":[{"issue_id":"engram-125","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.586995-06:00","created_by":"daemon"}]}
{"id":"engram-126","title":"HIGH: Missing named vector field in deduplicator search","description":"Location: packages/search-core/src/services/deduplicator.ts:25-30\n\nThe search does not specify which vector field to use, but the collection has named vectors (text_dense, code_dense, colbert).\n\nSearching without specifying the vector name will fail or produce unexpected results with modern Qdrant API.\n\nFix: Specify the vector field name in the search query.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:25.066329-06:00","updated_at":"2025-12-19T15:32:08.384252-06:00","closed_at":"2025-12-19T00:39:58.197106-06:00"}
{"id":"engram-127","title":"Implement query result Redis cache","description":"Cache reranked results in Redis with 5min TTL. Key: hash(query+filters+rerankTier). Target 30%+ hit rate.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:13.374933-06:00","updated_at":"2025-12-19T15:32:08.384485-06:00","closed_at":"2025-12-09T00:24:38.126496-06:00","dependencies":[{"issue_id":"engram-127","depends_on_id":"engram-132","type":"blocks","created_at":"2025-12-08T23:03:27.884299-06:00","created_by":"daemon"}]}
{"id":"engram-128","title":"MEDIUM: Unbounded session engine cache - memory leak","description":"Location: apps/control/src/session/manager.ts:27,78-82\n\nThe SessionManager stores DecisionEngine instances in a Map keyed by session ID but never removes them. Each engine contains an XState actor with subscriptions and event listeners.\n\nImpact: Memory leak, eventual OOM crash for long-running service.\n\nFix: Implement session timeout/cleanup mechanism.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:59.330219-06:00","updated_at":"2025-12-19T15:32:08.384885-06:00","closed_at":"2025-12-19T00:59:10.887277-06:00"}
{"id":"engram-129","title":"Add FileTouchNode schema to memory-core","description":"Create FileTouchNode with file_path (indexed), action (read/edit/create/delete), diff_preview","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T03:13:54.365247-06:00","updated_at":"2025-12-19T15:32:08.385157-06:00","closed_at":"2025-12-08T03:18:11.196582-06:00","dependencies":[{"issue_id":"engram-129","depends_on_id":"engram-259","type":"blocks","created_at":"2025-12-08T03:14:04.515795-06:00","created_by":"daemon"}]}
{"id":"engram-13","title":"Milestone 4: Full Evaluation","description":"GPT-4o QA evaluation integration, per-category metrics breakdown, retrieval recall/NDCG computation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:33:46.465895-06:00","updated_at":"2025-12-19T15:32:08.344386-06:00","closed_at":"2025-12-18T12:33:05.083667-06:00","dependencies":[{"issue_id":"engram-13","depends_on_id":"engram-12","type":"blocks","created_at":"2025-12-18T11:34:17.902632-06:00","created_by":"ccheney"}]}
{"id":"engram-130","title":"Update edge types for new hierarchy","description":"Add HAS_TURN, CONTAINS, TOUCHES edges. Session→Turn→Reasoning/FileTouch hierarchy","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T03:13:56.705827-06:00","updated_at":"2025-12-19T15:32:08.385451-06:00","closed_at":"2025-12-08T03:19:20.848304-06:00","dependencies":[{"issue_id":"engram-130","depends_on_id":"engram-259","type":"blocks","created_at":"2025-12-08T03:14:04.593217-06:00","created_by":"daemon"}]}
{"id":"engram-131","title":"Update memory app ingestion to create Turn/Reasoning/FileTouch nodes","description":"Modify apps/memory to aggregate tokens into Turns, extract reasoning blocks, track file touches","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T03:13:57.810188-06:00","updated_at":"2025-12-19T15:32:08.385773-06:00","closed_at":"2025-12-08T03:24:06.494292-06:00","dependencies":[{"issue_id":"engram-131","depends_on_id":"engram-130","type":"blocks","created_at":"2025-12-08T03:14:04.631055-06:00","created_by":"daemon"}]}
{"id":"engram-132","title":"Implement document representation LRU cache","description":"In-memory LRU cache for ColBERT document embeddings. Max size 1GB, 1hr TTL. Invalidate on document update.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:12.52381-06:00","updated_at":"2025-12-19T15:32:08.386072-06:00","closed_at":"2025-12-09T00:24:36.899172-06:00"}
{"id":"engram-133","title":"MEDIUM: Module-level state shared between TurnAggregator instances","description":"Location: apps/memory/src/turn-aggregator.ts:56-59\n\nThe activeTurns and sessionSequence maps are declared at module level but accessed by instance methods. sessionSequence is never cleaned up.\n\nImpact: State leakage between tests, memory leak over time.\n\nFix: Move maps to instance properties or implement cleanup mechanism.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:01.517812-06:00","updated_at":"2025-12-19T15:32:08.386387-06:00","closed_at":"2025-12-19T00:58:58.339455-06:00"}
{"id":"engram-134","title":"Evaluate interface nodes: add Cost, Session, GitSnapshot, Timing nodes?","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T18:50:45.476212-06:00","updated_at":"2025-12-19T15:32:08.386644-06:00","closed_at":"2025-12-08T19:01:43.324894-06:00"}
{"id":"engram-135","title":"MEDIUM: Interval timers not cleared on shutdown","description":"Location: apps/memory/src/index.ts:142-165\n\nstartPruningJob() and startTurnCleanupJob() create setInterval timers but never store or return the interval IDs. The shutdown handler only clears heartbeatInterval.\n\nImpact: Timers continue running during shutdown, may cause errors.\n\nFix: Store interval IDs and clear them in shutdown handler.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:02.388938-06:00","updated_at":"2025-12-19T15:32:08.386887-06:00","closed_at":"2025-12-19T00:58:58.337954-06:00"}
{"id":"engram-136","title":"Implement Wassette MCP Client","description":"Expose execution tools via MCP. See docs/bitemporal/context/deterministic-execution/implement-wassette-mcp-client.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:13.183237-06:00","updated_at":"2025-12-19T15:32:08.387112-06:00","closed_at":"2025-12-06T22:31:25.865419-06:00","labels":["api","execution","mcp"],"dependencies":[{"issue_id":"engram-136","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:13.183643-06:00","created_by":"daemon"}]}
{"id":"engram-137","title":"Define Execution Error Handling","description":"Classify User vs System errors. See docs/bitemporal/context/deterministic-execution/define-execution-error-handling.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:13.139375-06:00","updated_at":"2025-12-19T15:32:08.387426-06:00","closed_at":"2025-12-06T22:31:25.836447-06:00","labels":["errors","execution"],"dependencies":[{"issue_id":"engram-137","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:13.139707-06:00","created_by":"daemon"}]}
{"id":"engram-138","title":"Implement Deterministic Replay Engine","description":"Re-run sessions with mocked Time/RNG. See docs/bitemporal/context/deterministic-execution/implement-deterministic-replay-engine.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:13.055726-06:00","updated_at":"2025-12-19T15:32:08.387749-06:00","closed_at":"2025-12-06T22:31:25.804666-06:00","labels":["determinism","execution","replay"],"dependencies":[{"issue_id":"engram-138","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:13.056108-06:00","created_by":"daemon"}]}
{"id":"engram-139","title":"Create MCP Tool Registry","description":"Registry mapping tool names to Wasm entrypoints. See docs/bitemporal/context/deterministic-execution/create-mcp-tool-registry.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:12.926676-06:00","updated_at":"2025-12-19T15:32:08.388065-06:00","closed_at":"2025-12-06T22:30:52.041813-06:00","labels":["execution","mcp","registry"],"dependencies":[{"issue_id":"engram-139","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.927093-06:00","created_by":"daemon"}]}
{"id":"engram-13lo7","title":"Add tests for apps/api routes and services","description":"Missing tests for API endpoints and services:\n- db/migrate.ts, db/oauth-tokens.ts, db/organizations.ts\n- middleware/rate-limit.ts\n- routes/admin.ts, routes/alerts.ts, routes/deployments.ts, routes/metrics.ts\n- services/audit.ts\n\nPriority: HIGH - REST API is the main entry point","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:20:37.42977-06:00","updated_at":"2026-01-01T17:20:37.42977-06:00"}
{"id":"engram-14","title":"Milestone 5: CI/CD and Reporting","description":"Automated benchmark runs, historical score tracking, regression detection","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:33:53.022111-06:00","updated_at":"2025-12-19T15:32:08.344789-06:00","closed_at":"2025-12-18T12:40:47.886005-06:00","dependencies":[{"issue_id":"engram-14","depends_on_id":"engram-13","type":"blocks","created_at":"2025-12-18T11:34:24.03805-06:00","created_by":"ccheney"}]}
{"id":"engram-140","title":"Implement Standard Tool Wrapper","description":"Python/JS wrapper to read stdin args and print JSON stdout. See docs/bitemporal/context/deterministic-execution/implement-standard-tool-wrapper-wasm.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:12.883147-06:00","updated_at":"2025-12-19T15:32:08.38841-06:00","closed_at":"2025-12-06T22:30:52.011826-06:00","labels":["execution","tools","wrapper"],"dependencies":[{"issue_id":"engram-140","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.883517-06:00","created_by":"daemon"}]}
{"id":"engram-141","title":"Implement Wasm Module Loader","description":"Load and cache Wasm binaries (Python, QuickJS). See docs/bitemporal/context/deterministic-execution/implement-wasm-module-loader.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:12.798975-06:00","updated_at":"2025-12-19T15:32:08.38875-06:00","closed_at":"2025-12-06T22:30:19.604297-06:00","labels":["execution","loader","wasm"],"dependencies":[{"issue_id":"engram-141","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.799295-06:00","created_by":"daemon"}]}
{"id":"engram-142","title":"Create Graphiti MCP Server Wrapper","description":"Expose memory capabilities via MCP (read_graph, search). See docs/bitemporal/context/bitemporal-memory/create-graphiti-mcp-server-wrapper.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:50:33.807801-06:00","updated_at":"2025-12-19T15:32:08.389049-06:00","closed_at":"2025-12-06T22:26:39.919864-06:00","labels":["api","mcp","memory"],"dependencies":[{"issue_id":"engram-142","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.808232-06:00","created_by":"daemon"}]}
{"id":"engram-143","title":"Implement Transaction Time Logic","description":"Logic for 'Correction' (Append-Only + REPLACES edge). See docs/bitemporal/context/bitemporal-memory/implement-transaction-time-logic.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:50:33.718919-06:00","updated_at":"2025-12-19T15:32:08.390617-06:00","closed_at":"2025-12-06T22:26:05.365759-06:00","labels":["logic","memory","temporal"],"dependencies":[{"issue_id":"engram-143","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.719335-06:00","created_by":"daemon"}]}
{"id":"engram-144","title":"Develop Bitemporal Query Builder","description":"Fluent API to inject temporal WHERE clauses into Cypher. See docs/bitemporal/context/bitemporal-memory/develop-bitemporal-query-builder.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:50:33.547233-06:00","updated_at":"2025-12-19T15:32:08.39095-06:00","closed_at":"2025-12-06T22:25:41.607899-06:00","labels":["builder","cypher","memory"],"dependencies":[{"issue_id":"engram-144","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.547662-06:00","created_by":"daemon"}]}
{"id":"engram-145","title":"Implement Stream De-multiplexer","description":"Ensure ordering by using session_id as Kafka partition key. See docs/bitemporal/context/cognitive-ingestion/implement-stream-de-multiplexer.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:50.484897-06:00","updated_at":"2025-12-19T15:32:08.391261-06:00","closed_at":"2025-12-06T22:27:34.813109-06:00","labels":["ingestion","partitioning","streaming"],"dependencies":[{"issue_id":"engram-145","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.485301-06:00","created_by":"daemon"}]}
{"id":"engram-145w","title":"Test coverage: apps/memory/src/handlers/tool-call.handler.ts (73%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:16.279467-06:00","updated_at":"2025-12-21T04:07:03.767509-06:00","closed_at":"2025-12-21T04:07:03.767509-06:00"}
{"id":"engram-146","title":"Create Redpanda Consumer Configuration","description":"Shared consumer factory for downstream services. See docs/bitemporal/context/cognitive-ingestion/create-redpanda-consumer-configuration.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:50.438598-06:00","updated_at":"2025-12-19T15:32:08.39159-06:00","closed_at":"2025-12-06T22:14:59.118088-06:00","labels":["consumer","ingestion","redpanda"],"dependencies":[{"issue_id":"engram-146","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.438911-06:00","created_by":"daemon"}]}
{"id":"engram-147","title":"Implement Tool Call Extractor","description":"Normalizer for native tool calls into a standard internal format. See docs/bitemporal/context/cognitive-ingestion/implement-tool-call-extractor.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:50.21583-06:00","updated_at":"2025-12-19T15:32:08.391922-06:00","closed_at":"2025-12-06T22:27:15.84294-06:00","labels":["ingestion","tool-call"],"dependencies":[{"issue_id":"engram-147","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.216209-06:00","created_by":"daemon"}]}
{"id":"engram-148","title":"Create OpenAI Parser Strategy","description":"Parser for OpenAI chat.completion.chunk objects. See docs/bitemporal/context/cognitive-ingestion/create-openai-parser-strategy.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:50.079563-06:00","updated_at":"2025-12-19T15:32:08.392246-06:00","closed_at":"2025-12-06T22:27:15.811689-06:00","labels":["ingestion","openai","parser"],"dependencies":[{"issue_id":"engram-148","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.079982-06:00","created_by":"daemon"}]}
{"id":"engram-149","title":"Create Anthropic Parser Strategy","description":"Parser for Anthropic SSE events (message_start, content_block_delta). See docs/bitemporal/context/cognitive-ingestion/create-anthropic-parser-strategy.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:50.036626-06:00","updated_at":"2025-12-19T15:32:08.392597-06:00","closed_at":"2025-12-06T22:27:15.778402-06:00","labels":["anthropic","ingestion","parser"],"dependencies":[{"issue_id":"engram-149","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.037092-06:00","created_by":"daemon"}]}
{"id":"engram-14ts","title":"Update TurnRepository for tenant context","description":"Update TurnRepository to use tenant-scoped graph.\n\n## Files to Modify\n- packages/graph/src/repositories/falkor-turn.ts\n\n## Agent Instructions\nFollow pattern from SessionRepository update.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:43.974255-06:00","updated_at":"2025-12-29T23:11:10.135237-06:00","closed_at":"2025-12-29T23:11:10.135237-06:00","dependencies":[{"issue_id":"engram-14ts","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:19.915117-06:00","created_by":"ccheney"}]}
{"id":"engram-15","title":"P2: Implement hedging pattern detection","description":"Layer 3 of abstention: Detect hedging language and convert to explicit abstention.\n\n## Context\n- Plan: docs/plans/retrieval-v2/02-abstention-detection.md\n- Implementation: lines 122-135 (checkHedgingPatterns method)\n- Pattern list: lines 40-50\n\n## Tasks\n1. Define hedging regex patterns\n2. Implement checkHedgingPatterns method\n3. Convert detected hedging to explicit 'I don't know' response\n4. Add pattern customization config\n\n## Expected Impact\n- Catches implicit uncertainty in generated answers\n- Converts 'I think maybe...' to clean abstention\n\n## Dependencies\n- Requires: P2 retrieval confidence scoring (the-system-uy4s)\n\n## References\n- Hedging patterns list: lines 40-50\n- Pattern detection logic: lines 122-135","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:37:19.762424-06:00","updated_at":"2025-12-19T15:32:08.3451-06:00","closed_at":"2025-12-18T23:14:48.048758-06:00","dependencies":[{"issue_id":"engram-15","depends_on_id":"engram-201","type":"blocks","created_at":"2025-12-18T21:40:04.376752-06:00","created_by":"ccheney"}]}
{"id":"engram-150","title":"Add Prometheus metrics for score improvement","description":"Histogram: search_rerank_score_delta tracking top result score improvement from reranking","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:01.69805-06:00","updated_at":"2025-12-19T15:32:08.392952-06:00","closed_at":"2025-12-08T23:58:31.460004-06:00"}
{"id":"engram-151","title":"MEDIUM: setInterval without cleanup in WebSocket server","description":"Location: apps/interface/lib/websocket-server.ts:357-372\n\nsetInterval created at module load time for timeout checker is never cleared. During HMR in development, multiple intervals accumulate.\n\nImpact: Multiple timers running simultaneously, duplicate broadcasts.\n\nFix: Store interval reference and clear on module unload.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:30.959122-06:00","updated_at":"2025-12-19T15:32:08.393195-06:00","closed_at":"2025-12-19T00:58:58.339714-06:00"}
{"id":"engram-152","title":"Add SpladeEmbedder unit tests","description":"Write unit tests for SpladeEmbedder: sparse vector generation, semantic expansion, empty input handling, sparsity verification. Add to packages/search-core/src/services/splade-embedder.test.ts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T19:25:06.82236-06:00","updated_at":"2025-12-19T15:32:08.393439-06:00","closed_at":"2025-12-08T19:40:14.347408-06:00","dependencies":[{"issue_id":"engram-152","depends_on_id":"engram-280","type":"blocks","created_at":"2025-12-08T19:25:16.392869-06:00","created_by":"daemon"}]}
{"id":"engram-153","title":"Add unit tests for sparse and hybrid search in SearchRetriever","description":"Add unit tests for the new sparse and hybrid search paths in SearchRetriever.\n\nReference: docs/plans/hybrid-retriever.md (Phase 4)\n\nChanges to packages/search-core/src/services/retriever.test.ts:\n\nNew test cases:\n1. \"should perform sparse-only search\"\n   - Mock textEmbedder.embedSparseQuery to return { indices: [...], values: [...] }\n   - Call search() with strategy: \"sparse\"\n   - Verify client.query called with sparse vector format\n   - Verify using: \"sparse\" in the query\n\n2. \"should perform hybrid search with RRF fusion\"\n   - Mock both embedQuery and embedSparseQuery\n   - Call search() with strategy: \"hybrid\"\n   - Verify client.query called with prefetch array containing both vectors\n   - Verify query: { fusion: \"rrf\" } is present\n\n3. \"should handle code search in hybrid mode\"\n   - Set filters.type = \"code\"\n   - Verify prefetch uses \"code_dense\" vector name (not \"text_dense\")\n\n4. \"should oversample in prefetch for better fusion\"\n   - Request limit: 5\n   - Verify prefetch limit is 10 (2x)\n\nExisting integration tests in hybrid-search.integration.test.ts already cover end-to-end behavior.\n\nDepends on: the-system-6bo (hybrid implementation must exist to test it)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:38:21.041701-06:00","updated_at":"2025-12-19T15:32:08.393726-06:00","closed_at":"2025-12-08T21:50:12.32914-06:00","dependencies":[{"issue_id":"engram-153","depends_on_id":"engram-289","type":"blocks","created_at":"2025-12-08T21:38:28.77441-06:00","created_by":"daemon"}]}
{"id":"engram-154","title":"Create useSearch hook for search API integration","description":"Create a React hook for search API integration with debouncing and SWR caching.\n\nReference: docs/plans/search-ui.md (Phase 3: API Integration)\n\nNew file: apps/interface/app/hooks/useSearch.ts\n\nInterface:\n- Input: query string, optional UseSearchOptions\n- Output: { results, isLoading, error }\n\nUseSearchOptions:\n- debounceMs: number (default 300) - prevent excessive API calls\n- limit: number (default 10) - max results to return\n- filters: { type?: 'thought' | 'code' | 'doc', session_id?: string }\n\nSearchResult shape (from Qdrant):\n- id: string\n- score: number\n- payload: { content, node_id, session_id, type, timestamp, file_path? }\n\nImplementation details:\n- Use SWR for caching and request deduplication (already in package.json)\n- Debounce query changes to avoid hammering API during typing\n- Call POST /api/search with { query, limit, filters }\n- Handle loading and error states\n- Return empty array when query is empty or too short (\u003c 2 chars)\n\nThe hook should be strategy-agnostic - the API route already defaults to hybrid search.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:38:43.503504-06:00","updated_at":"2025-12-19T15:32:08.394054-06:00","closed_at":"2025-12-08T21:53:58.042214-06:00","dependencies":[{"issue_id":"engram-154","depends_on_id":"engram-153","type":"blocks","created_at":"2025-12-08T21:38:51.000726-06:00","created_by":"daemon"}]}
{"id":"engram-155","title":"Create SearchInput component with UUID detection","description":"Create a smart search input that detects UUIDs vs natural language queries.\n\nReference: docs/plans/search-ui.md (Phase 1: SearchInput Component)\n\nNew file: apps/interface/app/components/SearchInput.tsx\n\nFeatures:\n- Single input field replacing the current UUID-only input on homepage\n- Placeholder: \"Search thoughts, code, or enter session UUID...\"\n- UUID detection: regex /^[0-9a-f-]{36}$/i triggers \"Go to session\" mode\n- Natural language: triggers search mode after debounce\n\nComponent state:\n- query: string - current input value\n- mode: 'idle' | 'uuid' | 'search' - determined by input pattern\n\nProps:\n- onSearch: (query: string) =\u003e void - callback when search should execute\n- onNavigateSession: (sessionId: string) =\u003e void - callback for UUID navigation\n\nVisual design (matching existing glassmorphism):\n- Background: rgba(15, 20, 30, 0.7)\n- Border: 1px solid rgba(100, 116, 139, 0.25)\n- Focus border: rgba(0, 245, 212, 0.4) (cyan accent)\n- Focus glow: box-shadow with cyan\n- Font: JetBrains Mono, 13px\n- Search icon: lucide-react Search icon, rgb(148, 163, 184)\n\nKeyboard shortcuts:\n- \"/\" focuses the input (global listener)\n- Enter with UUID navigates to session\n- Enter with search query is optional (search is live)\n\nThis component is UI-only and does not call the API directly - it uses callbacks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:39:06.939115-06:00","updated_at":"2025-12-19T15:32:08.39437-06:00","closed_at":"2025-12-08T21:53:40.195809-06:00"}
{"id":"engram-156","title":"Add Prometheus metrics for candidate counts","description":"Histogram: search_rerank_candidates with tier labels, buckets [5,10,20,30,50,100]","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:00.653278-06:00","updated_at":"2025-12-19T15:32:08.394641-06:00","closed_at":"2025-12-08T23:58:30.544456-06:00"}
{"id":"engram-157","title":"MEDIUM: Global Date.now/Math.random pollution in ReplayEngine","description":"Location: packages/execution-core/src/replay.ts:139-159\n\nThe setupDeterministicEnv() method modifies global Date.now and Math.random which affects all code running in the same process.\n\nImpact: Race condition with concurrent replays, cross-contamination of other operations.\n\nFix: Use dependency injection for time/random instead of global mutation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:33.849424-06:00","updated_at":"2025-12-19T15:32:08.394878-06:00","closed_at":"2025-12-19T00:59:21.344868-06:00"}
{"id":"engram-158","title":"Merge Execution Service into Control Service","description":"The Execution Service (apps/execution) uses MCP for internal service-to-service communication, which is not idiomatic. MCP is designed for AI-to-tool interfaces, not internal RPC. Since only Control uses Execution, merge the VFS/PatchManager/TimeTravelService functionality directly into Control as imports rather than maintaining a separate MCP server. This eliminates unnecessary process overhead, stdio serialization, and complexity.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T14:18:58.154569-06:00","updated_at":"2025-12-19T15:32:08.395131-06:00","closed_at":"2025-12-19T14:30:26.233485-06:00"}
{"id":"engram-159","title":"Integrate search components into homepage","description":"Integrate SearchInput and SearchResults into the homepage, replacing the UUID-only input.\n\nReference: docs/plans/search-ui.md (Phase 4: Homepage Integration)\n\nModified file: apps/interface/app/page.tsx\n\nChanges:\n1. Remove the existing UUID input form (lines 326-381)\n2. Add SearchInput component in its place\n3. Add state to track current search query and results\n4. Wire up useSearch hook with the query\n5. Conditionally render:\n   - SearchResults when query has results\n   - SessionBrowser when query is empty (current behavior)\n6. Add global \"/\" keyboard shortcut to focus search input\n\nState to add:\n- searchQuery: string\n- Pass to useSearch hook\n- Pass to SearchInput as controlled input\n\nLayout flow:\n- Header (unchanged)\n- SearchInput (new, replaces UUID form)\n- SearchResults OR SessionBrowser (conditional)\n- Footer (unchanged)\n\nBehavior:\n- Page loads: shows SessionBrowser (existing behavior)\n- User types search: shows SearchResults after debounce\n- User clears search: returns to SessionBrowser\n- User enters UUID: navigates to session (existing behavior)\n\nImport new components:\n- import { SearchInput } from \"./components/SearchInput\"\n- import { SearchResults } from \"./components/SearchResults\"\n- import { useSearch } from \"./hooks/useSearch\"\n\nDepends on: SearchInput, SearchResults, and useSearch hook must all be complete.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:39:36.624523-06:00","updated_at":"2025-12-19T15:32:08.395372-06:00","closed_at":"2025-12-08T21:53:58.081378-06:00","dependencies":[{"issue_id":"engram-159","depends_on_id":"engram-155","type":"blocks","created_at":"2025-12-08T21:39:44.930567-06:00","created_by":"daemon"},{"issue_id":"engram-159","depends_on_id":"engram-248","type":"blocks","created_at":"2025-12-08T21:39:44.961809-06:00","created_by":"daemon"},{"issue_id":"engram-159","depends_on_id":"engram-154","type":"blocks","created_at":"2025-12-08T21:39:44.991398-06:00","created_by":"daemon"}]}
{"id":"engram-16","title":"P3: Implement session summarization","description":"Generate summaries for conversation sessions to enable hierarchical retrieval.\n\n## Context\n- Plan: docs/plans/retrieval-v2/03-session-aware-retrieval.md\n- Implementation: lines 120-175 (SessionSummarizer class)\n- Session schema: lines 35-55\n\n## Tasks\n1. Create SessionSummarizer class\n2. Implement summarize method with LLM\n3. Extract topics using KeyBERT\n4. Extract entities using NER\n5. Generate session embeddings\n\n## Expected Impact\n- Foundation for session-aware retrieval\n- Enables two-stage hierarchical retrieval\n\n## References\n- SGMem research: lines 15-20\n- Summary prompt: lines 140-155","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:38:34.438803-06:00","updated_at":"2025-12-19T15:32:08.345708-06:00","closed_at":"2025-12-18T23:29:35.927425-06:00"}
{"id":"engram-160","title":"Add Prometheus metrics for reranking latency","description":"Histogram: search_rerank_latency_ms with tier/model labels, buckets [10,25,50,100,200,500,1000]ms","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:01:59.452692-06:00","updated_at":"2025-12-19T15:32:08.395647-06:00","closed_at":"2025-12-08T23:58:29.354572-06:00"}
{"id":"engram-161","title":"Implement deterministic replay engine","description":"The ReplayEngine class in execution-core/src/replay.ts is a complete stub. Need to implement: VFS rehydration, RNG seeding for determinism, Date.now() mocking, execution and output comparison. Ref: TSD 3.4.1, implement-deterministic-replay-engine.md","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-08T02:05:38.580517-06:00","updated_at":"2025-12-19T15:32:08.395886-06:00","closed_at":"2025-12-08T02:25:22.052627-06:00","dependencies":[{"issue_id":"engram-161","depends_on_id":"engram-96","type":"blocks","created_at":"2025-12-08T02:06:46.309574-06:00","created_by":"daemon"}]}
{"id":"engram-162","title":"Implement BatchedReranker class","description":"Implement BatchedReranker for parallel document scoring.\n\nReference: docs/plans/reranker-implementation.md (Section 3.2.2)\n\nInterface:\n```typescript\nexport interface BatchedRerankerOptions {\n  model: string;\n  maxBatchSize: number;        // Default: 16\n  maxConcurrency: number;      // Default: 4\n  quantization: \"fp16\" | \"q8\"; // Default: q8\n  cacheEnabled: boolean;\n}\n```\n\nKey optimizations:\n- Dynamic batching based on document length\n- Concurrent batch processing via p-queue\n- Query-document pair caching (LRU)\n\nLocation: packages/search-core/src/services/batched-reranker.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:55:14.679825-06:00","updated_at":"2025-12-19T15:32:08.396162-06:00","closed_at":"2025-12-08T23:53:30.205501-06:00","dependencies":[{"issue_id":"engram-162","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T22:55:19.883161-06:00","created_by":"daemon"}]}
{"id":"engram-163","title":"Phase 4: Implement /ingest/* endpoints","description":"Implement event, tool, prompt, and session ingest endpoints","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T04:03:36.287276-06:00","updated_at":"2025-12-19T15:32:08.396418-06:00","closed_at":"2025-12-19T04:08:19.884792-06:00"}
{"id":"engram-164","title":"Phase 4: Add Hono HTTP server","description":"Create HTTP server using Hono for ingest API endpoints","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T04:03:30.378975-06:00","updated_at":"2025-12-19T15:32:08.396723-06:00","closed_at":"2025-12-19T04:08:19.883144-06:00"}
{"id":"engram-165","title":"MEDIUM: Unhandled async callback rejection in TurnAggregator","description":"Location: apps/memory/src/index.ts:118-134\n\nThe onNodeCreated callback is async but emitNodeCreated() calls it without await. The try/catch only catches synchronous errors.\n\nImpact: Unhandled promise rejections, potential process crash.\n\nFix: Await the callback or add .catch() handler.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:36.296615-06:00","updated_at":"2025-12-19T15:32:08.397031-06:00","closed_at":"2025-12-19T00:58:58.339136-06:00"}
{"id":"engram-166","title":"Phase 3: Implement roots handling","description":"Handle workspace roots for project-scoped memory access","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:58:04.320672-06:00","updated_at":"2025-12-19T15:32:08.397253-06:00","closed_at":"2025-12-19T04:02:28.243137-06:00"}
{"id":"engram-167","title":"Phase 3: Implement elicitation integration","description":"Add elicitation support for interactive confirmations and clarifications when client supports it","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:57:58.059217-06:00","updated_at":"2025-12-19T15:32:08.397479-06:00","closed_at":"2025-12-19T04:02:28.242824-06:00"}
{"id":"engram-168","title":"Add ms-marco-MiniLM-L-6-v2 fast reranker model","description":"Add fast-tier reranker using ms-marco-MiniLM-L-6-v2.\n\nReference: docs/plans/reranker-implementation.md (Section 2.2, Tier 1)\n\nModel: Xenova/ms-marco-MiniLM-L-6-v2\n- 22M parameters\n- Target latency: \u003c 50ms\n- Use case: All queries, fast default\n\nImplementation:\n- Add model constant to reranker config\n- Implement fast reranker singleton\n- Use q8 quantization for speed\n\nLocation: packages/search-core/src/services/fast-reranker.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:55:33.760038-06:00","updated_at":"2025-12-19T15:32:08.397717-06:00","closed_at":"2025-12-08T23:53:44.638167-06:00"}
{"id":"engram-169","title":"Write unit tests for ColBERTReranker","description":"Test MaxSim scoring, document encoding, multivector handling. File: packages/search-core/src/services/__tests__/colbert-reranker.test.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:01:45.580775-06:00","updated_at":"2025-12-19T15:32:08.397926-06:00","closed_at":"2025-12-08T23:59:20.604303-06:00"}
{"id":"engram-17","title":"Add tuner infrastructure to k8s","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T01:12:38.594384-06:00","updated_at":"2025-12-19T15:32:08.346066-06:00","closed_at":"2025-12-19T01:15:18.26418-06:00"}
{"id":"engram-170","title":"Phase 2: Add /e recap prompt","description":"Implement e-recap prompt to summarize a past session","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:50:39.531385-06:00","updated_at":"2025-12-19T15:32:08.398117-06:00","closed_at":"2025-12-19T03:56:22.163099-06:00"}
{"id":"engram-171","title":"Phase 2: Add /e prime prompt","description":"Implement e-prime prompt to load relevant context for a new task","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:50:33.527659-06:00","updated_at":"2025-12-19T15:32:08.398363-06:00","closed_at":"2025-12-19T03:56:22.162796-06:00"}
{"id":"engram-172","title":"MEDIUM: LRU cache uses O(n) operations","description":"Location: packages/search-core/src/services/embedding-cache.ts:216-222\n\nThe LRU implementation uses indexOf and splice on an array, making cache operations O(n).\n\nImpact: For large caches (1GB default), this could cause performance degradation.\n\nFix: Use a Map with doubly-linked list or LRU library for O(1) operations.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:18.22501-06:00","updated_at":"2025-12-19T15:32:08.398609-06:00","closed_at":"2025-12-19T00:39:58.198947-06:00"}
{"id":"engram-173","title":"MEDIUM: Promise completion detection logic broken in BatchedReranker","description":"Location: packages/search-core/src/services/batched-reranker.ts:309-321\n\nThe logic races already-completed promises against Promise.resolve(false) which returns false immediately. No promises are ever removed from the executing array.\n\nImpact: Concurrency limits are not enforced correctly.\n\nFix: Use proper promise tracking or Promise.allSettled pattern.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:19.248795-06:00","updated_at":"2025-12-19T15:32:08.398809-06:00","closed_at":"2025-12-19T00:59:10.885224-06:00"}
{"id":"engram-174","title":"Phase 2: Implement memory:// resource","description":"Implement MCP resource for accessing individual memories via memory://{id} URI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:50:14.615894-06:00","updated_at":"2025-12-19T15:32:08.399017-06:00","closed_at":"2025-12-19T03:56:22.161011-06:00"}
{"id":"engram-175","title":"Phase 1: Implement capability negotiation","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:32:48.645222-06:00","updated_at":"2025-12-19T15:32:08.399253-06:00","closed_at":"2025-12-19T03:42:06.353976-06:00"}
{"id":"engram-176","title":"Phase 1: Add Memory node to @engram/graph","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:32:43.520471-06:00","updated_at":"2025-12-19T15:32:08.399476-06:00","closed_at":"2025-12-19T03:42:06.353739-06:00"}
{"id":"engram-177","title":"Phase 1: Implement engram_query tool","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:32:38.392074-06:00","updated_at":"2025-12-19T15:32:08.399717-06:00","closed_at":"2025-12-19T03:42:06.353505-06:00"}
{"id":"engram-178","title":"MEDIUM: Missing graceful shutdown in execution service","description":"Location: apps/execution/src/index.ts:199-210\n\nThe main() function starts the MCP server but does not register any signal handlers for graceful shutdown. Open database connections are not closed cleanly.\n\nImpact: Container pods may be killed forcefully, resources not released.\n\nFix: Add SIGTERM/SIGINT handlers to disconnect gracefully.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:20.947286-06:00","updated_at":"2025-12-19T15:32:08.39996-06:00","closed_at":"2025-12-19T00:58:45.156594-06:00"}
{"id":"engram-179","title":"[EPIC] Phase 4: Testing Infrastructure","description":"# Phase 4: Testing Infrastructure\n\n**Duration**: 5-7 days\n**Dependencies**: Phase 3 complete\n**Parallelization**: ALL tasks can run in parallel\n\n## Overview\nBuild comprehensive testing coverage:\n- Add critical missing unit tests\n- Create integration test infrastructure\n- Build test helpers and fixtures\n\n## Issue Summary\n- Testing gaps: 31\n- Current coverage: ~35%\n- Target coverage: \u003e80%\n- Critical untested files: 6\n\n## Success Criteria\n- [ ] Test coverage \u003e80%\n- [ ] All critical paths covered\n- [ ] Integration test helpers available\n- [ ] CI/CD test stage passing\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 536-569)\n- All app and package REPORT.md files (Testing sections)","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-09T03:36:26.81194-06:00","updated_at":"2025-12-19T15:32:08.40022-06:00","closed_at":"2025-12-09T04:39:13.083585-06:00","labels":["p0","refactoring","testing"],"dependencies":[{"issue_id":"engram-179","depends_on_id":"engram-284","type":"blocks","created_at":"2025-12-09T03:38:41.161771-06:00","created_by":"daemon"}]}
{"id":"engram-17jn","title":"Add search quality evaluation benchmark","description":"Create evaluation suite comparing fragment-level vs turn-level retrieval. Measure: retrieval scores, reranking success, top-5 relevance.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:12:26.924013-06:00","updated_at":"2025-12-21T07:06:22.894548-06:00","closed_at":"2025-12-21T07:06:22.894548-06:00","dependencies":[{"issue_id":"engram-17jn","depends_on_id":"engram-6u4w","type":"blocks","created_at":"2025-12-21T06:14:13.736174-06:00","created_by":"ccheney"}]}
{"id":"engram-18","title":"Phase 1: Implement engram_remember tool","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:32:28.141098-06:00","updated_at":"2025-12-19T15:32:08.34633-06:00","closed_at":"2025-12-19T03:42:06.352937-06:00"}
{"id":"engram-180","title":"Phase 1: Scaffold apps/mcp with MCP SDK","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:32:23.013223-06:00","updated_at":"2025-12-19T15:32:08.400549-06:00","closed_at":"2025-12-19T03:42:06.352155-06:00"}
{"id":"engram-181","title":"Implement unified MCP server (apps/mcp)","description":"Implement the unified MCP server as described in docs/plans/unified-mcp-server.md. This is a client-agnostic MCP server exposing Engram's full memory capabilities to any MCP-compatible client.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T03:32:09.163628-06:00","updated_at":"2025-12-19T15:32:08.40079-06:00","closed_at":"2025-12-19T04:08:42.747956-06:00","dependencies":[{"issue_id":"engram-181","depends_on_id":"engram-180","type":"blocks","created_at":"2025-12-19T03:33:00.218543-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-18","type":"blocks","created_at":"2025-12-19T03:33:05.344171-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-264","type":"blocks","created_at":"2025-12-19T03:33:10.462996-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-177","type":"blocks","created_at":"2025-12-19T03:33:15.574654-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-176","type":"blocks","created_at":"2025-12-19T03:33:20.687487-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-175","type":"blocks","created_at":"2025-12-19T03:33:25.800093-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-174","type":"blocks","created_at":"2025-12-19T03:50:59.630802-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-19","type":"blocks","created_at":"2025-12-19T03:51:04.766413-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-20","type":"blocks","created_at":"2025-12-19T03:51:09.886865-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-171","type":"blocks","created_at":"2025-12-19T03:51:15.000714-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-170","type":"blocks","created_at":"2025-12-19T03:51:20.11067-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-21","type":"blocks","created_at":"2025-12-19T03:51:25.389594-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-22","type":"blocks","created_at":"2025-12-19T03:58:24.913525-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-167","type":"blocks","created_at":"2025-12-19T03:58:30.035663-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-166","type":"blocks","created_at":"2025-12-19T03:58:35.153083-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-237","type":"blocks","created_at":"2025-12-19T03:58:40.270789-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-164","type":"blocks","created_at":"2025-12-19T04:03:49.557084-06:00","created_by":"ccheney"},{"issue_id":"engram-181","depends_on_id":"engram-163","type":"blocks","created_at":"2025-12-19T04:03:54.681504-06:00","created_by":"ccheney"}]}
{"id":"engram-182","title":"Implement score merging strategy","description":"Implement score merging for RRF + reranker scores.\n\nReference: docs/plans/reranker-implementation.md (Section 4.2)\n\nStrategy options:\n- Option A: Replace with reranker score\n- Option B: Weighted combination  \n- Option C: Rank-based (reranker ordering, preserve both scores)\n\nRecommendation: Use Option C\n- Reranker determines final ordering\n- Preserve both scores in response for transparency\n\nInterface:\n```typescript\ninterface MergedResult {\n  rrfScore: number;\n  rerankerScore: number;\n  finalScore: number;\n}\n```\n\nLocation: packages/search-core/src/services/score-merger.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:55:42.774178-06:00","updated_at":"2025-12-19T15:32:08.401158-06:00","closed_at":"2025-12-09T00:31:47.033528-06:00"}
{"id":"engram-183","title":"Convert all k8s YAML to Pulumi resources","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T01:17:14.719688-06:00","updated_at":"2025-12-19T15:32:08.401425-06:00","closed_at":"2025-12-19T01:24:02.834323-06:00"}
{"id":"engram-184","title":"MEDIUM: DoS vulnerability - no request body size limit","description":"Location: apps/search/src/index.ts:219-238\n\nThe HTTP handler accumulates request body chunks without any size limit. An attacker can send arbitrarily large POST body.\n\nImpact: Denial of Service via memory exhaustion.\n\nFix: Add MAX_BODY_SIZE check and reject oversized requests.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:22.659182-06:00","updated_at":"2025-12-19T15:32:08.401708-06:00","closed_at":"2025-12-19T00:58:45.157756-06:00"}
{"id":"engram-185","title":"[EPIC] Query Routing \u0026 Classification","description":"Query routing system for tier selection.\n\nBounded Context: Query Classification Domain\nReference: docs/plans/reranker-implementation.md (Section 3.2.1, Appendix B)\n\nRoutes queries to appropriate reranker tier based on:\n- Query complexity (length, operators)\n- Content type filter (code vs text)\n- User tier/subscription\n- Latency budget\n\nRouting heuristics:\n- Quoted strings → accurate tier\n- Code patterns → code tier\n- Long/complex queries → accurate tier\n- Simple queries → fast tier","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:55:51.528438-06:00","updated_at":"2025-12-19T15:32:08.401979-06:00","closed_at":"2025-12-08T23:54:29.195471-06:00","dependencies":[{"issue_id":"engram-185","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T23:02:51.332623-06:00","created_by":"daemon"}]}
{"id":"engram-186","title":"Implement RerankerRouter class","description":"Implement RerankerRouter for query-based tier selection.\n\nReference: docs/plans/reranker-implementation.md (Section 3.2.1)\n\nInterface:\n```typescript\nexport type RerankerTier = \"fast\" | \"accurate\" | \"code\" | \"llm\";\n\nexport interface RerankerRoutingResult {\n  tier: RerankerTier;\n  reranker: string;\n  maxCandidates: number;\n  reason: string;\n}\n\nexport class RerankerRouter {\n  route(query: string, options: RoutingOptions): RerankerRoutingResult;\n}\n```\n\nRouting rules:\n- Code patterns (function(), class, =\u003e) → code tier\n- Complex queries (\u003e50 chars, operators) → accurate tier\n- Agentic patterns (tool, execute) → accurate tier\n- Default → fast tier\n\nLocation: packages/search-core/src/services/reranker-router.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:56:01.207548-06:00","updated_at":"2025-12-19T15:32:08.402302-06:00","closed_at":"2025-12-08T23:39:18.592562-06:00"}
{"id":"engram-187","title":"[EPIC] ColBERT Late Interaction Reranking","description":"ColBERT late interaction for billion-scale efficiency.\n\nBounded Context: Late Interaction Domain\nReference: docs/plans/reranker-implementation.md (Section 3.2.3, Phase 3)\n\nColBERT enables:\n- Precomputed document token embeddings\n- MaxSim scoring at query time\n- 180x fewer FLOPs than cross-encoders at k=10\n- Native Qdrant multivector support\n\nModel: jinaai/jina-colbert-v2 (559M, 89 languages)\n\nThis is the scale path for billion-event search.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:56:19.020164-06:00","updated_at":"2025-12-19T15:32:08.402537-06:00","closed_at":"2025-12-09T00:36:42.045753-06:00","dependencies":[{"issue_id":"engram-187","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T23:02:49.04013-06:00","created_by":"daemon"}]}
{"id":"engram-188","title":"Phase 1: Extract programmatic API from benchmark","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T00:47:49.888778-06:00","updated_at":"2025-12-19T15:32:08.40278-06:00","closed_at":"2025-12-19T00:50:48.035442-06:00"}
{"id":"engram-189","title":"Implement ColBERTEmbedder using jina-colbert-v2","description":"Implement ColBERT embedder for token-level representations.\n\nReference: docs/plans/reranker-implementation.md (Section 3.2.3, Phase 3)\n\nModel: jinaai/jina-colbert-v2\n- Token dimension: 128\n- Supports 89 languages\n- Aggressive quantization (2-bit: 36→20 bytes per vector)\n\nInterface:\n```typescript\nexport class ColBERTEmbedder {\n  // Encode document into token-level embeddings\n  async encodeDocument(content: string): Promise\u003cFloat32Array[]\u003e;\n  \n  // Encode query for MaxSim scoring\n  async encodeQuery(query: string): Promise\u003cFloat32Array[]\u003e;\n}\n```\n\nLocation: packages/search-core/src/services/colbert-embedder.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:56:27.758309-06:00","updated_at":"2025-12-19T15:32:08.403082-06:00","closed_at":"2025-12-09T00:36:41.873834-06:00"}
{"id":"engram-19","title":"Phase 2: Implement session:// resource","description":"Implement MCP resource for accessing session transcripts via session://{session_id}/transcript URI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:50:21.065015-06:00","updated_at":"2025-12-19T15:32:08.346671-06:00","closed_at":"2025-12-19T03:56:22.161936-06:00"}
{"id":"engram-190","title":"MEDIUM: Missing flush() method for unclosed tags in extractors","description":"Location: packages/ingestion-core/src/extractors/base.ts\n\nIf a stream ends while inside a block (after open tag but before close tag), buffered content is never flushed. No flush() or finalize() method exists.\n\nImpact: Content is lost in truncated streams or dropped connections.\n\nFix: Add flush() method to retrieve remaining buffered content.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:24.102028-06:00","updated_at":"2025-12-19T15:32:08.403361-06:00","closed_at":"2025-12-19T00:58:58.33994-06:00"}
{"id":"engram-191","title":"P6: Implement query feature extraction","description":"Extract features from queries for learned fusion weight prediction.\n\n## Context\n- Plan: docs/plans/retrieval-v2/06-learned-fusion.md\n- Implementation: lines 40-90 (QueryFeatureExtractor class)\n- Feature schema: lines 25-40\n\n## Tasks\n1. Create QueryFeatureExtractor class\n2. Extract: length, entityDensity, hasTemporal\n3. Classify question type (factoid, list, etc.)\n4. Calculate avgIDF and hasRareTerms\n5. Build IDF index from corpus\n\n## Expected Impact\n- Foundation for learned fusion\n- Enables query-adaptive retrieval\n\n## References\n- Feature definitions: lines 25-40\n- Question type classification: lines 70-85","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:39:17.994485-06:00","updated_at":"2025-12-19T15:32:08.404988-06:00","closed_at":"2025-12-18T23:54:01.101697-06:00"}
{"id":"engram-192","title":"P3: Update indexing pipeline for sessions","description":"Modify indexing to create session summaries alongside turn embeddings.\n\n## Context\n- Plan: docs/plans/retrieval-v2/03-session-aware-retrieval.md\n- Implementation: lines 180-220 (Indexing Pipeline Update)\n\n## Tasks\n1. Group documents by session during indexing\n2. Generate session summaries for each group\n3. Index session summaries in separate collection\n4. Maintain session_id linkage\n5. Add --session-aware CLI flag\n\n## Expected Impact\n- Enables session-level retrieval\n- +5-10% storage overhead (acceptable)\n\n## Dependencies\n- Requires: P3 session summarization (previous)\n- Requires: P3 two-stage retrieval (previous)\n\n## References\n- groupBySession logic: lines 200-215\n- Storage considerations: lines 230-235","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:38:50.229807-06:00","updated_at":"2025-12-19T15:32:08.405488-06:00","closed_at":"2025-12-18T23:40:02.287838-06:00","dependencies":[{"issue_id":"engram-192","depends_on_id":"engram-193","type":"blocks","created_at":"2025-12-18T21:40:37.581746-06:00","created_by":"ccheney"}]}
{"id":"engram-193","title":"P3: Implement two-stage session retrieval","description":"Retrieve sessions first, then turns within sessions for better MR performance.\n\n## Context\n- Plan: docs/plans/retrieval-v2/03-session-aware-retrieval.md\n- Implementation: lines 60-115 (SessionAwareRetriever class)\n- Architecture: lines 20-35\n\n## Tasks\n1. Create SessionAwareRetriever class\n2. Implement retrieveSessions (stage 1)\n3. Implement retrieveTurnsInSession (stage 2)\n4. Create session collection in Qdrant\n5. Add session_id filter for turn retrieval\n\n## Expected Impact\n- +5-10% on MR (Multi-Session Reasoning)\n- Better context coherence\n\n## Dependencies\n- Requires: P3 session summarization (previous)\n\n## References\n- LiCoMemory hierarchical retrieval: lines 10-15\n- Retrieval flow: lines 20-35","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:38:41.284041-06:00","updated_at":"2025-12-19T15:32:08.405875-06:00","closed_at":"2025-12-18T23:34:59.414293-06:00","dependencies":[{"issue_id":"engram-193","depends_on_id":"engram-16","type":"blocks","created_at":"2025-12-18T21:40:32.455668-06:00","created_by":"ccheney"}]}
{"id":"engram-194","title":"Write unit tests for BatchedReranker","description":"Test batch processing, latency budgets, concurrent processing. File: packages/search-core/src/services/__tests__/batched-reranker.test.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:01:43.01757-06:00","updated_at":"2025-12-19T15:32:08.40622-06:00","closed_at":"2025-12-08T23:54:54.934973-06:00"}
{"id":"engram-195","title":"P1: Integrate multi-query retriever with benchmark","description":"Wire up multi-query retrieval into the benchmark pipeline.\n\n## Context\n- Plan: docs/plans/retrieval-v2/01-multi-query-retrieval.md\n- Integration: lines 155-180 (EngramRetriever integration)\n- CLI flags: lines 185-190\n\n## Tasks\n1. Add multiQueryRetriever to EngramRetriever\n2. Add --multi-query CLI flag\n3. Add --multi-query-variations option\n4. Run ablation study on 50 instances\n5. Validate +5% accuracy gain\n\n## Expected Impact\n- +5-8% overall accuracy\n- +15-20% recall@10\n- +200-500ms latency (acceptable)\n\n## Dependencies\n- Requires: P1 query expansion (previous)\n- Requires: P1 RRF fusion (previous)\n\n## References\n- Success metrics: lines 195-200\n- Rollout plan: lines 200-210","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:38:10.665223-06:00","updated_at":"2025-12-19T15:32:08.406485-06:00","closed_at":"2025-12-18T22:17:19.549424-06:00","dependencies":[{"issue_id":"engram-195","depends_on_id":"engram-196","type":"blocks","created_at":"2025-12-18T21:40:26.212571-06:00","created_by":"ccheney"}]}
{"id":"engram-196","title":"P1: Implement RRF fusion for multi-query results","description":"Combine results from multiple query variations using Reciprocal Rank Fusion.\n\n## Context\n- Plan: docs/plans/retrieval-v2/01-multi-query-retrieval.md\n- Implementation: lines 120-150 (rrfFusion method)\n\n## Tasks\n1. Implement rrfFusion method\n2. Build score map across all result sets\n3. Handle deduplication by document ID\n4. Apply RRF formula: 1/(k + rank)\n5. Sort and return top-K\n\n## Expected Impact\n- Merges diverse results into coherent ranking\n- Improves recall while maintaining precision\n\n## Dependencies\n- Requires: P1 query expansion (previous)\n\n## References\n- RRF algorithm: lines 120-150\n- Config options: lines 50-60","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:38:04.087531-06:00","updated_at":"2025-12-19T15:32:08.406795-06:00","closed_at":"2025-12-18T22:01:34.518149-06:00","dependencies":[{"issue_id":"engram-196","depends_on_id":"engram-197","type":"blocks","created_at":"2025-12-18T21:40:21.082471-06:00","created_by":"ccheney"}]}
{"id":"engram-197","title":"P1: Implement query expansion with LLM","description":"Generate multiple query variations using LLM for improved retrieval recall.\n\n## Context\n- Plan: docs/plans/retrieval-v2/01-multi-query-retrieval.md\n- Core Implementation: lines 60-120 (MultiQueryRetriever class)\n- Expansion Prompt: lines 100-115\n\n## Tasks\n1. Create MultiQueryRetriever class\n2. Implement expandQuery method with LLM call\n3. Implement buildExpansionPrompt for strategies\n4. Support paraphrase, entity, stepback, decompose strategies\n5. Parse LLM response into query list\n\n## Expected Impact\n- Foundation for multi-query retrieval\n- +15-20% recall improvement\n\n## References\n- DMQR-RAG strategies: lines 35-45\n- Prompt template: lines 100-115","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:37:57.005227-06:00","updated_at":"2025-12-19T15:32:08.407101-06:00","closed_at":"2025-12-18T22:01:34.516518-06:00"}
{"id":"engram-198","title":"Implement ColBERTReranker with MaxSim scoring","description":"Implement ColBERT reranker using late interaction scoring.\n\nReference: docs/plans/reranker-implementation.md (Section 3.2.3)\n\nMaxSim algorithm:\n- For each query token, compute similarity with every document token\n- Keep only max similarity per query token\n- Sum all token-level max scores into final relevance\n\nInterface:\n```typescript\nexport class ColBERTReranker {\n  // Fast query-time scoring using cached doc embeddings\n  async rerank(\n    query: string,\n    candidates: CachedDocumentCandidate[],\n    topK: number\n  ): Promise\u003cRerankResult[]\u003e;\n}\n```\n\nPerformance target: ~20ms for 30 docs (with precomputed)\n\nLocation: packages/search-core/src/services/colbert-reranker.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:56:37.210825-06:00","updated_at":"2025-12-19T15:32:08.407402-06:00","closed_at":"2025-12-09T00:36:41.953739-06:00","dependencies":[{"issue_id":"engram-198","depends_on_id":"engram-189","type":"blocks","created_at":"2025-12-08T23:03:10.407399-06:00","created_by":"daemon"}]}
{"id":"engram-199","title":"[EPIC] Caching \u0026 Optimization","description":"Document representation caching, query result caching, and async reranking (Phase 5)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T23:01:27.738605-06:00","updated_at":"2025-12-19T15:32:08.407676-06:00","closed_at":"2025-12-09T00:24:42.010535-06:00","dependencies":[{"issue_id":"engram-199","depends_on_id":"engram-210","type":"blocks","created_at":"2025-12-08T23:03:06.001547-06:00","created_by":"daemon"}]}
{"id":"engram-1b4e","title":"Test coverage: packages/events/src/index.ts (88%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:29.702732-06:00","updated_at":"2025-12-21T04:07:03.763434-06:00","closed_at":"2025-12-21T04:07:03.763434-06:00"}
{"id":"engram-1cg4","title":"[Search-Py] Phase 5: Production Hardening","description":"Add production-grade observability and reliability. Prometheus metrics for latency, throughput, cache hits, reranker costs. Structured logging with structlog. Request tracing with correlation IDs. Graceful shutdown handling. Connection pooling for Qdrant/Redis. Memory profiling to prevent leaks.\n\nReference: docs/plans/search-python-migration.md (Phase 6: Production Hardening)\n\nDeliverables:\n- src/search/utils/metrics.py - Prometheus instrumentation\n- src/search/utils/logging.py - structlog configuration\n- src/search/utils/tracing.py - Correlation ID middleware\n- Graceful shutdown in lifespan handler\n- Connection pool configuration\n- /metrics endpoint\n- Load testing with locust\n- Memory leak tests","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:22:16.640143-06:00","updated_at":"2025-12-20T09:19:33.226882-06:00","closed_at":"2025-12-20T09:19:33.226882-06:00","dependencies":[{"issue_id":"engram-1cg4","depends_on_id":"engram-tqfu","type":"blocks","created_at":"2025-12-20T07:23:02.361693-06:00","created_by":"ccheney"}]}
{"id":"engram-1cgn","title":"Integration tests for end-to-end conflict detection","description":"Test scenarios: 1) Create 'prefers dark mode' then 'prefers light mode' → first invalidated, 2) recall returns only valid by default, 3) includeInvalidated returns all, 4) elicitation confirmation flow","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:44:30.077679-06:00","updated_at":"2026-01-01T16:44:30.077679-06:00","dependencies":[{"issue_id":"engram-1cgn","depends_on_id":"engram-6gkb","type":"blocks","created_at":"2026-01-01T16:46:47.992915-06:00","created_by":"ccheney"},{"issue_id":"engram-1cgn","depends_on_id":"engram-d7pz","type":"blocks","created_at":"2026-01-01T16:46:53.122791-06:00","created_by":"ccheney"},{"issue_id":"engram-1cgn","depends_on_id":"engram-xydt","type":"blocks","created_at":"2026-01-01T16:46:58.253114-06:00","created_by":"ccheney"}]}
{"id":"engram-1crc","title":"Migrate control service to NATS","description":"Update control service to use NATS instead of Kafka.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 4: Service Migration\n\n## Topic Mapping\n- parsed_events → events.parsed (subscribe only)\n\n## Consumer\n- Stream: EVENTS\n- Durable name: control\n\n## Implementation\n- Import createNatsClient from @engram/storage\n- Replace Kafka consumer with NATS\n- Update environment variable from REDPANDA_BROKERS to NATS_URL\n\n## Acceptance Criteria\n- Service starts and connects to NATS\n- Subscribes to events.parsed\n- Triggers SessionManager on user content","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:26:43.235066-05:00","updated_at":"2025-12-22T00:49:14.131802-05:00","closed_at":"2025-12-22T00:49:14.131802-05:00","dependencies":[{"issue_id":"engram-1crc","depends_on_id":"engram-qgcm","type":"blocks","created_at":"2025-12-22T00:29:31.321952-05:00","created_by":"ccheney"},{"issue_id":"engram-1crc","depends_on_id":"engram-3xez","type":"blocks","created_at":"2025-12-22T00:29:36.44913-05:00","created_by":"ccheney"}]}
{"id":"engram-1kld","title":"[CRITICAL] Hardcoded DB credentials in packages/infra/src/k8s/tuner.ts","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:03.420204-06:00","updated_at":"2025-12-20T23:45:30.485456-06:00","closed_at":"2025-12-20T23:45:30.485456-06:00"}
{"id":"engram-1m9i","title":"Improve engram_query tool description","description":"Update apps/mcp/src/tools/query.ts with improved descriptions. Changes:\n- Main description: 'Query the knowledge graph directly using Cypher for complex lookups that semantic search cannot handle. Use for: finding all decisions within a date range, tracing relationships between sessions and files, counting memories by type.'\n- cypher param: Add common Cypher patterns and explain bitemporal fields\n- params param: Explain safe value injection with examples\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_query","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:06.176543-05:00","updated_at":"2025-12-25T00:59:24.413893-05:00","closed_at":"2025-12-25T00:59:24.413893-05:00"}
{"id":"engram-1mgl","title":"Design OAuth device flow for MCP authentication","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-25T02:14:13.250417-05:00","updated_at":"2025-12-25T02:16:26.372721-05:00","closed_at":"2025-12-25T02:16:26.372721-05:00"}
{"id":"engram-1njp","title":"[CRITICAL] evaluateWithBenchmark not implemented in tuner","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:55.424577-06:00","updated_at":"2025-12-20T23:45:30.479556-06:00","closed_at":"2025-12-20T23:45:30.479556-06:00"}
{"id":"engram-1p9y","title":"Fix any type errors from TypeScript 7 upgrade","description":"Address any new type errors that arise from stricter TypeScript 7 checking or ES2025 target changes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:38:10.520337-06:00","updated_at":"2025-12-20T22:33:07.954465-06:00","closed_at":"2025-12-20T22:33:07.954465-06:00","dependencies":[{"issue_id":"engram-1p9y","depends_on_id":"engram-wv53","type":"blocks","created_at":"2025-12-20T21:39:23.910882-06:00","created_by":"ccheney"}]}
{"id":"engram-1pwm","title":"Create TenantContext type definition","description":"Create the TenantContext type in packages/common/src/types/tenant.ts.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'TenantContext Type' section (lines 576-604)\n\n## Implementation\nCreate new file packages/common/src/types/tenant.ts with:\n- TenantContext interface: orgId, orgSlug, userId, isAdmin\n- getTenantGraphName() utility function\n- createTenantContext() factory function\n- validateTenantAccess() validation helper\n\n## Key Code (from plan):\n```typescript\nexport interface TenantContext {\n    orgId: string;         // ULID from OAuth token\n    orgSlug: string;       // URL-safe slug for graph naming\n    userId: string;        // Authenticated user\n    isAdmin: boolean;      // Has admin:read scope (cross-tenant access)\n}\n```\n\n## Files to Create/Modify\n- packages/common/src/types/tenant.ts (NEW)\n- packages/common/src/index.ts (export)\n\n## Agent Instructions\nUse Context7 MCP for TypeScript best practices. This is a foundational type - ensure it's well-documented and exported properly.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:02.626877-06:00","updated_at":"2025-12-29T22:22:23.522722-06:00","closed_at":"2025-12-29T22:22:23.522722-06:00"}
{"id":"engram-1qe2","title":"Create HuggingFaceEmbedder client class","description":"Implement embedder that calls Hugging Face Inference API instead of running models locally.\n\n## Location\n`apps/search/src/clients/huggingface.py`\n\n## Interface\n- Inherit from or match BaseEmbedder interface\n- `__init__(model_id, api_token)`\n- `async embed(text, is_query) -\u003e list[float]`\n- `async embed_batch(texts) -\u003e list[list[float]]`\n\n## Models to support\n- text: BAAI/bge-small-en-v1.5 (384 dims)\n- code: nomic-ai/nomic-embed-text-v1.5 (768 dims)\n\n## Implementation notes\n- Use huggingface_hub InferenceClient\n- Handle BGE query prefix for is_query=True\n- Handle rate limiting and retries\n- Async using httpx\n\n## Acceptance Criteria\n- Class matches BaseEmbedder interface\n- Unit tests pass\n- Works with HF free tier","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:29:14.049948-06:00","updated_at":"2025-12-21T16:10:46.978643-06:00","closed_at":"2025-12-21T16:10:46.978643-06:00"}
{"id":"engram-1tw9","title":"Install hcloud CLI on local machine","description":"Install Hetzner Cloud CLI tool for server management.\n\n## Steps\n1. Run `brew install hcloud` (macOS)\n2. Verify with `hcloud version`\n\n## Acceptance Criteria\n- hcloud CLI is installed and accessible from terminal","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:28:12.262115-06:00","updated_at":"2025-12-21T15:53:47.524979-06:00","closed_at":"2025-12-21T15:53:47.524979-06:00"}
{"id":"engram-2","title":"MEDIUM: Redis connection not disconnected on shutdown","description":"Location: apps/ingestion/src/index.ts:217-242\n\nRedis publisher is created but redis.disconnect() is never called in the shutdown handler. Connection is left open.\n\nImpact: Redis connections may leak on shutdown.\n\nFix: Add redis.disconnect() call in shutdown handler.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:21.809651-06:00","updated_at":"2025-12-19T15:32:08.340383-06:00","closed_at":"2025-12-19T00:58:45.157258-06:00"}
{"id":"engram-20","title":"Phase 2: Implement file-history:// resource","description":"Implement MCP resource for accessing file change history via file-history://{path} URI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:50:27.234022-06:00","updated_at":"2025-12-19T15:32:08.347236-06:00","closed_at":"2025-12-19T03:56:22.162463-06:00"}
{"id":"engram-200","title":"P2: Implement NLI-based answer grounding check","description":"Layer 2 of abstention: Verify answer is entailed by retrieved context.\n\n## Context\n- Plan: docs/plans/retrieval-v2/02-abstention-detection.md\n- Implementation: lines 97-120 (checkAnswerGrounding method)\n- NLI Model Loading: lines 135-140\n\n## Tasks\n1. Add @xenova/transformers for NLI model\n2. Implement checkAnswerGrounding method\n3. Load cross-encoder/nli-deberta-v3-base model\n4. Integrate with AbstentionDetector\n5. Add --abstention-nli CLI flag\n\n## Expected Impact\n- Catches hallucinated answers not supported by context\n- Prevents confident wrong answers\n\n## Dependencies\n- Requires: P2 retrieval confidence scoring (the-system-uy4s)\n\n## References\n- HALT-RAG framework: lines 10-15\n- NLI threshold calibration: lines 170-185","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:37:13.437643-06:00","updated_at":"2025-12-19T15:32:08.407971-06:00","closed_at":"2025-12-18T23:14:48.047756-06:00","dependencies":[{"issue_id":"engram-200","depends_on_id":"engram-201","type":"blocks","created_at":"2025-12-18T21:39:59.24162-06:00","created_by":"ccheney"}]}
{"id":"engram-201","title":"P2: Implement retrieval confidence scoring","description":"Layer 1 of abstention: Score-based confidence thresholding.\n\n## Context\n- Plan: docs/plans/retrieval-v2/02-abstention-detection.md\n- Implementation: lines 55-95 (checkRetrievalConfidence method)\n\n## Tasks\n1. Create AbstentionDetector class skeleton\n2. Implement checkRetrievalConfidence method\n3. Add minRetrievalScore threshold (default 0.3)\n4. Add score gap detection for uncertain matches\n5. Add --abstention-threshold CLI flag\n\n## Expected Impact\n- Foundation for abstention system\n- Catches obvious cases of no relevant documents\n\n## References\n- Config interface: lines 30-45\n- Threshold calibration: lines 170-185","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:36:32.919081-06:00","updated_at":"2025-12-19T15:32:08.408306-06:00","closed_at":"2025-12-18T22:56:50.443838-06:00"}
{"id":"engram-202","title":"P4: Implement temporal query parser with chrono-node","description":"Parse temporal expressions from queries and apply time filters to retrieval.\n\n## Context\n- Plan: docs/plans/retrieval-v2/04-temporal-query.md\n- Core Implementation: lines 60-130 (TemporalQueryParser class)\n- Qdrant Filter Builder: lines 132-155\n\n## Tasks\n1. Add chrono-node dependency\n2. Implement TemporalQueryParser class\n3. Implement buildTemporalFilter for Qdrant\n4. Integrate with EngramRetriever\n5. Add --temporal-aware CLI flag\n\n## Expected Impact\n- +7-11% on TR (Temporal Reasoning) tasks\n- +3-5% overall accuracy\n\n## References\n- Temporal expression types: lines 35-45\n- Edge cases: lines 200-210\n- Research: TG-RAG, TA-RAG papers","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:36:25.861331-06:00","updated_at":"2025-12-19T15:32:08.408595-06:00","closed_at":"2025-12-18T23:54:01.100984-06:00"}
{"id":"engram-203","title":"P5: Upgrade embedding model to GTE-large","description":"Upgrade from E5-small (384d) to GTE-large (1024d) for +2-3% accuracy.\n\n## Context\n- Plan: docs/plans/retrieval-v2/05-embedding-upgrade.md\n- Implementation: lines 70-95 (Configuration-Based Model Selection)\n- CLI Integration: lines 97-103\n\n## Tasks\n1. Add model selection to TextEmbedder constructor\n2. Update Qdrant collection schema for 1024d vectors\n3. Add --embedding-model CLI flag\n4. Test on 50 instances for regression\n\n## Expected Impact\n- +2-3% overall accuracy\n- +5-10% retrieval recall\n- Slower inference (acceptable tradeoff)\n\n## References\n- MTEB Leaderboard comparison: lines 30-45\n- GTE-large specs: 1024 dims, 335M params, MIT license","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:36:19.676916-06:00","updated_at":"2025-12-19T15:32:08.408838-06:00","closed_at":"2025-12-18T23:54:01.096561-06:00"}
{"id":"engram-204","title":"Add colbert multivector field to Qdrant schema","description":"Add ColBERT multivector field to Qdrant collection schema.\n\nReference: docs/plans/reranker-implementation.md (Section 7.1)\n\nSchema update:\n```typescript\nconst COLLECTION_CONFIG = {\n  vectors: {\n    text_dense: { size: 384, distance: \"Cosine\" },\n    code_dense: { size: 768, distance: \"Cosine\" },\n    // NEW: ColBERT multivector for late interaction\n    colbert: {\n      size: 128,  // Jina ColBERT v2 token dim\n      distance: \"Cosine\",\n      multivector_config: {\n        comparator: \"max_sim\"  // MaxSim for late interaction\n      }\n    },\n  },\n  // ... sparse_vectors unchanged\n};\n```\n\nRequires schema migration for existing data.\n\nLocation: packages/search-core/src/services/schema-manager.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:56:47.551034-06:00","updated_at":"2025-12-19T15:32:08.409096-06:00","closed_at":"2025-12-09T00:36:41.914216-06:00","dependencies":[{"issue_id":"engram-204","depends_on_id":"engram-189","type":"blocks","created_at":"2025-12-08T23:03:21.88198-06:00","created_by":"daemon"}]}
{"id":"engram-205","title":"Update SearchIndexer to generate ColBERT representations","description":"Update indexer to generate ColBERT token embeddings at index time.\n\nReference: docs/plans/reranker-implementation.md (Section 5.2, Strategy 2)\n\nUpdate indexNode():\n```typescript\nasync indexNode(node: IndexableNode) {\n  // Existing dense/sparse vectors\n  const textVector = await this.textEmbedder.embed(content);\n  const sparseVector = await this.textEmbedder.embedSparse(content);\n\n  // NEW: ColBERT token embeddings for late interaction\n  const colbertEmbeddings = await this.colbertEmbedder.encode(content);\n\n  await this.client.upsert(this.collectionName, {\n    points: [{\n      id: node.id,\n      vector: {\n        text_dense: textVector,\n        sparse: sparseVector,\n        colbert: colbertEmbeddings, // Multivector field\n      },\n      payload,\n    }],\n  });\n}\n```\n\nLocation: packages/search-core/src/services/indexer.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:56:57.2403-06:00","updated_at":"2025-12-19T15:32:08.409401-06:00","closed_at":"2025-12-09T00:36:41.997843-06:00","dependencies":[{"issue_id":"engram-205","depends_on_id":"engram-204","type":"blocks","created_at":"2025-12-08T23:03:22.919858-06:00","created_by":"daemon"}]}
{"id":"engram-206","title":"[EPIC] LLM Listwise Reranking","description":"LLM-based listwise reranking for premium queries.\n\nBounded Context: LLM Reranking Domain\nReference: docs/plans/reranker-implementation.md (Section 3.2.4, Phase 4)\n\nUses grok-4-1-fast-reasoning via xAI API for:\n- Listwise comparison ranking\n- Complex reasoning queries\n- High-stakes search results\n\nAdvantages over pointwise:\n- Sees all candidates in context\n- Can make relative comparisons\n- Better for complex reasoning queries\n\nReserved for premium tier due to cost/latency.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:57:06.019306-06:00","updated_at":"2025-12-19T15:32:08.409699-06:00","closed_at":"2025-12-09T00:36:40.318197-06:00","dependencies":[{"issue_id":"engram-206","depends_on_id":"engram-185","type":"blocks","created_at":"2025-12-08T23:02:50.403079-06:00","created_by":"daemon"}]}
{"id":"engram-207","title":"Implement LLMListwiseReranker class","description":"Implement LLM-based listwise reranker using grok-4-1-fast-reasoning.\n\nReference: docs/plans/reranker-implementation.md (Section 3.2.4)\n\nInterface:\n```typescript\nexport interface LLMRerankerOptions {\n  model: \"grok-4-1-fast-reasoning\";\n  maxCandidates: number;  // Max 10 for context efficiency\n  systemPrompt?: string;  // Custom ranking instructions\n}\n\nexport class LLMListwiseReranker {\n  async rerank(\n    query: string,\n    candidates: DocumentCandidate[],\n    topK: number\n  ): Promise\u003cRerankResult[]\u003e;\n}\n```\n\nImplementation notes:\n- Single API call with all candidates in prompt\n- Request ordered list response\n- Parse ranking from LLM output\n- Handle rate limiting and errors\n\nLocation: packages/search-core/src/services/llm-reranker.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:57:14.539443-06:00","updated_at":"2025-12-19T15:32:08.409973-06:00","closed_at":"2025-12-09T00:36:40.284518-06:00","dependencies":[{"issue_id":"engram-207","depends_on_id":"engram-208","type":"blocks","created_at":"2025-12-08T23:03:24.05078-06:00","created_by":"daemon"}]}
{"id":"engram-208","title":"Add xAI API client for grok-4-1-fast-reasoning","description":"Implement xAI API client for LLM reranking.\n\nReference: docs/plans/reranker-implementation.md (Section 9.1)\n\nEnvironment variables:\n- XAI_API_KEY: API key for xAI\n- LLM_RERANK_MODEL: grok-4-1-fast-reasoning\n\nClient requirements:\n- Async API calls\n- Rate limiting\n- Error handling and retries\n- Cost tracking per query\n\nLocation: packages/search-core/src/clients/xai-client.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:57:32.249662-06:00","updated_at":"2025-12-19T15:32:08.410242-06:00","closed_at":"2025-12-09T00:36:40.213062-06:00"}
{"id":"engram-209","title":"Create File State Rehydrator","description":"Reconstruct VFS from Snapshot + Diffs chain. See docs/bitemporal/context/deterministic-execution/create-file-state-rehydrator.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:12.715327-06:00","updated_at":"2025-12-19T15:32:08.410528-06:00","closed_at":"2025-12-06T22:29:41.480129-06:00","labels":["execution","rehydration","vfs"],"dependencies":[{"issue_id":"engram-209","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:12.715735-06:00","created_by":"daemon"}]}
{"id":"engram-21","title":"Phase 2: Add /e why prompt","description":"Implement e-why prompt to search for past decisions on a topic","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:50:46.244223-06:00","updated_at":"2025-12-19T15:32:08.347605-06:00","closed_at":"2025-12-19T03:56:22.163367-06:00"}
{"id":"engram-210","title":"[EPIC] SearchRetriever Integration","description":"Integrate reranking into SearchRetriever pipeline.\n\nBounded Context: Retrieval Integration Domain\nReference: docs/plans/reranker-implementation.md (Section 4)\n\nThis is Phase 1 - the critical path to enable reranking.\n\nIntegration points:\n- Add rerank option to SearchQuery interface\n- Call reranker after hybrid search\n- Merge scores and return enriched results\n- Circuit breaker for latency protection\n\nThis epic wires everything together.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:57:41.084625-06:00","updated_at":"2025-12-19T15:32:08.410829-06:00","closed_at":"2025-12-08T23:54:29.159561-06:00","dependencies":[{"issue_id":"engram-210","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T23:02:46.137633-06:00","created_by":"daemon"}]}
{"id":"engram-211","title":"Implement RERANK_CONFIG runtime configuration","description":"Implement runtime configuration for reranking.\n\nReference: docs/plans/reranker-implementation.md (Section 9.2)\n\nConfiguration structure:\n```typescript\nexport const RERANK_CONFIG = {\n  enabled: true,\n  defaultTier: \"fast\" as RerankerTier,\n\n  tiers: {\n    fast: {\n      model: \"Xenova/ms-marco-MiniLM-L-6-v2\",\n      maxLatencyMs: 50,\n      batchSize: 16,\n    },\n    accurate: {\n      model: \"Xenova/bge-reranker-base\",\n      maxLatencyMs: 150,\n      batchSize: 8,\n    },\n    code: {\n      model: \"jinaai/jina-reranker-v2-base-multilingual\",\n      maxLatencyMs: 150,\n      batchSize: 8,\n    },\n    llm: {\n      model: \"grok-4-1-fast-reasoning\",\n      maxLatencyMs: 2000,\n      maxCandidates: 10,\n    },\n  },\n\n  routing: {\n    codePatterns: [/\\w+\\.\\w+\\(/, /function\\s+\\w+/, /class\\s+\\w+/],\n    complexThreshold: 50,\n    agenticPatterns: [/tool|function|call|execute/i],\n  },\n\n  cache: {\n    queryResultTTL: 300,\n    documentRepresentationTTL: 3600,\n    maxCacheSize: 1024 * 1024 * 1024,\n  },\n};\n```\n\nLocation: packages/search-core/src/config.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:59:29.618242-06:00","updated_at":"2025-12-19T15:32:08.411186-06:00","closed_at":"2025-12-08T23:32:07.760324-06:00"}
{"id":"engram-212","title":"Fix reranker-integration.test.ts assertion failures","description":"The reranker-integration.test.ts has failing assertions in search ranking tests. The hybrid search reranking logic is returning unexpected result ordering. Needs investigation into the scoring algorithm and expected vs actual rankings.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T18:24:23.346575-06:00","updated_at":"2025-12-19T15:32:08.411441-06:00","closed_at":"2025-12-19T01:02:43.880981-06:00"}
{"id":"engram-213","title":"Fix missing xai-client module in llm-reranker tests","description":"The llm-reranker.test.ts has 20 failing tests due to missing '../clients/xai-client' module. The import path does not resolve to an existing file. Need to either create the xai-client module or update the import path.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T18:24:13.569652-06:00","updated_at":"2025-12-19T15:32:08.411673-06:00","closed_at":"2025-12-19T02:54:40.721521-06:00","dependencies":[{"issue_id":"engram-213","depends_on_id":"engram-329","type":"blocks","created_at":"2025-12-19T01:24:30.943253-06:00","created_by":"ccheney"}]}
{"id":"engram-214","title":"Wire reranker call into SearchRetriever.search()","description":"Integrate reranking stage into SearchRetriever.search() method.\n\nReference: docs/plans/reranker-implementation.md (Section 4.1)\n\nUpdated flow:\n```typescript\nasync search(query: SearchQuery): Promise\u003cSearchResult[]\u003e {\n  // 1. Query classification (existing)\n  const classification = this.classifier.classify(query.text);\n\n  // 2. Hybrid retrieval - OVERSAMPLE\n  const rerankDepth = query.rerankDepth ?? 30;\n  const rawResults = await this.hybridSearch(query.text, rerankDepth, filters);\n\n  // 3. NEW: Reranking stage\n  if (query.rerank !== false) {\n    const tier = query.rerankTier ?? this.router.route(query.text, { classification });\n    const reranker = this.getReranker(tier);\n\n    const reranked = await reranker.rerank(\n      query.text,\n      rawResults.map(r =\u003e r.payload.content),\n      query.limit ?? 10\n    );\n\n    return this.mergeScores(rawResults, reranked);\n  }\n\n  return rawResults.slice(0, query.limit);\n}\n```\n\nLocation: packages/search-core/src/services/retriever.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:58:02.323205-06:00","updated_at":"2025-12-19T15:32:08.411957-06:00","closed_at":"2025-12-08T23:08:03.264261-06:00","dependencies":[{"issue_id":"engram-214","depends_on_id":"engram-234","type":"blocks","created_at":"2025-12-08T23:03:25.392307-06:00","created_by":"daemon"}]}
{"id":"engram-215","title":"LOW: Inconsistent array vs object access in rehydrator","description":"Location: packages/execution-core/src/rehydrator.ts:59-62\n\nThe code accesses query results as array indices (snap[0], snap[1]) but other queries use typed object access. Could cause undefined values if GraphClient returns objects.\n\nFix: Use consistent access pattern with proper typing.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:48.225806-06:00","updated_at":"2025-12-19T15:32:08.412239-06:00","closed_at":"2025-12-18T21:47:49.200603-06:00"}
{"id":"engram-216","title":"LOW: Missing error handling for corrupted snapshot data","description":"Location: packages/vfs/src/vfs.ts:111-114\n\nloadSnapshot does not handle corrupted/invalid snapshot data gracefully. Invalid gzip or JSON throws unclear errors.\n\nFix: Add try-catch with descriptive error messages.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:44.49805-06:00","updated_at":"2025-12-19T15:32:08.412482-06:00","closed_at":"2025-12-18T21:47:22.601032-06:00"}
{"id":"engram-217","title":"Add reranking environment variables","description":"Add environment variables for reranking configuration.\n\nReference: docs/plans/reranker-implementation.md (Section 9.1)\n\nEnvironment variables:\n```bash\n# Reranking configuration\nRERANK_ENABLED=true\nRERANK_DEFAULT_TIER=fast\nRERANK_DEPTH=30\nRERANK_TIMEOUT_MS=500\n\n# Model paths (for custom/local models)\nRERANK_MODEL_FAST=Xenova/ms-marco-MiniLM-L-6-v2\nRERANK_MODEL_ACCURATE=Xenova/bge-reranker-base\nRERANK_MODEL_CODE=jinaai/jina-reranker-v2-base-multilingual\nRERANK_MODEL_COLBERT=jinaai/jina-colbert-v2\n\n# LLM reranking (premium)\nLLM_RERANK_ENABLED=false\nLLM_RERANK_MODEL=grok-4-1-fast-reasoning\nLLM_RERANK_MAX_CANDIDATES=10\nXAI_API_KEY=your-xai-api-key\n```\n\nUpdate .env.example with all variables.\n\nLocation: .env.example, apps/search/.env.example","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:59:18.382605-06:00","updated_at":"2025-12-19T15:32:08.412738-06:00","closed_at":"2025-12-08T23:26:47.345666-06:00"}
{"id":"engram-218","title":"Implement context assembly for agent loops","description":"The ContextAssembler in control/src/context/assembler.ts returns hardcoded 'System: You are Engram.' instead of assembling actual context. Need to: query search service for relevant memories, fetch recent session history, implement sliding window with token counting. Ref: implement-context-window-manager.md","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-08T02:05:39.422099-06:00","updated_at":"2025-12-19T15:32:08.412972-06:00","closed_at":"2025-12-08T02:17:41.692016-06:00","dependencies":[{"issue_id":"engram-218","depends_on_id":"engram-102","type":"blocks","created_at":"2025-12-08T02:06:47.444388-06:00","created_by":"daemon"}]}
{"id":"engram-219","title":"Add circuit breaker for reranking latency protection","description":"Implement circuit breaker to fall back to RRF if reranking is slow.\n\nReference: docs/plans/reranker-implementation.md (Section 12)\n\nRisk mitigation:\n- If rerank latency \u003e 500ms, fall back to RRF-only results\n- Circuit breaker pattern to prevent cascading failures\n- Log fallback events for monitoring\n\nImplementation:\n```typescript\nconst RERANK_TIMEOUT_MS = 500;\n\nasync searchWithRerank(query, rawResults) {\n  try {\n    const reranked = await Promise.race([\n      this.reranker.rerank(...),\n      timeout(RERANK_TIMEOUT_MS)\n    ]);\n    return reranked;\n  } catch (e) {\n    logger.warn({ event: \"rerank_fallback\", reason: e.message });\n    return rawResults; // Fallback to RRF\n  }\n}\n```\n\nLocation: packages/search-core/src/services/retriever.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:58:12.099734-06:00","updated_at":"2025-12-19T15:32:08.413262-06:00","closed_at":"2025-12-08T23:25:14.990579-06:00"}
{"id":"engram-22","title":"Phase 3: Implement sampling integration","description":"Add sampling support for LLM-powered summarization and enrichment when client supports it","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:57:52.044489-06:00","updated_at":"2025-12-19T15:32:08.348025-06:00","closed_at":"2025-12-19T04:02:28.241125-06:00"}
{"id":"engram-220","title":"Update API response schema with reranker metadata","description":"Add reranker metadata to search API response.\n\nReference: docs/plans/reranker-implementation.md (Section 7.3)\n\nResponse schema:\n```typescript\ninterface SearchAPIResponse {\n  success: boolean;\n  data: {\n    results: SearchResult[];\n    meta: {\n      query: string;\n      strategy: SearchStrategy;\n      reranker?: {\n        tier: RerankerTier;\n        model: string;\n        latencyMs: number;\n      };\n      totalLatencyMs: number;\n    };\n  };\n}\n```\n\nLocation: apps/interface/app/api/search/route.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:58:33.982851-06:00","updated_at":"2025-12-19T15:32:08.413532-06:00","closed_at":"2025-12-08T23:19:19.038265-06:00","dependencies":[{"issue_id":"engram-220","depends_on_id":"engram-315","type":"blocks","created_at":"2025-12-08T23:03:26.756607-06:00","created_by":"daemon"}]}
{"id":"engram-221","title":"LOW: Silent JSON.stringify failure in parsers","description":"Locations: \n- packages/ingestion-core/src/parser/claude-code.ts:61\n- packages/ingestion-core/src/parser/gemini.ts:93\n\nSeveral parsers call JSON.stringify() on user-provided input without handling potential circular reference errors.\n\nFix: Add try-catch around JSON.stringify calls.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:22.097664-06:00","updated_at":"2025-12-19T15:32:08.413819-06:00","closed_at":"2025-12-18T21:47:22.602739-06:00"}
{"id":"engram-222","title":"LOW: QueryBuilder allows parameter collision","description":"Location: packages/memory-core/src/queries/builder.ts:24-46\n\nThe at() method uses fixed parameter names. If called multiple times with different values, the last call overwrites previous values.\n\nFix: Use indexed parameter names like vt_0, vt_1.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:21.12854-06:00","updated_at":"2025-12-19T15:32:08.414099-06:00","closed_at":"2025-12-18T21:47:22.603055-06:00"}
{"id":"engram-223","title":"[EPIC] Phase 0: Foundation - Prerequisites for Refactoring","description":"# Phase 0: Foundation\n\n**Duration**: 2-3 days\n**Blocking**: All subsequent phases (1-5)\n**Parallelization**: Tasks 0.1, 0.2, 0.3 can run in parallel\n\n## Overview\nThese are critical cross-cutting blockers that must be resolved first as they block multiple downstream tasks:\n1. `@engram/storage` Interface Layer - 8 components depend on concrete `FalkorClient`\n2. `@engram/common` Package - Required for shared utilities, errors, constants\n3. Domain Type Consolidation - Types scattered between `memory-core`, `storage`, and apps\n\n## Success Criteria\n- [ ] All apps can import `@engram/common`\n- [ ] Storage interfaces defined and implemented\n- [ ] Domain types consolidated in `memory-core`\n- [ ] All existing tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 118-246)\n- docs/refactor/packages/storage/REPORT.md\n- docs/refactor/packages/memory-core/REPORT.md","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-09T03:29:42.436073-06:00","updated_at":"2025-12-19T15:32:08.414341-06:00","closed_at":"2025-12-09T03:49:51.204145-06:00","labels":["foundation","p0","refactoring"]}
{"id":"engram-224","title":"LOW: Timeout memory leak in retriever createTimeout","description":"Location: packages/search-core/src/services/retriever.ts:17-21\n\nThe createTimeout function creates a timer that is never cleared when reranking succeeds. Timer continues until it fires (then ignored).\n\nFix: Use AbortController pattern or return cleanup function.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:19.327997-06:00","updated_at":"2025-12-19T15:32:08.414658-06:00","closed_at":"2025-12-18T21:47:37.304226-06:00"}
{"id":"engram-225","title":"[EPIC] UI/Presentation Layer Updates","description":"UI updates for reranking display.\n\nBounded Context: Presentation Domain\nReference: docs/plans/reranker-implementation.md (Section 8)\n\nUpdates:\n- Show REL score when reranked (instead of RRF)\n- Display reranking indicator badge\n- Update score bar component\n- Show reranker metadata in response\n\nUser should see transparency into ranking method.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:58:41.869302-06:00","updated_at":"2025-12-19T15:32:08.414895-06:00","closed_at":"2025-12-09T00:32:26.241209-06:00","dependencies":[{"issue_id":"engram-225","depends_on_id":"engram-302","type":"blocks","created_at":"2025-12-08T23:02:48.023063-06:00","created_by":"daemon"}]}
{"id":"engram-226","title":"[EPIC] Configuration Management","description":"Configuration for reranking system.\n\nBounded Context: Configuration Domain\nReference: docs/plans/reranker-implementation.md (Section 9)\n\nConfiguration levels:\n- Environment variables\n- Runtime configuration\n- Tier-specific settings\n- Routing heuristics\n\nEnables flexible deployment and tuning.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:59:08.223991-06:00","updated_at":"2025-12-19T15:32:08.415177-06:00","closed_at":"2025-12-09T00:35:19.34847-06:00","dependencies":[{"issue_id":"engram-226","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T23:03:06.734126-06:00","created_by":"daemon"}]}
{"id":"engram-227","title":"Update ScoreBar to show REL vs RRF based on rerank status","description":"Update score bar component to differentiate reranked vs non-reranked results.\n\nReference: docs/plans/reranker-implementation.md (Section 8.1)\n\nImplementation:\n```typescript\nfunction ScoreBar({ result }: { result: SearchResult }) {\n  const hasRerank = result.rerankerScore !== undefined;\n\n  return (\n    \u003cdiv\u003e\n      {hasRerank ? (\n        \u003c\u003e\n          \u003cspan title=\"Cross-encoder relevance score\"\u003eREL\u003c/span\u003e\n          \u003cBar score={result.rerankerScore} /\u003e\n          \u003cspan\u003e{Math.round(result.rerankerScore * 100)}%\u003c/span\u003e\n        \u003c/\u003e\n      ) : (\n        \u003c\u003e\n          \u003cspan title=\"Reciprocal Rank Fusion score\"\u003eRRF\u003c/span\u003e\n          \u003cBar score={result.rrfScore} /\u003e\n          \u003cspan\u003e{Math.round(result.rrfScore * 100)}%\u003c/span\u003e\n        \u003c/\u003e\n      )}\n    \u003c/div\u003e\n  );\n}\n```\n\nLocation: apps/interface/app/components/SearchResults.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:58:51.034902-06:00","updated_at":"2025-12-19T15:32:08.415467-06:00","closed_at":"2025-12-08T23:21:34.595427-06:00"}
{"id":"engram-228","title":"Add RERANKED indicator badge to search results header","description":"Add visual indicator when results have been reranked.\n\nReference: docs/plans/reranker-implementation.md (Section 8.2)\n\nImplementation:\n```typescript\n// In SearchResults header\n{meta?.reranker \u0026\u0026 (\n  \u003cspan \n    className=\"rerank-badge\" \n    title={\\`Reranked by \\${meta.reranker.model}\\`}\n  \u003e\n    RERANKED ({meta.reranker.latencyMs}ms)\n  \u003c/span\u003e\n)}\n```\n\nStyling:\n- Cyan/teal badge consistent with design system\n- Show model name on hover\n- Display latency for transparency\n\nLocation: apps/interface/app/components/SearchResults.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:59:00.191152-06:00","updated_at":"2025-12-19T15:32:08.415694-06:00","closed_at":"2025-12-08T23:23:53.646996-06:00"}
{"id":"engram-229","title":"LOW: Log loss when forwardToBackend is false","description":"Location: packages/logger/src/browser.ts:30-36\n\nWhen forwardToBackend is false, flush() clears the buffer before checking the flag. Logs accumulated in the buffer are silently discarded.\n\nFix: Check forwardToBackend before clearing buffer.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:52.496359-06:00","updated_at":"2025-12-19T15:32:08.415926-06:00","closed_at":"2025-12-18T21:47:37.308567-06:00"}
{"id":"engram-22qm","title":"Run TR benchmark and verify temporal filtering","description":"Run benchmark --limit 20 (TR questions), verify time_range in search logs, compare accuracy before/after","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T15:45:35.762496-05:00","updated_at":"2025-12-27T17:32:57.437524-05:00","closed_at":"2025-12-27T17:32:57.437524-05:00","dependencies":[{"issue_id":"engram-22qm","depends_on_id":"engram-w9hl","type":"blocks","created_at":"2025-12-27T15:46:23.140895-05:00","created_by":"ccheney"},{"issue_id":"engram-22qm","depends_on_id":"engram-cchc","type":"blocks","created_at":"2025-12-27T15:46:28.264793-05:00","created_by":"ccheney"}]}
{"id":"engram-22yx","title":"Register engram-ingestion OAuth client (scopes: ingest:write, memory:write)","description":"Register engram-ingestion as OAuth client for Ingestion service.\n\n**Prerequisites:** Run seed-oauth-clients.ts script from engram-h44m\n\n**Client configuration:**\n- client_id: engram-ingestion\n- scopes: ingest:write, memory:write\n- grant_types: client_credentials\n- token_endpoint_auth_method: client_secret_basic\n\n**Environment variables to set:**\n```bash\n# In apps/ingestion/.env\nENGRAM_CLIENT_ID=engram-ingestion\nENGRAM_CLIENT_SECRET=\u003cfrom seed script output\u003e\nENGRAM_AUTH_URL=http://localhost:6178\n```\n\n**Ingestion service usage:**\nThe ingestion service receives events from external agents and writes to memory system.\n\n**Files to update:**\n- `apps/ingestion/.env.example` - add new env vars\n- `docker-compose.dev.yml` - add ingestion service env\n\n**Subagent instructions:**\n- Verify seed script ran successfully first\n- Check client exists in database\n- Update .env.example files","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:53:00.518349-06:00","updated_at":"2025-12-29T16:41:52.614127-06:00","closed_at":"2025-12-29T16:41:52.614127-06:00","dependencies":[{"issue_id":"engram-22yx","depends_on_id":"engram-h44m","type":"blocks","created_at":"2025-12-29T15:58:24.326863-06:00","created_by":"ccheney"}]}
{"id":"engram-23","title":"Write tests for MCP services","description":"Unit tests for MemoryStore and MemoryRetriever","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T04:11:58.077283-06:00","updated_at":"2025-12-19T15:32:08.348342-06:00","closed_at":"2025-12-19T04:17:12.638386-06:00"}
{"id":"engram-230","title":"Integrate SpladeEmbedder into TextEmbedder","description":"Update TextEmbedder to use SpladeEmbedder for embedSparse() and embedSparseQuery() methods. Replace BM25Sparse usage. Keep BM25Sparse as fallback initially.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T19:25:05.862727-06:00","updated_at":"2025-12-19T15:32:08.416156-06:00","closed_at":"2025-12-08T19:43:44.839434-06:00","dependencies":[{"issue_id":"engram-230","depends_on_id":"engram-263","type":"blocks","created_at":"2025-12-08T19:25:16.360697-06:00","created_by":"daemon"}]}
{"id":"engram-231","title":"[EPIC] Phase 1: Type Safety \u0026 Error Handling","description":"# Phase 1: Type Safety \u0026 Error Handling\n\n**Duration**: 3-4 days\n**Dependencies**: Phase 0 complete\n**Parallelization**: Tasks 1.1, 1.2, 1.3 can run in parallel\n\n## Overview\nAddress type safety issues and fix silent error swallowing across the codebase:\n- Remove dangerous `as any` type casts\n- Add Zod schemas to parsers for runtime validation\n- Fix silent error swallowing patterns\n\n## Issue Summary\n- Total `as any` casts: 70+\n- Silent error catches: 15+\n- Parsers without validation: 8\n\n## Success Criteria\n- [ ] `as any` usage reduced from 70+ to \u003c10\n- [ ] All parsers have Zod validation\n- [ ] No silent error swallowing\n- [ ] All tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 249-345)\n- docs/refactor/apps/execution/REPORT.md\n- docs/refactor/apps/ingestion/REPORT.md\n- docs/refactor/packages/ingestion-core/REPORT.md","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-09T03:30:31.92641-06:00","updated_at":"2025-12-19T15:32:08.416448-06:00","closed_at":"2025-12-09T04:03:15.833088-06:00","labels":["p0","refactoring","type-safety"],"dependencies":[{"issue_id":"engram-231","depends_on_id":"engram-223","type":"blocks","created_at":"2025-12-09T03:38:41.068863-06:00","created_by":"daemon"}]}
{"id":"engram-231y","title":"Test coverage: packages/temporal/src/time-travel.ts (87%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:40.973012-06:00","updated_at":"2025-12-21T01:43:24.071886-06:00","closed_at":"2025-12-21T01:43:24.071886-06:00"}
{"id":"engram-232","title":"Migrate tests from bun:test to vitest","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T19:02:32.952965-06:00","updated_at":"2025-12-19T15:32:08.416773-06:00","closed_at":"2025-12-08T19:13:02.357643-06:00"}
{"id":"engram-233","title":"[1.3] Fix Silent Error Swallowing","description":"# Task 1.3: Fix Silent Error Swallowing\n\n**Effort**: 4 hours\n**Dependencies**: Task 0.1 (error types from @engram/common)\n**Parallel**: Can run with 1.1, 1.2 (after 0.1 complete)\n\n## Locations to Fix\n\n| File | Lines | Current Behavior | Fix |\n|------|-------|------------------|-----|\n| `apps/control/src/context/assembler.ts` | 113-116, 147-150 | Returns `[]` | Log + throw ContextAssemblyError |\n| `packages/execution-core/src/rehydrator.ts` | 33-43 | Silent JSON parse | Log + throw RehydrationError |\n| `apps/ingestion/src/index.ts` | 173-178 | Kafka errors logged only | Add to DLQ |\n| `apps/memory/src/index.ts` | 84-87 | Silent message drop | Log warning |\n| `packages/vfs/src/patch.ts` | 12-14 | Silent catch | Check error type, rethrow unexpected |\n| `packages/logger/src/browser.ts` | 44-46 | Silent fetch failure | Add error callback |\n| `packages/storage/src/blob.ts` | 78-83, 112-117 | Returns stub URI | Throw or use Result type |\n\n## Error Types to Use (from @engram/common)\n- `EngramError` - base class\n- `GraphOperationError` - FalkorDB operations\n- `ParseError` - parsing failures\n- `ValidationError` - validation failures\n- `ContextAssemblyError` - context building\n- `RehydrationError` - state reconstruction\n\n## Acceptance Criteria\n- [ ] All silent catches identified and fixed\n- [ ] Appropriate error types used\n- [ ] Errors logged before throwing\n- [ ] DLQ implementation for Kafka\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 325-345)\n- docs/refactor/apps/control/REPORT.md\n- docs/refactor/packages/execution-core/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:31:15.864464-06:00","updated_at":"2025-12-19T15:32:08.417102-06:00","closed_at":"2025-12-09T04:03:15.798651-06:00","labels":["error-handling","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-233","depends_on_id":"engram-231","type":"parent-child","created_at":"2025-12-09T03:31:15.864991-06:00","created_by":"daemon"},{"issue_id":"engram-233","depends_on_id":"engram-89","type":"blocks","created_at":"2025-12-09T03:38:48.008965-06:00","created_by":"daemon"}]}
{"id":"engram-234","title":"Add rerank options to SearchQuery interface","description":"Extend SearchQuery interface with reranking options.\n\nReference: docs/plans/reranker-implementation.md (Section 4.1)\n\nInterface update:\n```typescript\nexport interface SearchOptions {\n  // Existing\n  limit?: number;\n  filters?: SearchFilters;\n  strategy?: SearchStrategy;\n\n  // New: Reranking control\n  rerank?: boolean;              // Default: true\n  rerankTier?: RerankerTier;     // Default: auto-routed\n  rerankDepth?: number;          // How many to fetch for reranking\n}\n```\n\nDefault behavior:\n- rerank: true (enabled by default)\n- rerankTier: undefined (auto-routed)\n- rerankDepth: 30 (oversample for reranking)\n\nLocation: packages/search-core/src/models/schema.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:57:50.618749-06:00","updated_at":"2025-12-19T15:32:08.417491-06:00","closed_at":"2025-12-08T23:06:54.942258-06:00"}
{"id":"engram-235","title":"[1.2] Add Zod Schemas to Ingestion Parsers","description":"# Task 1.2: Add Zod Schemas to Parsers\n\n**Effort**: 8 hours\n**Dependencies**: Task 0.1 (@engram/common)\n**Parallel**: Can run with 1.1, 1.3 (after 0.1 complete)\n\n## Deliverables\nCreate: `packages/ingestion-core/src/parser/schemas.ts`\n\n```typescript\nexport const AnthropicMessageStartSchema = z.object({\n  type: z.literal(\"message_start\"),\n  message: z.object({\n    usage: z.object({\n      input_tokens: z.number(),\n    }).optional(),\n  }).optional(),\n});\n\nexport const OpenAIChunkSchema = z.object({\n  choices: z.array(z.object({\n    delta: z.object({\n      content: z.string().optional(),\n      tool_calls: z.array(z.object({\n        id: z.string(),\n        function: z.object({\n          name: z.string(),\n          arguments: z.string(),\n        }),\n      })).optional(),\n    }),\n  })),\n});\n\n// Add schemas for all 8 parsers\n```\n\n## Parsers to Update\n- AnthropicParser\n- OpenAIParser\n- ClaudeCodeParser\n- GeminiParser\n- CodexParser\n- ClineParser\n- XAIParser\n- OpenCodeParser\n\n## Acceptance Criteria\n- [ ] All 8 parsers have Zod schemas\n- [ ] Runtime validation active\n- [ ] ParseError thrown on invalid input\n- [ ] Unit tests for each schema\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 276-323)\n- docs/refactor/packages/ingestion-core/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:31:01.914302-06:00","updated_at":"2025-12-19T15:32:08.417806-06:00","closed_at":"2025-12-09T04:03:15.76196-06:00","labels":["parallel-ok","refactoring","type-safety","zod"],"dependencies":[{"issue_id":"engram-235","depends_on_id":"engram-231","type":"parent-child","created_at":"2025-12-09T03:31:01.914809-06:00","created_by":"daemon"},{"issue_id":"engram-235","depends_on_id":"engram-89","type":"blocks","created_at":"2025-12-09T03:38:47.975938-06:00","created_by":"daemon"}]}
{"id":"engram-236","title":"[1.1] Remove 'as any' Type Bypasses","description":"# Task 1.1: Remove `as any` Type Bypasses\n\n**Effort**: 8 hours\n**Dependencies**: Task 0.2 (Storage Interfaces)\n**Parallel**: Can run with 1.2, 1.3 (after 0.2 complete)\n\n## Files by Priority\n\n| File | Count | Resolution |\n|------|-------|------------|\n| `apps/execution/src/index.ts` | 6 | Create proper MCP SDK types |\n| `apps/ingestion/src/index.ts` | 1 | Import KafkaClient types |\n| `apps/search/src/index.ts` | 5 | Import Kafka message types |\n| `apps/control/src/index.ts` | 1 | Use null pattern for SearchRetriever |\n| `packages/search-core/src/services/*.ts` | 8 | Type pipeline functions properly |\n| `packages/logger/src/index.ts` | 1 | Fix level type |\n\n## Strategy\n1. Audit all `as any` casts with `grep -r \"as any\" --include=\"*.ts\"`\n2. For each cast, determine proper type\n3. Create missing type definitions where needed\n4. Update function signatures to accept proper types\n\n## Acceptance Criteria\n- [ ] `as any` count reduced from 70+ to \u003c10\n- [ ] No type errors introduced\n- [ ] All tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 255-274)\n- docs/refactor/apps/execution/REPORT.md\n- docs/refactor/apps/search/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:30:49.207013-06:00","updated_at":"2025-12-19T15:32:08.418132-06:00","closed_at":"2025-12-09T04:03:15.718563-06:00","labels":["parallel-ok","refactoring","type-safety"],"dependencies":[{"issue_id":"engram-236","depends_on_id":"engram-231","type":"parent-child","created_at":"2025-12-09T03:30:49.207418-06:00","created_by":"daemon"},{"issue_id":"engram-236","depends_on_id":"engram-88","type":"blocks","created_at":"2025-12-09T03:38:47.944607-06:00","created_by":"daemon"}]}
{"id":"engram-237","title":"Phase 3: Update engram_context with sampling","description":"Enhance context tool to use sampling for summarization when available","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:58:10.225115-06:00","updated_at":"2025-12-19T15:32:08.41843-06:00","closed_at":"2025-12-19T04:02:28.243399-06:00"}
{"id":"engram-238","title":"Integrate Microsoft Wassette Library","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-07T00:35:57.400142-06:00","updated_at":"2025-12-19T15:32:08.418693-06:00","closed_at":"2025-12-07T00:44:03.560935-06:00","dependencies":[{"issue_id":"engram-238","depends_on_id":"engram-275","type":"blocks","created_at":"2025-12-07T00:36:36.294796-06:00","created_by":"daemon"},{"issue_id":"engram-238","depends_on_id":"engram-343","type":"blocks","created_at":"2025-12-07T00:36:36.327121-06:00","created_by":"daemon"},{"issue_id":"engram-238","depends_on_id":"engram-252","type":"blocks","created_at":"2025-12-07T00:36:36.357739-06:00","created_by":"daemon"},{"issue_id":"engram-238","depends_on_id":"engram-122","type":"blocks","created_at":"2025-12-07T00:36:36.387797-06:00","created_by":"daemon"}]}
{"id":"engram-239","title":"MEDIUM: Process event listeners accumulate - memory leak","description":"Location: apps/search/src/index.ts:110-117\n\nThe startConsumer() method registers SIGTERM and SIGINT handlers every time it is called. These handlers are never removed.\n\nImpact: Memory leak, MaxListenersExceededWarning after 11 listeners.\n\nFix: Use process.once() instead of process.on(), or store and remove listeners.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:03.492692-06:00","updated_at":"2025-12-19T15:32:08.419004-06:00","closed_at":"2025-12-19T00:58:45.15696-06:00"}
{"id":"engram-24","title":"Create/update README files for all apps and packages","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T14:11:31.638289-06:00","updated_at":"2025-12-19T15:32:08.348616-06:00","closed_at":"2025-12-19T14:16:01.453354-06:00"}
{"id":"engram-241","title":"Expand CI/CD pipeline for all services","description":"cloudbuild.yaml only includes build/deploy steps for ingestion service. Need to add similar steps for memory, search, execution, control, and interface services. Consider matrix builds for efficiency. Ref: define-cicd-pipeline.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T02:06:31.315902-06:00","updated_at":"2025-12-19T15:32:08.420859-06:00","closed_at":"2025-12-08T02:45:53.073412-06:00"}
{"id":"engram-242","title":"MEDIUM: FalkorDB connection promise created eagerly","description":"Location: packages/storage/src/falkor.ts:77-88\n\nThe FalkorClient constructor creates a connection promise immediately upon instantiation. If FalkorDB is unavailable, errors surface later unexpectedly.\n\nImpact: Test setup complexity, confusing error timing.\n\nFix: Defer connection until connect() is explicitly called.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:19.956142-06:00","updated_at":"2025-12-19T15:32:08.421211-06:00","closed_at":"2025-12-19T00:59:10.886685-06:00"}
{"id":"engram-243","title":"CRITICAL: Arbitrary Cypher query execution without auth","description":"Location: apps/interface/app/api/graphql/schema.ts:115-121\n\nThe 'graph' resolver accepts arbitrary Cypher queries and executes them directly. The comment acknowledges this should be protected, but there is no authentication or authorization check.\n\nImpact: Any GraphQL user can execute arbitrary database commands including data deletion, extraction, or manipulation.\n\nFix: Either remove the graph resolver entirely or add strong authentication/authorization.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:55:49.997962-06:00","updated_at":"2025-12-19T15:32:08.421487-06:00","closed_at":"2025-12-19T00:39:58.19785-06:00"}
{"id":"engram-244","title":"HIGH: Database connection leak in handleListFilesAtTime","description":"Location: apps/execution/src/index.ts:145-158\n\nThe handleListFilesAtTime function calls graphClient.connect() but never calls disconnect(). Each invocation opens a new connection that is never closed.\n\nImpact: Connection pool exhaustion over time.\n\nFix: Add finally block to ensure disconnect() is always called.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:57.512847-06:00","updated_at":"2025-12-19T15:32:08.421738-06:00","closed_at":"2025-12-19T00:58:45.154881-06:00"}
{"id":"engram-245","title":"MEDIUM: Unhandled JSON.parse errors in session repository","description":"Location: packages/memory-core/src/repositories/falkor-session.repository.ts:210\n\nJSON.parse(props.metadata) is called without try-catch. If metadata contains malformed JSON, this will throw an unhandled exception.\n\nImpact: Crashes operation if database contains corrupted metadata.\n\nFix: Wrap JSON.parse in try-catch, log warning, return undefined on failure.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:37.619302-06:00","updated_at":"2025-12-19T15:32:08.421986-06:00","closed_at":"2025-12-19T00:39:58.198512-06:00"}
{"id":"engram-246","title":"Update Qdrant schema for separate code/text vectors","description":"CodeEmbedder now uses nomic-embed-text-v1 (768 dim) while TextEmbedder uses e5-small (384 dim). The current schema only has a single 'dense' vector field. Need to: 1) Add separate vector fields (text_dense: 384, code_dense: 768), 2) Update indexer to use correct vector field based on content type, 3) Consider migration strategy for existing data.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T02:20:56.357901-06:00","updated_at":"2025-12-19T15:32:08.422223-06:00","closed_at":"2025-12-08T02:35:58.080574-06:00"}
{"id":"engram-247","title":"Write tests for MCP ingest handlers","description":"Unit tests for HTTP ingest event handlers","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T04:12:04.743011-06:00","updated_at":"2025-12-19T15:32:08.422454-06:00","closed_at":"2025-12-19T04:17:12.638752-06:00"}
{"id":"engram-248","title":"Create SearchResults component with result cards","description":"Create a search results grid component matching SessionBrowser's design.\n\nReference: docs/plans/search-ui.md (Phase 2: SearchResults Component)\n\nNew file: apps/interface/app/components/SearchResults.tsx\n\nSearchResults component:\n- Header: \"● SEARCH RESULTS\" with match count badge\n- Grid layout: repeat(auto-fill, minmax(220px, 1fr)) - same as SessionBrowser\n- Empty state: \"No matches found. Try different keywords.\"\n- Error state: \"Search unavailable. Check connection.\"\n- Loading state: Skeleton cards with pulse animation\n\nSearchResultCard sub-component props:\n- type: 'thought' | 'code' | 'doc'\n- content: string (truncated to ~100 chars with ellipsis)\n- score: number (0-1, displayed as percentage like \"92% match\")\n- sessionId: string (truncated to 8 chars, clickable)\n- nodeId: string (for future deep linking)\n- timestamp: number (formatted as relative time)\n- onClick: () =\u003e void\n\nVisual design:\n- Card background: rgba(15, 20, 30, 0.6) with glassmorphism\n- Type icon/badge with color:\n  - Thought: 💭 or brain icon, rgb(139, 92, 246) violet\n  - Code: 💻 or code icon, rgb(251, 191, 36) amber  \n  - Doc: 📄 or file icon, rgb(59, 130, 246) blue\n- Score bar: 5 segments like activity bar, filled based on score percentage\n- Hover: translateY(-2px), border glow, background gradient shift\n- Animation: cardReveal with staggered delay (same as SessionCard)\n\nClick action: navigate to /session/{sessionId}\nFuture: add ?highlight={nodeId} for deep linking to specific node","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:39:23.535994-06:00","updated_at":"2025-12-19T15:32:08.422704-06:00","closed_at":"2025-12-08T21:53:46.845027-06:00"}
{"id":"engram-249","title":"Implement graceful degradation on reranker failure","description":"If reranker throws/times out: return RRF results with degradation flag. Log error. Don't fail the entire search.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:31.528484-06:00","updated_at":"2025-12-19T15:32:08.422961-06:00","closed_at":"2025-12-09T00:13:48.384792-06:00"}
{"id":"engram-25","title":"Add Test Coverage: packages/storage","description":"Add comprehensive unit and integration tests for packages/storage","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.348873-06:00","closed_at":"2025-12-07T02:02:43.830572-06:00","labels":["packages","storage","testing"]}
{"id":"engram-250","title":"MEDIUM: Redis connection race condition returns null client","description":"Locations:\n- packages/storage/src/redis.ts:42-61\n\nThe connection wait loop has a race condition. If connecting becomes true and the connection fails, connecting is reset but client remains null. Waiting callers return client! which is null.\n\nImpact: Null pointer crashes under network failure conditions.\n\nFix: Check client is not null after exiting wait loop.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:31.869197-06:00","updated_at":"2025-12-19T15:32:08.423181-06:00","closed_at":"2025-12-19T00:59:10.886345-06:00"}
{"id":"engram-251","title":"LOW: Division by zero in reranking statistics","description":"Location: packages/search-core/src/services/retriever.ts:186-190\n\nWhen calculating average scores, there is no check for empty arrays. If reranked is empty, avgRerankedScore will be NaN (0/0).\n\nFix: Add length check before division.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:17.089991-06:00","updated_at":"2025-12-19T15:32:08.423398-06:00","closed_at":"2025-12-18T21:47:37.306136-06:00"}
{"id":"engram-252","title":"Update Execution Service to use Wassette","description":"the-system-1p4","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T00:36:28.997771-06:00","updated_at":"2025-12-19T15:32:08.423604-06:00","closed_at":"2025-12-07T00:41:57.107522-06:00"}
{"id":"engram-253","title":"Integrate xAI Grok Model","description":"Replace mock model in DecisionEngine with xAI grok-4-1-fast-reasoning using OpenAI compatibility.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-07T01:19:43.069323-06:00","updated_at":"2025-12-19T15:32:08.423874-06:00","closed_at":"2025-12-07T01:20:41.45158-06:00"}
{"id":"engram-254","title":"LOW: VirtualFileSystem cwd property never used","description":"Location: packages/vfs/src/vfs.ts:22,26\n\nThe cwd property is initialized but never used in any method. All path operations use absolute paths.\n\nFix: Remove dead code or implement relative path support.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:45.485677-06:00","updated_at":"2025-12-19T15:32:08.424082-06:00","closed_at":"2025-12-18T21:47:22.600544-06:00"}
{"id":"engram-255","title":"P6: Train fusion weight MLP","description":"Train a small MLP to predict optimal fusion weights from query features.\n\n## Context\n- Plan: docs/plans/retrieval-v2/06-learned-fusion.md\n- Training Pipeline: lines 180-230 (Python training script)\n- Data Generation: lines 235-280\n\n## Tasks\n1. Generate training data via grid search\n2. Implement FusionMLP in PyTorch (6→32→32→3)\n3. Train on LongMemEval validation set\n4. Export to ONNX for inference\n5. Validate on held-out test set\n\n## Expected Impact\n- Query-adaptive fusion weights\n- Reduces variance across query types\n\n## Dependencies\n- Requires: P6 query feature extraction (previous)\n\n## References\n- MLP architecture: lines 185-200\n- Training data generation: lines 235-280","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:39:25.050043-06:00","updated_at":"2025-12-19T15:32:08.424367-06:00","closed_at":"2025-12-19T00:17:01.900765-06:00","dependencies":[{"issue_id":"engram-255","depends_on_id":"engram-191","type":"blocks","created_at":"2025-12-18T21:40:44.529749-06:00","created_by":"ccheney"}]}
{"id":"engram-256","title":"HIGH: Cypher injection in GraphMerger","description":"Location: packages/memory-core/src/merger.ts:28,34\n\nThe mergeNodes method interpolates the relationship type from query results directly into new queries without validation.\n\nRisk: If the database contains malicious data in relationship types, this could cause unexpected behavior.\n\nFix: Validate relationship types before interpolation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:18.594555-06:00","updated_at":"2025-12-19T15:32:08.424674-06:00","closed_at":"2025-12-19T00:39:58.197615-06:00"}
{"id":"engram-257","title":"Add ReasoningNode schema to memory-core","description":"Create ReasoningNode for thinking blocks within a turn, with content_hash, preview, blob_ref, embedding, sequence_index","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T03:13:53.505541-06:00","updated_at":"2025-12-19T15:32:08.424917-06:00","closed_at":"2025-12-08T03:18:11.157575-06:00","dependencies":[{"issue_id":"engram-257","depends_on_id":"engram-259","type":"blocks","created_at":"2025-12-08T03:14:04.476967-06:00","created_by":"daemon"}]}
{"id":"engram-258","title":"Add TurnNode schema to memory-core","description":"Create TurnNode with user_content, assistant_preview, blob_ref, embedding, sequence_index, files_touched","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T03:13:52.852817-06:00","updated_at":"2025-12-19T15:32:08.425159-06:00","closed_at":"2025-12-08T03:18:11.118751-06:00","dependencies":[{"issue_id":"engram-258","depends_on_id":"engram-259","type":"blocks","created_at":"2025-12-08T03:14:04.438837-06:00","created_by":"daemon"}]}
{"id":"engram-259","title":"Refactor graph nodes: Replace ThoughtNode with Turn/Reasoning/FileTouch hierarchy","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T03:13:41.027462-06:00","updated_at":"2025-12-19T15:32:08.425402-06:00","closed_at":"2025-12-08T03:24:06.53209-06:00"}
{"id":"engram-26","title":"Add Test Coverage: packages/search-core","description":"Add comprehensive unit and integration tests for packages/search-core","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.349177-06:00","closed_at":"2025-12-07T02:03:50.342867-06:00","labels":["packages","search-core","testing"]}
{"id":"engram-260","title":"Define Agent Persona Configuration","description":"The Soul persona definition and core system prompt. See docs/bitemporal/context/agent-control/define-agent-persona-configuration.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:04.863714-06:00","updated_at":"2025-12-19T15:32:08.425734-06:00","closed_at":"2025-12-06T22:32:10.34155-06:00","labels":["control","persona","prompt"],"dependencies":[{"issue_id":"engram-260","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:04.864076-06:00","created_by":"daemon"}]}
{"id":"engram-261","title":"Initialize Mastra Framework Project","description":"Setup apps/control with Mastra core and Vercel AI SDK. See docs/bitemporal/context/agent-control/initialize-mastra-framework-project.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:04.82216-06:00","updated_at":"2025-12-19T15:32:08.426055-06:00","closed_at":"2025-12-06T22:32:10.311596-06:00","labels":["control","mastra","setup"],"dependencies":[{"issue_id":"engram-261","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:04.822514-06:00","created_by":"daemon"}]}
{"id":"engram-262","title":"Implement Mastra Workflow Definitions","description":"The Think-Act-Observe loop workflow in Mastra. See docs/bitemporal/context/agent-control/implement-mastra-workflow-definitions.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:04.906247-06:00","updated_at":"2025-12-19T15:32:08.426356-06:00","closed_at":"2025-12-06T22:32:10.369884-06:00","labels":["control","logic","workflow"],"dependencies":[{"issue_id":"engram-262","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:04.906621-06:00","created_by":"daemon"}]}
{"id":"engram-263","title":"Implement SPLADE pooling algorithm","description":"Implement spladePooling function: max pooling over sequence + ReLU + log(1+x) scaling. Output sparse vector with indices and values arrays. Handle 30,522-dim BERT vocabulary.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T19:25:04.937404-06:00","updated_at":"2025-12-19T15:32:08.426683-06:00","closed_at":"2025-12-08T19:37:27.307598-06:00","dependencies":[{"issue_id":"engram-263","depends_on_id":"engram-280","type":"blocks","created_at":"2025-12-08T19:25:16.328248-06:00","created_by":"daemon"}]}
{"id":"engram-264","title":"Phase 1: Implement engram_recall tool","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T03:32:33.265444-06:00","updated_at":"2025-12-19T15:32:08.426991-06:00","closed_at":"2025-12-19T03:42:06.353243-06:00"}
{"id":"engram-265","title":"Implement Context Window Manager","description":"Strategy to assemble prompts within token limits. See docs/bitemporal/context/agent-control/implement-context-window-manager.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:05.120761-06:00","updated_at":"2025-12-19T15:32:08.42725-06:00","closed_at":"2025-12-06T23:10:01.451046-06:00","labels":["context","control","tokens"],"dependencies":[{"issue_id":"engram-265","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.12118-06:00","created_by":"daemon"}]}
{"id":"engram-266","title":"Implement Graphiti MCP Client Integration","description":"Bridge Memory MCP tools to Mastra agent. See docs/bitemporal/context/agent-control/implement-graphiti-mcp-client-integration.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:04.995243-06:00","updated_at":"2025-12-19T15:32:08.427543-06:00","closed_at":"2025-12-06T23:15:26.591919-06:00","labels":["control","integration","mcp"],"dependencies":[{"issue_id":"engram-266","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:04.995629-06:00","created_by":"daemon"}]}
{"id":"engram-267","title":"Define Fallback Behavior Logic","description":"Error recovery for hallucinations or bad JSON. See docs/bitemporal/context/agent-control/define-fallback-behavior-logic.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:05.289559-06:00","updated_at":"2025-12-19T15:32:08.427846-06:00","closed_at":"2025-12-07T01:00:13.218045-06:00","labels":["control","error-handling"],"dependencies":[{"issue_id":"engram-267","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.289947-06:00","created_by":"daemon"}]}
{"id":"engram-268","title":"Implement Wassette MCP Client Integration","description":"Bridge Execution MCP tools to Mastra agent. See docs/bitemporal/context/agent-control/implement-wassette-mcp-client-integration.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:05.037032-06:00","updated_at":"2025-12-19T15:32:08.428109-06:00","closed_at":"2025-12-06T23:15:26.622314-06:00","labels":["control","integration","mcp"],"dependencies":[{"issue_id":"engram-268","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.037369-06:00","created_by":"daemon"}]}
{"id":"engram-269","title":"Develop Agent Heartbeat Monitor","description":"Watchdog for stuck agent states. See docs/bitemporal/context/agent-control/develop-agent-heartbeat-monitor.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:05.249694-06:00","updated_at":"2025-12-19T15:32:08.42839-06:00","closed_at":"2025-12-06T23:21:48.867979-06:00","labels":["control","monitor","resilience"],"dependencies":[{"issue_id":"engram-269","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.250052-06:00","created_by":"daemon"}]}
{"id":"engram-26h2","title":"Wire ReplayEngine for tool execution audit","description":"packages/temporal/src/replay.ts has complete ReplayEngine for deterministic tool replay but is never invoked outside tests. Expose via control service for debugging and audit trails.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:01:18.499558-06:00","updated_at":"2025-12-20T23:25:49.61579-06:00","closed_at":"2025-12-20T23:25:49.61579-06:00"}
{"id":"engram-27","title":"Add Test Coverage: packages/memory-core","description":"Add comprehensive unit and integration tests for packages/memory-core","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.34949-06:00","closed_at":"2025-12-07T02:02:50.415732-06:00","labels":["memory-core","packages","testing"]}
{"id":"engram-270","title":"Create Agent State Machine","description":"XState machine for agent lifecycle status (IDLE, ACTING). See docs/bitemporal/context/agent-control/create-agent-state-machine.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:04.948837-06:00","updated_at":"2025-12-19T15:32:08.428651-06:00","closed_at":"2025-12-06T23:09:19.610526-06:00","labels":["control","state","xstate"],"dependencies":[{"issue_id":"engram-270","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:04.949233-06:00","created_by":"daemon"}]}
{"id":"engram-271","title":"Implement Tool Selection Strategy","description":"Static vs Dynamic tool injection logic. See docs/bitemporal/context/agent-control/implement-tool-selection-strategy.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:05.205829-06:00","updated_at":"2025-12-19T15:32:08.428923-06:00","closed_at":"2025-12-06T23:10:23.431234-06:00","labels":["control","optimization","tools"],"dependencies":[{"issue_id":"engram-271","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.206288-06:00","created_by":"daemon"}]}
{"id":"engram-272","title":"Define Decision Loop Logic","description":"Logic to route LLM output (tool_call vs thought vs content). See docs/bitemporal/context/agent-control/define-decision-loop-logic.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:05.07853-06:00","updated_at":"2025-12-19T15:32:08.42922-06:00","closed_at":"2025-12-06T23:38:26.430149-06:00","labels":["control","logic","routing"],"dependencies":[{"issue_id":"engram-272","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.078882-06:00","created_by":"daemon"}]}
{"id":"engram-273","title":"Create Agent Session Initializer","description":"Bootstrap new sessions in Memory and Redpanda. See docs/bitemporal/context/agent-control/create-agent-session-initializer.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:05.16388-06:00","updated_at":"2025-12-19T15:32:08.429491-06:00","closed_at":"2025-12-07T00:25:23.07323-06:00","labels":["control","init","session"],"dependencies":[{"issue_id":"engram-273","depends_on_id":"engram-274","type":"parent-child","created_at":"2025-12-06T21:55:05.16433-06:00","created_by":"daemon"}]}
{"id":"engram-274","title":"Bounded Context: Agent Control","description":"The 'Frontal Cortex'. Mastra agents, workflows, and decision loops. See docs/bitemporal/context/agent-control/","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:47:42.521911-06:00","updated_at":"2025-12-19T15:32:08.429779-06:00","closed_at":"2025-12-06T22:33:15.17818-06:00","labels":["context","control","mastra"]}
{"id":"engram-275","title":"Install Wassette Binary","description":"the-system-1p4","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T00:36:28.913252-06:00","updated_at":"2025-12-19T15:32:08.43038-06:00","closed_at":"2025-12-07T00:38:05.086774-06:00"}
{"id":"engram-276","title":"MEDIUM: Non-atomic read-modify-write in session update","description":"Location: packages/memory-core/src/repositories/falkor-session.repository.ts:119-182\n\nThe update method performs a read-modify-write cycle without atomic guarantees. Two concurrent updates could cause lost updates or orphaned versions.\n\nImpact: Data integrity issues under concurrent access.\n\nFix: Implement optimistic locking with version numbers or use database transactions.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:33.026126-06:00","updated_at":"2025-12-19T15:32:08.430699-06:00","closed_at":"2025-12-19T01:07:17.489723-06:00"}
{"id":"engram-277","title":"[3.3] Implement Dependency Injection Pattern","description":"# Task 3.3: Implement Dependency Injection Pattern\n\n**Effort**: 10 hours\n**Dependencies**: Task 3.1 (Repository Pattern)\n**NOT Parallel**: Must wait for 3.1\n\n## Pattern\nFactory functions with injectable dependencies\n\n## Apps to Update\n\n### apps/control\n```typescript\n// Before\nconst assembler = new ContextAssembler(falkorClient);\n\n// After\nexport function createContextAssembler(deps: {\n  sessionRepo: SessionRepository;\n  turnRepo: TurnRepository;\n  searchRetriever?: SearchRetriever;\n}): ContextAssembler {\n  return new ContextAssembler(deps);\n}\n```\n\nComponents:\n- DecisionEngine\n- ContextAssembler\n- SessionManager\n\n### apps/memory\nComponents:\n- TurnAggregator\n- index.ts bootstrap\n\n### apps/execution\nComponents:\n- Rehydrator\n- TimeTravelService\n\n### apps/search\nComponents:\n- SearchService\n\n### apps/ingestion\nComponents:\n- IngestionProcessor\n\n## Factory Pattern\n```typescript\n// factory.ts\nexport interface AppDependencies {\n  graphClient: GraphClient;\n  messageClient: MessageClient;\n  blobStore: BlobStore;\n  logger: Logger;\n}\n\nexport function createApp(deps: AppDependencies): App {\n  const sessionRepo = new FalkorSessionRepository(deps.graphClient);\n  const turnRepo = new FalkorTurnRepository(deps.graphClient);\n  // ...\n}\n```\n\n## Acceptance Criteria\n- [ ] All apps have factory functions\n- [ ] Dependencies injectable\n- [ ] Easy to mock for tests\n- [ ] No global singletons\n- [ ] Integration tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 492-510)\n- docs/refactor/apps/control/REPORT.md\n- docs/refactor/apps/memory/REPORT.md\n- docs/refactor/apps/execution/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:36:09.858694-06:00","updated_at":"2025-12-19T15:32:08.430952-06:00","closed_at":"2025-12-09T04:28:53.279073-06:00","labels":["architecture","dependency-injection","refactoring"],"dependencies":[{"issue_id":"engram-277","depends_on_id":"engram-284","type":"parent-child","created_at":"2025-12-09T03:36:09.85938-06:00","created_by":"daemon"},{"issue_id":"engram-277","depends_on_id":"engram-281","type":"blocks","created_at":"2025-12-09T03:38:59.726132-06:00","created_by":"daemon"}]}
{"id":"engram-278","title":"[3.4] Add IFileSystem Interface (vfs)","description":"# Task 3.4: Add IFileSystem Interface (vfs)\n\n**Effort**: 2 hours\n**Dependencies**: None (after Phase 2)\n**Parallel**: Can run with 3.1, 3.2\n\n## Location\n`packages/vfs/src/interfaces.ts`\n\n## Interface Design\n```typescript\nexport interface IFileSystem {\n  exists(path: string): boolean;\n  mkdir(path: string): void;\n  writeFile(path: string, content: string): void;\n  readFile(path: string): string;\n  readDir(path: string): string[];\n  stat(path: string): FileStat;\n  unlink(path: string): void;\n}\n\nexport interface FileStat {\n  isFile(): boolean;\n  isDirectory(): boolean;\n  size: number;\n  mtime: Date;\n}\n\n// Node.js implementation\nexport class NodeFileSystem implements IFileSystem {\n  exists(path: string): boolean {\n    return fs.existsSync(path);\n  }\n  // ...\n}\n\n// In-memory implementation for testing\nexport class InMemoryFileSystem implements IFileSystem {\n  private files = new Map\u003cstring, string\u003e();\n  // ...\n}\n```\n\n## Components to Update\n- PatchManager (uses fs directly)\n- Any other vfs components using fs\n\n## Acceptance Criteria\n- [ ] IFileSystem interface defined\n- [ ] NodeFileSystem implementation\n- [ ] InMemoryFileSystem for tests\n- [ ] PatchManager updated\n- [ ] Unit tests using InMemoryFileSystem\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 512-533)\n- docs/refactor/packages/vfs/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:36:11.451735-06:00","updated_at":"2025-12-19T15:32:08.431296-06:00","closed_at":"2025-12-09T04:20:16.1617-06:00","labels":["architecture","interfaces","parallel-ok","refactoring","vfs"],"dependencies":[{"issue_id":"engram-278","depends_on_id":"engram-284","type":"parent-child","created_at":"2025-12-09T03:36:11.452504-06:00","created_by":"daemon"}]}
{"id":"engram-279","title":"Write integration tests for reranker pipeline","description":"End-to-end tests: index documents, search with/without rerank, verify relevance improvement. File: packages/search-core/src/services/__tests__/reranker.integration.test.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:01:46.473247-06:00","updated_at":"2025-12-19T15:32:08.431579-06:00","closed_at":"2025-12-08T23:59:17.47617-06:00"}
{"id":"engram-28","title":"Add Test Coverage: packages/logger","description":"Add comprehensive unit and integration tests for packages/logger","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.349816-06:00","closed_at":"2025-12-07T02:02:43.768391-06:00","labels":["logger","packages","testing"]}
{"id":"engram-280","title":"Create SpladeEmbedder class with ONNX model loading","description":"Implement SpladeEmbedder class in packages/search-core/src/services/splade-embedder.ts. Load sparse-encoder-testing/splade-bert-tiny-nq-onnx model via onnxruntime-node. Include model caching and lazy initialization.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T19:24:50.584545-06:00","updated_at":"2025-12-19T15:32:08.431795-06:00","closed_at":"2025-12-08T19:32:22.691119-06:00"}
{"id":"engram-281","title":"[3.1] Implement Repository Pattern (memory-core)","description":"# Task 3.1: Implement Repository Pattern\n\n**Effort**: 12 hours\n**Dependencies**: Tasks 0.2 (interfaces), 0.3 (types)\n**Parallel**: Can run with 3.2, 3.4\n\n## Location\n`packages/memory-core/src/repositories/`\n\n## Interfaces to Create\n```typescript\n// session.repository.ts\nexport interface SessionRepository {\n  findById(id: string): Promise\u003cSession | null\u003e;\n  findByExternalId(externalId: string): Promise\u003cSession | null\u003e;\n  findActive(): Promise\u003cSession[]\u003e;\n  create(session: CreateSessionInput): Promise\u003cSession\u003e;\n  update(id: string, updates: UpdateSessionInput): Promise\u003cSession\u003e;\n  delete(id: string): Promise\u003cvoid\u003e;\n}\n\n// turn.repository.ts\nexport interface TurnRepository {\n  findById(id: string): Promise\u003cTurn | null\u003e;\n  findBySession(sessionId: string): Promise\u003cTurn[]\u003e;\n  findByTimeRange(sessionId: string, start: Date, end: Date): Promise\u003cTurn[]\u003e;\n  create(turn: CreateTurnInput): Promise\u003cTurn\u003e;\n  update(id: string, updates: UpdateTurnInput): Promise\u003cTurn\u003e;\n}\n\n// reasoning.repository.ts\nexport interface ReasoningRepository {\n  findByTurn(turnId: string): Promise\u003cReasoning[]\u003e;\n  create(reasoning: CreateReasoningInput): Promise\u003cReasoning\u003e;\n}\n\n// tool-call.repository.ts\nexport interface ToolCallRepository {\n  findByTurn(turnId: string): Promise\u003cToolCall[]\u003e;\n  create(toolCall: CreateToolCallInput): Promise\u003cToolCall\u003e;\n  updateResult(id: string, result: ToolResult): Promise\u003cToolCall\u003e;\n}\n```\n\n## Implementations\n- FalkorSessionRepository\n- FalkorTurnRepository\n- FalkorReasoningRepository\n- FalkorToolCallRepository\n\n## Usage Changes\n- `apps/control/src/session/initializer.ts` → Use `SessionRepository`\n- `apps/control/src/context/assembler.ts` → Use repositories\n- `apps/memory/src/index.ts` → Use `SessionRepository`\n- `apps/memory/src/turn-aggregator.ts` → Use repositories\n\n## Acceptance Criteria\n- [ ] All 4 repository interfaces defined\n- [ ] FalkorDB implementations created\n- [ ] Apps updated to use repositories\n- [ ] Unit tests for repositories\n- [ ] Integration tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 448-469)\n- docs/refactor/packages/memory-core/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:36:06.074919-06:00","updated_at":"2025-12-19T15:32:08.432098-06:00","closed_at":"2025-12-09T04:20:13.364645-06:00","labels":["architecture","parallel-ok","refactoring","repository-pattern"],"dependencies":[{"issue_id":"engram-281","depends_on_id":"engram-284","type":"parent-child","created_at":"2025-12-09T03:36:06.075901-06:00","created_by":"daemon"},{"issue_id":"engram-281","depends_on_id":"engram-88","type":"blocks","created_at":"2025-12-09T03:38:59.661222-06:00","created_by":"daemon"},{"issue_id":"engram-281","depends_on_id":"engram-87","type":"blocks","created_at":"2025-12-09T03:38:59.693718-06:00","created_by":"daemon"}]}
{"id":"engram-282","title":"Write unit tests for RerankerRouter","description":"Test query classification, tier selection, routing heuristics. File: packages/search-core/src/services/__tests__/reranker-router.test.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:01:44.090351-06:00","updated_at":"2025-12-19T15:32:08.432451-06:00","closed_at":"2025-12-08T23:42:40.800687-06:00"}
{"id":"engram-283","title":"[3.2] Extract Event Handler Strategy (memory app)","description":"# Task 3.2: Extract Event Handler Strategy (memory app)\n\n**Effort**: 6 hours\n**Dependencies**: None (after Phase 2)\n**Parallel**: Can run with 3.1, 3.4\n\n## Location\n`apps/memory/src/handlers/`\n\n## Current Problem\n120-line switch statement in `TurnAggregator.processEvent()`\n\n## Handlers to Create\n```typescript\n// handler.interface.ts\nexport interface EventHandler {\n  eventType: string;\n  handle(event: IngestionEvent, context: HandlerContext): Promise\u003cvoid\u003e;\n}\n\n// content.handler.ts\nexport class ContentEventHandler implements EventHandler {\n  eventType = 'content';\n  async handle(event: ContentEvent, context: HandlerContext): Promise\u003cvoid\u003e {\n    // Handle content events\n  }\n}\n\n// thought.handler.ts\nexport class ThoughtEventHandler implements EventHandler {\n  eventType = 'thought';\n  async handle(event: ThoughtEvent, context: HandlerContext): Promise\u003cvoid\u003e {\n    // Handle thought events\n  }\n}\n\n// tool-call.handler.ts\nexport class ToolCallEventHandler implements EventHandler {\n  eventType = 'tool_call';\n  async handle(event: ToolCallEvent, context: HandlerContext): Promise\u003cvoid\u003e {\n    // Handle tool call events\n  }\n}\n\n// Additional handlers:\n// - DiffEventHandler\n// - UsageEventHandler\n// - ControlEventHandler\n```\n\n## Handler Registry\n```typescript\nexport class EventHandlerRegistry {\n  private handlers = new Map\u003cstring, EventHandler\u003e();\n  \n  register(handler: EventHandler): void {\n    this.handlers.set(handler.eventType, handler);\n  }\n  \n  getHandler(eventType: string): EventHandler | undefined {\n    return this.handlers.get(eventType);\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] EventHandler interface defined\n- [ ] All 6 handlers implemented\n- [ ] Handler registry created\n- [ ] TurnAggregator refactored\n- [ ] Unit tests for each handler\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 471-490)\n- docs/refactor/apps/memory/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:36:07.488962-06:00","updated_at":"2025-12-19T15:32:08.432683-06:00","closed_at":"2025-12-09T04:20:14.656653-06:00","labels":["architecture","parallel-ok","refactoring","strategy-pattern"],"dependencies":[{"issue_id":"engram-283","depends_on_id":"engram-284","type":"parent-child","created_at":"2025-12-09T03:36:07.489766-06:00","created_by":"daemon"}]}
{"id":"engram-284","title":"[EPIC] Phase 3: Architecture Improvements","description":"# Phase 3: Architecture Improvements\n\n**Duration**: 5-7 days\n**Dependencies**: Phase 2 complete\n**Parallelization**: Tasks 3.1, 3.2 parallel; 3.3 depends on 3.1; 3.4 independent\n\n## Overview\nImprove architectural patterns across the codebase:\n- Repository pattern for data access\n- Strategy pattern for event handlers\n- Dependency injection throughout\n- File system abstraction for testing\n\n## Issue Summary\n- SOLID violations: 34\n- Missing abstractions: 8+\n- Testability blockers: 5+\n\n## Success Criteria\n- [ ] Repository interfaces defined and implemented\n- [ ] Event handlers use strategy pattern\n- [ ] All apps support dependency injection\n- [ ] IFileSystem interface enables mocking\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 442-534)\n- docs/refactor/packages/memory-core/REPORT.md\n- docs/refactor/apps/memory/REPORT.md\n- docs/refactor/packages/vfs/REPORT.md","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-09T03:35:33.147796-06:00","updated_at":"2025-12-19T15:32:08.432946-06:00","closed_at":"2025-12-09T04:28:54.899457-06:00","labels":["architecture","p0","refactoring"],"dependencies":[{"issue_id":"engram-284","depends_on_id":"engram-358","type":"blocks","created_at":"2025-12-09T03:38:41.131587-06:00","created_by":"daemon"}]}
{"id":"engram-285","title":"MEDIUM: Session extractors never cleaned up - memory leak","description":"Location: apps/ingestion/src/index.ts:28-29\n\nThe thinkingExtractors and diffExtractors Maps store per-session extractors but are never cleaned up. As new sessions are processed, these Maps grow indefinitely.\n\nImpact: Over time, the service will consume increasing memory until it crashes or is OOM-killed.\n\nFix: Implement session lifecycle management to remove extractors when sessions end.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:56:58.512594-06:00","updated_at":"2025-12-19T15:32:08.433265-06:00","closed_at":"2025-12-19T00:58:58.340155-06:00"}
{"id":"engram-286","title":"MEDIUM: Browser logger event listeners never removed","description":"Location: packages/logger/src/browser.ts:117-126\n\nEvery call to createBrowserLogger() adds new event listeners that are never removed. The flush timer is also never cleared.\n\nImpact: Memory leak in long-running browser applications.\n\nFix: Add destroy() method to remove event listeners and clear timer.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:04.226701-06:00","updated_at":"2025-12-19T15:32:08.433468-06:00","closed_at":"2025-12-19T00:59:21.346045-06:00"}
{"id":"engram-287","title":"Write tests for MCP tools","description":"Unit tests for remember, recall, query, context tools","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T04:11:51.632814-06:00","updated_at":"2025-12-19T15:32:08.43368-06:00","closed_at":"2025-12-19T04:17:12.637456-06:00"}
{"id":"engram-288","title":"LOW: Unhandled WebSocket unsubscribe errors","description":"Location: apps/interface/lib/websocket-server.ts:53-56, 99-102\n\nThe ws.on('close') handler calls unsubscribe() without error handling. If unsubscribe fails, it becomes an unhandled promise rejection.\n\nFix: Add .catch() handler to unsubscribe call.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:23.157877-06:00","updated_at":"2025-12-19T15:32:08.433872-06:00","closed_at":"2025-12-18T21:47:22.60242-06:00"}
{"id":"engram-289","title":"Implement hybrid search with RRF fusion in SearchRetriever","description":"Implement true hybrid search in SearchRetriever.search() using Qdrant's prefetch + RRF fusion API.\n\nReference: docs/plans/hybrid-retriever.md (Phase 2)\n\nChanges to packages/search-core/src/services/retriever.ts:\n- Generate both dense and sparse query vectors in parallel using Promise.all\n- Use client.query() with prefetch array containing:\n  - Dense vector prefetch: { query: denseVector, using: vectorName, limit: limit * 2 }\n  - Sparse vector prefetch: { query: { indices, values }, using: \"sparse\", limit: limit * 2 }\n- Set query: { fusion: \"rrf\" } for Reciprocal Rank Fusion\n- Oversample in prefetch (2x limit) to give RRF more candidates to fuse\n- Apply filter if provided\n- No score_threshold with RRF (scores are rank-based)\n- Return results.points\n\nThe hybrid search is the default strategy for most natural language queries.\nQueryClassifier returns alpha weight (0.0-1.0) which could be used for weighted fusion in future.\n\nDepends on: the-system-63j (sparse search implementation provides the pattern)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:38:01.042392-06:00","updated_at":"2025-12-19T15:32:08.434096-06:00","closed_at":"2025-12-08T21:47:09.802851-06:00","dependencies":[{"issue_id":"engram-289","depends_on_id":"engram-349","type":"blocks","created_at":"2025-12-08T21:38:08.75772-06:00","created_by":"daemon"}]}
{"id":"engram-28pq4","title":"Create EntityResolverService","description":"Create apps/mcp/src/services/entity-resolver.ts for entity deduplication and resolution.\n\n## Resolution Strategy (in order)\n\n### 1. Exact Name Match\n```typescript\nconst exactMatch = await entityRepo.findByName(extracted.name, project);\nif (exactMatch) return { entity: exactMatch, isNew: false };\n```\n\n### 2. Alias Match\nSearch existing entities where extracted.name appears in aliases array.\nIf found, return existing entity.\n\n### 3. Embedding Similarity\n```typescript\nconst embedding = await embed(extracted.name);\nconst similar = await entityRepo.findByEmbedding(embedding, 5, 0.9);\n```\nThreshold: 0.9 cosine similarity (configurable)\n\n### 4. LLM Confirmation\nFor high-similarity but not exact matches, use LLM to confirm:\n'Are these the same entity? \"PostgreSQL\" and \"Postgres\"'\n\n### 5. Create New Entity\nIf no match found, create new entity with generated embedding.\n\n## Merge Behavior\nWhen matching existing entity:\n- Add new name to aliases if not present\n- Update description if new context is richer\n- Do NOT update type (trust original classification)\n\n## Research\n- EAGER entity resolution: https://arxiv.org/abs/2101.06126\n- Semantic entity resolution patterns: https://towardsdatascience.com/the-rise-of-semantic-entity-resolution/\n- Embedding-based blocking: Web search 'entity resolution embedding similarity threshold 2025'\n- Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'entity deduplication merge'","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:55.757301-06:00","updated_at":"2026-01-01T17:08:47.656098-06:00","dependencies":[{"issue_id":"engram-28pq4","depends_on_id":"engram-h09jt","type":"blocks","created_at":"2026-01-01T16:54:27.131524-06:00","created_by":"ccheney"},{"issue_id":"engram-28pq4","depends_on_id":"engram-cqo6t","type":"blocks","created_at":"2026-01-01T16:54:33.271478-06:00","created_by":"ccheney"},{"issue_id":"engram-28pq4","depends_on_id":"engram-mefkc","type":"blocks","created_at":"2026-01-01T16:54:39.487118-06:00","created_by":"ccheney"},{"issue_id":"engram-28pq4","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:53.586787-06:00","created_by":"ccheney"}]}
{"id":"engram-29","title":"Add Test Coverage: packages/ingestion-core","description":"Add comprehensive unit and integration tests for packages/ingestion-core","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.350146-06:00","closed_at":"2025-12-07T02:02:43.737909-06:00","labels":["ingestion-core","packages","testing"]}
{"id":"engram-290","title":"LOW: hashObject crashes on non-object input","description":"Location: packages/common/src/utils/hash.ts:64\n\nThe hashObject function crashes when passed null, arrays, or primitive values. Object.keys(null) throws TypeError.\n\nFix: Add type check before calling Object.keys.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:46.245164-06:00","updated_at":"2025-12-19T15:32:08.435878-06:00","closed_at":"2025-12-18T21:47:49.202336-06:00"}
{"id":"engram-291","title":"Develop Session Replay Endpoint","description":"POST /api/replay triggers Deterministic Execution. See docs/bitemporal/context/observability-interface/develop-session-replay-endpoint.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:31.358518-06:00","updated_at":"2025-12-19T15:32:08.436225-06:00","closed_at":"2025-12-07T00:53:09.015891-06:00","labels":["endpoint","interface","replay"],"dependencies":[{"issue_id":"engram-291","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.35897-06:00","created_by":"daemon"}]}
{"id":"engram-292","title":"Implement Response Serialization","description":"Consistent JSON envelope for API responses. See docs/bitemporal/context/observability-interface/implement-response-serialization.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:31.535004-06:00","updated_at":"2025-12-19T15:32:08.436537-06:00","closed_at":"2025-12-07T00:32:08.165391-06:00","labels":["api","interface","standards"],"dependencies":[{"issue_id":"engram-292","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.535404-06:00","created_by":"daemon"}]}
{"id":"engram-293","title":"[5.1] Split SessionReplay.tsx (1580 LOC)","description":"# Task 5.1: Split SessionReplay.tsx\n\n**Effort**: 8 hours\n**Current LOC**: 1580 lines\n**Target LOC**: ~200 per file\n**Parallel**: Can run with 5.2, 5.4\n\n## File Under Refactoring\n`apps/interface/app/components/SessionReplay.tsx`\n\n## Target Structure\n```\napp/components/SessionReplay/\n  index.tsx              # Main component (~200 LOC)\n  MessageCards/\n    ResponseCard.tsx     # AI response rendering\n    QueryCard.tsx        # User query rendering\n    ToolCallCard.tsx     # Tool invocations\n    ReasoningTrace.tsx   # Thinking/reasoning display\n    TurnHeader.tsx       # Turn metadata header\n  StatsHeader.tsx        # Session statistics\n  LoadingState.tsx       # Loading skeleton\n  EmptyState.tsx         # No data state\n  utils/\n    consolidateTimeline.ts  # Timeline logic\n    messageUtils.ts         # Message formatting\n```\n\n## Extraction Strategy\n1. Identify natural component boundaries\n2. Extract MessageCards first (most complex)\n3. Extract utility functions\n4. Create barrel exports\n5. Update imports in parent\n\n## Acceptance Criteria\n- [ ] Main file \u003c200 LOC\n- [ ] All subcomponents extracted\n- [ ] Utils extracted\n- [ ] No functionality lost\n- [ ] All tests pass\n- [ ] Visual regression verified\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 579-604)\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:38:09.659879-06:00","updated_at":"2025-12-19T15:32:08.436873-06:00","closed_at":"2025-12-09T04:47:32.658098-06:00","labels":["component-split","frontend","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-293","depends_on_id":"engram-314","type":"parent-child","created_at":"2025-12-09T03:38:09.661054-06:00","created_by":"daemon"}]}
{"id":"engram-294","title":"Bounded Context: Observability Interface","description":"The 'Mirror'. API layer, GraphQL lineage, and replay interface. See docs/bitemporal/context/observability-interface/","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:47:42.567017-06:00","updated_at":"2025-12-19T15:32:08.437228-06:00","closed_at":"2025-12-06T22:33:15.206385-06:00","labels":["context","interface","nextjs"]}
{"id":"engram-295","title":"Develop Ingest Stream Endpoint","description":"POST /api/ingest webhook for raw event testing. See docs/bitemporal/context/observability-interface/develop-ingest-stream-endpoint.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:31.230885-06:00","updated_at":"2025-12-19T15:32:08.43759-06:00","closed_at":"2025-12-07T00:58:40.657795-06:00","labels":["endpoint","ingestion","interface"],"dependencies":[{"issue_id":"engram-295","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.231326-06:00","created_by":"daemon"}]}
{"id":"engram-296","title":"[5.4] Remove Dead Code \u0026 Unused Dependencies","description":"# Task 5.4: Remove Dead Code \u0026 Unused Dependencies\n\n**Effort**: 2 hours\n**Dependencies**: None (after Phase 4)\n**Parallel**: Can run with 5.1, 5.2\n\n## Dead Code to Remove\n\n| File | Dead Code | Action |\n|------|-----------|--------|\n| `apps/search/src/routes/health.ts` | Entire file unused | Integrate or remove |\n| `apps/memory/src/index.ts:176-216` | Legacy ThoughtNode | Remove (behind flag) |\n\n## Unused Dependencies to Remove\n\n| Package | Dependency | Action |\n|---------|------------|--------|\n| `packages/storage` | `kafkajs` | Remove (duplicate of @engram/events) |\n| `packages/ingestion-core` | `google-libphonenumber` | Remove |\n| `packages/memory-core` | `ulid`, `date-fns` | Remove (unused) |\n| `apps/control` | `@ai-sdk/openai` | Remove |\n\n## Process\n1. Run `npm run build` to verify baseline\n2. Remove dead code files\n3. Remove unused deps one by one\n4. Run `npm run build` after each removal\n5. Run tests to verify\n\n## Verification Commands\n```bash\n# Find unused exports\nnpx ts-unused-exports tsconfig.json\n\n# Find unused deps\nnpx depcheck\n\n# Verify build\nnpm run build \u0026\u0026 npm test\n```\n\n## Acceptance Criteria\n- [ ] Dead code removed\n- [ ] Unused deps removed\n- [ ] Build passes\n- [ ] Tests pass\n- [ ] No runtime errors\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 651-675)\n- All package.json files","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-09T03:38:14.40676-06:00","updated_at":"2025-12-19T15:32:08.437939-06:00","closed_at":"2025-12-09T04:47:35.368052-06:00","labels":["cleanup","dead-code","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-296","depends_on_id":"engram-314","type":"parent-child","created_at":"2025-12-09T03:38:14.407441-06:00","created_by":"daemon"}]}
{"id":"engram-297","title":"Develop API Usage Telemetry","description":"Middleware logging for Cloud Logging. See docs/bitemporal/context/observability-interface/develop-api-usage-telemetry.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:31.578377-06:00","updated_at":"2025-12-19T15:32:08.438217-06:00","closed_at":"2025-12-07T01:03:39.24205-06:00","labels":["interface","logging","observability"],"dependencies":[{"issue_id":"engram-297","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.578753-06:00","created_by":"daemon"}]}
{"id":"engram-298","title":"Create Swagger OpenAPI Documentation","description":"Auto-generated API docs at /api/docs. See docs/bitemporal/context/observability-interface/create-swagger-openapi-documentation.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:55:31.620621-06:00","updated_at":"2025-12-19T15:32:08.438536-06:00","closed_at":"2025-12-06T23:55:07.690416-06:00","labels":["docs","interface","swagger"],"dependencies":[{"issue_id":"engram-298","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.621056-06:00","created_by":"daemon"}]}
{"id":"engram-299","title":"Implement query complexity classifier","description":"Implement query complexity classification for routing decisions.\n\nReference: docs/plans/reranker-implementation.md (Appendix B)\n\nClassification function:\n```typescript\nfunction classifyQueryComplexity(query: string): \"simple\" | \"moderate\" | \"complex\" {\n  const features = {\n    length: query.length,\n    words: query.split(/\\s+/).length,\n    hasQuotes: /\"[^\"]+\"/.test(query),\n    hasOperators: /AND|OR|NOT|\\+|-/.test(query),\n    hasCode: /[a-zA-Z]+\\.[a-zA-Z]+\\(|function\\s|class\\s|=\u003e/.test(query),\n    questionWords: /^(what|how|why|when|where|who|which)/i.test(query),\n  };\n  // Score-based classification\n}\n```\n\nUsed by RerankerRouter to select appropriate tier.\n\nLocation: packages/search-core/src/services/query-classifier.ts (extend existing)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:56:09.269894-06:00","updated_at":"2025-12-19T15:32:08.43885-06:00","closed_at":"2025-12-08T23:35:52.376248-06:00"}
{"id":"engram-29x4","title":"Test coverage: packages/temporal/src/replay.ts (78%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:34.934237-06:00","updated_at":"2025-12-21T01:43:29.221206-06:00","closed_at":"2025-12-21T01:43:29.221206-06:00"}
{"id":"engram-2a6r","title":"Implement scope-based access control for API keys","description":"apps/api extracts scopes from API keys (auth.ts:109) but never validates them. All endpoints equally accessible regardless of scopes. Either implement enforcement or remove the infrastructure.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:09:48.61067-06:00","updated_at":"2025-12-20T23:26:12.816135-06:00","closed_at":"2025-12-20T23:26:12.816135-06:00"}
{"id":"engram-2bmi","title":"Create ServiceHealthGrid component","description":"3x3 grid showing all 10 services with status indicators (healthy/degraded/down), uses Tremor Card components. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:25.914029-05:00","updated_at":"2025-12-27T16:54:17.404458-05:00","closed_at":"2025-12-27T16:54:17.404458-05:00","dependencies":[{"issue_id":"engram-2bmi","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:25:49.836001-05:00","created_by":"ccheney"}]}
{"id":"engram-2dar","title":"Remove unused HighlightContext from LineageGraph","description":"apps/interface LineageGraph/HighlightContext.ts creates context but no Provider implementation exists. Component uses highlightedNodeId prop instead.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:15:22.145999-06:00","updated_at":"2025-12-20T23:21:37.05133-06:00","closed_at":"2025-12-20T23:21:37.05133-06:00"}
{"id":"engram-2fl4","title":"Create Hugging Face account and API token","description":"Set up Hugging Face account for Inference API access.\n\n## Steps\n1. Create account at https://huggingface.co\n2. Go to Settings → Access Tokens\n3. Create token with 'read' permissions (sufficient for inference)\n4. Save token securely for use in .env\n\n## Acceptance Criteria\n- HF account is active\n- API token is generated\n- Token works with `curl -H 'Authorization: Bearer HF_TOKEN' https://api-inference.huggingface.co/models/BAAI/bge-small-en-v1.5`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:28:24.744791-06:00","updated_at":"2025-12-21T16:32:38.433802-06:00","closed_at":"2025-12-21T16:32:38.433802-06:00"}
{"id":"engram-2g1w","title":"[HIGH] Single replica for all databases in infra","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:14.439076-06:00","updated_at":"2025-12-20T23:58:07.713298-06:00","closed_at":"2025-12-20T23:58:07.713298-06:00"}
{"id":"engram-2i4c","title":"Store DiffHunk nodes for VFS rehydration","description":"packages/graph DiffHunkNode (nodes.ts:225-232) defined and packages/temporal Rehydrator expects them, but NO code creates DiffHunk nodes. apply_patch tool doesn't record patches. Rehydrator can't replay history.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:10:31.297882-06:00","updated_at":"2025-12-20T23:25:37.517299-06:00","closed_at":"2025-12-20T23:25:37.517299-06:00"}
{"id":"engram-2kyk","title":"Add tests for packages/storage/src/postgres.ts (5% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:50.827011-05:00","updated_at":"2025-12-27T01:58:50.827011-05:00"}
{"id":"engram-2mqp","title":"Create .turbo/config.json with API URL and team ID","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-20T23:07:51.700591-06:00","updated_at":"2025-12-21T03:50:24.616974-06:00","closed_at":"2025-12-21T03:50:24.616974-06:00","dependencies":[{"issue_id":"engram-2mqp","depends_on_id":"engram-da07","type":"blocks","created_at":"2025-12-20T23:08:48.041647-06:00","created_by":"ccheney"}]}
{"id":"engram-2osk","title":"Improve /e why prompt description","description":"Update apps/mcp/src/prompts/e-why.ts with improved descriptions. Changes:\n- Main description: 'Find past decisions and their rationale for a topic. Use when: about to make an architectural choice and want to check for precedent, the user asks why did we..., or you encounter code that seems intentional but unclear.'\n- topic arg: Guide on topic selection\n\nReference: docs/plans/mcp-tool-descriptions.md#prompt-e-why","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:45.445031-05:00","updated_at":"2025-12-25T01:00:56.869377-05:00","closed_at":"2025-12-25T01:00:56.869377-05:00"}
{"id":"engram-2pns","title":"Remove or integrate createBrowserLogger()","description":"packages/logger browser.ts fully implements browser logging with batching but createBrowserLogger() is never called. Integrate into interface app or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:10.534283-06:00","updated_at":"2025-12-20T23:20:57.035839-06:00","closed_at":"2025-12-20T23:20:57.035839-06:00"}
{"id":"engram-2qb3","title":"Migrate from Node.js/npm to Bun 1.3.5","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T01:42:47.733095-05:00","updated_at":"2025-12-22T01:48:09.327773-05:00","closed_at":"2025-12-22T01:48:09.327773-05:00"}
{"id":"engram-2rgk","title":"Improve tests for search api/routes.py (64.6% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:03.615424-05:00","updated_at":"2025-12-27T01:59:03.615424-05:00"}
{"id":"engram-2rgy","title":"[CRITICAL] Resource leaks - connections never disconnected","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:36.289043-06:00","updated_at":"2025-12-20T23:45:30.481308-06:00","closed_at":"2025-12-20T23:45:30.481308-06:00"}
{"id":"engram-2ts5","title":"Test coverage: packages/parser/src/parser/cline.ts (83%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:11.19364-06:00","updated_at":"2025-12-21T04:07:03.768709-06:00","closed_at":"2025-12-21T04:07:03.768709-06:00"}
{"id":"engram-2u65","title":"Create RLS roles migration","description":"Create PostgreSQL roles for RLS policies via custom Drizzle migration.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Custom Migration for RLS Roles' section (lines 317-336)\n\n## Implementation\nCreate custom migration for RLS roles:\n```bash\nbunx drizzle-kit generate --custom --name=create-rls-roles\n```\n\nMigration SQL:\n```sql\nDO $$\nBEGIN\n  IF NOT EXISTS (SELECT FROM pg_roles WHERE rolname = 'authenticated') THEN\n    CREATE ROLE authenticated;\n  END IF;\n  IF NOT EXISTS (SELECT FROM pg_roles WHERE rolname = 'service_role') THEN\n    CREATE ROLE service_role;\n  END IF;\nEND\n$$;\n\nGRANT USAGE ON SCHEMA public TO authenticated;\nGRANT USAGE ON SCHEMA public TO service_role;\n```\n\n## Files to Create\n- apps/observatory/drizzle/migrations/xxxx_create-rls-roles.sql\n\n## Agent Instructions\nUse Context7 MCP for Drizzle Kit migration docs. Web search 'drizzle-kit generate custom migration'.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:16.137671-06:00","updated_at":"2025-12-29T22:38:45.224633-06:00","closed_at":"2025-12-29T22:38:45.224633-06:00","dependencies":[{"issue_id":"engram-2u65","depends_on_id":"engram-a89d","type":"blocks","created_at":"2025-12-29T22:12:17.025569-06:00","created_by":"ccheney"},{"issue_id":"engram-2u65","depends_on_id":"engram-gkcl","type":"blocks","created_at":"2025-12-29T22:12:25.813701-06:00","created_by":"ccheney"}]}
{"id":"engram-2z0a","title":"[CRITICAL] Missing bitemporal validation in snapshot query","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:32.909066-06:00","updated_at":"2025-12-20T23:45:30.481692-06:00","closed_at":"2025-12-20T23:45:30.481692-06:00"}
{"id":"engram-2za9","title":"Test coverage: packages/logger/src/node.ts (66%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:36.34767-06:00","updated_at":"2025-12-21T04:07:03.761621-06:00","closed_at":"2025-12-21T04:07:03.761621-06:00"}
{"id":"engram-3","title":"LOW: formatBytes returns incorrect output for negative values","description":"Location: packages/common/src/utils/format.ts:97-105\n\nMath.log() of a negative number returns NaN, causing formatBytes(-1024) to return '-1024 undefined'.\n\nFix: Add check for negative bytes and handle appropriately.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:47.257807-06:00","updated_at":"2025-12-19T15:32:08.340989-06:00","closed_at":"2025-12-18T21:47:49.201852-06:00"}
{"id":"engram-30","title":"Add Test Coverage: packages/infra","description":"Add comprehensive unit and integration tests for packages/infra","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.350516-06:00","closed_at":"2025-12-07T02:08:35.766277-06:00","labels":["infra","packages","testing"]}
{"id":"engram-300","title":"[5.3] Extract Shared UI Components","description":"# Task 5.3: Extract Shared UI Components\n\n**Effort**: 4 hours\n**Dependencies**: Tasks 5.1, 5.2 (extract from splits)\n**NOT Parallel**: Must wait for 5.1, 5.2\n\n## Location\n`apps/interface/app/components/shared/`\n\n## Components to Extract\n```\napp/components/shared/\n  EmptyState.tsx         # Reusable empty state\n  LoadingSkeleton.tsx    # Reusable loading skeleton\n  Particles.tsx          # Background particles effect\n  design-tokens.ts       # Shared design tokens\n  index.ts               # Barrel export\n```\n\n## EmptyState Component\n```typescript\ninterface EmptyStateProps {\n  icon?: React.ReactNode;\n  title: string;\n  description?: string;\n  action?: {\n    label: string;\n    onClick: () =\u003e void;\n  };\n}\n\nexport function EmptyState({ icon, title, description, action }: EmptyStateProps) {\n  // Reusable empty state\n}\n```\n\n## LoadingSkeleton Component\n```typescript\ninterface LoadingSkeletonProps {\n  variant: 'card' | 'list' | 'graph';\n  count?: number;\n}\n\nexport function LoadingSkeleton({ variant, count = 3 }: LoadingSkeletonProps) {\n  // Reusable loading skeleton\n}\n```\n\n## Acceptance Criteria\n- [ ] Shared components extracted\n- [ ] Design tokens consolidated\n- [ ] Components used in SessionReplay\n- [ ] Components used in LineageGraph\n- [ ] Consistent styling\n- [ ] Storybook stories (optional)\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 632-649)\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:38:12.06236-06:00","updated_at":"2025-12-19T15:32:08.439101-06:00","closed_at":"2025-12-09T04:47:34.673583-06:00","labels":["frontend","refactoring","ui-components"],"dependencies":[{"issue_id":"engram-300","depends_on_id":"engram-314","type":"parent-child","created_at":"2025-12-09T03:38:12.063844-06:00","created_by":"daemon"},{"issue_id":"engram-300","depends_on_id":"engram-293","type":"blocks","created_at":"2025-12-09T03:39:10.82268-06:00","created_by":"daemon"},{"issue_id":"engram-300","depends_on_id":"engram-301","type":"blocks","created_at":"2025-12-09T03:39:10.871092-06:00","created_by":"daemon"}]}
{"id":"engram-301","title":"[5.2] Split LineageGraph.tsx (1171 LOC)","description":"# Task 5.2: Split LineageGraph.tsx\n\n**Effort**: 6 hours\n**Current LOC**: 1171 lines\n**Target LOC**: ~200 per file\n**Parallel**: Can run with 5.1, 5.4\n\n## File Under Refactoring\n`apps/interface/app/components/LineageGraph.tsx`\n\n## Target Structure\n```\napp/components/LineageGraph/\n  index.tsx              # Main component (~200 LOC)\n  NeuralNode.tsx         # Node rendering\n  GraphStats.tsx         # Graph statistics\n  layouts/\n    radialLayout.ts      # Radial layout algorithm\n    gridLayout.ts        # Grid layout algorithm\n  config/\n    nodeTypeConfig.ts    # Node type configuration\n  EmptyState.tsx         # No data state\n  LoadingSkeleton.tsx    # Loading skeleton\n```\n\n## Extraction Strategy\n1. Extract layout algorithms (pure functions)\n2. Extract node configuration\n3. Extract NeuralNode component\n4. Extract state components\n5. Create barrel exports\n\n## Acceptance Criteria\n- [ ] Main file \u003c200 LOC\n- [ ] Layout algorithms extracted\n- [ ] Node rendering separated\n- [ ] No functionality lost\n- [ ] All tests pass\n- [ ] Visual regression verified\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 606-630)\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:38:10.700448-06:00","updated_at":"2025-12-19T15:32:08.439448-06:00","closed_at":"2025-12-09T04:47:33.495985-06:00","labels":["component-split","frontend","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-301","depends_on_id":"engram-314","type":"parent-child","created_at":"2025-12-09T03:38:10.701223-06:00","created_by":"daemon"}]}
{"id":"engram-302","title":"[EPIC] Schema \u0026 Data Model Updates","description":"Schema updates for reranking support.\n\nBounded Context: Data Model Domain\nReference: docs/plans/reranker-implementation.md (Section 7)\n\nUpdates required:\n- Qdrant collection schema (ColBERT multivector)\n- Search result schema (rerankerScore field)\n- API response schema (reranker metadata)\n\nSchema migrations for existing data.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:58:19.493877-06:00","updated_at":"2025-12-19T15:32:08.439782-06:00","closed_at":"2025-12-08T23:54:29.231685-06:00","dependencies":[{"issue_id":"engram-302","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T23:02:47.022205-06:00","created_by":"daemon"}]}
{"id":"engram-303","title":"Implement NEXT relationship chaining for thoughts","description":"The Memory service has a TODO comment for creating NEXT edges between sequential thoughts within sessions. This breaks thought lineage visualization. Need to update memory/src/index.ts to create NEXT edges when processing parsed events. Ref: define-thought-node-schema.md","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-08T02:05:40.437926-06:00","updated_at":"2025-12-19T15:32:08.440062-06:00","closed_at":"2025-12-08T02:15:29.998911-06:00"}
{"id":"engram-304","title":"[EPIC] Risk Mitigation \u0026 Safety","description":"Lazy model loading, A/B testing framework, rate limiting for LLM tier (Section 12)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T23:01:28.827114-06:00","updated_at":"2025-12-19T15:32:08.440286-06:00","closed_at":"2025-12-09T00:14:00.213883-06:00","dependencies":[{"issue_id":"engram-304","depends_on_id":"engram-340","type":"blocks","created_at":"2025-12-08T23:03:07.507811-06:00","created_by":"daemon"}]}
{"id":"engram-305","title":"Fix retriever.test.ts result count mismatch","description":"The retriever.test.ts expects 10 results but receives 60. The limit parameter in the retriever is not being properly applied or there's a multiplication issue when aggregating results from multiple sources (vector + graph).","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T18:24:25.985942-06:00","updated_at":"2025-12-19T15:32:08.440549-06:00","closed_at":"2025-12-19T01:02:43.879898-06:00"}
{"id":"engram-306","title":"Implement RBAC Authorization Logic","description":"Role-based checks (Viewer vs Admin). See docs/bitemporal/context/observability-interface/implement-rbac-authorization-logic.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:31.446552-06:00","updated_at":"2025-12-19T15:32:08.440758-06:00","closed_at":"2025-12-07T00:45:59.19262-06:00","labels":["auth","interface","rbac"],"dependencies":[{"issue_id":"engram-306","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.446957-06:00","created_by":"daemon"}]}
{"id":"engram-307","title":"Develop Lineage Query Endpoint","description":"GET /api/lineage/:sessionId logic using FalkorDB traversals. See docs/bitemporal/context/observability-interface/develop-lineage-query-endpoint.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:31.315247-06:00","updated_at":"2025-12-19T15:32:08.441029-06:00","closed_at":"2025-12-06T23:27:47.079816-06:00","labels":["endpoint","graph","interface"],"dependencies":[{"issue_id":"engram-307","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.315619-06:00","created_by":"daemon"}]}
{"id":"engram-308","title":"Develop Semantic Search Endpoint","description":"POST /api/search proxy to Qdrant/Search Service. See docs/bitemporal/context/observability-interface/develop-semantic-search-endpoint.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:31.273817-06:00","updated_at":"2025-12-19T15:32:08.441284-06:00","closed_at":"2025-12-06T23:26:13.049729-06:00","labels":["endpoint","interface","search"],"dependencies":[{"issue_id":"engram-308","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.274271-06:00","created_by":"daemon"}]}
{"id":"engram-309","title":"Create API Request Validator","description":"Zod middleware for request body validation. See docs/bitemporal/context/observability-interface/create-api-request-validator.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:31.489571-06:00","updated_at":"2025-12-19T15:32:08.441575-06:00","closed_at":"2025-12-06T22:32:35.481197-06:00","labels":["interface","validation","zod"],"dependencies":[{"issue_id":"engram-309","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.491-06:00","created_by":"daemon"}]}
{"id":"engram-31","title":"Add Test Coverage: packages/execution-core","description":"Add comprehensive unit and integration tests for packages/execution-core","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.350897-06:00","closed_at":"2025-12-07T02:02:43.706184-06:00","labels":["execution-core","packages","testing"]}
{"id":"engram-310","title":"Implement Authentication Middleware","description":"Clerk integration for protecting /api routes. See docs/bitemporal/context/observability-interface/implement-authentication-middleware.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:31.401751-06:00","updated_at":"2025-12-19T15:32:08.441852-06:00","closed_at":"2025-12-06T22:32:35.450233-06:00","labels":["auth","clerk","interface"],"dependencies":[{"issue_id":"engram-310","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.402188-06:00","created_by":"daemon"}]}
{"id":"engram-311","title":"Implement REST API Scaffolding","description":"Standardized error handling and wrappers for NextResponse. See docs/bitemporal/context/observability-interface/implement-rest-api-scaffolding.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:31.189463-06:00","updated_at":"2025-12-19T15:32:08.442154-06:00","closed_at":"2025-12-06T22:32:35.421097-06:00","labels":["api","interface","utils"],"dependencies":[{"issue_id":"engram-311","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.189884-06:00","created_by":"daemon"}]}
{"id":"engram-312","title":"Define API Route Structure","description":"Next.js App Router setup for /api/ingest, /api/search, /api/graph. See docs/bitemporal/context/observability-interface/define-api-route-structure.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:55:31.104036-06:00","updated_at":"2025-12-19T15:32:08.44251-06:00","closed_at":"2025-12-06T22:32:35.393001-06:00","labels":["interface","nextjs","routing"],"dependencies":[{"issue_id":"engram-312","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.104425-06:00","created_by":"daemon"}]}
{"id":"engram-313","title":"Create GraphQL Schema Definition","description":"Schema for Session/Thought/Fact graph traversal. See docs/bitemporal/context/observability-interface/create-graphql-schema-definition.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:55:31.147222-06:00","updated_at":"2025-12-19T15:32:08.442817-06:00","closed_at":"2025-12-06T23:24:18.904903-06:00","labels":["graphql","interface","schema"],"dependencies":[{"issue_id":"engram-313","depends_on_id":"engram-294","type":"parent-child","created_at":"2025-12-06T21:55:31.147603-06:00","created_by":"daemon"}]}
{"id":"engram-314","title":"[EPIC] Phase 5: Frontend \u0026 Polish","description":"# Phase 5: Frontend \u0026 Polish\n\n**Duration**: 4-5 days\n**Dependencies**: Phase 4 complete\n**Parallelization**: Tasks 5.1-5.2 parallel; 5.3 depends on 5.1/5.2; 5.4 independent\n\n## Overview\nClean up frontend code and remove technical debt:\n- Split god components\n- Extract shared UI components\n- Remove dead code and unused dependencies\n\n## Issue Summary\n- God components: 2 (1580 LOC, 1171 LOC)\n- Dead code files: 2+\n- Unused dependencies: 4+\n- Max file length target: \u003c400 LOC\n\n## Success Criteria\n- [ ] SessionReplay.tsx split into \u003c200 LOC files\n- [ ] LineageGraph.tsx split into \u003c200 LOC files\n- [ ] Shared UI components extracted\n- [ ] Dead code removed\n- [ ] Unused deps removed\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 573-675)\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-09T03:37:37.783851-06:00","updated_at":"2025-12-19T15:32:08.443181-06:00","closed_at":"2025-12-09T04:47:36.419903-06:00","labels":["frontend","p0","polish","refactoring"],"dependencies":[{"issue_id":"engram-314","depends_on_id":"engram-179","type":"blocks","created_at":"2025-12-09T03:38:41.191895-06:00","created_by":"daemon"}]}
{"id":"engram-315","title":"Update SearchResult schema with rerankerScore","description":"Add reranker score fields to search result schema.\n\nReference: docs/plans/reranker-implementation.md (Section 7.2)\n\nSchema update:\n```typescript\nexport interface SearchResult {\n  id: string;\n\n  // Scores\n  rrfScore: number;           // Original hybrid fusion score\n  rerankerScore?: number;     // Cross-encoder/ColBERT score\n  rerankTier?: RerankerTier;  // Which reranker was used\n\n  // Existing\n  payload: SearchResultPayload;\n}\n```\n\nBoth scores preserved for transparency and debugging.\n\nLocation: packages/search-core/src/models/schema.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:58:26.887024-06:00","updated_at":"2025-12-19T15:32:08.443554-06:00","closed_at":"2025-12-08T23:08:37.233174-06:00"}
{"id":"engram-317","title":"MEDIUM: Unhandled promise rejection in BatchIndexer.add()","description":"Location: packages/search-core/src/services/batch-indexer.ts:20-27\n\nThe add() method calls this.flush() without awaiting it or handling errors. If flush rejects, the error is silently ignored.\n\nImpact: Indexing errors are silently dropped.\n\nFix: Handle errors from flush() or make add() async.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:39.007444-06:00","updated_at":"2025-12-19T15:32:08.444111-06:00","closed_at":"2025-12-19T00:39:58.198299-06:00"}
{"id":"engram-318","title":"Select Text Embedding Model","description":"Choice: intfloat/multilingual-e5-small (ONNX). See docs/bitemporal/context/semantic-search/select-text-embedding-model.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.353524-06:00","updated_at":"2025-12-19T15:32:08.444364-06:00","closed_at":"2025-12-06T22:28:17.759043-06:00","labels":["model","search","text"],"dependencies":[{"issue_id":"engram-318","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.353852-06:00","created_by":"daemon"}]}
{"id":"engram-319","title":"Select Code Embedding Model","description":"Choice: nomic-embed-text-v1.5 (8k context). See docs/bitemporal/context/semantic-search/select-code-embedding-model.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.39731-06:00","updated_at":"2025-12-19T15:32:08.444658-06:00","closed_at":"2025-12-06T22:28:17.789022-06:00","labels":["code","model","search"],"dependencies":[{"issue_id":"engram-319","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.397728-06:00","created_by":"daemon"}]}
{"id":"engram-31wh","title":"Create MCP token cache","description":"Create apps/mcp/src/auth/token-cache.ts with TokenCache class. Store/retrieve tokens from ~/.engram/auth.json. Check access_token expiration, trigger refresh when needed. Handle file permissions, create directory if missing. Cache format: {access_token, refresh_token, expires_at, user}. See docs/design/oauth-device-flow.md sequence diagram.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:45.175994-05:00","updated_at":"2025-12-25T02:39:34.177842-05:00","closed_at":"2025-12-25T02:39:34.177842-05:00","dependencies":[{"issue_id":"engram-31wh","depends_on_id":"engram-kf57","type":"blocks","created_at":"2025-12-25T02:21:56.30305-05:00","created_by":"ccheney"}]}
{"id":"engram-32","title":"Add Test Coverage: packages/events","description":"Add comprehensive unit and integration tests for packages/events","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.351254-06:00","closed_at":"2025-12-07T02:02:43.672865-06:00","labels":["events","packages","testing"]}
{"id":"engram-320","title":"Develop Sparse Graph Keyword Retrieval","description":"Execute Qdrant search on 'sparse' vector field. See docs/bitemporal/context/semantic-search/develop-sparse-graph-keyword-retrieval.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.736242-06:00","updated_at":"2025-12-19T15:32:08.444916-06:00","closed_at":"2025-12-06T22:29:05.215974-06:00","labels":["retrieval","search","sparse"],"dependencies":[{"issue_id":"engram-320","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.736624-06:00","created_by":"daemon"}]}
{"id":"engram-321","title":"Develop Semantic Deduplication Logic","description":"Prevent indexing semantically identical duplicates. See docs/bitemporal/context/semantic-search/develop-semantic-deduplication-logic.md","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-06T21:52:43.949354-06:00","updated_at":"2025-12-19T15:32:08.445231-06:00","closed_at":"2025-12-07T01:18:14.912124-06:00","labels":["dedupe","quality","search"],"dependencies":[{"issue_id":"engram-321","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.949671-06:00","created_by":"daemon"}]}
{"id":"engram-322","title":"Improve code coverage across the monorepo","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T02:44:22.329459-06:00","updated_at":"2025-12-19T15:32:08.445492-06:00","closed_at":"2025-12-08T02:56:44.70659-06:00"}
{"id":"engram-323","title":"Define Hybrid Search Request Schema","description":"Interface for search queries (text, filters, strategy). See docs/bitemporal/context/semantic-search/define-hybrid-search-request-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.610895-06:00","updated_at":"2025-12-19T15:32:08.445698-06:00","closed_at":"2025-12-06T22:29:05.157489-06:00","labels":["api","schema","search"],"dependencies":[{"issue_id":"engram-323","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.611304-06:00","created_by":"daemon"}]}
{"id":"engram-324","title":"Bounded Context: Semantic Search","description":"The 'Cortex'. Vector indexing, hybrid search, and reranking. See docs/bitemporal/context/semantic-search/","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:47:42.480224-06:00","updated_at":"2025-12-19T15:32:08.445973-06:00","closed_at":"2025-12-06T23:26:13.080162-06:00","labels":["context","qdrant","search"]}
{"id":"engram-325","title":"Implement Intent Classifier for Queries","description":"Heuristic router to weight dense vs sparse search. See docs/bitemporal/context/semantic-search/implement-intent-classifier-for-queries.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:52:43.652792-06:00","updated_at":"2025-12-19T15:32:08.446784-06:00","closed_at":"2025-12-06T23:59:35.580584-06:00","labels":["nlp","router","search"],"dependencies":[{"issue_id":"engram-325","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.653219-06:00","created_by":"daemon"}]}
{"id":"engram-326","title":"Implement Qdrant Snapshot Manager","description":"Automated backup of vector index to GCS. See docs/bitemporal/context/semantic-search/implement-qdrant-snapshot-manager.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:52:43.864783-06:00","updated_at":"2025-12-19T15:32:08.447061-06:00","closed_at":"2025-12-07T01:01:26.548378-06:00","labels":["backup","ops","search"],"dependencies":[{"issue_id":"engram-326","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.865127-06:00","created_by":"daemon"}]}
{"id":"engram-327","title":"Create Similarity Score Threshold Configuration","description":"Dynamic thresholds to filter irrelevant results. See docs/bitemporal/context/semantic-search/create-similarity-score-threshold-configuration.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:52:43.90902-06:00","updated_at":"2025-12-19T15:32:08.447338-06:00","closed_at":"2025-12-06T23:58:01.176474-06:00","labels":["config","search","tuning"],"dependencies":[{"issue_id":"engram-327","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.909425-06:00","created_by":"daemon"}]}
{"id":"engram-328","title":"Define Vector Point Schema","description":"Zod schema for Qdrant points (dense/sparse vectors + metadata). See docs/bitemporal/context/semantic-search/define-vector-point-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.310246-06:00","updated_at":"2025-12-19T15:32:08.447588-06:00","closed_at":"2025-12-06T22:28:17.730495-06:00","labels":["qdrant","schema","search"],"dependencies":[{"issue_id":"engram-328","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.310637-06:00","created_by":"daemon"}]}
{"id":"engram-329","title":"Replace custom xai-client with @ai-sdk/xai","description":"The custom packages/search-core/src/clients/xai-client.ts duplicates functionality already provided by Vercel AI SDK's @ai-sdk/xai package.\n\nBenefits of switching:\n- First-party xAI Grok provider (added in AI SDK 4.0, Nov 2024)\n- Unified API across all LLM providers\n- Better tested, community supported\n- Streaming, tool use, structured output built-in\n- Can swap models with 1-2 lines of code\n\nFiles to update:\n- Remove packages/search-core/src/clients/xai-client.ts\n- Update packages/search-core/src/services/llm-reranker.ts to use @ai-sdk/xai\n- Fix tests (llm-reranker.test.ts module resolution issue goes away)\n\nReference: https://www.npmjs.com/package/@ai-sdk/xai","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T01:24:17.603755-06:00","updated_at":"2025-12-19T15:32:08.447856-06:00","closed_at":"2025-12-19T02:54:40.720475-06:00"}
{"id":"engram-33","title":"Add Test Coverage: apps/search","description":"Add comprehensive unit and integration tests for apps/search","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.351583-06:00","closed_at":"2025-12-07T02:08:18.988343-06:00","labels":["apps","search","testing"]}
{"id":"engram-330","title":"Implement Text Embedding Service","description":"Wrapper for fast-embed/ONNX to generate text vectors. See docs/bitemporal/context/semantic-search/implement-text-embedding-service.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.439112-06:00","updated_at":"2025-12-19T15:32:08.448086-06:00","closed_at":"2025-12-06T22:28:17.817752-06:00","labels":["embedding","search","service"],"dependencies":[{"issue_id":"engram-330","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.439559-06:00","created_by":"daemon"}]}
{"id":"engram-331","title":"Implement Code Embedding Service","description":"Wrapper for nomic-embed to generate code vectors. See docs/bitemporal/context/semantic-search/implement-code-embedding-service.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.482698-06:00","updated_at":"2025-12-19T15:32:08.448365-06:00","closed_at":"2025-12-06T22:28:17.844905-06:00","labels":["embedding","search","service"],"dependencies":[{"issue_id":"engram-331","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.483104-06:00","created_by":"daemon"}]}
{"id":"engram-332","title":"Configure Qdrant Collection Manager","description":"Script to init Qdrant with dense/sparse configuration. See docs/bitemporal/context/semantic-search/configure-qdrant-collection-manager.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.526279-06:00","updated_at":"2025-12-19T15:32:08.448643-06:00","closed_at":"2025-12-06T22:28:36.50325-06:00","labels":["ops","qdrant","search"],"dependencies":[{"issue_id":"engram-332","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.52668-06:00","created_by":"daemon"}]}
{"id":"engram-333","title":"Implement Vector Upsert Logic","description":"Indexer service listening to memory.node_created events. See docs/bitemporal/context/semantic-search/implement-vector-upsert-logic.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.569542-06:00","updated_at":"2025-12-19T15:32:08.450296-06:00","closed_at":"2025-12-06T22:29:05.127442-06:00","labels":["indexing","redpanda","search"],"dependencies":[{"issue_id":"engram-333","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.56991-06:00","created_by":"daemon"}]}
{"id":"engram-334","title":"Implement Result Re-ranking Logic","description":"Cross-Encoder (bge-reranker) to refine top-k results. See docs/bitemporal/context/semantic-search/implement-result-re-ranking-logic.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:43.778368-06:00","updated_at":"2025-12-19T15:32:08.45062-06:00","closed_at":"2025-12-06T23:23:16.249-06:00","labels":["ml","ranking","search"],"dependencies":[{"issue_id":"engram-334","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.778789-06:00","created_by":"daemon"}]}
{"id":"engram-335","title":"Create Embedding Batch Processor","description":"Queue system to batch embedding generation. See docs/bitemporal/context/semantic-search/create-embedding-batch-processor.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:52:43.822685-06:00","updated_at":"2025-12-19T15:32:08.45092-06:00","closed_at":"2025-12-06T23:43:46.907097-06:00","labels":["batching","performance","search"],"dependencies":[{"issue_id":"engram-335","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.823076-06:00","created_by":"daemon"}]}
{"id":"engram-336","title":"LOW: Buffer written with utf-8 encoding corrupts binary data","description":"Location: packages/storage/src/blob.ts:17-24\n\nWhen saving a Buffer, the method writes it with utf-8 encoding, which can corrupt binary data that is not valid UTF-8.\n\nFix: Don't specify encoding for Buffer content.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:18.127053-06:00","updated_at":"2025-12-19T15:32:08.4512-06:00","closed_at":"2025-12-18T21:47:37.305526-06:00"}
{"id":"engram-337","title":"LOW: PII patterns defined but not applied in redactor","description":"Location: packages/ingestion-core/src/redactor.ts\n\nAWS_KEY and GENERIC_SECRET patterns are defined in PATTERNS object but never applied in redact() method.\n\nFix: Either remove unused patterns or apply them.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:47.017672-06:00","updated_at":"2025-12-19T15:32:08.451418-06:00","closed_at":"2025-12-18T21:47:22.599292-06:00"}
{"id":"engram-338","title":"Develop Dense Vector Retrieval","description":"Execute Qdrant search on 'dense' vector field. See docs/bitemporal/context/semantic-search/develop-dense-vector-retrieval.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:52:43.693549-06:00","updated_at":"2025-12-19T15:32:08.451636-06:00","closed_at":"2025-12-06T22:29:05.186659-06:00","labels":["dense","retrieval","search"],"dependencies":[{"issue_id":"engram-338","depends_on_id":"engram-324","type":"parent-child","created_at":"2025-12-06T21:52:43.6939-06:00","created_by":"daemon"}]}
{"id":"engram-339","title":"Design LLM reranking prompt templates","description":"Design effective prompt templates for listwise reranking.\n\nReference: docs/plans/reranker-implementation.md (Phase 4)\n\nPrompt requirements:\n- Present query and all candidates clearly\n- Request ordered ranking with reasoning\n- Handle different content types (code, text, mixed)\n- Optimize for grok-4-1-fast-reasoning token efficiency\n\nTemplate structure:\n```\nSystem: You are a search relevance expert...\nUser: \nQuery: {query}\nCandidates:\n1. {doc1_content}\n2. {doc2_content}\n...\nRank these candidates by relevance to the query.\nReturn format: [1, 3, 2, ...] most to least relevant.\n```\n\nLocation: packages/search-core/src/services/llm-reranker.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:57:23.380636-06:00","updated_at":"2025-12-19T15:32:08.451935-06:00","closed_at":"2025-12-09T00:36:40.249902-06:00"}
{"id":"engram-33kd","title":"Add message queue for offline/disconnected state","description":"## Problem\n\nThe `useWebSocket` hook at `apps/interface/app/hooks/useWebSocket.ts:259-264` silently drops messages when the connection is not open:\n\n```typescript\nconst send = useCallback((data: string | object) =\u003e {\n  if (wsRef.current?.readyState === WebSocket.OPEN) {\n    const message = typeof data === 'string' ? data : JSON.stringify(data);\n    wsRef.current.send(message);\n  }\n  // Messages are silently dropped if not connected\n}, []);\n```\n\nThis can lead to data loss during brief disconnections or reconnection periods.\n\n## Use Cases Affected\n\n1. **Race conditions**: User action triggers send() milliseconds before connection drops\n2. **Reconnection gaps**: Messages sent during exponential backoff reconnection period are lost\n3. **Mobile networks**: Frequent brief disconnections on mobile networks\n4. **Tab visibility**: Messages sent while tab is backgrounded and connection dropped\n\n## Recommended Solution\n\nImplement an optional message queue that buffers messages during disconnection:\n\n```typescript\ninterface UseWebSocketOptions\u003cT\u003e {\n  // ... existing options\n  \n  /** Queue messages when disconnected and send on reconnect. Default: false */\n  queueOfflineMessages?: boolean;\n  \n  /** Maximum queue size to prevent memory issues. Default: 100 */\n  maxQueueSize?: number;\n  \n  /** Max age of queued messages in ms before discarding. Default: 30000 */\n  maxQueueAge?: number;\n}\n\n// Implementation\nconst messageQueueRef = useRef\u003cArray\u003c{ data: string; timestamp: number }\u003e\u003e([]);\n\nconst send = useCallback((data: string | object) =\u003e {\n  const message = typeof data === 'string' ? data : JSON.stringify(data);\n  \n  if (wsRef.current?.readyState === WebSocket.OPEN) {\n    wsRef.current.send(message);\n  } else if (queueOfflineMessages) {\n    // Add to queue with timestamp\n    messageQueueRef.current.push({ data: message, timestamp: Date.now() });\n    \n    // Trim queue if over max size\n    if (messageQueueRef.current.length \u003e maxQueueSize) {\n      messageQueueRef.current.shift();\n    }\n  }\n}, [queueOfflineMessages, maxQueueSize]);\n\n// On reconnect, flush queue\nws.onopen = () =\u003e {\n  // ... existing onopen logic\n  \n  // Flush queued messages (filtering out stale ones)\n  const now = Date.now();\n  const validMessages = messageQueueRef.current.filter(\n    msg =\u003e now - msg.timestamp \u003c maxQueueAge\n  );\n  validMessages.forEach(msg =\u003e ws.send(msg.data));\n  messageQueueRef.current = [];\n};\n```\n\n### Additional Return Value\n\n```typescript\ninterface UseWebSocketReturn {\n  // ... existing fields\n  \n  /** Number of messages currently queued */\n  queuedMessageCount: number;\n  \n  /** Clear the message queue */\n  clearQueue: () =\u003e void;\n}\n```\n\n## Considerations\n\n1. **Memory management**: Cap queue size and message age to prevent unbounded growth\n2. **Message ordering**: Queued messages sent before new messages on reconnect\n3. **Idempotency**: Consumer should handle potential duplicate delivery (network ack lost before disconnect)\n4. **Opt-in**: Default to false to maintain current behavior\n\n## References\n\n- [react-use-websocket library](https://github.com/robtaussig/react-use-websocket) - Implements message queuing\n- [Best Practices for WebSockets in React Native](https://medium.com/@tusharkumar27864/best-practices-of-using-websockets-real-time-communication-in-react-native-projects-89e749ba2e3f)\n- [The complete guide to WebSockets with React](https://ably.com/blog/websockets-react-tutorial)\n\n## Priority\n\nLow - Nice to have for reliability, but many applications can tolerate occasional message loss or handle it at the application layer.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T20:41:44.798353-06:00","updated_at":"2025-12-20T23:07:49.46631-06:00","closed_at":"2025-12-20T23:07:49.46631-06:00"}
{"id":"engram-34","title":"Add Test Coverage: apps/memory","description":"Add comprehensive unit and integration tests for apps/memory","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.351925-06:00","closed_at":"2025-12-07T02:06:40.35145-06:00","labels":["apps","memory","testing"]}
{"id":"engram-340","title":"[EPIC] Reranker Core Infrastructure","description":"Core reranker infrastructure for Engram search pipeline.\n\nBounded Context: Reranker Domain\nReference: docs/plans/reranker-implementation.md (Section 3.2)\n\nProvides the foundational reranking capabilities including:\n- BatchedReranker for parallel document scoring\n- Model management and singleton patterns\n- Score normalization and result merging\n\nThis epic enables multi-tier reranking architecture.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-08T22:55:04.069554-06:00","updated_at":"2025-12-19T15:32:08.452165-06:00","closed_at":"2025-12-08T23:53:50.186046-06:00"}
{"id":"engram-341","title":"Create test dataset with relevance judgments","description":"Curate 100+ query-document pairs with human relevance labels for evaluation. Export to JSON for reproducible benchmarks.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T23:01:48.398766-06:00","updated_at":"2025-12-19T15:32:08.452465-06:00","closed_at":"2025-12-09T00:35:34.847294-06:00"}
{"id":"engram-342","title":"[EPIC] Testing \u0026 Quality","description":"Unit tests, integration tests, and quality evaluation for reranker system (Section 10)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T23:01:25.788967-06:00","updated_at":"2025-12-19T15:32:08.45271-06:00","closed_at":"2025-12-08T23:59:28.757899-06:00","dependencies":[{"issue_id":"engram-342","depends_on_id":"engram-210","type":"blocks","created_at":"2025-12-08T23:03:03.470975-06:00","created_by":"daemon"}]}
{"id":"engram-343","title":"Configure Control Service MCP Client","description":"the-system-1p4","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T00:36:28.953409-06:00","updated_at":"2025-12-19T15:32:08.452956-06:00","closed_at":"2025-12-07T00:39:29.552858-06:00"}
{"id":"engram-344","title":"Add structured logging for rerank events","description":"Log: event=search_rerank with query hash, tier, model, inputCandidates, outputResults, latencyMs, topScoreDelta","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:02.506404-06:00","updated_at":"2025-12-19T15:32:08.453206-06:00","closed_at":"2025-12-08T23:58:32.827028-06:00"}
{"id":"engram-345","title":"Phase 3: Add latency tracking to benchmark pipeline","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T00:48:02.6195-06:00","updated_at":"2025-12-19T15:32:08.453426-06:00","closed_at":"2025-12-19T00:55:25.812954-06:00","dependencies":[{"issue_id":"engram-345","depends_on_id":"engram-188","type":"blocks","created_at":"2025-12-19T00:48:26.036636-06:00","created_by":"ccheney"}]}
{"id":"engram-346","title":"LOW: Path traversal not handled in VirtualFileSystem","description":"Location: packages/vfs/src/vfs.ts:97-99\n\nThe splitPath method does not handle '..' path components. A path like '/foo/../bar' creates '..' as a literal directory name instead of resolving to '/bar'.\n\nFix: Normalize paths to resolve '..' segments.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:50.975105-06:00","updated_at":"2025-12-19T15:32:08.453679-06:00","closed_at":"2025-12-18T21:47:37.308965-06:00"}
{"id":"engram-347","title":"LOW: JSON.stringify comparison unreliable for object equality","description":"Location: packages/execution-core/src/replay.ts:199-209\n\nUsing JSON.stringify for deep equality comparison is unreliable. Object key order matters, undefined values are stripped, circular references throw.\n\nFix: Use deep-equal library or structured comparison.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:14.707291-06:00","updated_at":"2025-12-19T15:32:08.45391-06:00","closed_at":"2025-12-18T21:47:37.306611-06:00"}
{"id":"engram-348","title":"LOW: isUserError always returns true","description":"Location: packages/execution-core/src/errors.ts:9-12\n\nThe isUserError function is a stub that always returns true. All errors are incorrectly classified as user errors.\n\nFix: Implement proper error classification logic.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:53.703759-06:00","updated_at":"2025-12-19T15:32:08.454123-06:00","closed_at":"2025-12-18T21:47:37.307624-06:00"}
{"id":"engram-349","title":"Implement sparse-only search in SearchRetriever","description":"Implement the sparse search path in SearchRetriever.search() that currently returns an empty array.\n\nReference: docs/plans/hybrid-retriever.md (Phase 1)\n\nChanges to packages/search-core/src/services/retriever.ts:\n- Add call to textEmbedder.embedSparseQuery(text) to generate SPLADE sparse vector\n- Use client.query() with sparse vector format: { indices, values }\n- Set using: \"sparse\" to target the sparse named vector field\n- Apply filter and score_threshold (default 0.1 for sparse)\n- Return results.points to match dense search return format\n\nThe sparse search is triggered when:\n- User explicitly sets strategy: \"sparse\"\n- QueryClassifier detects quoted strings (exact match intent)\n\nSparse search works for both text and code content since SPLADE is content-agnostic.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T21:37:49.339784-06:00","updated_at":"2025-12-19T15:32:08.454363-06:00","closed_at":"2025-12-08T21:46:15.838917-06:00"}
{"id":"engram-35","title":"Add Test Coverage: apps/interface","description":"Add comprehensive unit and integration tests for apps/interface","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.352243-06:00","closed_at":"2025-12-07T02:05:45.45239-06:00","labels":["apps","interface","testing"]}
{"id":"engram-350","title":"Add project context properties to SessionNode","description":"Add working_dir, git_remote, agent_type to SessionNode for project-level filtering","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T03:13:55.589464-06:00","updated_at":"2025-12-19T15:32:08.454631-06:00","closed_at":"2025-12-08T03:18:11.081148-06:00","dependencies":[{"issue_id":"engram-350","depends_on_id":"engram-259","type":"blocks","created_at":"2025-12-08T03:14:04.554328-06:00","created_by":"daemon"}]}
{"id":"engram-351","title":"Run typecheck, lint, format, and test","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T02:43:44.282608-06:00","updated_at":"2025-12-19T15:32:08.454882-06:00","closed_at":"2025-12-08T02:53:44.524789-06:00"}
{"id":"engram-352","title":"Phase 4: Add evaluation caching","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T00:48:09.64257-06:00","updated_at":"2025-12-19T15:32:08.455142-06:00","closed_at":"2025-12-19T01:00:06.673315-06:00","dependencies":[{"issue_id":"engram-352","depends_on_id":"engram-362","type":"blocks","created_at":"2025-12-19T00:48:31.150676-06:00","created_by":"ccheney"}]}
{"id":"engram-353","title":"P2: Integrate abstention detector with Reader","description":"Wire up all abstention layers into the Reader pipeline.\n\n## Context\n- Plan: docs/plans/retrieval-v2/02-abstention-detection.md\n- Integration: lines 145-175 (Reader integration)\n- CLI flags: lines 180-185\n\n## Tasks\n1. Add abstentionDetector to Reader class\n2. Call shouldAbstain after answer generation\n3. Return abstention response when triggered\n4. Add --abstention CLI flag to benchmark\n5. Run on ABS subset to validate\n\n## Expected Impact\n- ABS accuracy: 10% → 40%+ (4x improvement)\n- False abstention rate: \u003c10%\n- Overall accuracy: +2-3%\n\n## Dependencies\n- Requires: P2 retrieval confidence (the-system-uy4s)\n- Requires: P2 NLI grounding (previous)\n- Requires: P2 hedging detection (previous)\n\n## References\n- Success metrics: lines 190-195","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:37:30.718117-06:00","updated_at":"2025-12-19T15:32:08.455397-06:00","closed_at":"2025-12-18T23:20:19.415989-06:00","dependencies":[{"issue_id":"engram-353","depends_on_id":"engram-200","type":"blocks","created_at":"2025-12-18T21:40:09.511284-06:00","created_by":"ccheney"},{"issue_id":"engram-353","depends_on_id":"engram-15","type":"blocks","created_at":"2025-12-18T21:40:14.641124-06:00","created_by":"ccheney"}]}
{"id":"engram-354","title":"Create quality evaluation script with NDCG/MRR metrics","description":"Build evaluation harness: test queries, ground truth, compute NDCG@10, MRR, MAP. Compare RRF-only vs RRF+rerank. File: scripts/evaluate-reranker.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:01:47.472355-06:00","updated_at":"2025-12-19T15:32:08.455643-06:00","closed_at":"2025-12-08T23:59:19.270629-06:00"}
{"id":"engram-355","title":"[2.5] Create Shared useWebSocket Hook (interface)","description":"# Task 2.5: Create Shared useWebSocket Hook\n\n**Effort**: 3 hours\n**Dependencies**: None (after Phase 1)\n**LOC Saved**: ~80 lines\n**Parallel**: Can run with all Phase 2 tasks\n\n## Location\n`apps/interface/app/hooks/useWebSocket.ts`\n\n## Hooks to Refactor\n- useSessionStream\n- useSessionsStream\n\n## Hook Design\n```typescript\ninterface UseWebSocketOptions\u003cT\u003e {\n  url: string;\n  onMessage: (data: T) =\u003e void;\n  onError?: (error: Error) =\u003e void;\n  onOpen?: () =\u003e void;\n  onClose?: () =\u003e void;\n  reconnect?: boolean;\n  reconnectInterval?: number;\n}\n\nexport function useWebSocket\u003cT\u003e(options: UseWebSocketOptions\u003cT\u003e) {\n  const [status, setStatus] = useState\u003c'connecting' | 'open' | 'closed' | 'error'\u003e('connecting');\n  const wsRef = useRef\u003cWebSocket | null\u003e(null);\n  \n  // Common WebSocket logic...\n  \n  return { status, send, close };\n}\n```\n\n## Acceptance Criteria\n- [ ] useWebSocket hook created\n- [ ] useSessionStream refactored\n- [ ] useSessionsStream refactored\n- [ ] Reconnection logic shared\n- [ ] Unit tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 423-439)\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:35:15.44817-06:00","updated_at":"2025-12-19T15:32:08.455888-06:00","closed_at":"2025-12-09T04:10:18.428972-06:00","labels":["dry","hooks","interface","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-355","depends_on_id":"engram-358","type":"parent-child","created_at":"2025-12-09T03:35:15.448617-06:00","created_by":"daemon"}]}
{"id":"engram-356","title":"[2.4] Consolidate Configuration (search-core)","description":"# Task 2.4: Consolidate Configuration (search-core)\n\n**Effort**: 3 hours\n**Dependencies**: Task 0.1 (env helpers from @engram/common)\n**Parallel**: Can run with all Phase 2 tasks\n\n## Files to Merge\n- `packages/search-core/src/config.ts`\n- `packages/search-core/src/config/reranker-config.ts`\n- `packages/search-core/src/config/env.ts`\n\n## Target\nSingle `packages/search-core/src/config/index.ts`\n\n## Config Structure\n```typescript\nexport const searchConfig = {\n  qdrant: {\n    host: envStr('QDRANT_HOST', 'localhost'),\n    port: envNum('QDRANT_PORT', 6333),\n    collectionName: envStr('QDRANT_COLLECTION', 'engram'),\n  },\n  reranker: {\n    enabled: envBool('RERANKER_ENABLED', false),\n    model: envStr('RERANKER_MODEL', 'cross-encoder'),\n    topK: envNum('RERANKER_TOP_K', 10),\n  },\n  embedding: {\n    model: envStr('EMBEDDING_MODEL', 'text-embedding-ada-002'),\n    dimensions: envNum('EMBEDDING_DIMENSIONS', 1536),\n  },\n} as const;\n\nexport type SearchConfig = typeof searchConfig;\n```\n\n## Acceptance Criteria\n- [ ] Config files merged\n- [ ] Using env helpers from @engram/common\n- [ ] No duplicate env reads\n- [ ] Type-safe config object\n- [ ] All tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 407-421)\n- docs/refactor/packages/search-core/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:35:13.814887-06:00","updated_at":"2025-12-19T15:32:08.45621-06:00","closed_at":"2025-12-09T04:10:18.387392-06:00","labels":["config","dry","parallel-ok","refactoring","search-core"],"dependencies":[{"issue_id":"engram-356","depends_on_id":"engram-358","type":"parent-child","created_at":"2025-12-09T03:35:13.815313-06:00","created_by":"daemon"},{"issue_id":"engram-356","depends_on_id":"engram-89","type":"blocks","created_at":"2025-12-09T03:38:54.374518-06:00","created_by":"daemon"}]}
{"id":"engram-357","title":"[2.3] Create Parser Registry (ingestion-core)","description":"# Task 2.3: Create Parser Registry\n\n**Effort**: 4 hours\n**Dependencies**: None (after Phase 1)\n**Blocks**: Ingestion app refactoring\n**Parallel**: Can run with all Phase 2 tasks\n\n## Location\n`packages/ingestion-core/src/parser/registry.ts`\n\n## Current Problem\n8-way if-else chain in `apps/ingestion/src/index.ts` for parser selection.\n\n## Registry Design\n```typescript\nexport class ParserRegistry {\n  private parsers = new Map\u003cstring, Parser\u003e();\n  \n  register(provider: string, parser: Parser): void {\n    this.parsers.set(provider.toLowerCase(), parser);\n  }\n  \n  get(provider: string): Parser | undefined {\n    return this.parsers.get(provider.toLowerCase());\n  }\n  \n  has(provider: string): boolean {\n    return this.parsers.has(provider.toLowerCase());\n  }\n  \n  providers(): string[] {\n    return Array.from(this.parsers.keys());\n  }\n}\n\n// Auto-registration\nexport const defaultRegistry = new ParserRegistry();\ndefaultRegistry.register('anthropic', new AnthropicParser());\ndefaultRegistry.register('openai', new OpenAIParser());\n// ... etc\n```\n\n## Changes Required\n- Create `ParserRegistry` class\n- Auto-register all 8 parsers\n- Update `apps/ingestion/src/index.ts` to use registry\n- Add support for provider aliases\n\n## Acceptance Criteria\n- [ ] ParserRegistry class created\n- [ ] All 8 parsers registered\n- [ ] Ingestion app updated\n- [ ] Provider aliases work\n- [ ] Unit tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 389-405)\n- docs/refactor/packages/ingestion-core/REPORT.md\n- docs/refactor/apps/ingestion/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:35:12.657478-06:00","updated_at":"2025-12-19T15:32:08.456539-06:00","closed_at":"2025-12-09T04:10:18.325441-06:00","labels":["dry","ingestion-core","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-357","depends_on_id":"engram-358","type":"parent-child","created_at":"2025-12-09T03:35:12.657956-06:00","created_by":"daemon"}]}
{"id":"engram-358","title":"[EPIC] Phase 2: DRY Consolidation","description":"# Phase 2: DRY Consolidation\n\n**Duration**: 4-5 days\n**Dependencies**: Phase 1 complete\n**Parallelization**: ALL tasks (2.1-2.5) can run in parallel\n\n## Overview\nEliminate code duplication across the codebase:\n- Create base classes for embedders and extractors\n- Build parser registry to replace if-else chains\n- Consolidate configuration files\n- Create shared React hooks\n\n## Issue Summary\n- Total duplicated code: ~15%\n- LOC to save: ~400+ lines\n- Files to consolidate: 12+\n\n## Success Criteria\n- [ ] Duplicated code reduced from ~15% to \u003c5%\n- [ ] Base classes created and in use\n- [ ] Parser registry operational\n- [ ] Config files consolidated\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 348-440)\n- docs/refactor/packages/search-core/REPORT.md\n- docs/refactor/packages/ingestion-core/REPORT.md\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-09T03:31:26.606386-06:00","updated_at":"2025-12-19T15:32:08.456829-06:00","closed_at":"2025-12-09T04:10:18.468532-06:00","labels":["dry","p0","refactoring"],"dependencies":[{"issue_id":"engram-358","depends_on_id":"engram-231","type":"blocks","created_at":"2025-12-09T03:38:41.101881-06:00","created_by":"daemon"}]}
{"id":"engram-359","title":"[2.1] Create BaseEmbedder Class (search-core)","description":"# Task 2.1: Create BaseEmbedder Class\n\n**Effort**: 4 hours\n**Dependencies**: None (after Phase 1)\n**LOC Saved**: ~150 lines\n**Parallel**: Can run with all Phase 2 tasks\n\n## Location\n`packages/search-core/src/services/base-embedder.ts`\n\n## Classes to Refactor\n- TextEmbedder\n- CodeEmbedder\n- ColBERTEmbedder\n- SpladeEmbedder\n\n## Base Class Design\n```typescript\nexport abstract class BaseEmbedder\u003cTConfig extends EmbedderConfig\u003e {\n  protected config: TConfig;\n  protected logger: Logger;\n  \n  constructor(config: TConfig, logger: Logger) {\n    this.config = config;\n    this.logger = logger;\n  }\n  \n  abstract embed(text: string): Promise\u003cnumber[]\u003e;\n  abstract embedBatch(texts: string[]): Promise\u003cnumber[][]\u003e;\n  \n  protected async withRetry\u003cT\u003e(fn: () =\u003e Promise\u003cT\u003e): Promise\u003cT\u003e {\n    // Common retry logic\n  }\n  \n  protected validateInput(text: string): void {\n    // Common validation\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] BaseEmbedder class created\n- [ ] All 4 embedders refactored to extend base\n- [ ] Common logic deduplicated\n- [ ] Unit tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 354-370)\n- docs/refactor/packages/search-core/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:34:43.696657-06:00","updated_at":"2025-12-19T15:32:08.457174-06:00","closed_at":"2025-12-09T04:10:18.198915-06:00","labels":["dry","parallel-ok","refactoring","search-core"],"dependencies":[{"issue_id":"engram-359","depends_on_id":"engram-358","type":"parent-child","created_at":"2025-12-09T03:34:43.697195-06:00","created_by":"daemon"}]}
{"id":"engram-35j9","title":"Test coverage: packages/infra/src/config.ts (branches 75%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:29.263631-06:00","updated_at":"2025-12-21T04:07:03.763649-06:00","closed_at":"2025-12-21T04:07:03.763649-06:00"}
{"id":"engram-36","title":"Add Test Coverage: apps/ingestion","description":"Add comprehensive unit and integration tests for apps/ingestion","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.352563-06:00","closed_at":"2025-12-07T02:05:02.450726-06:00","labels":["apps","ingestion","testing"]}
{"id":"engram-360","title":"[2.2] Create TagExtractor Base Class (ingestion-core)","description":"# Task 2.2: Create TagExtractor Base Class\n\n**Effort**: 3 hours\n**Dependencies**: None (after Phase 1)\n**LOC Saved**: ~80 lines\n**Parallel**: Can run with all Phase 2 tasks\n\n## Location\n`packages/ingestion-core/src/extractors/base.ts`\n\n## Classes to Refactor\n- ThinkingExtractor\n- DiffExtractor\n\n## Base Class Design\n```typescript\nexport abstract class BaseTagExtractor {\n  protected tagName: string;\n  protected logger: Logger;\n  \n  constructor(tagName: string, logger: Logger) {\n    this.tagName = tagName;\n    this.logger = logger;\n  }\n  \n  abstract extract(content: string): ExtractedTag[];\n  \n  protected findTagBoundaries(content: string): TagBoundary[] {\n    // Common tag boundary detection\n  }\n  \n  protected parseAttributes(tag: string): Record\u003cstring, string\u003e {\n    // Common attribute parsing\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] BaseTagExtractor class created\n- [ ] ThinkingExtractor refactored\n- [ ] DiffExtractor refactored\n- [ ] Common regex logic shared\n- [ ] Unit tests pass\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 372-387)\n- docs/refactor/packages/ingestion-core/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:35:11.224357-06:00","updated_at":"2025-12-19T15:32:08.457479-06:00","closed_at":"2025-12-09T04:10:18.263311-06:00","labels":["dry","ingestion-core","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-360","depends_on_id":"engram-358","type":"parent-child","created_at":"2025-12-09T03:35:11.224946-06:00","created_by":"daemon"}]}
{"id":"engram-361","title":"MEDIUM: Missing HTTP request error handler","description":"Location: apps/ingestion/src/index.ts:299-338\n\nThe HTTP server sets up req.on('data') and req.on('end') handlers but does not handle the 'error' event on the request stream.\n\nImpact: Potential unhandled errors when clients disconnect unexpectedly.\n\nFix: Add req.on('error') handler.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:35.413066-06:00","updated_at":"2025-12-19T15:32:08.45775-06:00","closed_at":"2025-12-19T00:58:45.157501-06:00"}
{"id":"engram-362","title":"Phase 2: Create evaluation adapter in tuner","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T00:47:56.378039-06:00","updated_at":"2025-12-19T15:32:08.457964-06:00","closed_at":"2025-12-19T00:53:39.705272-06:00","dependencies":[{"issue_id":"engram-362","depends_on_id":"engram-188","type":"blocks","created_at":"2025-12-19T00:48:20.922564-06:00","created_by":"ccheney"}]}
{"id":"engram-363","title":"Create Ingestion Service Dockerfile","description":"Multi-stage Dockerfile for Ingestion Service (Bun). See docs/bitemporal/context/system-infrastructure/create-ingestion-service-dockerfile.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:15.908008-06:00","updated_at":"2025-12-19T15:32:08.458226-06:00","closed_at":"2025-12-06T22:10:59.10131-06:00","labels":["docker","infrastructure","ingestion"],"dependencies":[{"issue_id":"engram-363","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:15.908412-06:00","created_by":"daemon"}]}
{"id":"engram-364","title":"Define Cloud Infrastructure Strategy","description":"Architecture for Cloud Run (Stateless) + GKE Autopilot (Stateful). See docs/bitemporal/context/system-infrastructure/define-cloud-infrastructure-strategy.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:15.863526-06:00","updated_at":"2025-12-19T15:32:08.458525-06:00","closed_at":"2025-12-06T22:11:27.31555-06:00","labels":["architecture","gcp","infrastructure"],"dependencies":[{"issue_id":"engram-364","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:15.863919-06:00","created_by":"daemon"}]}
{"id":"engram-365","title":"Define Secret Management","description":"Integrate GCP Secret Manager with Cloud Run. See docs/bitemporal/context/system-infrastructure/define-secret-management.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:16.253675-06:00","updated_at":"2025-12-19T15:32:08.458791-06:00","closed_at":"2025-12-06T22:11:16.081954-06:00","labels":["gcp","infrastructure","security"],"dependencies":[{"issue_id":"engram-365","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.25406-06:00","created_by":"daemon"}]}
{"id":"engram-366","title":"Create Memory Service Dockerfile","description":"Multi-stage Dockerfile for Memory Service (Bun/Node). See docs/bitemporal/context/system-infrastructure/create-memory-service-dockerfile.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:15.951797-06:00","updated_at":"2025-12-19T15:32:08.459091-06:00","closed_at":"2025-12-06T22:10:59.130231-06:00","labels":["docker","infrastructure","memory"],"dependencies":[{"issue_id":"engram-366","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:15.952181-06:00","created_by":"daemon"}]}
{"id":"engram-367","title":"Create Development Environment Setup","description":"docker-compose.dev.yml and 'bun run dev' scripts. See docs/bitemporal/context/system-infrastructure/create-development-environment-setup.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:16.345125-06:00","updated_at":"2025-12-19T15:32:08.459354-06:00","closed_at":"2025-12-06T22:08:55.192393-06:00","labels":["dx","infrastructure","setup"],"dependencies":[{"issue_id":"engram-367","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.345549-06:00","created_by":"daemon"}]}
{"id":"engram-368","title":"Create Search Service Dockerfile","description":"Multi-stage Dockerfile for Search Service. See docs/bitemporal/context/system-infrastructure/create-search-service-dockerfile.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:15.9968-06:00","updated_at":"2025-12-19T15:32:08.459641-06:00","closed_at":"2025-12-06T22:10:59.160843-06:00","labels":["docker","infrastructure","search"],"dependencies":[{"issue_id":"engram-368","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:15.997201-06:00","created_by":"daemon"}]}
{"id":"engram-369","title":"Bounded Context: System Infrastructure","description":"Foundational deployment configuration, container orchestration (GKE/Cloud Run), and database provisioning (Redpanda, FalkorDB, Qdrant). See docs/bitemporal/context/system-infrastructure/","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:47:42.307572-06:00","updated_at":"2025-12-19T15:32:08.459941-06:00","closed_at":"2025-12-06T22:11:34.264879-06:00","labels":["context","gcp","infrastructure"]}
{"id":"engram-37","title":"Add Test Coverage: apps/execution","description":"Add comprehensive unit and integration tests for apps/execution","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.35292-06:00","closed_at":"2025-12-07T02:03:42.250721-06:00","labels":["apps","execution","testing"]}
{"id":"engram-370","title":"Define Monorepo Structure","description":"Establish Turborepo v2.6.3 workspace with 'apps', 'packages', and 'tooling'. See docs/bitemporal/context/system-infrastructure/define-monorepo-structure.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:15.819997-06:00","updated_at":"2025-12-19T15:32:08.460263-06:00","closed_at":"2025-12-06T22:08:27.919341-06:00","labels":["infrastructure","setup","turborepo"],"dependencies":[{"issue_id":"engram-370","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:15.820431-06:00","created_by":"daemon"}]}
{"id":"engram-371","title":"Create Execution Service Dockerfile","description":"Multi-stage Dockerfile for Execution Service (Wasm). See docs/bitemporal/context/system-infrastructure/create-execution-service-dockerfile.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:16.039854-06:00","updated_at":"2025-12-19T15:32:08.460536-06:00","closed_at":"2025-12-06T22:10:59.189713-06:00","labels":["docker","execution","infrastructure"],"dependencies":[{"issue_id":"engram-371","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.040344-06:00","created_by":"daemon"}]}
{"id":"engram-372","title":"Define Log Aggregation","description":"Structured JSON logging (Pino) for Cloud Logging. See docs/bitemporal/context/system-infrastructure/define-log-aggregation.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:16.299128-06:00","updated_at":"2025-12-19T15:32:08.46081-06:00","closed_at":"2025-12-06T22:10:59.067714-06:00","labels":["infrastructure","logging","observability"],"dependencies":[{"issue_id":"engram-372","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.299554-06:00","created_by":"daemon"}]}
{"id":"engram-373","title":"Configure Redpanda Deployment","description":"docker-compose and Helm charts for Redpanda. See docs/bitemporal/context/system-infrastructure/configure-redpanda-deployment.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:16.082757-06:00","updated_at":"2025-12-19T15:32:08.461103-06:00","closed_at":"2025-12-06T22:10:11.214642-06:00","labels":["deployment","infrastructure","redpanda"],"dependencies":[{"issue_id":"engram-373","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.083154-06:00","created_by":"daemon"}]}
{"id":"engram-374","title":"Configure FalkorDB Deployment","description":"docker-compose and Kubernetes manifest for FalkorDB. See docs/bitemporal/context/system-infrastructure/configure-falkordb-deployment.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:16.124943-06:00","updated_at":"2025-12-19T15:32:08.461395-06:00","closed_at":"2025-12-06T22:10:11.247386-06:00","labels":["deployment","falkordb","infrastructure"],"dependencies":[{"issue_id":"engram-374","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.125294-06:00","created_by":"daemon"}]}
{"id":"engram-375","title":"Configure Qdrant Deployment","description":"docker-compose and Helm charts for Qdrant. See docs/bitemporal/context/system-infrastructure/configure-qdrant-deployment.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:16.166807-06:00","updated_at":"2025-12-19T15:32:08.46169-06:00","closed_at":"2025-12-06T22:10:11.275536-06:00","labels":["deployment","infrastructure","qdrant"],"dependencies":[{"issue_id":"engram-375","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.167296-06:00","created_by":"daemon"}]}
{"id":"engram-376","title":"Define CI/CD Pipeline","description":"Google Cloud Build configuration (cloudbuild.yaml). See docs/bitemporal/context/system-infrastructure/define-cicd-pipeline.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T21:48:16.210169-06:00","updated_at":"2025-12-19T15:32:08.461986-06:00","closed_at":"2025-12-06T22:11:16.052426-06:00","labels":["cicd","gcp","infrastructure"],"dependencies":[{"issue_id":"engram-376","depends_on_id":"engram-369","type":"parent-child","created_at":"2025-12-06T21:48:16.210608-06:00","created_by":"daemon"}]}
{"id":"engram-377","title":"MEDIUM: MCP client connections never disconnected","description":"Location: apps/control/src/tools/mcp_client.ts:16-22\n\nThe McpToolAdapter creates MCP client connections via StdioClientTransport (spawns child processes) but provides no disconnect() method. On shutdown, child processes and connections are never closed.\n\nImpact: Resource leaks and zombie processes.\n\nFix: Add disconnect() method and call it in SIGTERM/SIGINT handlers.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:57:00.115588-06:00","updated_at":"2025-12-19T15:32:08.462255-06:00","closed_at":"2025-12-19T00:59:10.886989-06:00"}
{"id":"engram-378","title":"MEDIUM: ReDoS risk in phone regex","description":"Location: packages/ingestion-core/src/redactor.ts:45\n\nThe phone regex has nested optional groups with catastrophic backtracking potential on certain inputs.\n\nImpact: Performance degradation on crafted inputs in high-throughput scenarios.\n\nFix: Simplify regex or use phone parsing library as suggested in comments.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:25.222214-06:00","updated_at":"2025-12-19T15:32:08.462488-06:00","closed_at":"2025-12-19T00:39:58.198725-06:00"}
{"id":"engram-379","title":"Add Test Coverage: packages/vfs","description":"Add comprehensive unit and integration tests for packages/vfs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T08:00:00-06:00","updated_at":"2025-12-19T15:32:08.462698-06:00","closed_at":"2025-12-07T02:02:43.860444-06:00","labels":["packages","testing","vfs"]}
{"id":"engram-38","title":"P6: Implement learned fusion inference","description":"Use trained MLP to predict fusion weights at inference time.\n\n## Context\n- Plan: docs/plans/retrieval-v2/06-learned-fusion.md\n- Predictor: lines 95-140 (FusionWeightPredictor class)\n- LearnedFusion: lines 145-180\n\n## Tasks\n1. Create FusionWeightPredictor with ONNX runtime\n2. Implement LearnedFusion class\n3. Build score map across dense/sparse/rerank\n4. Apply predicted weights for final ranking\n5. Add --learned-fusion CLI flag\n\n## Expected Impact\n- +1-2% overall accuracy\n- Reduced query-type variance\n- +3-5% retrieval recall\n\n## Dependencies\n- Requires: P6 query features (previous)\n- Requires: P6 MLP training (previous)\n\n## References\n- Inference code: lines 95-140\n- Success metrics: lines 290-295","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T21:39:32.565448-06:00","updated_at":"2025-12-19T15:32:08.353212-06:00","closed_at":"2025-12-19T00:11:57.810974-06:00","dependencies":[{"issue_id":"engram-38","depends_on_id":"engram-255","type":"blocks","created_at":"2025-12-18T21:40:49.65266-06:00","created_by":"ccheney"}]}
{"id":"engram-39","title":"LOW: Unreachable code in protocol detection","description":"Location: packages/ingestion-core/src/protocol.ts:23-25\n\nThe Azure OpenAI check is unreachable because the previous condition on line 18 returns early on the same condition.\n\nFix: Restructure logic to check more specific case first.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:43.627699-06:00","updated_at":"2025-12-19T15:32:08.353512-06:00","closed_at":"2025-12-18T21:47:22.601412-06:00"}
{"id":"engram-39l8","title":"Create WebSocket server routes","description":"app/api/ws/[...path]/route.ts - WebSocket endpoints for real-time log streaming and metrics updates","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:31.883612-05:00","updated_at":"2025-12-27T04:22:31.883612-05:00"}
{"id":"engram-3ddj","title":"[CRITICAL] Post-destroy logging not prevented in logger","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:02.334943-06:00","updated_at":"2025-12-20T23:45:30.485844-06:00","closed_at":"2025-12-20T23:45:30.485844-06:00"}
{"id":"engram-3gc4","title":"[Benchmark-Py] Phase 2a: LLM Integration","description":"Implement LLM provider using LiteLLM for unified access to 100+ providers. Port Reader with Chain-of-Note reasoning (~+10 points QA). Implement three-layer abstention detection (retrieval confidence, NLI grounding, hedging detection). Structured output parsing with Pydantic. Cost tracking for LLM calls.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 2: LLM Integration)\n\nDeliverables:\n- src/engram_benchmark/providers/llm.py - LiteLLM wrapper\n- src/engram_benchmark/longmemeval/reader.py - Answer generation\n- Chain-of-Note prompt templates\n- Abstention detection (3-layer)\n- Confidence calibration\n- Cost tracking per provider\n- Unit tests with mock LLM\n\nCAN BE DEVELOPED IN PARALLEL WITH: [Benchmark-Py] Phase 2b: Retrieval, Phase 2c: Metrics","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:23:51.371032-06:00","updated_at":"2025-12-20T08:20:23.446732-06:00","closed_at":"2025-12-20T08:20:23.446732-06:00","dependencies":[{"issue_id":"engram-3gc4","depends_on_id":"engram-fpr1","type":"blocks","created_at":"2025-12-20T07:24:59.874374-06:00","created_by":"ccheney"}]}
{"id":"engram-3i95","title":"Add heartbeat/ping-pong to useWebSocket hook","description":"## Problem\n\nThe `useWebSocket` hook at `apps/interface/app/hooks/useWebSocket.ts` has no heartbeat mechanism to detect stale/dead connections. This is the most critical robustness gap.\n\n### Why This Matters\n\n1. **Browser limitation**: The WebSocket API in browsers doesn't expose the native Ping/Pong frames defined in RFC 6455. Browsers don't enable keepalive by default.\n\n2. **Silent failures**: A WebSocket connection can appear open (`readyState === OPEN`) while the underlying TCP connection is actually dead. The browser won't fire a `close` event until TCP times out, which can take **minutes**.\n\n3. **User experience**: Users may think they're connected and sending messages, but nothing is actually being transmitted.\n\n## Evidence\n\nFrom the websockets library documentation:\n\u003e 'Browsers don't enable a keepalive mechanism like websockets by default. As a consequence, they can fail to notice that a WebSocket connection is broken for an extended period of time, until the TCP connection times out. In this scenario, the WebSocket object in the browser doesn't fire a close event.'\n\n## Recommended Solution\n\nImplement application-level heartbeat with configurable options:\n\n```typescript\ninterface HeartbeatOptions {\n  /** Message to send as ping (e.g., 'ping' or JSON) */\n  message: string;\n  /** Expected response from server */\n  returnMessage?: string;\n  /** Interval between pings in ms (recommended: 20000-30000) */\n  interval: number;\n  /** Timeout to wait for pong before considering connection dead */\n  timeout: number;\n}\n```\n\nImplementation pattern:\n1. After connection opens, start interval timer sending ping messages\n2. Track last pong received timestamp\n3. If no pong received within timeout, force close and trigger reconnect\n4. Clear timers on close/unmount\n\nSocket.IO uses this pattern: 'At a given interval (pingInterval) the server sends a PING packet and the client has a few seconds (pingTimeout) to send a PONG packet back.'\n\n## References\n\n- [Keepalive and latency - websockets documentation](https://websockets.readthedocs.io/en/stable/topics/keepalive.html)\n- [Understanding Ping Pong Frame WebSocket (2025)](https://www.videosdk.live/developer-hub/websocket/ping-pong-frame-websocket)\n- [Socket.IO heartbeat mechanism](https://socket.io/docs/v4/how-it-works/)\n- [websocket-heartbeat-js npm package](https://www.npmjs.com/package/websocket-heartbeat-js)\n- [react-use-websocket heartbeat options](https://github.com/robtaussig/react-use-websocket)\n- [WHATWG WebSocket ping API discussion](https://github.com/whatwg/html/issues/4353)\n\n## Priority\n\n**High** - This is the most critical missing feature. Without heartbeat, the hook cannot reliably detect silent connection failures.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T20:41:26.874641-06:00","updated_at":"2025-12-20T23:07:49.465232-06:00","closed_at":"2025-12-20T23:07:49.465232-06:00"}
{"id":"engram-3ip4","title":"Create EnvironmentSwitcher UI component","description":"Tremor Select + TextInput for environment switching, connection status badge, keyboard shortcut Cmd+E. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:13.334142-05:00","updated_at":"2025-12-27T16:41:56.903059-05:00","closed_at":"2025-12-27T16:41:56.903059-05:00","dependencies":[{"issue_id":"engram-3ip4","depends_on_id":"engram-bc25","type":"blocks","created_at":"2025-12-27T04:25:38.521725-05:00","created_by":"ccheney"}]}
{"id":"engram-3l5a","title":"Test coverage: packages/infra/src/k8s/falkordb.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:53.609724-06:00","updated_at":"2025-12-21T04:07:03.757319-06:00","closed_at":"2025-12-21T04:07:03.757319-06:00"}
{"id":"engram-3mjo","title":"Fix test failures after Bun test runner migration","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-23T02:12:34.386875-05:00","updated_at":"2025-12-23T02:46:26.947216-05:00","closed_at":"2025-12-23T02:46:26.947216-05:00"}
{"id":"engram-3p5n","title":"[HIGH] Blob path traversal incomplete in packages/storage","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:25.616776-06:00","updated_at":"2025-12-20T23:58:50.321308-06:00","closed_at":"2025-12-20T23:58:50.321308-06:00"}
{"id":"engram-3xez","title":"Create NATS stream initialization script","description":"Create script to initialize JetStream streams on startup.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 3: Stream Initialization Script\n\n## Implementation\nCreate scripts/init-nats-streams.ts:\n- EVENTS stream (subjects: events.\u003e)\n- MEMORY stream (subjects: memory.\u003e)  \n- DLQ stream (subjects: dlq.\u003e)\n- All with workqueue retention and file storage\n\n## Acceptance Criteria\n- Script runs successfully against NATS\n- All 3 streams created\n- Can verify via nats CLI or HTTP API","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:25:58.858669-05:00","updated_at":"2025-12-22T00:42:57.639528-05:00","closed_at":"2025-12-22T00:42:57.639528-05:00","dependencies":[{"issue_id":"engram-3xez","depends_on_id":"engram-v4sh","type":"blocks","created_at":"2025-12-22T00:28:47.154907-05:00","created_by":"ccheney"}]}
{"id":"engram-3xfz","title":"Test coverage: apps/mcp/src/capabilities/elicitation.ts (81%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:58.645371-06:00","updated_at":"2025-12-21T04:07:03.756138-06:00","closed_at":"2025-12-21T04:07:03.756138-06:00"}
{"id":"engram-3xin3","title":"Integration tests for community detection","description":"Create apps/worker/src/__tests__/community-detector.integration.test.ts. Test: create entities with relationships in FalkorDB, trigger detection job, verify Community nodes created with correct membership, verify summarization triggered.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:19.586546-06:00","updated_at":"2026-01-01T16:50:19.586546-06:00","dependencies":[{"issue_id":"engram-3xin3","depends_on_id":"engram-htgl2","type":"blocks","created_at":"2026-01-01T16:52:28.310107-06:00","created_by":"ccheney"}]}
{"id":"engram-3yru","title":"[CRITICAL] Race condition in extractor cleanup (apps/ingestion)","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:43.546987-06:00","updated_at":"2025-12-20T23:45:30.480473-06:00","closed_at":"2025-12-20T23:45:30.480473-06:00"}
{"id":"engram-3zhm","title":"Remove unused instanceId from logger BaseLogContext","description":"packages/logger types.ts:10 defines instanceId in BaseLogContext but it is never populated anywhere in the codebase.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:16:57.485686-06:00","updated_at":"2025-12-20T23:21:09.195788-06:00","closed_at":"2025-12-20T23:21:09.195788-06:00"}
{"id":"engram-3ztj","title":"Implement or remove GraphQL endpoint","description":"apps/interface has /api/graphql/schema.ts defined but /api/graphql/route.ts has no implementation. Either complete or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:15:09.901485-06:00","updated_at":"2025-12-20T23:25:54.583565-06:00","closed_at":"2025-12-20T23:25:54.583565-06:00"}
{"id":"engram-4","title":"LOW: applySearchReplace only replaces first match","description":"Location: packages/vfs/src/patch.ts:44-51\n\nThe method uses String.replace() which only replaces the first occurrence. Users may expect all occurrences to be replaced.\n\nFix: Document behavior or add replaceAll option.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:49.083405-06:00","updated_at":"2025-12-19T15:32:08.341296-06:00","closed_at":"2025-12-18T21:47:37.309655-06:00"}
{"id":"engram-40","title":"Implement Graph Edge Writer","description":"Service to write edges with temporal props. See docs/bitemporal/context/bitemporal-memory/implement-graph-edge-writer.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.676429-06:00","updated_at":"2025-12-19T15:32:08.353744-06:00","closed_at":"2025-12-06T22:25:23.009858-06:00","labels":["cypher","memory","writer"],"dependencies":[{"issue_id":"engram-40","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.676784-06:00","created_by":"daemon"}]}
{"id":"engram-40bx","title":"[MEDIUM] XAI parser type conflict","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:26.557559-06:00","updated_at":"2025-12-21T00:09:56.47879-06:00","closed_at":"2025-12-21T00:09:56.47879-06:00"}
{"id":"engram-41","title":"Implement Graph Node Writer","description":"Service to write nodes with current transaction time. See docs/bitemporal/context/bitemporal-memory/implement-graph-node-writer.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.633077-06:00","updated_at":"2025-12-19T15:32:08.354368-06:00","closed_at":"2025-12-06T22:25:22.979018-06:00","labels":["cypher","memory","writer"],"dependencies":[{"issue_id":"engram-41","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.63344-06:00","created_by":"daemon"}]}
{"id":"engram-41sa","title":"Define Engram schema using new DSL","description":"Create the full Engram schema definition using the new Schema DSL\n\n## Overview\nThis task defines all existing Engram node and edge types using the new Schema DSL. It serves as both validation of the DSL design and the actual schema that will drive code generation.\n\n## Requirements\n- Define all 15+ node types from packages/graph/src/models/nodes.ts\n- Define all 12+ edge types from packages/graph/src/models/edges.ts\n- Use field types for all properties\n- Include bitemporal metadata\n- Maintain backward compatibility with existing data\n\n## Node Types to Define\n| Node | Key Properties |\n|------|---------------|\n| Session | user_id, started_at, working_dir, agent_type, summary, embedding |\n| Turn | user_content, assistant_preview, embedding, sequence_index, files_touched |\n| Reasoning | content_hash, preview, blob_ref, reasoning_type |\n| ToolCall | call_id, tool_name, tool_type, arguments_json, status |\n| Observation | content, is_error, error_type, execution_time_ms |\n| FileTouch | file_path, action, diff tracking |\n| CodeArtifact | filename, language, blob_ref |\n| DiffHunk | file_path, original_line_start/end, patch_content |\n| Snapshot | vfs_state_blob_ref, state_hash |\n| Memory | content, type, tags, source, embedding |\n| Entity | name, aliases, type, description, embedding |\n\n## Edge Types to Define\nHAS_TURN, NEXT, CONTAINS, INVOKES, TRIGGERS, TOUCHES, YIELDS, MODIFIES, SNAPSHOT_OF, REPLACES, SAME_AS, SELF_INVOKES, MENTIONS, RELATED_TO\n\n## Research Required\nReview existing implementations:\n- packages/graph/src/models/nodes.ts (current Zod schemas)\n- packages/graph/src/models/edges.ts (current edge constants)\n- packages/graph/src/models/base.ts (bitemporal schema)\n\nUse web search for:\n- 'Graph database schema design best practices'\n- 'FalkorDB data modeling patterns'\n\n## Validation\n- Compare generated types against existing Zod schemas\n- Ensure all current queries remain valid\n- Run existing tests to verify compatibility\n\n## Files\n- packages/graph/src/schema/engram-schema.ts (NEW)\n\n## References\n- Current nodes: packages/graph/src/models/nodes.ts\n- Current edges: packages/graph/src/models/edges.ts\n- Plan: docs/plans/compiled-query-layer.md lines 72-159","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:23.888154-06:00","updated_at":"2026-01-01T18:09:28.055148-06:00","closed_at":"2026-01-01T18:09:28.055148-06:00","dependencies":[{"issue_id":"engram-41sa","depends_on_id":"engram-0v41","type":"blocks","created_at":"2026-01-01T16:54:31.376972-06:00","created_by":"ccheney"}]}
{"id":"engram-42","title":"Create Blob Storage Adapter","description":"Adapter for offloading large text to FS/GCS. See docs/bitemporal/context/bitemporal-memory/create-blob-storage-adapter.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.590197-06:00","updated_at":"2025-12-19T15:32:08.354822-06:00","closed_at":"2025-12-06T22:25:00.383424-06:00","labels":["blob","memory","storage"],"dependencies":[{"issue_id":"engram-42","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.590608-06:00","created_by":"daemon"}]}
{"id":"engram-42ty","title":"Test coverage: apps/memory/src/handlers/usage.handler.ts (92%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:22.341032-06:00","updated_at":"2025-12-21T04:07:03.76602-06:00","closed_at":"2025-12-21T04:07:03.76602-06:00"}
{"id":"engram-42up","title":"Add /conflict-candidates endpoint to search service","description":"Add POST /v1/search/conflict-candidates to apps/search/src/api/routes.py: embed content, query Qdrant with score_threshold=0.65, filter by org_id and optional project, return top 10 candidates","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:53.92053-06:00","updated_at":"2026-01-01T18:00:55.973997-06:00","closed_at":"2026-01-01T18:00:55.973997-06:00","dependencies":[{"issue_id":"engram-42up","depends_on_id":"engram-h2o8","type":"blocks","created_at":"2026-01-01T16:45:10.183296-06:00","created_by":"ccheney"}]}
{"id":"engram-43","title":"Implement FalkorDB Connection Manager","description":"Redis client wrapper ensuring graph module is loaded. See docs/bitemporal/context/bitemporal-memory/implement-falkordb-connection-manager.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.502096-06:00","updated_at":"2025-12-19T15:32:08.355169-06:00","closed_at":"2025-12-06T22:16:16.310599-06:00","labels":["infrastructure","memory","redis"],"dependencies":[{"issue_id":"engram-43","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.502466-06:00","created_by":"daemon"}]}
{"id":"engram-43w7o","title":"Automatic Memory Invalidation","description":"Phase 1: Real-time conflict detection and vt_end closure when memories become outdated or contradicted. Detects conflicts during remember operations, asks user for confirmation via elicitation, and invalidates superseded memories. See docs/plans/automatic-memory-invalidation.md","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-01T17:04:49.90582-06:00","updated_at":"2026-01-01T17:04:49.90582-06:00"}
{"id":"engram-44","title":"Define Standard Edge Schemas","description":"Zod schemas for NEXT, TRIGGERS, MODIFIES, etc. See docs/bitemporal/context/bitemporal-memory/define-standard-edge-schemas.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.459816-06:00","updated_at":"2025-12-19T15:32:08.355559-06:00","closed_at":"2025-12-06T22:18:30.892085-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-44","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.460217-06:00","created_by":"daemon"}]}
{"id":"engram-45","title":"Define Snapshot Node Schema","description":"Zod schema for SnapshotNode (VFS state). See docs/bitemporal/context/bitemporal-memory/define-snapshot-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.414833-06:00","updated_at":"2025-12-19T15:32:08.355931-06:00","closed_at":"2025-12-06T22:18:30.865327-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-45","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.415209-06:00","created_by":"daemon"}]}
{"id":"engram-46","title":"Define Observation Node Schema","description":"Zod schema for ObservationNode. See docs/bitemporal/context/bitemporal-memory/define-observation-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.372577-06:00","updated_at":"2025-12-19T15:32:08.356291-06:00","closed_at":"2025-12-06T22:18:30.835872-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-46","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.372993-06:00","created_by":"daemon"}]}
{"id":"engram-46ks","title":"Register engram-console OAuth client (admin scopes)","description":"Register engram-console as OAuth client for Console admin access.\n\n**Prerequisites:** Run seed-oauth-clients.ts script from engram-h44m\n\n**Client configuration:**\n- client_id: engram-console\n- scopes: * (admin - all scopes)\n- grant_types: client_credentials\n- token_endpoint_auth_method: client_secret_basic\n\n**Environment variables to set:**\n```bash\n# In apps/console/.env.local\nENGRAM_CLIENT_ID=engram-console\nENGRAM_CLIENT_SECRET=\u003cfrom seed script output\u003e\nENGRAM_AUTH_URL=http://localhost:6178\n```\n\n**Console usage:**\nThe Next.js console app uses server-side API routes that need admin access to all Engram APIs.\n\n**Files to update:**\n- `apps/console/.env.example` - add new env vars\n- `docker-compose.dev.yml` - add console service env\n\n**Subagent instructions:**\n- Verify seed script ran successfully first\n- Check client exists with admin scope\n- Update Next.js env example","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:52:54.118996-06:00","updated_at":"2025-12-29T16:41:52.613646-06:00","closed_at":"2025-12-29T16:41:52.613646-06:00","dependencies":[{"issue_id":"engram-46ks","depends_on_id":"engram-h44m","type":"blocks","created_at":"2025-12-29T15:58:19.177011-06:00","created_by":"ccheney"}]}
{"id":"engram-47","title":"Define DiffHunk Node Schema","description":"Zod schema for DiffHunkNode. See docs/bitemporal/context/bitemporal-memory/define-diff-hunk-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.330499-06:00","updated_at":"2025-12-19T15:32:08.356647-06:00","closed_at":"2025-12-06T22:18:30.807637-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-47","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.33086-06:00","created_by":"daemon"}]}
{"id":"engram-47jc","title":"Add egm_client token pattern to packages/common/src/types/auth.ts","description":"Add the egm_client token pattern for M2M/service authentication.\n\n**File to modify:** `packages/common/src/types/auth.ts`\n\n**Add pattern:**\n```typescript\nexport const CLIENT_TOKEN_PATTERN = /^egm_client_[a-f0-9]{32}_[a-zA-Z0-9]{6}$/;\n```\n\n**Token format:** `egm_client_{random32}_{crc6}`\n- `egm`: Engram identifier (3 chars)\n- `client`: Token type for M2M/service tokens\n- `random32`: 32 hex characters (128 bits entropy)\n- `crc6`: 6 Base62 characters (CRC32 checksum)\n\n**Context:**\n- Existing patterns: `OAUTH_TOKEN_PATTERN`, `REFRESH_TOKEN_PATTERN` in same file\n- CRC32 validation function: `validateTokenChecksum()` in `apps/observatory/lib/device-auth.ts:1`\n- Token generation: `generateOAuthToken()` in same file\n\n**References:**\n- OAuth 2.1 Client Credentials: https://oauth.net/2/grant-types/client-credentials/\n- RFC 6749 §4.4: https://tools.ietf.org/html/rfc6749#section-4.4\n- GitHub token format inspiration: https://github.blog/engineering/platform-security/behind-githubs-new-authentication-token-formats/\n\n**Subagent instructions:**\n- Use Context7 MCP to check current TypeScript regex best practices\n- Web search \"OAuth 2.1 client token format 2025\" for latest standards\n- Run `bun run typecheck` after changes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:51:35.479254-06:00","updated_at":"2025-12-29T16:22:25.252299-06:00","closed_at":"2025-12-29T16:22:25.252299-06:00"}
{"id":"engram-47r4","title":"[HIGH] Resource leak in EmbeddingProvider","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:23.963229-06:00","updated_at":"2025-12-21T00:00:08.275197-06:00","closed_at":"2025-12-21T00:00:08.275197-06:00"}
{"id":"engram-48","title":"Define CodeArtifact Node Schema","description":"Zod schema for CodeArtifactNode. See docs/bitemporal/context/bitemporal-memory/define-code-artifact-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.288416-06:00","updated_at":"2025-12-19T15:32:08.357002-06:00","closed_at":"2025-12-06T22:18:30.780787-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-48","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.288799-06:00","created_by":"daemon"}]}
{"id":"engram-49","title":"Define ToolCall Node Schema","description":"Zod schema for ToolCallNode. See docs/bitemporal/context/bitemporal-memory/define-tool-call-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.243789-06:00","updated_at":"2025-12-19T15:32:08.359032-06:00","closed_at":"2025-12-06T22:18:30.751907-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-49","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.244099-06:00","created_by":"daemon"}]}
{"id":"engram-4ba1","title":"[HIGH] Missing fetch timeouts in apps/mcp","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:12.4322-06:00","updated_at":"2025-12-20T23:57:48.169038-06:00","closed_at":"2025-12-20T23:57:48.169038-06:00"}
{"id":"engram-4bj9","title":"[HIGH] Set.union ES2025 compatibility issue in logger","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:17.823192-06:00","updated_at":"2025-12-20T23:56:07.533147-06:00","closed_at":"2025-12-20T23:56:07.533147-06:00"}
{"id":"engram-4eb4","title":"[Console Redesign] Migrate Performance page to shadcn","description":"## Overview\nMigrate the Performance page with percentile cards, latency histogram, and strategy comparison.\n\n## Target Page\n- apps/console/app/(dashboard)/performance/page.tsx\n\n## Components to Migrate\n\n### Percentile Cards with Sparklines\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-4\"\u003e\n  {percentiles.map((p) =\u003e (\n    \u003cCard key={p.name}\u003e\n      \u003cCardHeader className=\"pb-2\"\u003e\n        \u003cCardTitle className=\"text-sm font-medium\"\u003e{p.name}\u003c/CardTitle\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cdiv className=\"text-2xl font-bold\"\u003e{p.value}ms\u003c/div\u003e\n        \u003cBadge variant={getTrendVariant(p.trend)} className=\"mt-1\"\u003e\n          {p.trend \u003e 0 ? '+' : ''}{p.trend}%\n        \u003c/Badge\u003e\n        \u003cChartContainer config={chartConfig} className=\"h-[40px] mt-2\"\u003e\n          \u003cAreaChart data={p.history}\u003e\n            \u003cArea dataKey=\"value\" fill=\"var(--chart-1)\" /\u003e\n          \u003c/AreaChart\u003e\n        \u003c/ChartContainer\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  ))}\n\u003c/div\u003e\n```\n\n### Time Range Selector\n```tsx\n\u003cdiv className=\"flex items-center gap-2\"\u003e\n  {/* Desktop: ToggleGroup */}\n  \u003cToggleGroup type=\"single\" value={timeRange} onValueChange={setTimeRange} className=\"hidden md:flex\"\u003e\n    \u003cToggleGroupItem value=\"1h\"\u003e1H\u003c/ToggleGroupItem\u003e\n    \u003cToggleGroupItem value=\"6h\"\u003e6H\u003c/ToggleGroupItem\u003e\n    \u003cToggleGroupItem value=\"24h\"\u003e24H\u003c/ToggleGroupItem\u003e\n    \u003cToggleGroupItem value=\"7d\"\u003e7D\u003c/ToggleGroupItem\u003e\n  \u003c/ToggleGroup\u003e\n  \n  {/* Mobile: Select */}\n  \u003cSelect value={timeRange} onValueChange={setTimeRange} className=\"md:hidden\"\u003e\n    \u003cSelectTrigger className=\"w-[100px]\"\u003e\n      \u003cSelectValue /\u003e\n    \u003c/SelectTrigger\u003e\n    \u003cSelectContent\u003e\n      \u003cSelectItem value=\"1h\"\u003e1 Hour\u003c/SelectItem\u003e\n      \u003cSelectItem value=\"6h\"\u003e6 Hours\u003c/SelectItem\u003e\n      \u003cSelectItem value=\"24h\"\u003e24 Hours\u003c/SelectItem\u003e\n      \u003cSelectItem value=\"7d\"\u003e7 Days\u003c/SelectItem\u003e\n    \u003c/SelectContent\u003e\n  \u003c/Select\u003e\n\u003c/div\u003e\n```\n\n### Latency Histogram\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eLatency Distribution\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent\u003e\n    \u003cChartContainer config={chartConfig} className=\"h-[300px]\"\u003e\n      \u003cBarChart data={histogramData}\u003e\n        \u003cCartesianGrid strokeDasharray=\"3 3\" /\u003e\n        \u003cXAxis dataKey=\"bucket\" /\u003e\n        \u003cYAxis /\u003e\n        \u003cChartTooltip content={\u003cChartTooltipContent /\u003e} /\u003e\n        \u003cBar dataKey=\"count\" fill=\"var(--chart-1)\" /\u003e\n      \u003c/BarChart\u003e\n    \u003c/ChartContainer\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n### Strategy Comparison Chart\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cdiv className=\"flex items-center justify-between\"\u003e\n      \u003cCardTitle\u003eSearch Strategy Performance\u003c/CardTitle\u003e\n      \u003cdiv className=\"flex gap-2\"\u003e\n        \u003cBadge variant=\"outline\" style={{ borderColor: \"var(--chart-1)\" }}\u003eDense\u003c/Badge\u003e\n        \u003cBadge variant=\"outline\" style={{ borderColor: \"var(--chart-2)\" }}\u003eSparse\u003c/Badge\u003e\n        \u003cBadge variant=\"outline\" style={{ borderColor: \"var(--chart-3)\" }}\u003eHybrid\u003c/Badge\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent\u003e\n    \u003cChartContainer config={chartConfig} className=\"h-[300px]\"\u003e\n      \u003cAreaChart data={strategyData}\u003e\n        \u003cArea dataKey=\"dense\" stroke=\"var(--chart-1)\" fill=\"var(--chart-1)\" fillOpacity={0.2} /\u003e\n        \u003cArea dataKey=\"sparse\" stroke=\"var(--chart-2)\" fill=\"var(--chart-2)\" fillOpacity={0.2} /\u003e\n        \u003cArea dataKey=\"hybrid\" stroke=\"var(--chart-3)\" fill=\"var(--chart-3)\" fillOpacity={0.2} /\u003e\n        \u003cChartTooltip content={\u003cChartTooltipContent /\u003e} /\u003e\n        \u003cChartLegend content={\u003cChartLegendContent /\u003e} /\u003e\n      \u003c/AreaChart\u003e\n    \u003c/ChartContainer\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n## Components to Use\n- Card (containers)\n- Badge (trend indicators, legend)\n- ToggleGroup (desktop time range)\n- Select (mobile time range)\n- ChartContainer + BarChart (histogram)\n- ChartContainer + AreaChart (strategy comparison)\n- ChartTooltip, ChartLegend\n\n## Reference\n- shadcn chart: https://ui.shadcn.com/docs/components/chart\n- chart-bar-default, chart-area-stacked examples\n\n## Acceptance Criteria\n- [ ] Percentile cards with sparklines\n- [ ] Responsive time range selector\n- [ ] Latency histogram bar chart\n- [ ] Strategy comparison multi-line chart\n- [ ] Legend with color indicators\n- [ ] Tooltips on hover","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:49:40.219048-06:00","updated_at":"2025-12-28T17:45:28.480746-06:00","closed_at":"2025-12-28T17:45:28.480746-06:00","dependencies":[{"issue_id":"engram-4eb4","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:48.792187-06:00","created_by":"ccheney"}]}
{"id":"engram-4f18","title":"Drop api_keys and api_usage tables from database schema","description":"Remove legacy database tables from the schema initialization file at apps/api/src/db/init.sql. Delete the CREATE TABLE statements for: (1) api_keys table (stored API key tokens, user_id, scopes, rate limits, creation/expiry timestamps, revocation status), and (2) api_usage table (tracked API usage metrics per key for rate limiting enforcement). Also remove any associated indexes (e.g., idx_api_keys_key_hash, idx_api_usage_window) and foreign key constraints. These tables are obsolete after migrating to OAuth 2.1 device flow where tokens are validated via introspection against the Observatory service, not database lookups. IMPORTANT: This is a direct schema modification in init.sql, NOT a migration script - the database will be recreated from scratch. After making changes, reset the local database by running 'bun run infra:down' followed by 'bun run infra:up' to recreate containers with the new schema.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:55:24.149561-06:00","updated_at":"2025-12-29T17:07:05.36127-06:00","closed_at":"2025-12-29T17:07:05.36127-06:00","dependencies":[{"issue_id":"engram-4f18","depends_on_id":"engram-l7xa","type":"blocks","created_at":"2025-12-29T16:02:32.184726-06:00","created_by":"ccheney"},{"issue_id":"engram-4f18","depends_on_id":"engram-66be","type":"blocks","created_at":"2025-12-29T16:02:37.33025-06:00","created_by":"ccheney"}]}
{"id":"engram-4hd8","title":"[Benchmark-Py] Phase 3: Pipeline \u0026 Reporting","description":"Implement end-to-end benchmark pipeline with async orchestration. Port BenchmarkPipeline with stages: Load → Map → Index → Retrieve → Read → Evaluate. Rich progress bars for terminal output. Key expansion for +9% recall improvement. Temporal query analysis for +7-11% TR. Markdown and JSON report generation.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 5: Pipeline)\n\nDeliverables:\n- src/engram_benchmark/longmemeval/pipeline.py - Async orchestration\n- src/engram_benchmark/longmemeval/mapper.py - Document mapping\n- src/engram_benchmark/longmemeval/key_expansion.py - Fact extraction\n- src/engram_benchmark/longmemeval/temporal.py - Time-aware queries\n- src/engram_benchmark/utils/progress.py - Rich progress bars\n- src/engram_benchmark/utils/reporting.py - Markdown/JSON reports\n- 'engram-benchmark run longmemeval' command working\n- End-to-end integration tests","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:24:30.832338-06:00","updated_at":"2025-12-20T09:48:45.670899-06:00","closed_at":"2025-12-20T09:48:45.670899-06:00","dependencies":[{"issue_id":"engram-4hd8","depends_on_id":"engram-3gc4","type":"blocks","created_at":"2025-12-20T07:25:20.45985-06:00","created_by":"ccheney"},{"issue_id":"engram-4hd8","depends_on_id":"engram-0azz","type":"blocks","created_at":"2025-12-20T07:25:25.621764-06:00","created_by":"ccheney"},{"issue_id":"engram-4hd8","depends_on_id":"engram-916x","type":"blocks","created_at":"2025-12-20T07:25:30.767983-06:00","created_by":"ccheney"}]}
{"id":"engram-4jex","title":"Create Container List component","description":"Table with name, image, status, CPU/memory %, restart count, actions. MUST use frontend-design skill for UI implementation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:21:26.78843-05:00","updated_at":"2025-12-27T04:21:26.78843-05:00","dependencies":[{"issue_id":"engram-4jex","depends_on_id":"engram-nddy","type":"blocks","created_at":"2025-12-27T04:26:47.516064-05:00","created_by":"ccheney"}]}
{"id":"engram-4kifs","title":"Unit tests for EntityRepository","description":"Unit tests for EntityRepository (FalkorDB implementation).\n\n## Test Cases\n\n### CRUD Operations\n```typescript\n// Create\nconst entity = await repo.create({name: 'PostgreSQL', type: 'technology'});\nexpect(entity.id).toBeDefined();\nexpect(entity.vt_start).toBeDefined();\n\n// Read\nconst found = await repo.findById(entity.id);\nexpect(found).toEqual(entity);\n\n// Update (merge)\nconst merged = await repo.merge(entity.id, {description: 'Relational database'});\nexpect(merged.description).toBe('Relational database');\n\n// Soft delete (close tt_end)\nawait repo.delete(entity.id);\nconst deleted = await repo.findById(entity.id);\nexpect(deleted).toBeNull();\n```\n\n### Graph Traversal\n```typescript\n// Setup: A -[RELATED_TO]-\u003e B -[RELATED_TO]-\u003e C\nconst related = await repo.findRelatedEntities(entityA.id, 2);\nexpect(related).toContainEqual(entityB);\nexpect(related).toContainEqual(entityC);\n\n// Depth 1 should only return B\nconst depth1 = await repo.findRelatedEntities(entityA.id, 1);\nexpect(depth1).toContainEqual(entityB);\nexpect(depth1).not.toContainEqual(entityC);\n```\n\n### Embedding Similarity Search\n```typescript\n// Create entities with embeddings\n// Search with similar embedding\nconst similar = await repo.findByEmbedding(queryEmbedding, 5, 0.8);\nexpect(similar.length).toBeGreaterThan(0);\nexpect(similar[0].name).toBe('PostgreSQL');\n```\n\n### Bitemporal Edge Creation\n```typescript\nawait repo.createMentionsEdge(memoryId, entityId, 'mentioned in context');\n// Verify edge has temporal fields\nconst edges = await repo.query('MATCH ()-[e:MENTIONS]-\u003e() RETURN e');\nexpect(edges[0].vt_start).toBeDefined();\n```\n\n### Tenant Isolation\n- Create entity in tenant A\n- Verify not visible in tenant B\n\n## Test Infrastructure\n- Use in-memory FalkorDB or test container\n- Clean up after each test\n\n## Research\n- FalkorDB testing: Web search 'FalkorDB test container integration testing'\n- Graph repository testing patterns: Use Context7 MCP for 'graph database repository test'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:51.586702-06:00","updated_at":"2026-01-01T18:33:49.381816-06:00","closed_at":"2026-01-01T18:33:49.381816-06:00","dependencies":[{"issue_id":"engram-4kifs","depends_on_id":"engram-cqo6t","type":"blocks","created_at":"2026-01-01T16:55:58.220439-06:00","created_by":"ccheney"},{"issue_id":"engram-4kifs","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:39.910572-06:00","created_by":"ccheney"}]}
{"id":"engram-4l62","title":"Create Logs Panel page","description":"Centralized log viewing page with LogViewer component. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:00.044039-05:00","updated_at":"2025-12-27T17:27:26.673073-05:00","closed_at":"2025-12-27T17:27:26.673073-05:00","dependencies":[{"issue_id":"engram-4l62","depends_on_id":"engram-889b","type":"blocks","created_at":"2025-12-27T04:28:19.862444-05:00","created_by":"ccheney"}]}
{"id":"engram-4lde","title":"Install @typescript/native-preview package","description":"Install @typescript/native-preview as devDependency in root package.json. This provides the tsgo CLI.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:37:46.035757-06:00","updated_at":"2025-12-20T22:29:44.524193-06:00","closed_at":"2025-12-20T22:29:44.524193-06:00","dependencies":[{"issue_id":"engram-4lde","depends_on_id":"engram-kr52","type":"blocks","created_at":"2025-12-20T21:39:00.080498-06:00","created_by":"ccheney"}]}
{"id":"engram-4ll5","title":"[CRITICAL] Unsafe type casting (as Record) throughout codebase","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:30.075611-06:00","updated_at":"2025-12-20T23:45:30.482585-06:00","closed_at":"2025-12-20T23:45:30.482585-06:00"}
{"id":"engram-4lry","title":"Create MetricCard component","description":"Tremor Card with metric value, sparkline chart, percentage badge for overview metrics (requests, errors, latency). MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:41.097276-05:00","updated_at":"2025-12-27T16:57:37.356454-05:00","closed_at":"2025-12-27T16:57:37.356454-05:00","dependencies":[{"issue_id":"engram-4lry","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:25:54.958163-05:00","created_by":"ccheney"}]}
{"id":"engram-4m9i","title":"[Observatory Auth] End-to-end testing and verification","description":"Test the complete authentication flow end-to-end. Reference: docs/observatory-auth-implementation-plan.md Testing Checklist. Tests: 1) Start local dev server, 2) Visit http://localhost:5000 - should redirect to /sign-in, 3) Click Continue with Google - should redirect to Google OAuth, 4) Complete Google sign-in - should redirect back to home page, 5) Verify session persists on page refresh, 6) Verify sign-out clears session and redirects to sign-in, 7) Test protected API routes return 401 without session, 8) Deploy to production and test OAuth callback URLs. DEPENDS ON: All other auth tasks must be complete.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:43:10.042716-05:00","updated_at":"2025-12-22T01:02:29.443661-05:00","closed_at":"2025-12-22T01:02:29.443661-05:00","dependencies":[{"issue_id":"engram-4m9i","depends_on_id":"engram-uqrv","type":"blocks","created_at":"2025-12-22T00:44:42.320367-05:00","created_by":"ccheney"},{"issue_id":"engram-4m9i","depends_on_id":"engram-rnes","type":"blocks","created_at":"2025-12-22T00:44:47.465483-05:00","created_by":"ccheney"},{"issue_id":"engram-4m9i","depends_on_id":"engram-hgid","type":"blocks","created_at":"2025-12-22T00:44:52.601043-05:00","created_by":"ccheney"},{"issue_id":"engram-4m9i","depends_on_id":"engram-5nsd","type":"blocks","created_at":"2025-12-22T00:44:57.741953-05:00","created_by":"ccheney"},{"issue_id":"engram-4m9i","depends_on_id":"engram-nhc2","type":"blocks","created_at":"2025-12-22T00:45:02.875494-05:00","created_by":"ccheney"},{"issue_id":"engram-4m9i","depends_on_id":"engram-xxc2","type":"blocks","created_at":"2025-12-22T00:45:08.011066-05:00","created_by":"ccheney"}]}
{"id":"engram-4pzx","title":"Test coverage: packages/tuner/src/executor/benchmark-types.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:47.077457-06:00","updated_at":"2025-12-21T01:43:18.911571-06:00","closed_at":"2025-12-21T01:43:18.911571-06:00"}
{"id":"engram-4qcq","title":"Add OAuth client credentials auth to apps/tuner/src/tuner/middleware/auth.py","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:54:01.259464-06:00","updated_at":"2025-12-29T16:51:26.231432-06:00","closed_at":"2025-12-29T16:51:26.231432-06:00","dependencies":[{"issue_id":"engram-4qcq","depends_on_id":"engram-xq1x","type":"blocks","created_at":"2025-12-29T15:59:58.329076-06:00","created_by":"ccheney"},{"issue_id":"engram-4qcq","depends_on_id":"engram-uxh4","type":"blocks","created_at":"2025-12-29T16:00:03.457983-06:00","created_by":"ccheney"},{"issue_id":"engram-4qcq","depends_on_id":"engram-vb58","type":"blocks","created_at":"2025-12-29T16:00:08.602902-06:00","created_by":"ccheney"}]}
{"id":"engram-4rit","title":"Support user and system roles in event parsing","description":"packages/events ParsedStreamEvent accepts role user/system but no parser ever populates them. Gemini returns null for user messages. Either support or remove from schema.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:16:25.463767-06:00","updated_at":"2025-12-20T23:25:09.639951-06:00","closed_at":"2025-12-20T23:25:09.639951-06:00"}
{"id":"engram-4suf","title":"Create Database Status Panels","description":"Cards for FalkorDB, Qdrant, PostgreSQL, NATS showing health and key metrics. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:21:32.723547-05:00","updated_at":"2025-12-27T17:00:11.365282-05:00","closed_at":"2025-12-27T17:00:11.365282-05:00","dependencies":[{"issue_id":"engram-4suf","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:26:35.661534-05:00","created_by":"ccheney"}]}
{"id":"engram-4u86","title":"Update AuthContext type with org fields","description":"Add orgId and orgSlug fields to AuthContext and related OAuth types.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'OAuth Token Structure' section (lines 363-396)\n\n## Implementation\nUpdate packages/common/src/types/auth.ts:\n- Add orgId: string to OAuthToken interface\n- Add orgSlug: string to OAuthToken interface\n- Update IntrospectionResponse with org_id, org_slug fields\n\n## Key Changes:\n```typescript\ninterface OAuthToken {\n    // ... existing fields\n    orgId: string;       // NEW: tenant identifier\n    orgSlug: string;     // NEW: for graph naming\n}\n\ninterface IntrospectionResponse {\n    // ... existing fields\n    org_id: string;      // NEW: tenant identifier\n    org_slug: string;    // NEW: for graph naming\n}\n```\n\n## Files to Modify\n- packages/common/src/types/auth.ts\n\n## Agent Instructions\nEnsure backward compatibility considerations. Use web search for RFC 7662 token introspection custom claims.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:16.505685-06:00","updated_at":"2025-12-29T22:27:18.21551-06:00","closed_at":"2025-12-29T22:27:18.21551-06:00","dependencies":[{"issue_id":"engram-4u86","depends_on_id":"engram-1pwm","type":"blocks","created_at":"2025-12-29T22:11:50.203767-06:00","created_by":"ccheney"}]}
{"id":"engram-4vnjv","title":"Add tests for apps/memory handlers","description":"Missing tests for memory event handlers:\n- handlers/content.handler.ts\n- handlers/control.handler.ts\n- handlers/diff.handler.ts\n- handlers/thought.handler.ts\n- handlers/tool-call.handler.ts\n- handlers/usage.handler.ts\n- handlers/registry.ts\n\nPriority: HIGH - Core memory aggregation pipeline","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:20:49.920379-06:00","updated_at":"2026-01-01T17:20:49.920379-06:00"}
{"id":"engram-4wzi","title":"Test coverage: packages/graph/src/pruner.ts (branches 95%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:47.938027-06:00","updated_at":"2025-12-21T04:07:03.758448-06:00","closed_at":"2025-12-21T04:07:03.758448-06:00"}
{"id":"engram-4y09","title":"Extract packages/websocket from Observatory","description":"Extract useWebSocket.ts and websocket-server.ts into shared package for reuse in Control Center","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:19:34.552985-05:00","updated_at":"2025-12-27T15:56:01.777591-05:00","closed_at":"2025-12-27T15:56:01.777591-05:00"}
{"id":"engram-5","title":"LOW: GraphPruner DELETE without DETACH will fail","description":"Location: packages/memory-core/src/pruner.ts:91-96\n\nThe pruner's delete query uses 'DELETE n' without 'DETACH', which will fail in FalkorDB if the nodes have relationships.\n\nFix: Change to 'DETACH DELETE n'.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:58:50.125276-06:00","updated_at":"2025-12-19T15:32:08.341591-06:00","closed_at":"2025-12-18T21:47:37.309334-06:00"}
{"id":"engram-50","title":"Define Thought Node Schema","description":"Zod schema for ThoughtNode including blob_ref. See docs/bitemporal/context/bitemporal-memory/define-thought-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.203394-06:00","updated_at":"2025-12-19T15:32:08.359572-06:00","closed_at":"2025-12-06T22:18:30.724027-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-50","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.203771-06:00","created_by":"daemon"}]}
{"id":"engram-5034","title":"Update packages/infra OpenTofu configs with OAuth client credentials","description":"Update OpenTofu (NOT Pulumi) infrastructure configs with OAuth service credentials.\n\n**Directory:** `packages/infra/`\n\n**Changes needed:**\n1. Add secret management for service client credentials\n2. Configure OAuth client_id and client_secret for each service\n3. Use OpenTofu's sensitive variable handling\n\n**Services to configure:**\n- engram-tuner: client_id + secret\n- engram-search: client_id + secret\n- engram-console: client_id + secret\n- engram-ingestion: client_id + secret\n\n**OpenTofu patterns:**\n```hcl\nvariable \"engram_tuner_client_secret\" {\n  type      = string\n  sensitive = true\n}\n\nresource \"kubernetes_secret\" \"engram_tuner_oauth\" {\n  metadata {\n    name = \"engram-tuner-oauth\"\n  }\n  data = {\n    ENGRAM_CLIENT_ID     = \"engram-tuner\"\n    ENGRAM_CLIENT_SECRET = var.engram_tuner_client_secret\n  }\n}\n```\n\n**References:**\n- OpenTofu sensitive variables: https://opentofu.org/docs/language/values/variables/#suppressing-values-in-cli-output\n- Kubernetes secrets with OpenTofu: https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/secret\n\n**Subagent instructions:**\n- Web search \"OpenTofu secrets management Kubernetes 2025\"\n- Read existing .tf files in packages/infra/\n- Do NOT use Pulumi patterns - we migrated to OpenTofu","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T16:12:36.704455-06:00","updated_at":"2025-12-29T16:59:27.743151-06:00","closed_at":"2025-12-29T16:59:27.743151-06:00","dependencies":[{"issue_id":"engram-5034","depends_on_id":"engram-j6pr","type":"blocks","created_at":"2025-12-29T16:12:52.025412-06:00","created_by":"ccheney"},{"issue_id":"engram-5034","depends_on_id":"engram-qeb4","type":"blocks","created_at":"2025-12-29T16:12:57.163802-06:00","created_by":"ccheney"}]}
{"id":"engram-50jiz","title":"Integration tests: Build-time validation","description":"Create integration tests for compile-time validation\n\n## Overview\nThese tests validate that the Bun build plugin correctly catches schema violations at build time. They verify error messages include helpful information.\n\n## Test Scenarios\n\n### 1. Invalid Node Label\n- Write query with typo in node label: `MATCH (m:Memry)`\n- Run bun build\n- Assert build fails\n- Verify error mentions 'Unknown node label: Memry'\n- Verify error includes file path and line number\n\n### 2. Invalid Property Name\n- Write query with invalid property: `m.userId` (should be `m.user_id`)\n- Run bun build\n- Assert build fails\n- Verify error mentions unknown property\n- Suggest correct property name if possible\n\n### 3. Valid Query Passes\n- Write query using generated query builder\n- Run bun build\n- Assert build succeeds\n\n### 4. Template Literal Query\n- Write query using template literal with parameters\n- Verify validation still works\n- Handle ${param} placeholders correctly\n\n## Test Setup\n```typescript\nimport { describe, test, expect } from 'bun:test';\nimport { spawn } from 'bun';\n\ndescribe('Build-Time Validation', () =\u003e {\n  test('invalid node label fails build', async () =\u003e {\n    // Create test file with invalid query\n    const testFile = '/tmp/test-invalid-label.ts';\n    await Bun.write(testFile, `\n      import { falkor } from '@engram/storage';\n      \n      async function test() {\n        return falkor.query(\\`MATCH (m:Memry {id: $id}) RETURN m\\`, { id: '123' });\n      }\n    `);\n    \n    // Run build\n    const proc = spawn(['bun', 'build', testFile], {\n      stderr: 'pipe',\n    });\n    \n    const exitCode = await proc.exited;\n    const stderr = await new Response(proc.stderr).text();\n    \n    expect(exitCode).not.toBe(0);\n    expect(stderr).toContain('Unknown node label: Memry');\n    expect(stderr).toContain('test-invalid-label.ts');\n  });\n\n  test('valid query builder passes build', async () =\u003e {\n    const testFile = '/tmp/test-valid-query.ts';\n    await Bun.write(testFile, `\n      import { Memory } from '@engram/graph/generated';\n      \n      async function test() {\n        return Memory.where({ type: 'decision' }).execute();\n      }\n    `);\n    \n    const proc = spawn(['bun', 'build', testFile]);\n    const exitCode = await proc.exited;\n    \n    expect(exitCode).toBe(0);\n  });\n});\n```\n\n## Research Required\nUse web search for:\n- 'Bun spawn process testing'\n- 'Testing build failures'\n- 'Compile-time validation testing patterns'\n\n## Files\n- packages/graph/src/integration/validation.integration.test.ts\n\n## References\n- Bun spawn: https://bun.sh/docs/api/spawn\n- Plan: docs/plans/compiled-query-layer.md lines 895-908","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:52:47.106419-06:00","updated_at":"2026-01-01T17:12:54.916805-06:00","dependencies":[{"issue_id":"engram-50jiz","depends_on_id":"engram-svaf6","type":"blocks","created_at":"2026-01-01T16:56:49.665142-06:00","created_by":"ccheney"}]}
{"id":"engram-51","title":"Define Session Node Schema","description":"Zod schema for SessionNode. See docs/bitemporal/context/bitemporal-memory/define-session-node-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.159325-06:00","updated_at":"2025-12-19T15:32:08.359974-06:00","closed_at":"2025-12-06T22:18:30.693836-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-51","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.159681-06:00","created_by":"daemon"}]}
{"id":"engram-52","title":"Define Base Node Model","description":"Zod schema for BaseNode with ULID and Bitemporal fields. See docs/bitemporal/context/bitemporal-memory/define-base-node-model.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.118314-06:00","updated_at":"2025-12-19T15:32:08.360304-06:00","closed_at":"2025-12-06T22:16:45.426168-06:00","labels":["memory","schema","zod"],"dependencies":[{"issue_id":"engram-52","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.118687-06:00","created_by":"daemon"}]}
{"id":"engram-52u4","title":"Test coverage: packages/tuner/src/executor/cache.ts (95%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:53.096288-06:00","updated_at":"2025-12-21T01:43:13.78332-06:00","closed_at":"2025-12-21T01:43:13.78332-06:00"}
{"id":"engram-53","title":"Implement Bitemporal Timestamp Logic","description":"Time utility for vt_start/end and tt_start/end logic. See docs/bitemporal/context/bitemporal-memory/implement-bitemporal-timestamp-logic.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.075239-06:00","updated_at":"2025-12-19T15:32:08.360617-06:00","closed_at":"2025-12-06T22:16:45.395588-06:00","labels":["logic","memory","temporal"],"dependencies":[{"issue_id":"engram-53","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.075584-06:00","created_by":"daemon"}]}
{"id":"engram-54","title":"Define FalkorDB Project Structure","description":"Setup packages/memory-core and apps/memory structure. See docs/bitemporal/context/bitemporal-memory/define-falkordb-project-structure.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:50:33.03288-06:00","updated_at":"2025-12-19T15:32:08.36091-06:00","closed_at":"2025-12-06T22:16:45.364284-06:00","labels":["memory","redis","structure"],"dependencies":[{"issue_id":"engram-54","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.033279-06:00","created_by":"daemon"}]}
{"id":"engram-55","title":"Create Redpanda Producer Configuration","description":"KafkaJS producer setup with idempotency enabled. See docs/bitemporal/context/cognitive-ingestion/create-redpanda-producer-configuration.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:50.394597-06:00","updated_at":"2025-12-19T15:32:08.361182-06:00","closed_at":"2025-12-06T22:14:59.087102-06:00","labels":["ingestion","producer","redpanda"],"dependencies":[{"issue_id":"engram-55","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.394957-06:00","created_by":"daemon"}]}
{"id":"engram-56","title":"Implement Secret Masking Regex","description":"Patterns to detect and mask API keys (sk-..., AKIA...). See docs/bitemporal/context/cognitive-ingestion/implement-secret-masking-regex.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:50.35047-06:00","updated_at":"2025-12-19T15:32:08.362062-06:00","closed_at":"2025-12-06T22:14:36.511188-06:00","labels":["ingestion","secrets","security"],"dependencies":[{"issue_id":"engram-56","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.350891-06:00","created_by":"daemon"}]}
{"id":"engram-57","title":"Implement PII Redaction Logic","description":"Regex-based scrubber for emails, credit cards, SSNs. See docs/bitemporal/context/cognitive-ingestion/implement-pii-redaction-logic.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:50.304318-06:00","updated_at":"2025-12-19T15:32:08.362664-06:00","closed_at":"2025-12-06T22:14:36.484353-06:00","labels":["ingestion","pii","security"],"dependencies":[{"issue_id":"engram-57","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.304763-06:00","created_by":"daemon"}]}
{"id":"engram-57ak","title":"Implement semantic tool selection in ToolRegistry","description":"packages/control/src/tools/registry.ts:22-23 - Add selectTools(query: string): Promise\u003cTool[]\u003e method for intelligent tool selection based on query semantics","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T16:22:33.352073-06:00","updated_at":"2025-12-20T19:18:04.835453-06:00","closed_at":"2025-12-20T19:18:04.835453-06:00"}
{"id":"engram-58","title":"Define Normalized Event Structure","description":"ParsedStreamEvent schema (Zod) including 'role' field. See docs/bitemporal/context/cognitive-ingestion/define-normalized-event-structure.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:50.259846-06:00","updated_at":"2025-12-19T15:32:08.36302-06:00","closed_at":"2025-12-06T22:13:50.406648-06:00","labels":["ingestion","schema","zod"],"dependencies":[{"issue_id":"engram-58","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.260267-06:00","created_by":"daemon"}]}
{"id":"engram-59","title":"Implement Stream Protocol Detector","description":"Lightweight fingerprinting logic to identify provider (OpenAI vs Anthropic) from headers/body. See docs/bitemporal/context/cognitive-ingestion/implement-stream-protocol-detector.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:49.991361-06:00","updated_at":"2025-12-19T15:32:08.363383-06:00","closed_at":"2025-12-06T22:14:36.453176-06:00","labels":["ingestion","protocol"],"dependencies":[{"issue_id":"engram-59","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:49.991728-06:00","created_by":"daemon"}]}
{"id":"engram-59qn","title":"Wire unused TunerClient methods to CLI","description":"packages/tuner TunerClient has ready(), deleteStudy(), pruneTrial(), getParetoFront(), getParamImportance() methods that are never called. Add CLI commands or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:15:46.946665-06:00","updated_at":"2025-12-20T23:22:22.505073-06:00","closed_at":"2025-12-20T23:22:22.505073-06:00"}
{"id":"engram-5e40","title":"[MAJOR] Double finalization race in apps/memory","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:04.82728-06:00","updated_at":"2025-12-20T23:58:00.498307-06:00","closed_at":"2025-12-20T23:58:00.498307-06:00"}
{"id":"engram-5e8w","title":"Test coverage: packages/graph/src/repositories/falkor-turn.repository.ts (28%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:23.174257-06:00","updated_at":"2025-12-21T04:07:03.765373-06:00","closed_at":"2025-12-21T04:07:03.765373-06:00"}
{"id":"engram-5f64","title":"Configure statient.com DNS for Hetzner services","description":"Use Vercel CLI to configure DNS records for statient.com pointing to Hetzner server (178.156.216.88).\n\n## Subdomains\n- api.statient.com -\u003e API service (port 8080)\n- search.statient.com -\u003e Search service (port 5002)\n- tuner.statient.com -\u003e Tuner service (port 8000)\n\n## Implementation\n1. Use vercel CLI to add A records for each subdomain\n2. Point all to Hetzner IP: 178.156.216.88\n3. Set up nginx or Caddy reverse proxy on server\n4. Configure SSL certificates (Let's Encrypt)\n\n## Commands\n```bash\nvercel dns add statient.com api A 178.156.216.88\nvercel dns add statient.com search A 178.156.216.88\nvercel dns add statient.com tuner A 178.156.216.88\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T16:52:00.85803-06:00","updated_at":"2025-12-21T17:59:17.452484-06:00","closed_at":"2025-12-21T17:59:17.452484-06:00"}
{"id":"engram-5gib","title":"Test coverage: packages/common/src/utils/retry.ts (3%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:23.509301-06:00","updated_at":"2025-12-21T04:07:03.764961-06:00","closed_at":"2025-12-21T04:07:03.764961-06:00"}
{"id":"engram-5j85","title":"Test coverage: apps/control/src/tools/mcp_client.ts (81%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:34.645143-06:00","updated_at":"2025-12-21T04:07:03.762737-06:00","closed_at":"2025-12-21T04:07:03.762737-06:00"}
{"id":"engram-5jif","title":"Test coverage: packages/graph/src/repositories/falkor-reasoning.repository.ts (38%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:05.10984-06:00","updated_at":"2025-12-21T04:07:03.769958-06:00","closed_at":"2025-12-21T04:07:03.769958-06:00"}
{"id":"engram-5jiq","title":"Upgrade to TypeScript 7 (tsgo)","description":"Upgrade entire monorepo from TypeScript 5.9.3 to TypeScript 7 (native Go port). Update all targets to ES2025/ESNext.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:37:03.720191-06:00","updated_at":"2025-12-20T22:33:07.954817-06:00","closed_at":"2025-12-20T22:33:07.954817-06:00"}
{"id":"engram-5nsd","title":"[Observatory Auth] Update docker-compose.prod.yml","description":"Update production Docker Compose with Better Auth environment variables. Reference: docs/observatory-auth-implementation-plan.md Step 12. File: docker-compose.prod.yml. Add to observatory service environment: BETTER_AUTH_SECRET, BETTER_AUTH_URL (https://observatory.statient.com), GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, AUTH_DATABASE_URL. Use variable substitution from .env file. DEPENDS ON: engram-glc5 (env vars must be defined first).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:42:13.927459-05:00","updated_at":"2025-12-22T00:51:52.639815-05:00","closed_at":"2025-12-22T00:51:52.639815-05:00","dependencies":[{"issue_id":"engram-5nsd","depends_on_id":"engram-glc5","type":"blocks","created_at":"2025-12-22T00:44:13.572968-05:00","created_by":"ccheney"}]}
{"id":"engram-5ob2","title":"Remove mock data from deployments/page.tsx","description":"Remove generateMockDeployments function and mock deployment data (lines 325-378, 383). Replace with proper 'No deployments' state when API fails.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:54:03.595707-05:00","updated_at":"2025-12-27T20:04:22.768277-05:00","closed_at":"2025-12-27T20:04:22.768277-05:00"}
{"id":"engram-5ovu","title":"Test coverage: apps/mcp/src/services/memory-store.ts (98%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:34.720355-06:00","updated_at":"2025-12-21T04:07:03.762519-06:00","closed_at":"2025-12-21T04:07:03.762519-06:00"}
{"id":"engram-5rsxq","title":"Add tests for packages/logger","description":"Missing tests for logger package:\n- node.ts\n- redaction.ts (PII redaction logic)\n- types.ts\n\nPriority: MEDIUM - Logging and PII redaction is security-relevant","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:21:08.459444-06:00","updated_at":"2026-01-01T17:21:08.459444-06:00"}
{"id":"engram-5rwj","title":"Delete Kafka client files","description":"Remove all Kafka-related files from the codebase.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 8: Files to Delete\n\n## Files to Delete\n- packages/storage/src/kafka.ts\n- packages/storage/src/kafka.test.ts\n- packages/storage/src/consumer-readiness.ts (Kafka admin API)\n- apps/search/src/clients/kafka.py\n\n## Also Update\n- packages/storage/src/index.ts - remove Kafka exports\n- packages/storage/src/interfaces.ts - remove Kafka-specific interfaces if any\n\n## Acceptance Criteria\n- No Kafka files remain\n- No Kafka imports in codebase\n- TypeScript compiles without errors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:28:01.379209-05:00","updated_at":"2025-12-22T00:50:09.548361-05:00","closed_at":"2025-12-22T00:50:09.548361-05:00","dependencies":[{"issue_id":"engram-5rwj","depends_on_id":"engram-vwt9","type":"blocks","created_at":"2025-12-22T00:30:10.068659-05:00","created_by":"ccheney"},{"issue_id":"engram-5rwj","depends_on_id":"engram-evdz","type":"blocks","created_at":"2025-12-22T00:30:15.203707-05:00","created_by":"ccheney"},{"issue_id":"engram-5rwj","depends_on_id":"engram-1crc","type":"blocks","created_at":"2025-12-22T00:30:20.344614-05:00","created_by":"ccheney"},{"issue_id":"engram-5rwj","depends_on_id":"engram-llff","type":"blocks","created_at":"2025-12-22T00:30:25.478523-05:00","created_by":"ccheney"},{"issue_id":"engram-5rwj","depends_on_id":"engram-5y7s","type":"blocks","created_at":"2025-12-22T00:30:30.612436-05:00","created_by":"ccheney"}]}
{"id":"engram-5til","title":"Test coverage: packages/graph/src/repositories/falkor-session.repository.ts (29%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:11.245854-06:00","updated_at":"2025-12-21T04:07:03.768478-06:00","closed_at":"2025-12-21T04:07:03.768478-06:00"}
{"id":"engram-5y70","title":"Test coverage: packages/parser/src/parser/codex.ts (88%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:17.26903-06:00","updated_at":"2025-12-21T04:07:03.766459-06:00","closed_at":"2025-12-21T04:07:03.766459-06:00"}
{"id":"engram-5y7s","title":"Migrate search service to NATS (Python)","description":"Update Python search service to use nats-py instead of aiokafka.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 5: Python Client\n\n## Topic Mapping\n- memory.turn_finalized → memory.turns.finalized (subscribe)\n- memory.node_created → memory.nodes.created (subscribe, legacy)\n\n## Consumer\n- Stream: MEMORY\n- Durable name: search-indexer\n\n## Implementation\n- Add nats-py\u003e=2.9.0 to pyproject.toml\n- Remove aiokafka from dependencies\n- Create apps/search/src/clients/nats.py\n- Update TurnFinalizedConsumer to use NATS\n- Update environment from KAFKA_BOOTSTRAP_SERVERS to NATS_URL\n\n## Acceptance Criteria\n- Service connects to NATS\n- Subscribes to memory.turns.finalized\n- Indexes turns to Qdrant successfully","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:26:55.220455-05:00","updated_at":"2025-12-22T00:49:14.132566-05:00","closed_at":"2025-12-22T00:49:14.132566-05:00","dependencies":[{"issue_id":"engram-5y7s","depends_on_id":"engram-3xez","type":"blocks","created_at":"2025-12-22T00:29:53.606363-05:00","created_by":"ccheney"}]}
{"id":"engram-5yl8","title":"Add auth to Search service endpoints","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T23:12:43.009195-05:00","updated_at":"2025-12-21T23:17:21.81985-05:00","closed_at":"2025-12-21T23:17:21.81985-05:00","dependencies":[{"issue_id":"engram-5yl8","depends_on_id":"engram-ws66","type":"blocks","created_at":"2025-12-21T23:13:03.884667-05:00","created_by":"ccheney"}]}
{"id":"engram-6","title":"LOW: Test/implementation mismatch for GCSBlobStore.read","description":"Location: packages/storage/src/blob.test.ts:161-167\n\nTest expects GCSBlobStore.read() to return empty string on failure, but implementation correctly throws StorageError.\n\nFix: Update test to expect thrown error.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:19.998534-06:00","updated_at":"2025-12-19T15:32:08.341937-06:00","closed_at":"2025-12-18T21:47:22.603382-06:00"}
{"id":"engram-60","title":"Define Raw Stream Event Schema","description":"Zod schema for validating raw JSON payloads from OpenAI/Anthropic. See docs/bitemporal/context/cognitive-ingestion/define-raw-stream-event-schema.md","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:48:49.946059-06:00","updated_at":"2025-12-19T15:32:08.363699-06:00","closed_at":"2025-12-06T22:13:50.37628-06:00","labels":["ingestion","schema","zod"],"dependencies":[{"issue_id":"engram-60","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:49.946457-06:00","created_by":"daemon"}]}
{"id":"engram-61","title":"Develop Node Merging Logic","description":"SAME_AS edge logic for entity resolution. See docs/bitemporal/context/bitemporal-memory/develop-node-merging-logic.md","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-06T21:50:33.892839-06:00","updated_at":"2025-12-19T15:32:08.363967-06:00","closed_at":"2025-12-07T01:19:13.419722-06:00","labels":["logic","memory","merge"],"dependencies":[{"issue_id":"engram-61","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.893204-06:00","created_by":"daemon"}]}
{"id":"engram-62","title":"Milestone 1: Basic Pipeline (MVP)","description":"Dataset loader, Session/Turn mapper, basic dense retrieval, simple reader, JSONL output","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:33:27.044808-06:00","updated_at":"2025-12-19T15:32:08.364266-06:00","closed_at":"2025-12-18T11:40:56.440985-06:00"}
{"id":"engram-62jy","title":"Test coverage: packages/parser/src/protocol.ts (90%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:43.628823-06:00","updated_at":"2025-12-21T04:07:03.760023-06:00","closed_at":"2025-12-21T04:07:03.760023-06:00"}
{"id":"engram-62xa","title":"[Observatory Auth] Create route protection middleware","description":"Create Next.js middleware to protect all routes and redirect unauthenticated users to sign-in. Reference: docs/observatory-auth-implementation-plan.md Step 6. File: apps/observatory/middleware.ts (NEW at app root). Use auth.api.getSession with headers. Redirect to /sign-in if no session. Configure runtime: nodejs for Next.js 16. Matcher excludes: /sign-in, /api/auth, /_next/static, /_next/image, /favicon.ico, /robots.txt. DEPENDS ON: engram-7d6p (server config), engram-wcqb (API route handler).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:41:03.138523-05:00","updated_at":"2025-12-22T00:54:12.31815-05:00","closed_at":"2025-12-22T00:54:12.31815-05:00","dependencies":[{"issue_id":"engram-62xa","depends_on_id":"engram-7d6p","type":"blocks","created_at":"2025-12-22T00:43:37.628209-05:00","created_by":"ccheney"},{"issue_id":"engram-62xa","depends_on_id":"engram-wcqb","type":"blocks","created_at":"2025-12-22T00:43:42.75965-05:00","created_by":"ccheney"}]}
{"id":"engram-63","title":"Research SPLADE-distilbert ONNX conversion","description":"If sparse retrieval quality is insufficient: 1) Convert SPLADE-distilbert to ONNX, 2) Implement SpladePooling in JavaScript, 3) Benchmark against improved BM25. See docs/sparse-embedding-evaluation.md for research findings, available models (naver/splade-v3, naver/splade-v3-distilbert), implementation path, and estimated effort (3-5 days).","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T02:53:59.382213-06:00","updated_at":"2025-12-19T15:32:08.364509-06:00","closed_at":"2025-12-08T19:17:58.831261-06:00"}
{"id":"engram-63pu","title":"Update Ingestion auth to accept OAuth tokens","description":"Modify apps/ingestion/src/auth.ts to accept engram_oauth_ prefixed tokens. Same changes as API middleware - update pattern, add oauth_tokens lookup, unified auth context. See docs/design/oauth-device-flow.md 'Token Format' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:49.903192-05:00","updated_at":"2025-12-25T02:48:13.315485-05:00","closed_at":"2025-12-25T02:48:13.315485-05:00","dependencies":[{"issue_id":"engram-63pu","depends_on_id":"engram-g0sx","type":"blocks","created_at":"2025-12-25T02:21:39.512715-05:00","created_by":"ccheney"}]}
{"id":"engram-64","title":"Update traffic generator script for new node types","description":"Update the traffic generator to create Turn, Reasoning, and FileTouch nodes with the new schema","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T03:19:12.927132-06:00","updated_at":"2025-12-19T15:32:08.364725-06:00","closed_at":"2025-12-08T03:34:05.999996-06:00"}
{"id":"engram-65","title":"Benchmark SPLADE vs BM25Sparse","description":"Create benchmark script comparing latency, sparsity, and retrieval quality between SPLADE and BM25Sparse implementations. Test with real search queries. Document results.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T19:25:07.625165-06:00","updated_at":"2025-12-19T15:32:08.364945-06:00","closed_at":"2025-12-08T19:47:14.158554-06:00","dependencies":[{"issue_id":"engram-65","depends_on_id":"engram-230","type":"blocks","created_at":"2025-12-08T19:25:16.424498-06:00","created_by":"daemon"}]}
{"id":"engram-6556","title":"[HIGH] XSS vulnerability in search results","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:14.451052-06:00","updated_at":"2025-12-21T00:00:08.276278-06:00","closed_at":"2025-12-21T00:00:08.276278-06:00"}
{"id":"engram-657w","title":"Update MemoryRepository for tenant context","description":"Update MemoryRepository to use tenant-scoped graph.\n\n## Files to Modify\n- packages/graph/src/repositories/falkor-memory.ts\n\n## Agent Instructions\nMemory queries are frequently used - ensure performance is maintained.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:53.512884-06:00","updated_at":"2025-12-29T23:11:10.135636-06:00","closed_at":"2025-12-29T23:11:10.135636-06:00","dependencies":[{"issue_id":"engram-657w","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:25.932548-06:00","created_by":"ccheney"}]}
{"id":"engram-66","title":"Test Qdrant hybrid search with SPLADE vectors","description":"Integration test for Qdrant hybrid search using SPLADE sparse vectors. Verify synonym handling and vocabulary mismatch improvements over BM25.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T19:25:08.791888-06:00","updated_at":"2025-12-19T15:32:08.365198-06:00","closed_at":"2025-12-08T20:20:17.320417-06:00","dependencies":[{"issue_id":"engram-66","depends_on_id":"engram-230","type":"blocks","created_at":"2025-12-08T19:25:16.457402-06:00","created_by":"daemon"}]}
{"id":"engram-66be","title":"Remove API_KEY_PATTERN, DEV_TOKEN_PATTERN, SERVICE_TOKEN_PATTERN from types/auth.ts","description":"Clean up legacy token pattern constants in packages/common/src/types/auth.ts. Remove the three old pattern exports: API_KEY_PATTERN (matched engram_live_* and engram_test_* keys), DEV_TOKEN_PATTERN (matched development tokens), and SERVICE_TOKEN_PATTERN (matched service-to-service tokens). Keep only the new unified TOKEN_PATTERNS constant that defines patterns for all current token types (egm_oauth_*, egm_refresh_*, engram_live_*, engram_test_*). After removal, search the codebase for any imports of the removed constants (likely in auth middleware files like apps/api/src/middleware/auth.ts, apps/ingestion/src/auth.ts, apps/search/src/middleware/auth.py) and update them to use TOKEN_PATTERNS instead. Run 'bun run typecheck' and 'bun run lint' to verify no broken imports remain.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:55:17.954579-06:00","updated_at":"2025-12-29T16:59:27.743519-06:00","closed_at":"2025-12-29T16:59:27.743519-06:00","dependencies":[{"issue_id":"engram-66be","depends_on_id":"engram-j6pr","type":"blocks","created_at":"2025-12-29T16:02:15.811932-06:00","created_by":"ccheney"},{"issue_id":"engram-66be","depends_on_id":"engram-iszl","type":"blocks","created_at":"2025-12-29T16:02:20.954413-06:00","created_by":"ccheney"},{"issue_id":"engram-66be","depends_on_id":"engram-qeb4","type":"blocks","created_at":"2025-12-29T16:02:26.097759-06:00","created_by":"ccheney"}]}
{"id":"engram-66py","title":"[CRITICAL] Missing event_id in ParsedStreamEvent (apps/ingestion)","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:23.963369-06:00","updated_at":"2025-12-20T23:45:30.482871-06:00","closed_at":"2025-12-20T23:45:30.482871-06:00"}
{"id":"engram-67","title":"Create Grafana dashboard for reranking metrics","description":"Dashboard panels: latency by tier, cache hit rate, score improvement distribution, error rates","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T23:02:03.550159-06:00","updated_at":"2025-12-19T15:32:08.365464-06:00","closed_at":"2025-12-09T00:35:33.919843-06:00"}
{"id":"engram-68","title":"Bounded Context: Deterministic Execution","description":"The 'Motor Cortex'. Virtual File System, Wasm sandbox, and tool execution. See docs/bitemporal/context/deterministic-execution/","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:47:42.435989-06:00","updated_at":"2025-12-19T15:32:08.365675-06:00","closed_at":"2025-12-06T22:33:15.120538-06:00","labels":["context","execution","wasm"]}
{"id":"engram-684i","title":"[Search-Py] Phase 6: Cutover \u0026 Deprecation","description":"Migrate traffic from TypeScript to Python service. Shadow mode: run both services, compare results. A/B comparison metrics for quality validation. Gradual traffic shift (10% → 50% → 100%). TypeScript service deprecation. Documentation updates for new service.\n\nReference: docs/plans/search-python-migration.md (Phase 7: Cutover)\n\nDeliverables:\n- Shadow mode configuration (nginx/envoy)\n- A/B comparison metrics dashboard\n- Traffic split configuration\n- Rollback runbook\n- TypeScript deprecation checklist\n- Updated docker-compose.dev.yml\n- Updated AGENTS.md with new service\n\nRollback triggers:\n- Search latency p99 \u003e 2x baseline\n- Error rate \u003e 1%\n- Embedding quality regression (cosine \u003c 0.9)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:22:21.935373-06:00","updated_at":"2025-12-20T09:25:25.02352-06:00","closed_at":"2025-12-20T09:25:25.02352-06:00","dependencies":[{"issue_id":"engram-684i","depends_on_id":"engram-1cg4","type":"blocks","created_at":"2025-12-20T07:23:07.511789-06:00","created_by":"ccheney"}]}
{"id":"engram-68a0","title":"Add memory embedding to Engram","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-24T01:39:20.323665-05:00","updated_at":"2025-12-24T01:56:28.945474-05:00","closed_at":"2025-12-24T01:56:28.945474-05:00"}
{"id":"engram-68bd","title":"Update FalkorBaseRepository for tenant context","description":"Refactor base repository to require TenantContext for all operations.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 558)\n\n## Implementation\nUpdate packages/graph/src/repositories/falkor-base.ts:\n- Constructor or method signature accepts TenantContext\n- Use TenantAwareFalkorClient for graph selection\n- All queries scoped to tenant graph\n- Add validateTenantAccess() calls where needed\n\n## Files to Modify\n- packages/graph/src/repositories/falkor-base.ts\n\n## Agent Instructions\nReview existing repository patterns first. Ensure backward compatibility or migration path for existing code.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:19.568032-06:00","updated_at":"2025-12-29T22:48:32.953872-06:00","closed_at":"2025-12-29T22:48:32.953872-06:00","dependencies":[{"issue_id":"engram-68bd","depends_on_id":"engram-9fhs","type":"blocks","created_at":"2025-12-29T22:12:07.264938-06:00","created_by":"ccheney"}]}
{"id":"engram-68fpa","title":"Create workflow formulas for common patterns","description":"Define formulas in .beads/formulas/ for implement-feature, fix-bug, add-tests, research-task, refactor-module, parallel-beads","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:49:00.614871-06:00","updated_at":"2026-01-01T18:51:34.921082-06:00","closed_at":"2026-01-01T18:51:34.921082-06:00"}
{"id":"engram-69","title":"Bounded Context: Bitemporal Memory","description":"The 'Hippocampus'. Manages the knowledge graph, bitemporal logic, and persistence. See docs/bitemporal/context/bitemporal-memory/","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:47:42.394915-06:00","updated_at":"2025-12-19T15:32:08.366517-06:00","closed_at":"2025-12-06T22:33:15.150172-06:00","labels":["context","falkordb","memory"]}
{"id":"engram-69zt","title":"Consolidate dual Redis+Kafka publication paths","description":"apps/memory index.ts:357-374 publishes to both Redis and Kafka for node creation events. These could diverge. Consolidate to single source of truth.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:15:40.757302-06:00","updated_at":"2025-12-20T23:23:02.353826-06:00","closed_at":"2025-12-20T23:23:02.353826-06:00"}
{"id":"engram-6g4u","title":"Test HuggingFace embedder integration locally","description":"Verify HuggingFace embedder works correctly with search service.\n\n## Test scenarios\n1. Unit tests for HuggingFaceEmbedder class\n2. Integration test with factory (EMBEDDER_BACKEND=huggingface)\n3. End-to-end search test via /search endpoint\n\n## Test commands\n```bash\ncd apps/search\nexport HF_API_TOKEN=your_token\nexport EMBEDDER_BACKEND=huggingface\nuv run pytest tests/test_huggingface.py\nuv run search  # manual testing\n```\n\n## Acceptance Criteria\n- All unit tests pass\n- Search endpoint returns results with HF backend\n- Latency is acceptable (\u003c2s including cold start)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:32:18.676764-06:00","updated_at":"2025-12-21T15:32:18.676764-06:00"}
{"id":"engram-6gkb","title":"Add elicitation confirmation flow for conflicts","description":"Use MCP elicitation to ask user before invalidating: formatConflictMessage(), elicitation.confirm() with title 'Confirm Memory Update', confirmLabel 'Update and Invalidate Old', cancelLabel 'Create Without Invalidating'","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:49.656506-06:00","updated_at":"2026-01-01T16:43:49.656506-06:00","dependencies":[{"issue_id":"engram-6gkb","depends_on_id":"engram-frn0","type":"blocks","created_at":"2026-01-01T16:46:06.593534-06:00","created_by":"ccheney"}]}
{"id":"engram-6iyw","title":"Create CI/CD Panel page","description":"Page with workflow runs, deployments, version matrix, infrastructure changes. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:26.149845-05:00","updated_at":"2025-12-27T17:27:31.813074-05:00","closed_at":"2025-12-27T17:27:31.813074-05:00","dependencies":[{"issue_id":"engram-6iyw","depends_on_id":"engram-x2hm","type":"blocks","created_at":"2025-12-27T04:27:41.031312-05:00","created_by":"ccheney"},{"issue_id":"engram-6iyw","depends_on_id":"engram-8euz","type":"blocks","created_at":"2025-12-27T04:27:46.150975-05:00","created_by":"ccheney"},{"issue_id":"engram-6iyw","depends_on_id":"engram-nyfb","type":"blocks","created_at":"2025-12-27T04:27:51.273705-05:00","created_by":"ccheney"}]}
{"id":"engram-6jrr","title":"Test coverage: packages/parser/src/parser/xai.ts (90%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:41.634903-06:00","updated_at":"2025-12-21T04:07:03.760474-06:00","closed_at":"2025-12-21T04:07:03.760474-06:00"}
{"id":"engram-6kci","title":"[Search-Py] Phase 3: Retrieval Pipeline","description":"Implement main search pipeline with strategy selection. Port SearchRetriever with dense/sparse/hybrid strategies and RRF fusion. Port SessionAwareRetriever for two-stage hierarchical retrieval (Stage 1: sessions, Stage 2: turns). Port MultiQueryRetriever with LLM-based query expansion. Port QueryClassifier for strategy/complexity classification. Remove timeout workarounds - Python async handles this cleanly.\n\nReference: docs/plans/search-python-migration.md (Phase 4: Retrieval Pipeline)\n\nDeliverables:\n- src/search/retrieval/retriever.py - Main search pipeline\n- src/search/retrieval/session.py - Session-aware hierarchical retrieval\n- src/search/retrieval/multi_query.py - Query expansion + RRF\n- src/search/retrieval/classifier.py - Strategy classification\n- src/search/api/routes.py - POST /search endpoint\n- src/search/api/schemas.py - Request/response Pydantic models\n- Integration tests with Qdrant\n- End-to-end search tests","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:21:50.861703-06:00","updated_at":"2025-12-20T08:48:55.217806-06:00","closed_at":"2025-12-20T08:48:55.217806-06:00","dependencies":[{"issue_id":"engram-6kci","depends_on_id":"engram-ycw5","type":"blocks","created_at":"2025-12-20T07:22:46.883117-06:00","created_by":"ccheney"},{"issue_id":"engram-6kci","depends_on_id":"engram-llpq","type":"blocks","created_at":"2025-12-20T07:22:52.037452-06:00","created_by":"ccheney"}]}
{"id":"engram-6l8b","title":"Remove mock data from Overview page.tsx","description":"Remove mock data fallbacks from Overview dashboard:\n- Lines 503+: Mock alerts and deployments data\n- Hardcoded Resources values (34%, 67%, 45%, 23%)\n- Static sparklineData for Request Volume chart\n\nReplace with real API data and proper 'No Data' states.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:53:57.024214-05:00","updated_at":"2025-12-27T20:04:22.767986-05:00","closed_at":"2025-12-27T20:04:22.767986-05:00"}
{"id":"engram-6m0c","title":"Differentiate WebSocket close codes before reconnecting","description":"## Problem\n\nThe `useWebSocket` hook at `apps/interface/app/hooks/useWebSocket.ts:238-252` attempts reconnection on any close event without examining the close code:\n\n```typescript\nws.onclose = (event) =\u003e {\n  setStatus('closed');\n  wsRef.current = null;\n  onCloseRef.current?.(event);\n\n  // Auto-reconnect logic (unless manually closed)\n  if (!manualCloseRef.current \u0026\u0026 shouldReconnect \u0026\u0026 reconnectAttemptsRef.current \u003c maxReconnectAttempts) {\n    // Reconnects regardless of close code...\n  }\n};\n```\n\n## WebSocket Close Codes (RFC 6455)\n\nNot all close events warrant reconnection:\n\n| Code | Name | Should Reconnect? |\n|------|------|-------------------|\n| 1000 | Normal Closure | No - intentional server close |\n| 1001 | Going Away | Maybe - server shutting down |\n| 1002 | Protocol Error | No - client bug |\n| 1003 | Unsupported Data | No - client bug |\n| 1006 | Abnormal Closure | Yes - network issue |\n| 1011 | Internal Error | Maybe - server issue |\n| 1012 | Service Restart | Yes - temporary |\n| 1013 | Try Again Later | Yes - with backoff |\n| 1014 | Bad Gateway | Yes - proxy issue |\n\n## Recommended Solution\n\nExamine the close code and reason to make informed reconnection decisions:\n\n```typescript\nws.onclose = (event) =\u003e {\n  setStatus('closed');\n  wsRef.current = null;\n  onCloseRef.current?.(event);\n\n  // Determine if we should reconnect based on close code\n  const shouldAttemptReconnect = () =\u003e {\n    if (manualCloseRef.current) return false;\n    if (!shouldReconnect) return false;\n    if (reconnectAttemptsRef.current \u003e= maxReconnectAttempts) return false;\n    \n    // Don't reconnect on clean closes or protocol errors\n    if (event.code === 1000) return false; // Normal closure\n    if (event.code === 1002) return false; // Protocol error\n    if (event.code === 1003) return false; // Unsupported data\n    \n    return true;\n  };\n\n  if (shouldAttemptReconnect()) {\n    // ... exponential backoff logic\n  }\n};\n```\n\n### Optional: Expose close code to consumer\n\n```typescript\ninterface UseWebSocketReturn {\n  // ... existing fields\n  lastCloseCode?: number;\n  lastCloseReason?: string;\n}\n```\n\n## References\n\n- [Robust WebSocket Reconnection Strategies](https://dev.to/hexshift/robust-websocket-reconnection-strategies-in-javascript-with-exponential-backoff-40n1) - 'On close events, check the code and reason properties to distinguish between clean disconnections (code 1000) and errors'\n- [RFC 6455 - WebSocket Protocol, Section 7.4](https://datatracker.ietf.org/doc/html/rfc6455#section-7.4) - Close code definitions\n- [MDN CloseEvent.code](https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent/code)\n\n## Priority\n\nLow - The current behavior (always reconnect) is safe but may cause unnecessary reconnection attempts after intentional server closes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T20:41:39.506239-06:00","updated_at":"2025-12-20T23:07:49.466023-06:00","closed_at":"2025-12-20T23:07:49.466023-06:00"}
{"id":"engram-6n47","title":"Remove or document NodeFileSystem usage","description":"packages/vfs node-fs.ts NodeFileSystem class fully implements IFileSystem but is only instantiated in tests. Document intended use case or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:48.201264-06:00","updated_at":"2025-12-20T23:23:14.438221-06:00","closed_at":"2025-12-20T23:23:14.438221-06:00"}
{"id":"engram-6qzk","title":"Test coverage: apps/observatory/lib/rbac.ts (46%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:34.42784-06:00","updated_at":"2025-12-21T04:07:03.76301-06:00","closed_at":"2025-12-21T04:07:03.76301-06:00"}
{"id":"engram-6slo","title":"Fix embedder model dimension mismatch","description":"Current default embedder (bge-base) produces 768 dims but collection expects 384. Either update collection schema or change default model to bge-small.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-21T06:12:32.909142-06:00","updated_at":"2025-12-21T06:31:33.243118-06:00","closed_at":"2025-12-21T06:31:33.243118-06:00"}
{"id":"engram-6u4w","title":"Update retriever to use engram_turns collection","description":"Modify SearchRetriever to query engram_turns as primary collection. Add fallback to engram_memory during transition.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:12:21.117201-06:00","updated_at":"2025-12-21T06:46:58.096552-06:00","closed_at":"2025-12-21T06:46:58.096552-06:00","dependencies":[{"issue_id":"engram-6u4w","depends_on_id":"engram-fxxg","type":"blocks","created_at":"2025-12-21T06:13:45.795084-06:00","created_by":"ccheney"}]}
{"id":"engram-6ush","title":"Add tests: Client credentials grant requires valid DPoP proof","description":"Add tests for client credentials grant requiring valid DPoP proof. Test POST /api/auth/token endpoint with grant_type=client_credentials. Test DPoP header required: request without DPoP header should return 400 with error=invalid_dpop_proof. Test invalid DPoP rejected: send malformed DPoP proof (bad signature, missing claims), expect 400. Test valid flow returns token: send valid client credentials + valid DPoP proof, expect 200 with access_token in egm_oauth_* format. Test DPoP proof validation: htm claim must equal POST, htu claim must match token endpoint URL, jti must be unique. Create test file in /Users/ccheney/Projects/engram/apps/observatory/app/api/auth/token/route.test.ts. Client credentials flow implements RFC 6749 Section 4.4 for M2M authentication. DPoP binding ensures tokens are bound to cryptographic proof, preventing token exfiltration attacks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:56:28.380422-06:00","updated_at":"2025-12-29T16:37:47.017148-06:00","closed_at":"2025-12-29T16:37:47.017148-06:00","dependencies":[{"issue_id":"engram-6ush","depends_on_id":"engram-qiua","type":"blocks","created_at":"2025-12-29T16:03:52.070776-06:00","created_by":"ccheney"}]}
{"id":"engram-6z80","title":"Remove legacy constructor patterns","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:12:37.940146-05:00","updated_at":"2025-12-24T02:19:02.017282-05:00","closed_at":"2025-12-24T02:19:02.017282-05:00"}
{"id":"engram-7","title":"LOW: XState actor never stopped - resource leak","description":"Location: apps/control/src/engine/decision.ts:224-226\n\nThe DecisionEngine has a start() method but no stop() method. XState actors maintain internal subscriptions that are never cleaned up.\n\nFix: Add stop() method that calls this.actor.stop().","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:41.753666-06:00","updated_at":"2025-12-19T15:32:08.342374-06:00","closed_at":"2025-12-18T21:47:22.602089-06:00"}
{"id":"engram-70","title":"Bounded Context: Cognitive Ingestion","description":"The 'Nervous System'. Stream intake, protocol detection, parsing, and sanitization. See docs/bitemporal/context/cognitive-ingestion/","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T21:47:42.349348-06:00","updated_at":"2025-12-19T15:32:08.367062-06:00","closed_at":"2025-12-06T22:33:15.059849-06:00","labels":["context","ingestion","redpanda"]}
{"id":"engram-71","title":"Implement async reranking option","description":"Return RRF results immediately, rerank in background, push refined results via WebSocket. Opt-in per query.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T23:02:14.294709-06:00","updated_at":"2025-12-19T15:32:08.367536-06:00","closed_at":"2025-12-09T00:35:33.156434-06:00"}
{"id":"engram-72","title":"[4.2] Create Integration Test Infrastructure","description":"# Task 4.2: Create Integration Test Infrastructure\n\n**Effort**: 8 hours\n**Dependencies**: Task 0.1 (@engram/common)\n**Parallel**: Can run with all Phase 4.1 tasks\n\n## Location\n`packages/common/src/testing/`\n\n## Utilities to Create\n\n### Test Factories\n```typescript\n// factories/falkor.ts\nexport function createTestFalkorClient(\n  responses?: Map\u003cstring, unknown[]\u003e\n): MockGraphClient {\n  return new MockGraphClient(responses);\n}\n\n// factories/kafka.ts\nexport function createTestKafkaClient(\n  messages?: unknown[]\n): MockMessageClient {\n  return new MockMessageClient(messages);\n}\n\n// factories/redis.ts\nexport function createTestRedisPublisher(): MockRedisPublisher {\n  return new MockRedisPublisher();\n}\n```\n\n### Test Fixtures\n```typescript\n// fixtures/sessions.ts\nexport const testSession: Session = {\n  id: 'test-session-1',\n  externalId: 'ext-123',\n  startTime: new Date('2024-01-01'),\n  // ...\n};\n\n// fixtures/turns.ts\nexport const testTurn: Turn = {\n  id: 'test-turn-1',\n  sessionId: 'test-session-1',\n  // ...\n};\n```\n\n### Test Helpers\n```typescript\n// helpers/time.ts\nexport function withFrozenTime\u003cT\u003e(\n  time: Date,\n  fn: () =\u003e T\n): T {\n  // Mock Date.now() for bitemporal testing\n}\n\n// helpers/graph.ts\nexport function buildTestGraph(\n  nodes: Node[],\n  edges: Edge[]\n): GraphSnapshot {\n  // Build test graph structure\n}\n```\n\n## Acceptance Criteria\n- [ ] All mock clients created\n- [ ] Common fixtures defined\n- [ ] Time helpers working\n- [ ] Graph helpers working\n- [ ] Exported from @engram/common\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 555-569)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:37:16.569248-06:00","updated_at":"2025-12-19T15:32:08.368014-06:00","closed_at":"2025-12-09T04:39:12.290691-06:00","labels":["infrastructure","parallel-ok","refactoring","testing"],"dependencies":[{"issue_id":"engram-72","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:16.569882-06:00","created_by":"daemon"},{"issue_id":"engram-72","depends_on_id":"engram-89","type":"blocks","created_at":"2025-12-09T03:39:05.037477-06:00","created_by":"daemon"}]}
{"id":"engram-729v","title":"Remove legacy UI type handling","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:12:50.794759-05:00","updated_at":"2025-12-24T02:21:58.481784-05:00","closed_at":"2025-12-24T02:21:58.481784-05:00"}
{"id":"engram-72hoe","title":"Install Gastown CLI and initialize rig","description":"Install gt CLI via go install, run gt install, and gt rig add engram to set up the workspace","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:43:10.533723-06:00","updated_at":"2026-01-01T18:54:46.744315-06:00","closed_at":"2026-01-01T18:54:46.744315-06:00"}
{"id":"engram-72q7","title":"Add tests for search embedders/bm25.py (0% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:09.649539-05:00","updated_at":"2025-12-27T01:59:09.649539-05:00"}
{"id":"engram-73","title":"[4.1f] Add Tests: apps/control ContextAssembler","description":"# Task 4.1f: Add Tests for ContextAssembler\n\n**Effort**: 4 hours\n**Current Coverage**: 0%\n**Target Coverage**: 80%\n**Parallel**: Can run with all Phase 4 tasks\n\n## File Under Test\n`apps/control/src/context/assembler.ts`\n\n## Test Cases to Write\n1. Context assembly from session\n2. Turn history retrieval\n3. Search context integration\n4. Token budget management\n5. Priority ordering\n6. Error handling (graph failures)\n\n## Mocking Requirements\n- SessionRepository\n- TurnRepository\n- SearchRetriever\n- Logger\n\n## Test File Location\n`apps/control/src/context/__tests__/assembler.test.ts`\n\n## Acceptance Criteria\n- [ ] 80% coverage achieved\n- [ ] Assembly logic tested\n- [ ] Token limits verified\n- [ ] Search integration tested\n- [ ] Error scenarios covered\n\n## References\n- docs/refactor/WORK_ORDER.md (line 105)\n- docs/refactor/apps/control/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:37:14.809787-06:00","updated_at":"2025-12-19T15:32:08.368393-06:00","closed_at":"2025-12-09T04:39:11.131015-06:00","labels":["control","parallel-ok","refactoring","testing"],"dependencies":[{"issue_id":"engram-73","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:14.810221-06:00","created_by":"daemon"}]}
{"id":"engram-74","title":"[4.1d] Add Tests: packages/storage/src/redis.ts","description":"# Task 4.1d: Add Tests for Redis Storage\n\n**Effort**: 4 hours\n**Current Coverage**: 0%\n**Target Coverage**: 80%\n**Parallel**: Can run with all Phase 4 tasks\n\n## File Under Test\n`packages/storage/src/redis.ts`\n\n## Test Cases to Write\n1. Connection management\n2. Publish/subscribe operations\n3. Session update publishing\n4. Error handling\n5. Reconnection logic\n6. Graceful disconnect\n\n## Mocking Requirements\n- Redis client (ioredis)\n- Network errors\n- Timeout scenarios\n\n## Test File Location\n`packages/storage/src/__tests__/redis.test.ts`\n\n## Acceptance Criteria\n- [ ] 80% coverage achieved\n- [ ] Connection lifecycle tested\n- [ ] Pub/sub operations verified\n- [ ] Error scenarios covered\n- [ ] Reconnection tested\n\n## References\n- docs/refactor/WORK_ORDER.md (line 103)\n- docs/refactor/packages/storage/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:37:10.768963-06:00","updated_at":"2025-12-19T15:32:08.368699-06:00","closed_at":"2025-12-09T04:39:08.925848-06:00","labels":["parallel-ok","refactoring","storage","testing"],"dependencies":[{"issue_id":"engram-74","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:10.769474-06:00","created_by":"daemon"}]}
{"id":"engram-75","title":"[4.1c] Add Tests: packages/ingestion-core OpenAI Parser","description":"# Task 4.1c: Add Tests for OpenAI Parser\n\n**Effort**: 4 hours\n**Current Coverage**: 0%\n**Target Coverage**: 80%\n**Parallel**: Can run with all Phase 4 tasks\n\n## File Under Test\n`packages/ingestion-core/src/parser/openai.ts`\n\n## Test Cases to Write\n1. Standard completion parsing\n2. Streaming chunk handling\n3. Tool call parsing\n4. Function call parsing\n5. Usage statistics extraction\n6. Error event handling\n7. Malformed input handling\n\n## Test Fixtures Needed\n- Sample OpenAI API responses\n- Streaming chunk sequences\n- Tool call examples\n- Error responses\n\n## Test File Location\n`packages/ingestion-core/src/parser/__tests__/openai.test.ts`\n\n## Acceptance Criteria\n- [ ] 80% coverage achieved\n- [ ] All message types tested\n- [ ] Streaming scenarios covered\n- [ ] Error handling verified\n- [ ] Fixtures documented\n\n## References\n- docs/refactor/WORK_ORDER.md (line 102)\n- docs/refactor/packages/ingestion-core/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:37:09.167631-06:00","updated_at":"2025-12-19T15:32:08.369044-06:00","closed_at":"2025-12-09T04:39:07.946701-06:00","labels":["ingestion-core","parallel-ok","refactoring","testing"],"dependencies":[{"issue_id":"engram-75","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:09.16832-06:00","created_by":"daemon"}]}
{"id":"engram-75ll","title":"Clean up unused UI components in interface","description":"apps/interface exports Card, CountBadge, TypeBadge, Badge, GlassPanel, StatusIndicator from shared/ but none are imported. Remove or consolidate with inline implementations.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:10:37.413643-06:00","updated_at":"2025-12-20T23:22:18.974549-06:00","closed_at":"2025-12-20T23:22:18.974549-06:00"}
{"id":"engram-76","title":"[4.1b] Add Tests: apps/memory/src/turn-aggregator.ts","description":"# Task 4.1b: Add Tests for TurnAggregator\n\n**Effort**: 8 hours\n**Current Coverage**: 0%\n**Target Coverage**: 80%\n**Parallel**: Can run with all Phase 4 tasks\n\n## File Under Test\n`apps/memory/src/turn-aggregator.ts`\n\n## Test Cases to Write\n1. Turn creation and aggregation\n2. Event processing (all 6 event types)\n3. Bitemporal timestamp handling\n4. Graph node/edge creation\n5. Session state management\n6. Error recovery\n7. Concurrent turn handling\n\n## Mocking Requirements\n- FalkorClient (GraphClient interface)\n- RedisPublisher\n- Logger\n- Clock for bitemporal testing\n\n## Test File Location\n`apps/memory/src/__tests__/turn-aggregator.test.ts`\n\n## Acceptance Criteria\n- [ ] 80% coverage achieved\n- [ ] All event types tested\n- [ ] Bitemporal logic verified\n- [ ] Concurrent scenarios tested\n- [ ] Graph operations mocked\n\n## References\n- docs/refactor/WORK_ORDER.md (line 101)\n- docs/refactor/apps/memory/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:37:07.033035-06:00","updated_at":"2025-12-19T15:32:08.369404-06:00","closed_at":"2025-12-09T04:39:06.825922-06:00","labels":["memory","parallel-ok","refactoring","testing"],"dependencies":[{"issue_id":"engram-76","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:07.033904-06:00","created_by":"daemon"}]}
{"id":"engram-77","title":"[4.1a] Add Tests: apps/execution/src/index.ts","description":"# Task 4.1a: Add Tests for apps/execution/src/index.ts\n\n**Effort**: 6 hours\n**Current Coverage**: 0%\n**Target Coverage**: 80%\n**Parallel**: Can run with all Phase 4 tasks\n\n## File Under Test\n`apps/execution/src/index.ts`\n\n## Test Cases to Write\n1. Kafka consumer initialization\n2. Message processing pipeline\n3. Tool execution flow\n4. Error handling and recovery\n5. Graceful shutdown\n6. Rehydration from graph\n\n## Mocking Requirements\n- KafkaClient (MessageClient interface)\n- FalkorClient (GraphClient interface)\n- Tool executors\n- Logger\n\n## Test File Location\n`apps/execution/src/__tests__/index.test.ts`\n\n## Acceptance Criteria\n- [ ] 80% coverage achieved\n- [ ] All happy paths tested\n- [ ] Error scenarios covered\n- [ ] Edge cases documented\n- [ ] Mocks properly typed\n\n## References\n- docs/refactor/WORK_ORDER.md (line 100)\n- docs/refactor/apps/execution/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:37:04.649643-06:00","updated_at":"2025-12-19T15:32:08.369727-06:00","closed_at":"2025-12-09T04:39:05.499781-06:00","labels":["execution","parallel-ok","refactoring","testing"],"dependencies":[{"issue_id":"engram-77","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:04.652031-06:00","created_by":"daemon"}]}
{"id":"engram-77hp","title":"Migrate packages/infra from Pulumi to OpenTofu","description":"Replace Pulumi GCP infrastructure with OpenTofu for Hetzner Cloud VPS deployment.\n\n## Scope Change\n- **Remove**: All GCP resources (GKE, VPC, NAT, K8s workloads)\n- **Add**: Hetzner Cloud VPS with Docker Compose\n- **Simplification**: From managed K8s to single VPS\n\n## Key Files to Create\n- `main.tf`, `variables.tf`, `outputs.tf`\n- `server.tf` - Hetzner VPS with cloud-init\n- `firewall.tf` - SSH, HTTP, HTTPS rules\n- `tests/*.tftest.hcl` - Unit and integration tests\n\n## Testing with OpenTofu\nOpenTofu has native `tofu test` command:\n- Unit tests: `command = plan` (validates config without creating resources)\n- Integration tests: `command = apply` (creates real infra, then destroys)\n- Assertions in HCL with `assert` blocks\n\n## Migration Steps\n1. `pulumi destroy` existing GCP resources\n2. Delete Pulumi files (src/, Pulumi.yaml, etc.)\n3. Create OpenTofu HCL files\n4. `tofu init \u0026\u0026 tofu test \u0026\u0026 tofu apply`\n\n## Cost Savings\n- Before: ~$200/month (GKE + VPC + storage)\n- After: ~$19/month (Hetzner CPX31)\n\nSee: docs/plans/opentofu-hetzner-migration.md","status":"closed","priority":4,"issue_type":"feature","created_at":"2025-12-20T22:17:53.251606-06:00","updated_at":"2025-12-21T15:51:58.841691-06:00","closed_at":"2025-12-21T15:51:58.841691-06:00"}
{"id":"engram-78","title":"Add reranker health check endpoint","description":"GET /health/reranker: model loaded status, last inference time, error count last 5min, circuit breaker state.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-08T23:02:32.531406-06:00","updated_at":"2025-12-19T15:32:08.370065-06:00","closed_at":"2025-12-09T00:35:31.540248-06:00"}
{"id":"engram-79","title":"Implement Thinking Tag Extractor","description":"Stateful stream transformer to isolate \u003cthinking\u003e blocks. See docs/bitemporal/context/cognitive-ingestion/implement-thinking-tag-extractor.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:48:50.124994-06:00","updated_at":"2025-12-19T15:32:08.370318-06:00","closed_at":"2025-12-06T23:35:12.643676-06:00","labels":["ingestion","thinking","xml"],"dependencies":[{"issue_id":"engram-79","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.125395-06:00","created_by":"daemon"}]}
{"id":"engram-7cjq","title":"Add auth to /v1/tofu/force-unlock endpoint","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T22:20:57.837932-05:00","updated_at":"2025-12-22T22:22:15.420224-05:00","closed_at":"2025-12-22T22:22:15.420224-05:00"}
{"id":"engram-7d6p","title":"[Observatory Auth] Create Better Auth server configuration","description":"Replace Clerk-based lib/auth.ts with Better Auth server configuration. Reference: docs/observatory-auth-implementation-plan.md Step 3. File: apps/observatory/lib/auth.ts. Configure: PostgreSQL database adapter via pg Pool, Google OAuth social provider, session settings (7-day expiry, 24h update, 5min cookie cache), trustedOrigins for localhost and production. Export Session and User types for use in other files. DEPENDS ON: engram-lzxj (dependency update must be done first).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:40:09.516479-05:00","updated_at":"2025-12-22T00:52:44.712479-05:00","closed_at":"2025-12-22T00:52:44.712479-05:00","dependencies":[{"issue_id":"engram-7d6p","depends_on_id":"engram-lzxj","type":"blocks","created_at":"2025-12-22T00:40:21.243694-05:00","created_by":"ccheney"}]}
{"id":"engram-7fk61","title":"Configure Witness and Refinery agents","description":"Set up Witness for lifecycle monitoring and Refinery for merge queue processing to coordinate parallel agent work","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:43:22.628858-06:00","updated_at":"2026-01-01T18:55:14.709107-06:00","closed_at":"2026-01-01T18:55:14.709107-06:00","dependencies":[{"issue_id":"engram-7fk61","depends_on_id":"engram-72hoe","type":"blocks","created_at":"2026-01-01T18:43:45.273857-06:00","created_by":"ccheney"}]}
{"id":"engram-7flux","title":"Design entity extraction prompt","description":"Design and test the entity extraction prompt for optimal LLM extraction.\n\n## Prompt Requirements\n\n### Input Context\n- Memory content\n- Memory type (decision, insight, preference, fact, context)\n- List of existing entity names (for reuse/linking)\n\n### Output Structure\nRequest JSON with:\n- entities: [{name, type, context, confidence}]\n- relationships: [{from, to, type}]\n\n### Entity Type Guidance\nProvide clear definitions for each type:\n- tool: Software tools and utilities (pytest, Docker)\n- concept: Abstract ideas and domains (authentication, caching)\n- pattern: Design patterns and architectures (repository pattern, CQRS)\n- file: Source code files (link to FileTouch when possible)\n- person: People mentioned (@alice, team members)\n- project: Repositories, packages, services\n- technology: Languages, databases, frameworks (PostgreSQL, React)\n\n### Relationship Extraction\n- RELATED_TO: General semantic relationship\n- DEPENDS_ON: A requires B\n- IMPLEMENTS: A implements B (pattern/interface)\n- PART_OF: A is contained in B\n\n## Testing Scenarios\n| Memory Content | Expected Entities |\n|----------------|-------------------|\n| 'Use pytest for unit tests' | pytest (tool), unit tests (concept) |\n| 'Implement repository pattern' | repository pattern (pattern) |\n| 'Migrate from MySQL to PostgreSQL' | MySQL (technology), PostgreSQL (technology) |\n\n## Research\n- Graphiti extraction prompts: Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'extract_nodes prompt template'\n- Few-shot prompting for NER: Web search 'LLM few-shot entity extraction prompt engineering 2025'\n- Reference implementation: https://github.com/getzep/graphiti/blob/main/graphiti_core/prompts/extract_nodes.py","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:49.164753-06:00","updated_at":"2026-01-01T17:33:40.713439-06:00","closed_at":"2026-01-01T17:33:40.713439-06:00"}
{"id":"engram-7oqq","title":"Test coverage: apps/control/src/tools/router.ts (63%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:46.723958-06:00","updated_at":"2025-12-21T04:07:03.759289-06:00","closed_at":"2025-12-21T04:07:03.759289-06:00"}
{"id":"engram-7ty7","title":"Improve tests for search utils/metrics.py (74.7% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:35.056324-05:00","updated_at":"2025-12-27T01:59:35.056324-05:00"}
{"id":"engram-7x73","title":"Enforce tenant context on search routes","description":"All search API routes must require and validate tenant context.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 569)\n\n## Implementation\nUpdate apps/search/src/api/routes.py:\n- Extract org_id from request.state\n- Pass to all retriever/indexer calls\n- Reject requests without valid org context\n- No bypass path allowed\n\n## Files to Modify\n- apps/search/src/api/routes.py\n\n## Agent Instructions\nThis is a security boundary. All endpoints (/query, /multi-query, /session-aware) must enforce tenant filtering.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:29.218814-06:00","updated_at":"2025-12-29T22:52:34.283236-06:00","closed_at":"2025-12-29T22:52:34.283236-06:00","dependencies":[{"issue_id":"engram-7x73","depends_on_id":"engram-hq89","type":"blocks","created_at":"2025-12-29T22:12:59.383908-06:00","created_by":"ccheney"},{"issue_id":"engram-7x73","depends_on_id":"engram-kwmo","type":"blocks","created_at":"2025-12-29T22:13:05.922668-06:00","created_by":"ccheney"}]}
{"id":"engram-7yxo","title":"[CRITICAL] Race condition in flush/destroy in logger","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:09.397223-06:00","updated_at":"2025-12-20T23:45:30.483704-06:00","closed_at":"2025-12-20T23:45:30.483704-06:00"}
{"id":"engram-8","title":"LOW: Singleton embedders cause test pollution","description":"Locations:\n- packages/search-core/src/services/text-embedder.ts:38\n- packages/search-core/src/services/code-embedder.ts:47\n- packages/search-core/src/services/reranker.ts:9\n\nAll embedders use static singleton instances without cleanup methods. Tests cannot reset state between runs.\n\nFix: Add reset() or destroy() methods for testing.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T16:59:42.657948-06:00","updated_at":"2025-12-19T15:32:08.342704-06:00","closed_at":"2025-12-18T21:47:22.601759-06:00"}
{"id":"engram-80","title":"Implement Diff Block Extractor","description":"Logic to extract code search/replace blocks from the stream. See docs/bitemporal/context/cognitive-ingestion/implement-diff-block-extractor.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:48:50.169791-06:00","updated_at":"2025-12-19T15:32:08.370864-06:00","closed_at":"2025-12-06T23:36:10.386845-06:00","labels":["code","diff","ingestion"],"dependencies":[{"issue_id":"engram-80","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.170164-06:00","created_by":"daemon"}]}
{"id":"engram-806h","title":"[Console Redesign] Initialize shadcn/ui foundation","description":"## Overview\nInitialize shadcn/ui in the console app as the foundation for the UI redesign.\n\n## Tasks\n1. Run `bunx shadcn@latest init` in apps/console\n2. Configure components.json for Next.js 16 + React 19\n3. Choose \"new-york\" style (closer to current mission-control aesthetic)\n4. Install core utility functions (cn helper in lib/utils.ts)\n\n## Reference Files\n- apps/console/package.json\n- apps/console/tailwind.config.ts (if exists)\n- apps/console/app/globals.css\n\n## Research Context\n- shadcn/ui docs: https://ui.shadcn.com/docs/installation/next\n- Next.js 16 uses Turbopack by default\n- React 19.2 with View Transitions support\n- Tailwind CSS 4 already in use\n\n## Acceptance Criteria\n- [ ] shadcn/ui initialized with components.json\n- [ ] lib/utils.ts created with cn() function\n- [ ] Base styles configured\n- [ ] Test that basic component installation works","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:44:22.074848-06:00","updated_at":"2025-12-28T17:05:58.257963-06:00","closed_at":"2025-12-28T17:05:58.257963-06:00"}
{"id":"engram-81","title":"Implement Dead Letter Queue Handler","description":"Route failed parse events to 'ingestion.dead_letter'. See docs/bitemporal/context/cognitive-ingestion/implement-dead-letter-queue-handler.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:48:50.529054-06:00","updated_at":"2025-12-19T15:32:08.371204-06:00","closed_at":"2025-12-07T00:15:45.628975-06:00","labels":["dlq","error-handling","ingestion"],"dependencies":[{"issue_id":"engram-81","depends_on_id":"engram-70","type":"parent-child","created_at":"2025-12-06T21:48:50.529498-06:00","created_by":"daemon"}]}
{"id":"engram-82","title":"Implement Valid Time Logic","description":"Support for inserting facts with custom valid-time windows. See docs/bitemporal/context/bitemporal-memory/implement-valid-time-logic.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:50:33.761664-06:00","updated_at":"2025-12-19T15:32:08.371523-06:00","closed_at":"2025-12-06T22:26:05.395851-06:00","labels":["logic","memory","temporal"],"dependencies":[{"issue_id":"engram-82","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.762095-06:00","created_by":"daemon"}]}
{"id":"engram-83","title":"Implement Graph Pruning Strategy","description":"Cron job to retire old transaction history to cold storage. See docs/bitemporal/context/bitemporal-memory/implement-graph-pruning-strategy.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:50:33.849582-06:00","updated_at":"2025-12-19T15:32:08.371828-06:00","closed_at":"2025-12-06T23:57:25.889554-06:00","labels":["maintenance","memory","pruning"],"dependencies":[{"issue_id":"engram-83","depends_on_id":"engram-69","type":"parent-child","created_at":"2025-12-06T21:50:33.850043-06:00","created_by":"daemon"}]}
{"id":"engram-84","title":"Add rate limiting for LLM reranker tier","description":"Hard limit: 100 LLM rerank requests/hour per user. Track cost attribution. Alert on budget exceeded.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:30.438042-06:00","updated_at":"2025-12-19T15:32:08.372158-06:00","closed_at":"2025-12-09T00:13:49.372619-06:00"}
{"id":"engram-85","title":"[4.1e] Add Tests: apps/interface graph-queries.ts","description":"# Task 4.1e: Add Tests for Graph Queries\n\n**Effort**: 6 hours\n**Current Coverage**: 0%\n**Target Coverage**: 80%\n**Parallel**: Can run with all Phase 4 tasks\n\n## File Under Test\n`apps/interface/lib/graph-queries.ts`\n\n## Test Cases to Write\n1. Session queries\n2. Turn queries\n3. Lineage graph construction\n4. Time-travel queries\n5. Search result formatting\n6. Error handling\n\n## Mocking Requirements\n- FalkorClient responses\n- Various graph structures\n- Edge cases (empty results, cycles)\n\n## Test File Location\n`apps/interface/lib/__tests__/graph-queries.test.ts`\n\n## Acceptance Criteria\n- [ ] 80% coverage achieved\n- [ ] All query types tested\n- [ ] Graph construction verified\n- [ ] Edge cases covered\n- [ ] Response formatting tested\n\n## References\n- docs/refactor/WORK_ORDER.md (line 104)\n- docs/refactor/apps/interface/REPORT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T03:37:12.985069-06:00","updated_at":"2025-12-19T15:32:08.372422-06:00","closed_at":"2025-12-09T04:39:10.151148-06:00","labels":["interface","parallel-ok","refactoring","testing"],"dependencies":[{"issue_id":"engram-85","depends_on_id":"engram-179","type":"parent-child","created_at":"2025-12-09T03:37:12.985544-06:00","created_by":"daemon"}]}
{"id":"engram-86","title":"Implement A/B testing framework for reranker rollout","description":"Feature flags: rerank_enabled_pct, rerank_tier_override. Random assignment per session. Track metrics per variant.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:29.648023-06:00","updated_at":"2025-12-19T15:32:08.372717-06:00","closed_at":"2025-12-09T00:13:50.194887-06:00"}
{"id":"engram-87","title":"[0.3] Consolidate Domain Type Definitions","description":"# Task 0.3: Consolidate Domain Type Definitions\n\n**Effort**: 6 hours\n**Dependencies**: None\n**Blocks**: Task 3.1 (Repository Pattern)\n**Parallel**: Can run with 0.1, 0.2\n\n## Current State (Problem)\n- `packages/storage/src/falkor.ts` - Contains domain types (SessionProperties, TurnProperties)\n- `packages/memory-core/src/models/base.ts` - Re-exports with aliases (`FalkorSessionNode`)\n- Various apps define their own `Session` interfaces\n\n## Target State\n```\npackages/memory-core/src/\n  models/\n    base.ts           # Bitemporal types, BaseNode\n    nodes.ts          # All node types (Session, Turn, Reasoning, ToolCall)\n    edges.ts          # Edge types\n    events.ts         # Event types (moved from @engram/events)\n  index.ts            # Clean exports\n\npackages/storage/src/\n  falkor.ts           # Only FalkorDB-specific types (FalkorNode, FalkorEdge)\n```\n\n## Migration Steps\n1. Move domain types from `storage/falkor.ts` to `memory-core/models/`\n2. Update `storage/falkor.ts` to import from `memory-core` for domain types\n3. Remove aliased re-exports from `memory-core/models/base.ts`\n4. Update all consumers to import from `memory-core`\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 213-246)\n- docs/refactor/packages/memory-core/REPORT.md\n- docs/refactor/packages/storage/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:30:21.743562-06:00","updated_at":"2025-12-19T15:32:08.37296-06:00","closed_at":"2025-12-09T03:49:51.17081-06:00","labels":["foundation","parallel-ok","refactoring","types"],"dependencies":[{"issue_id":"engram-87","depends_on_id":"engram-223","type":"parent-child","created_at":"2025-12-09T03:30:21.744091-06:00","created_by":"daemon"}]}
{"id":"engram-870t","title":"Test coverage: apps/control/src/context/assembler.ts (95%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:09.99165-06:00","updated_at":"2025-12-21T04:07:03.769755-06:00","closed_at":"2025-12-21T04:07:03.769755-06:00"}
{"id":"engram-87ry","title":"feature","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:41.314933-06:00","updated_at":"2026-01-01T16:49:41.314933-06:00"}
{"id":"engram-88","title":"[0.2] Create Interface Layer in @engram/storage","description":"# Task 0.2: Create Interface Layer in @engram/storage\n\n**Effort**: 4 hours\n**Dependencies**: None\n**Blocks**: Tasks 1.1, 3.1, 3.3\n**Parallel**: Can run with 0.1, 0.3\n\n## Deliverables\n```typescript\n// packages/storage/src/interfaces.ts (NEW)\nexport interface GraphClient {\n  connect(): Promise\u003cvoid\u003e;\n  disconnect(): Promise\u003cvoid\u003e;\n  query\u003cT\u003e(cypher: string, params?: Record\u003cstring, unknown\u003e): Promise\u003cT[]\u003e;\n  isConnected(): boolean;\n}\n\nexport interface MessageClient {\n  getProducer(): Promise\u003cProducer\u003e;\n  getConsumer(config: ConsumerConfig): Promise\u003cConsumer\u003e;\n  disconnect(): Promise\u003cvoid\u003e;\n}\n\nexport interface BlobStore {\n  save(content: string | Buffer): Promise\u003cstring\u003e;\n  load(uri: string): Promise\u003cstring\u003e;\n}\n\nexport interface RedisPublisher {\n  publishSessionUpdate(sessionId: string, event: unknown): Promise\u003cvoid\u003e;\n  disconnect(): Promise\u003cvoid\u003e;\n}\n```\n\n## Changes Required\n- Update `FalkorClient` to implement `GraphClient`\n- Update `KafkaClient` to implement `MessageClient`\n- Export interfaces from `packages/storage/src/index.ts`\n- Add missing `redis.ts` export\n\n## Dependent Components (must update after)\n- apps/control - ContextAssembler, SessionInitializer\n- apps/memory - TurnAggregator, index.ts\n- apps/execution - Rehydrator, TimeTravelService\n- apps/search - SearchService\n- packages/memory-core - GraphWriter, GraphMerger, GraphPruner\n- packages/search-core - SearchRetriever, SearchIndexer\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 161-210)\n- docs/refactor/packages/storage/REPORT.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:30:08.754876-06:00","updated_at":"2025-12-19T15:32:08.373303-06:00","closed_at":"2025-12-09T03:49:51.134631-06:00","labels":["foundation","interfaces","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-88","depends_on_id":"engram-223","type":"parent-child","created_at":"2025-12-09T03:30:08.755326-06:00","created_by":"daemon"}]}
{"id":"engram-889b","title":"Create Log Viewer component","description":"Service selector, level filter, time range, search, live tail with pause/resume. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:53.098533-05:00","updated_at":"2025-12-27T17:28:41.931067-05:00","closed_at":"2025-12-27T17:28:41.931067-05:00","dependencies":[{"issue_id":"engram-889b","depends_on_id":"engram-o9sa","type":"blocks","created_at":"2025-12-27T04:28:14.740485-05:00","created_by":"ccheney"}]}
{"id":"engram-89","title":"[0.1] Create @engram/common Package","description":"# Task 0.1: Create @engram/common Package\n\n**Effort**: 4 hours\n**Dependencies**: None\n**Blocks**: Phases 1, 2, 3, 4, 5\n**Parallel**: Can run with 0.2, 0.3\n\n## Deliverables\n```\npackages/common/\n  package.json\n  tsconfig.json\n  src/\n    index.ts\n    utils/\n      env.ts       # envBool, envNum, envStr\n      hash.ts      # sha256Hash\n      format.ts    # formatRelativeTime, truncateId\n      retry.ts     # withRetry\n    errors/\n      base.ts      # EngramError\n      domain.ts    # GraphOperationError, ParseError, ValidationError\n    constants/\n      timeouts.ts  # GRAPH_QUERY_MS, TOOL_EXECUTION_MS\n      limits.ts    # CONTENT_MAX_LENGTH, HISTORY_ITEMS\n      intervals.ts # PRUNE_JOB_MS, STALE_TURN_CLEANUP_MS\n```\n\n## Acceptance Criteria\n- [ ] All apps can import `@engram/common`\n- [ ] Existing duplicate code removed from apps\n- [ ] Unit tests pass\n- [ ] Package exports all utilities\n\n## References\n- docs/refactor/WORK_ORDER.md (lines 124-158)\n- Duplicated code identified in all app reports","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T03:29:55.71324-06:00","updated_at":"2025-12-19T15:32:08.373647-06:00","closed_at":"2025-12-09T03:49:51.092613-06:00","labels":["foundation","new-package","parallel-ok","refactoring"],"dependencies":[{"issue_id":"engram-89","depends_on_id":"engram-223","type":"parent-child","created_at":"2025-12-09T03:29:55.713681-06:00","created_by":"daemon"}]}
{"id":"engram-8a0b","title":"Update recall to filter by vt_end","description":"Modify apps/mcp/src/tools/recall.ts and search service: add vtEndAfter filter to only return memories where vt_end \u003e now (still valid in reality)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:27.533787-06:00","updated_at":"2026-01-01T17:45:06.810617-06:00","closed_at":"2026-01-01T17:45:06.810617-06:00","dependencies":[{"issue_id":"engram-8a0b","depends_on_id":"engram-sc6d","type":"blocks","created_at":"2026-01-01T16:45:44.694156-06:00","created_by":"ccheney"}]}
{"id":"engram-8euz","title":"Create Deployments Table component","description":"Table with service, version, status, deployed time, rollback button. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:06.085321-05:00","updated_at":"2025-12-27T17:28:41.933054-05:00","closed_at":"2025-12-27T17:28:41.933054-05:00","dependencies":[{"issue_id":"engram-8euz","depends_on_id":"engram-jxgz","type":"blocks","created_at":"2025-12-27T04:27:34.502156-05:00","created_by":"ccheney"}]}
{"id":"engram-8gr3","title":"Add includeInvalidated filter option","description":"Add includeInvalidated boolean to RecallInput schema. When true, skip vt_end filtering to show all memories including invalidated ones","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:33.623403-06:00","updated_at":"2026-01-01T18:00:55.975416-06:00","closed_at":"2026-01-01T18:00:55.975416-06:00","dependencies":[{"issue_id":"engram-8gr3","depends_on_id":"engram-8a0b","type":"blocks","created_at":"2026-01-01T16:45:49.818776-06:00","created_by":"ccheney"}]}
{"id":"engram-8h1j","title":"Create Overview Dashboard page","description":"Main dashboard page with ServiceHealthGrid, MetricCards, system alerts, quick actions. Route: app/page.tsx. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:47.051677-05:00","updated_at":"2025-12-27T18:33:24.522319-05:00","closed_at":"2025-12-27T18:33:24.522319-05:00","dependencies":[{"issue_id":"engram-8h1j","depends_on_id":"engram-2bmi","type":"blocks","created_at":"2025-12-27T04:26:06.03835-05:00","created_by":"ccheney"},{"issue_id":"engram-8h1j","depends_on_id":"engram-4lry","type":"blocks","created_at":"2025-12-27T04:26:11.163701-05:00","created_by":"ccheney"}]}
{"id":"engram-8hyrq","title":"Add tests for packages/graph repositories","description":"Missing tests for 12+ files in packages/graph including:\n- graph.ts (main graph implementation)\n- repositories/falkor-*.repository.ts (FalkorDB repositories)\n- repositories/memory.repository.ts\n- repositories/session.repository.ts\n- repositories/turn.repository.ts\n- models/base.ts (bitemporal schema)\n- models/nodes.ts, models/edges.ts\n\nPriority: HIGH - Core bitemporal graph functionality","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:20:25.592424-06:00","updated_at":"2026-01-01T17:20:25.592424-06:00"}
{"id":"engram-8ktc","title":"Improve tests for search middleware/auth.py (76.7% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:22.944259-05:00","updated_at":"2025-12-27T01:59:22.944259-05:00"}
{"id":"engram-8l1k","title":"Remove unused PostgreSQL connection options","description":"packages/storage postgres.ts:7-9 defines maxConnections, idleTimeoutMs, connectionTimeoutMs but all callers use defaults. Either use or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:23.15205-06:00","updated_at":"2025-12-20T23:24:12.875303-06:00","closed_at":"2025-12-20T23:24:12.875303-06:00"}
{"id":"engram-8mld","title":"Test coverage: packages/storage/src/redis.ts (96%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:16.645517-06:00","updated_at":"2025-12-21T04:07:03.766918-06:00","closed_at":"2025-12-21T04:07:03.766918-06:00"}
{"id":"engram-8ou5","title":"Test coverage: packages/parser/src/parser/anthropic.ts (86%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:21:01.501298-06:00","updated_at":"2025-12-21T04:07:03.75277-06:00","closed_at":"2025-12-21T04:07:03.75277-06:00"}
{"id":"engram-8z2o","title":"Include orgId in NATS event payloads","description":"Add orgId to all NATS event payloads for downstream tenant isolation.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'NATS Subject Patterns' section (lines 608-627)\n\n## Implementation\nUpdate apps/ingestion/src/index.ts:\n- Include orgId in event payload (not subject)\n- Add x-org-id header propagation if present\n- Event structure: { orgId, sessionId, ...eventData }\n\n## Files to Modify\n- apps/ingestion/src/index.ts\n\n## Agent Instructions\nDecision: Keep shared subjects with orgId in payload (per plan). Storage-layer isolation is sufficient.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:49.606833-06:00","updated_at":"2025-12-29T23:17:21.322972-06:00","closed_at":"2025-12-29T23:17:21.322972-06:00","dependencies":[{"issue_id":"engram-8z2o","depends_on_id":"engram-9k07","type":"blocks","created_at":"2025-12-29T22:12:34.940358-06:00","created_by":"ccheney"}]}
{"id":"engram-9","title":"Fix port conflicts in search-core tests (5001, 5002)","description":"Tests in search-core fail with EADDRINUSE on ports 5001 and 5002. The test setup/teardown is not properly cleaning up server instances, or tests are running in parallel without isolated port assignments. Need to either use dynamic port allocation or ensure proper cleanup between test suites.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-09T18:24:27.307264-06:00","updated_at":"2025-12-19T15:32:08.343018-06:00","closed_at":"2025-12-19T01:01:27.844794-06:00"}
{"id":"engram-90","title":"Add search settings panel for reranker configuration","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T23:44:10.003249-06:00","updated_at":"2025-12-19T15:32:08.375241-06:00","closed_at":"2025-12-09T00:08:26.75304-06:00"}
{"id":"engram-91","title":"Create Time Travel State Reconstruction","description":"Export VFS state at specific event_id. See docs/bitemporal/context/deterministic-execution/create-time-travel-state-reconstruction.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:52:13.09828-06:00","updated_at":"2025-12-19T15:32:08.375509-06:00","closed_at":"2025-12-06T23:52:26.332942-06:00","labels":["debugging","execution","time-travel"],"dependencies":[{"issue_id":"engram-91","depends_on_id":"engram-68","type":"parent-child","created_at":"2025-12-06T21:52:13.098657-06:00","created_by":"daemon"}]}
{"id":"engram-916x","title":"[Benchmark-Py] Phase 2c: Metrics","description":"Implement evaluation metrics using ranx and RAGAS. QA accuracy with optional LLM-based evaluation (GPT-4o style, 97% human agreement). IR metrics via ranx (NDCG@K, MRR, MAP, Recall@K). Abstention metrics (precision, recall, F1). RAGAS integration for faithfulness, answer relevancy, context precision/recall. Latency percentiles.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 4: Evaluation Metrics)\n\nDeliverables:\n- src/engram_benchmark/metrics/qa.py - QA accuracy\n- src/engram_benchmark/metrics/retrieval.py - ranx-based IR metrics\n- src/engram_benchmark/metrics/abstention.py - Abstention F1\n- src/engram_benchmark/metrics/ragas.py - RAGAS integration\n- Unit tests for each metric type\n- Parity tests vs TypeScript metrics\n\nCAN BE DEVELOPED IN PARALLEL WITH: [Benchmark-Py] Phase 2a: LLM, Phase 2b: Retrieval","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:24:03.742304-06:00","updated_at":"2025-12-20T08:20:23.447082-06:00","closed_at":"2025-12-20T08:20:23.447082-06:00","dependencies":[{"issue_id":"engram-916x","depends_on_id":"engram-fpr1","type":"blocks","created_at":"2025-12-20T07:25:15.303232-06:00","created_by":"ccheney"}]}
{"id":"engram-91xk","title":"Comprehensive Engram MCP testing","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T01:37:25.8633-05:00","updated_at":"2025-12-27T01:40:42.498622-05:00","closed_at":"2025-12-27T01:40:42.498622-05:00"}
{"id":"engram-92","title":"[EPIC] Observability \u0026 Metrics","description":"Prometheus metrics, structured logging, and dashboards for reranking performance (Section 11)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T23:01:26.84727-06:00","updated_at":"2025-12-19T15:32:08.375802-06:00","closed_at":"2025-12-08T23:58:39.524708-06:00","dependencies":[{"issue_id":"engram-92","depends_on_id":"engram-210","type":"blocks","created_at":"2025-12-08T23:03:04.506242-06:00","created_by":"daemon"}]}
{"id":"engram-92jt","title":"Require API key auth on all public endpoints","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:59:33.240551-06:00","updated_at":"2025-12-21T23:21:37.583763-05:00","closed_at":"2025-12-21T23:21:37.583763-05:00"}
{"id":"engram-93","title":"Implement lazy model loading with unload on idle","description":"Load reranker models on first use. Unload after 5min idle to prevent OOM. Track model_loaded/model_unloaded events.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:28.222358-06:00","updated_at":"2025-12-19T15:32:08.376065-06:00","closed_at":"2025-12-09T00:13:51.319618-06:00"}
{"id":"engram-94","title":"Add cache metrics and hit rate tracking","description":"Track cache_hits, cache_misses, cache_evictions counters. Expose hit_rate gauge.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T23:02:15.883625-06:00","updated_at":"2025-12-19T15:32:08.376298-06:00","closed_at":"2025-12-09T00:24:40.686967-06:00"}
{"id":"engram-95","title":"Fix tool extraction from LLM output","description":"The DecisionEngine in control/src/engine/decision.ts may not properly extract tool calls from LLM generateText response. Need to verify tool_calls parsing and handle edge cases where structured output is malformed. Ref: define-decision-loop-logic.md","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T02:06:09.319012-06:00","updated_at":"2025-12-19T15:32:08.376517-06:00","closed_at":"2025-12-08T02:31:05.742627-06:00"}
{"id":"engram-96","title":"Fix rehydrator session filtering","description":"The Rehydrator in execution-core/src/rehydrator.ts has incomplete session filtering. Cypher queries may return global results instead of session-specific. Need to add session_id parameter to all graph queries. Ref: create-file-state-rehydrator.md","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T02:06:08.160022-06:00","updated_at":"2025-12-19T15:32:08.376746-06:00","closed_at":"2025-12-08T02:23:19.701376-06:00"}
{"id":"engram-97","title":"Implement archive before graph pruning","description":"GraphPruner deletes old transaction history without archiving first. Need to export to JSONL before deletion, then upload to GCS cold storage to preserve audit trail. Ref: implement-graph-pruning-strategy.md","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T02:06:07.02924-06:00","updated_at":"2025-12-19T15:32:08.376998-06:00","closed_at":"2025-12-08T02:32:57.807637-06:00"}
{"id":"engram-97zc","title":"Test coverage: apps/control/src/tools/registry.ts (97%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:40.699026-06:00","updated_at":"2025-12-21T04:07:03.760955-06:00","closed_at":"2025-12-21T04:07:03.760955-06:00"}
{"id":"engram-98","title":"Add code-specific embedding model","description":"Code embedding currently uses the same text model (e5-small) as text, which is suboptimal for code semantics. Need to switch to nomic-embed-text-v1.5 or similar code model with 8k context, and implement chunking for large files. Ref: select-code-embedding-model.md","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T02:06:06.160641-06:00","updated_at":"2025-12-19T15:32:08.377218-06:00","closed_at":"2025-12-08T02:21:00.601945-06:00"}
{"id":"engram-98eb","title":"[Cleanup] Update dependent packages","description":"Update packages that previously depended on @engram/search to use HTTP client to search-py service.\n\nNO BACKWARDS COMPATIBILITY - direct integration removed.\n\nPackages to update:\n- apps/mcp: Update search tools to call search-py via HTTP\n- apps/memory: Remove any @engram/search imports if present\n- Any other packages importing from @engram/search\n\nDeliverables:\n- HTTP client for search-py in affected packages\n- Remove all @engram/search imports\n- Update tests to use HTTP mocks\n- Verify all affected packages build and pass tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T07:30:30.470439-06:00","updated_at":"2025-12-20T10:26:50.08099-06:00","closed_at":"2025-12-20T10:26:50.08099-06:00","dependencies":[{"issue_id":"engram-98eb","depends_on_id":"engram-ahjy","type":"blocks","created_at":"2025-12-20T07:31:13.725872-06:00","created_by":"ccheney"}]}
{"id":"engram-99","title":"Implement Wasm sandbox for code execution isolation","description":"The original Wassette (Wasm sandbox) concept is not implemented. Execution service operates directly on VFS without isolation. Need to integrate Wasmtime or similar, define capability-based permissions, enforce memory/CPU limits. Ref: define-wassette-runtime-configuration.md, develop-sandbox-security-policy.md","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-08T02:06:05.270576-06:00","updated_at":"2025-12-19T15:32:08.377458-06:00","closed_at":"2025-12-08T02:07:44.391937-06:00"}
{"id":"engram-998p","title":"Create packages/auth-mock for CI testing without database","description":"Create packages/auth-mock package for CI testing without database dependencies. Implement mock OAuth endpoints that return valid tokens without PostgreSQL. Minimal HTTP server exposing POST /token (client credentials + device code grants), POST /introspect (RFC 7662), GET /.well-known/oauth-authorization-server (RFC 8414). Returns tokens with valid egm_oauth_* format and CRC32 checksums. Accepts any client_id/client_secret for testing. Used in GitHub Actions CI pipelines where spinning up PostgreSQL is slow or undesirable. Package structure: packages/auth-mock/src/server.ts (HTTP server), packages/auth-mock/src/tokens.ts (token generation using device-auth.ts patterns), packages/auth-mock/package.json. Export CLI: bun run auth-mock to start server on PORT env var. Research OAuth mock server patterns for 2025 best practices (use WebSearch or Context7 with oauth mock testing libraries).","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:56:15.976629-06:00","updated_at":"2025-12-29T17:07:05.362176-06:00","closed_at":"2025-12-29T17:07:05.362176-06:00","dependencies":[{"issue_id":"engram-998p","depends_on_id":"engram-qiua","type":"blocks","created_at":"2025-12-29T16:03:40.005383-06:00","created_by":"ccheney"}]}
{"id":"engram-9a36","title":"[Console Redesign] Add loading skeletons and feedback components","description":"## Overview\nAdd consistent loading skeletons and feedback components across all pages.\n\n## Components to Add\n\n### Skeleton Patterns\n```tsx\n// Card skeleton\nexport function CardSkeleton() {\n  return (\n    \u003cCard\u003e\n      \u003cCardHeader\u003e\n        \u003cSkeleton className=\"h-4 w-[150px]\" /\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cSkeleton className=\"h-8 w-[100px] mb-2\" /\u003e\n        \u003cSkeleton className=\"h-[60px] w-full\" /\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  )\n}\n\n// Table row skeleton\nexport function TableRowSkeleton({ columns }: { columns: number }) {\n  return (\n    \u003cTableRow\u003e\n      {Array.from({ length: columns }).map((_, i) =\u003e (\n        \u003cTableCell key={i}\u003e\n          \u003cSkeleton className=\"h-4 w-full\" /\u003e\n        \u003c/TableCell\u003e\n      ))}\n    \u003c/TableRow\u003e\n  )\n}\n\n// Chart skeleton\nexport function ChartSkeleton() {\n  return (\n    \u003cdiv className=\"h-[300px] w-full\"\u003e\n      \u003cSkeleton className=\"h-full w-full\" /\u003e\n    \u003c/div\u003e\n  )\n}\n```\n\n### Toast Notifications (Sonner)\n```tsx\n// In providers.tsx or layout\nimport { Toaster } from \"@/components/ui/sonner\"\n\n// Usage\nimport { toast } from \"sonner\"\n\n// Success\ntoast.success(\"Changes saved successfully\")\n\n// Error\ntoast.error(\"Failed to save changes\", {\n  description: error.message,\n})\n\n// Loading with promise\ntoast.promise(saveData(), {\n  loading: \"Saving...\",\n  success: \"Saved!\",\n  error: \"Failed to save\",\n})\n```\n\n### Alert Component\n```tsx\n\u003cAlert variant=\"destructive\"\u003e\n  \u003cAlertCircle className=\"h-4 w-4\" /\u003e\n  \u003cAlertTitle\u003eError\u003c/AlertTitle\u003e\n  \u003cAlertDescription\u003e\n    {error.message}\n  \u003c/AlertDescription\u003e\n\u003c/Alert\u003e\n\n\u003cAlert variant=\"warning\"\u003e\n  \u003cAlertTriangle className=\"h-4 w-4\" /\u003e\n  \u003cAlertTitle\u003eWarning\u003c/AlertTitle\u003e\n  \u003cAlertDescription\u003e\n    Service degradation detected\n  \u003c/AlertDescription\u003e\n\u003c/Alert\u003e\n```\n\n### Spinner Component\n```tsx\nimport { Spinner } from \"@/components/ui/spinner\"\n\n\u003cButton disabled={isLoading}\u003e\n  {isLoading \u0026\u0026 \u003cSpinner className=\"mr-2\" /\u003e}\n  Save Changes\n\u003c/Button\u003e\n```\n\n## Files to Create/Update\n- components/shared/card-skeleton.tsx\n- components/shared/table-skeleton.tsx\n- components/shared/chart-skeleton.tsx\n- app/providers.tsx (add Toaster)\n- Standardize loading patterns across all pages\n\n## Integration Points\n- All data fetching hooks should show skeletons\n- All mutations should show toast feedback\n- Error boundaries should show Alert components\n- Buttons should show spinners during loading\n\n## Acceptance Criteria\n- [ ] Skeleton components created\n- [ ] Sonner toaster added to providers\n- [ ] Toast notifications for all mutations\n- [ ] Alert components for error states\n- [ ] Consistent loading patterns\n- [ ] Spinner in buttons during loading","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:50:58.170549-06:00","updated_at":"2025-12-28T17:28:26.229593-06:00","closed_at":"2025-12-28T17:28:26.229593-06:00","dependencies":[{"issue_id":"engram-9a36","depends_on_id":"engram-p0ks","type":"blocks","created_at":"2025-12-28T16:53:09.360978-06:00","created_by":"ccheney"}]}
{"id":"engram-9aj7","title":"[HIGH] Redis subscriber race condition in packages/storage","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:04.559514-06:00","updated_at":"2025-12-20T23:58:50.32223-06:00","closed_at":"2025-12-20T23:58:50.32223-06:00"}
{"id":"engram-9alm","title":"Test coverage: packages/tuner/src/executor/evaluation-adapter.ts (5%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:59.01007-06:00","updated_at":"2025-12-21T01:43:08.623524-06:00","closed_at":"2025-12-21T01:43:08.623524-06:00"}
{"id":"engram-9fhs","title":"Create TenantAwareFalkorClient","description":"Implement tenant-aware FalkorDB client with dynamic graph selection.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'FalkorDB Graph Selection' section (lines 399-424)\n\n## Implementation\nUpdate packages/storage/src/falkor.ts:\n- Create TenantAwareFalkorClient class\n- selectTenantGraph(ctx: TenantContext) → Graph\n- ensureTenantGraph(ctx: TenantContext) → creates indexes\n- getGraphName(ctx: TenantContext) → engram_{slug}_{id}\n\n## Key Code:\n```typescript\nexport function getGraphName(ctx: TenantContext): string {\n    return \\`engram_${ctx.orgSlug}_${ctx.orgId}\\`;\n}\n\nexport class TenantAwareFalkorClient {\n    async selectTenantGraph(ctx: TenantContext): Promise\u003cGraph\u003e {\n        const graphName = getGraphName(ctx);\n        return this.db.selectGraph(graphName);\n    }\n}\n```\n\n## Current State\n- Line 74 has hardcoded graphName = 'EngramGraph'\n- Need to refactor to accept TenantContext\n\n## Files to Modify\n- packages/storage/src/falkor.ts\n\n## Agent Instructions\nUse Context7 MCP for FalkorDB Node.js client docs. Web search 'FalkorDB selectGraph multi-tenant'. Preserve existing functionality while adding tenant support.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:05.41886-06:00","updated_at":"2025-12-29T22:27:24.350698-06:00","closed_at":"2025-12-29T22:27:24.350698-06:00","dependencies":[{"issue_id":"engram-9fhs","depends_on_id":"engram-1pwm","type":"blocks","created_at":"2025-12-29T22:12:01.075045-06:00","created_by":"ccheney"}]}
{"id":"engram-9i9z","title":"Add tests for apps/memory/src/index.ts (32.4% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:38.761948-05:00","updated_at":"2025-12-27T01:58:38.761948-05:00"}
{"id":"engram-9k07","title":"Update ingestion auth for org extraction","description":"Extract orgId from OAuth token in ingestion service.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Ingestion Service' section (lines 517-520)\n\n## Implementation\nUpdate apps/ingestion/src/auth.ts:\n- Parse org_id, org_slug from token validation response\n- Create TenantContext or attach to request\n- Make available for downstream event publishing\n\n## Files to Modify\n- apps/ingestion/src/auth.ts\n\n## Agent Instructions\nReview existing auth flow. Ensure org context flows through to NATS publishing.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:36.714571-06:00","updated_at":"2025-12-29T22:52:34.281736-06:00","closed_at":"2025-12-29T22:52:34.281736-06:00","dependencies":[{"issue_id":"engram-9k07","depends_on_id":"engram-nnmx","type":"blocks","created_at":"2025-12-29T22:12:28.576279-06:00","created_by":"ccheney"}]}
{"id":"engram-9l70","title":"[CRITICAL] Missing event_id generation in packages/events","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:38.842727-06:00","updated_at":"2025-12-20T23:45:30.480735-06:00","closed_at":"2025-12-20T23:45:30.480735-06:00"}
{"id":"engram-9qh9","title":"Test coverage: apps/mcp/src/services/memory-retriever.ts (branches 74%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:28.611795-06:00","updated_at":"2025-12-21T04:07:03.764118-06:00","closed_at":"2025-12-21T04:07:03.764118-06:00"}
{"id":"engram-9xcao","title":"Add entity search to recall reranking","description":"Modify reranking to incorporate graph distance as a scoring factor.\n\n## Scoring Formula\n```\nfinalScore = relevance * (1 - graphWeight) + graphScore * graphWeight\n```\n\nWhere graphWeight is configurable (default: 0.3)\n\n## Graph Score Components\n\n### Hop Distance\n- Direct mention (1 hop): score = 1.0\n- 2 hops: score = 0.7\n- 3+ hops: score = 0.5\n\n### Entity Popularity\n- mention_count normalization: log(mention_count + 1) / log(max_count + 1)\n- Popular entities boost related memories\n\n### Relationship Type Weights\n- MENTIONS: 1.0 (direct reference)\n- RELATED_TO: 0.8 (semantic connection)\n- DEPENDS_ON: 0.9 (strong connection)\n- IMPLEMENTS: 0.85\n\n## Integration with Existing Rerankers\n- Apply graph score AFTER vector reranking\n- Combine with reranker tiers (fast, accurate, code, llm)\n- Graph expansion happens before reranking\n\n## Implementation\n```typescript\ninterface GraphScoredResult extends RecallResult {\n  source: 'vector' | 'graph';\n  graphDistance?: number;\n  graphScore?: number;\n}\n```\n\n## Research\n- Reranking with graph features: Web search 'knowledge graph reranking scoring function 2025'\n- HybridRAG fusion: https://arxiv.org/abs/2408.04948\n- Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'search rerank score'","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:26.09779-06:00","updated_at":"2026-01-01T17:09:19.069017-06:00","dependencies":[{"issue_id":"engram-9xcao","depends_on_id":"engram-kve0y","type":"blocks","created_at":"2026-01-01T16:55:26.322774-06:00","created_by":"ccheney"},{"issue_id":"engram-9xcao","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:19.326351-06:00","created_by":"ccheney"}]}
{"id":"engram-9yah","title":"Use config.py settings instead of hardcoded constants","description":"apps/search/src/config.py defines search_min_score_dense, search_min_score_sparse, search_min_score_hybrid, search_default_limit, search_max_limit but retriever uses hardcoded values from constants.py instead.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:00:53.599249-06:00","updated_at":"2025-12-20T23:07:49.467075-06:00","closed_at":"2025-12-20T23:07:49.467075-06:00"}
{"id":"engram-a4ur","title":"Test coverage: packages/graph/src/repositories/falkor-tool-call.repository.ts (56%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:17.151011-06:00","updated_at":"2025-12-21T04:07:03.766671-06:00","closed_at":"2025-12-21T04:07:03.766671-06:00"}
{"id":"engram-a7tv","title":"Create ConflictDecision audit schema","description":"Add packages/graph/src/models/conflict-decision.ts: newMemoryId, existingMemoryId, relation, reason, modelUsed, userConfirmed, actionTaken, timestamp, orgId","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:27.485887-06:00","updated_at":"2026-01-01T17:45:06.807684-06:00","closed_at":"2026-01-01T17:45:06.807684-06:00"}
{"id":"engram-a89d","title":"Add org_id/org_slug to users table","description":"Update users table schema to include organization reference with RLS policies.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Users (with RLS)' section (lines 199-228)\n\n## Implementation\nUpdate users table in apps/observatory/src/db/schema.ts:\n- Add orgId foreign key reference to organizations\n- Enable RLS with pgTable.withRLS()\n- Add tenant isolation policy using current_setting('app.current_org_id')\n- Add service role bypass policy\n\n## Key Schema:\n```typescript\nexport const users = pgTable.withRLS(\n  'users',\n  {\n    // existing fields...\n    orgId: text('org_id').references(() =\u003e organizations.id),\n  },\n  (table) =\u003e [\n    pgPolicy('users_tenant_isolation', {\n      as: 'permissive',\n      for: 'all',\n      to: authenticatedRole,\n      using: sql`org_id = current_setting('app.current_org_id', true)`,\n    }),\n  ]\n);\n```\n\n## Files to Modify\n- apps/observatory/src/db/schema.ts\n\n## Agent Instructions\nUse Context7 MCP for Drizzle RLS documentation. Web search 'drizzle-orm withRLS pgPolicy 2025'.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:49.202942-06:00","updated_at":"2025-12-29T22:26:39.614647-06:00","closed_at":"2025-12-29T22:26:39.614647-06:00","dependencies":[{"issue_id":"engram-a89d","depends_on_id":"engram-qnh3","type":"blocks","created_at":"2025-12-29T22:11:59.052575-06:00","created_by":"ccheney"}]}
{"id":"engram-abtx","title":"Security tests for cross-tenant access prevention","description":"Security-focused tests for cross-tenant attack prevention.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Testing Strategy section (lines 654-658)\n\n## Test Cases\n- Token tampering detection (modified org_id)\n- Cross-tenant Cypher injection attempts\n- Missing org_id filter bypass attempts\n- RLS bypass prevention\n- Admin scope elevation attempts\n\n## Files to Create\n- tests/security/cross-tenant.test.ts\n\n## Agent Instructions\nThink like an attacker. Test all boundaries where tenant isolation is enforced.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:33.743452-06:00","updated_at":"2025-12-30T00:02:12.200147-06:00","closed_at":"2025-12-30T00:02:12.200147-06:00","dependencies":[{"issue_id":"engram-abtx","depends_on_id":"engram-gcmr","type":"blocks","created_at":"2025-12-29T22:12:49.836121-06:00","created_by":"ccheney"}]}
{"id":"engram-acypa","title":"Create workflow formulas for common patterns","description":"Define TOML formulas in .beads/formulas/ for: implement-feature, fix-bug, add-tests, refactor-module, and research-task workflows","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:43:16.638444-06:00","updated_at":"2026-01-01T18:55:14.707597-06:00","closed_at":"2026-01-01T18:55:14.707597-06:00","dependencies":[{"issue_id":"engram-acypa","depends_on_id":"engram-72hoe","type":"blocks","created_at":"2026-01-01T18:43:40.109208-06:00","created_by":"ccheney"}]}
{"id":"engram-af13k","title":"Add conflict dashboard to Observatory","description":"Create apps/observatory/app/(dashboard)/conflicts/page.tsx showing pending ConflictReports. Display source and target memory content, relation, reason. Add resolve/dismiss buttons with confirmation.\n\n## UI Components\n- ConflictList: Paginated list of pending reports\n- ConflictCard: Source/target content side-by-side, relation badge, reason\n- ResolutionDialog: Confirm action with options (invalidate source/target/keep both)\n- ConflictFilters: Filter by project, relation type, date range\n\n## API Integration\n- GET /api/conflicts?status=pending_review\u0026project=X\n- POST /api/conflicts/:id/resolve { action, reason }\n- POST /api/conflicts/:id/dismiss { reason }\n\n## Before Implementation\nUse Context7 MCP: Query 'next.js' for App Router patterns and server actions.\n\nReview Observatory UI patterns: apps/observatory/app/(dashboard)/\n\n## References\n- Observatory layouts: apps/observatory/app/(dashboard)/layout.tsx\n- UI components: apps/observatory/components/\n- shadcn/ui: Use MCP shadcn tools for component patterns","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:44.640781-06:00","updated_at":"2026-01-01T17:11:46.248438-06:00","dependencies":[{"issue_id":"engram-af13k","depends_on_id":"engram-cfcug","type":"blocks","created_at":"2026-01-01T16:53:15.55836-06:00","created_by":"ccheney"}]}
{"id":"engram-afpw","title":"Add tests for apps/api/src/middleware/scopes.ts (12.5% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:20.538681-05:00","updated_at":"2025-12-27T01:58:20.538681-05:00"}
{"id":"engram-ahjy","title":"[Cleanup] Remove packages/search (TypeScript)","description":"Remove deprecated TypeScript search package after Python migration is complete.\n\nNO BACKWARDS COMPATIBILITY - clean removal.\n\nDeliverables:\n- Delete packages/search/ directory\n- Remove from turbo.json\n- Remove @engram/search from all package.json dependencies\n- Update imports in dependent packages:\n  - packages/benchmark (will be removed separately)\n  - apps/mcp (update to use HTTP client to search-py)\n  - Any other consumers\n- Remove from root package.json workspaces","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T07:30:17.786377-06:00","updated_at":"2025-12-20T10:18:04.904251-06:00","closed_at":"2025-12-20T10:18:04.904251-06:00","dependencies":[{"issue_id":"engram-ahjy","depends_on_id":"engram-jkke","type":"blocks","created_at":"2025-12-20T07:30:58.219479-06:00","created_by":"ccheney"},{"issue_id":"engram-ahjy","depends_on_id":"engram-mija","type":"blocks","created_at":"2025-12-20T07:31:03.399898-06:00","created_by":"ccheney"}]}
{"id":"engram-aiaj","title":"Test coverage: packages/temporal/src/rehydrator.ts (78%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:28.934188-06:00","updated_at":"2025-12-21T01:43:34.363926-06:00","closed_at":"2025-12-21T01:43:34.363926-06:00"}
{"id":"engram-akrz","title":"Test coverage: packages/storage/src/blob.ts (96%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:47.668161-06:00","updated_at":"2025-12-21T04:07:03.758663-06:00","closed_at":"2025-12-21T04:07:03.758663-06:00"}
{"id":"engram-am3g","title":"[CRITICAL] Blocking Optuna operations in async endpoints","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:24:02.264137-06:00","updated_at":"2025-12-20T23:45:30.47841-06:00","closed_at":"2025-12-20T23:45:30.47841-06:00"}
{"id":"engram-am54","title":"Create Qdrant tenant index with is_tenant=true","description":"Add tenant-aware index to Qdrant collections using is_tenant=true flag.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Qdrant Tenant Indexing' section (lines 428-451)\n\n## Implementation\nUpdate apps/search/src/services/schema_manager.py:\n```python\nasync def ensure_tenant_index(client: QdrantClient, collection_name: str) -\u003e None:\n    await client.create_payload_index(\n        collection_name=collection_name,\n        field_name='org_id',\n        field_schema=models.KeywordIndexParams(\n            type='keyword',\n            is_tenant=True,  # Qdrant 1.16+ co-locates tenant vectors\n        ),\n    )\n```\n\n## Files to Create/Modify\n- apps/search/src/services/schema_manager.py\n\n## Agent Instructions\nUse Context7 MCP for Qdrant Python client docs. Web search 'Qdrant is_tenant index multitenancy 1.16'.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:29.534161-06:00","updated_at":"2025-12-29T22:28:41.547126-06:00","closed_at":"2025-12-29T22:28:41.547126-06:00","dependencies":[{"issue_id":"engram-am54","depends_on_id":"engram-1pwm","type":"blocks","created_at":"2025-12-29T22:12:44.653006-06:00","created_by":"ccheney"}]}
{"id":"engram-aq35","title":"Test coverage: apps/mcp/src/ingest/handlers.ts (89%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:22.615636-06:00","updated_at":"2025-12-21T04:07:03.765791-06:00","closed_at":"2025-12-21T04:07:03.765791-06:00"}
{"id":"engram-aqv1","title":"Remove mock data from logs/page.tsx","description":"Remove generateMockLogs function and mock log generation from Logs page (lines 232-296, 316-317, 334). Replace with proper 'No logs available' state when API fails.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:53:44.340187-05:00","updated_at":"2025-12-27T20:04:22.76673-05:00","closed_at":"2025-12-27T20:04:22.76673-05:00"}
{"id":"engram-aqza","title":"Test coverage: packages/temporal/src/errors.ts (84%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:22.830715-06:00","updated_at":"2025-12-21T01:43:39.514618-06:00","closed_at":"2025-12-21T01:43:39.514618-06:00"}
{"id":"engram-asf1","title":"Test coverage: apps/mcp/src/clients/search.ts (functions 66%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:16.560647-06:00","updated_at":"2025-12-21T04:07:03.767236-06:00","closed_at":"2025-12-21T04:07:03.767236-06:00"}
{"id":"engram-askd","title":"Run ts5to6 migration tool to fix rootDir","description":"Run npx @andrewbranch/ts5to6 --fixRootDir on all tsconfig files to ensure explicit rootDir with outDir","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:37:34.082571-06:00","updated_at":"2025-12-20T22:28:59.125072-06:00","closed_at":"2025-12-20T22:28:59.125072-06:00","dependencies":[{"issue_id":"engram-askd","depends_on_id":"engram-5jiq","type":"blocks","created_at":"2025-12-20T21:38:43.080614-06:00","created_by":"ccheney"}]}
{"id":"engram-atad","title":"Run tofu apply to provision Hetzner VPS","description":"Apply OpenTofu configuration to create Hetzner infrastructure.\n\n## Prerequisites\n- OpenTofu files written and validated\n- Hetzner API token available\n- SSH key exists locally\n\n## Steps\n1. `cd packages/infra`\n2. `export TF_VAR_hcloud_token=your_token`\n3. `tofu plan` - review changes\n4. `tofu apply` - create resources\n5. Note server IP from output\n\n## Expected resources created\n- hcloud_ssh_key (engram-key)\n- hcloud_server (CPX31, Ashburn VA)\n- hcloud_firewall (SSH, HTTP, HTTPS rules)\n- hcloud_firewall_attachment\n\n## Verification\n```bash\ntofu output server_ip\nssh engram@$(tofu output -raw server_ip)\ndocker --version  # Should work via cloud-init\n```\n\n## Acceptance Criteria\n- VPS is running\n- SSH access works\n- Docker is installed\n- Firewall rules are active","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:49:58.850213-06:00","updated_at":"2025-12-21T15:49:58.850213-06:00","dependencies":[{"issue_id":"engram-atad","depends_on_id":"engram-ksqn","type":"blocks","created_at":"2025-12-21T15:51:27.693103-06:00","created_by":"ccheney"},{"issue_id":"engram-atad","depends_on_id":"engram-bjmv","type":"blocks","created_at":"2025-12-21T15:51:32.836909-06:00","created_by":"ccheney"}]}
{"id":"engram-atbz","title":"Test coverage: packages/infra/src/k8s/tuner.ts (branches 72%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:30.297748-06:00","updated_at":"2025-12-21T04:07:03.763224-06:00","closed_at":"2025-12-21T04:07:03.763224-06:00"}
{"id":"engram-au61","title":"Expose VFS snapshot and time-travel tools","description":"apps/control has getFilesystemState() and getZippedState() implemented but not exposed as agent tools. VFS snapshots only triggered in tests. Add tools and lifecycle hooks for production use.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:01:30.718751-06:00","updated_at":"2025-12-20T23:25:46.153078-06:00","closed_at":"2025-12-20T23:25:46.153078-06:00"}
{"id":"engram-azoe","title":"Create admin cross-tenant endpoints","description":"Create admin endpoints that can query across tenant graphs.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Super-Admin Queries' section (lines 539-544)\n\n## Implementation\nAdd to API:\n- GET /v1/admin/orgs - List all organizations\n- GET /v1/admin/orgs/:id/stats - Org statistics\n- GET /v1/admin/memories/search - Cross-tenant memory search\n- All require admin:read scope\n\n## Files to Create\n- apps/api/src/routes/admin.ts\n\n## Agent Instructions\nEvery admin operation must be logged with user, action, target org, and timestamp.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:13.94276-06:00","updated_at":"2025-12-29T23:17:15.343187-06:00","closed_at":"2025-12-29T23:17:15.343187-06:00","dependencies":[{"issue_id":"engram-azoe","depends_on_id":"engram-i2sd","type":"blocks","created_at":"2025-12-29T22:12:05.50125-06:00","created_by":"ccheney"}]}
{"id":"engram-b0r6","title":"[Search-Py] Phase 1: Foundation","description":"Project scaffolding for Python search service. Create pyproject.toml with dependencies (FastAPI, sentence-transformers, qdrant-client, aiokafka). Set up FastAPI app with lifespan context manager for resource management. Implement /health endpoint. Create async Qdrant client wrapper. Add Pydantic settings for configuration. Create Docker multi-stage build.\n\nReference: docs/plans/search-python-migration.md (Phase 1: Foundation)\n\nDeliverables:\n- pyproject.toml with all dependencies\n- FastAPI app skeleton with lifespan\n- Health endpoint responding OK\n- AsyncQdrantClient wrapper\n- Pydantic Settings config\n- Dockerfile with multi-stage build\n- Basic pytest infrastructure","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:20:55.217637-06:00","updated_at":"2025-12-20T07:47:29.633823-06:00","closed_at":"2025-12-20T07:47:29.633823-06:00"}
{"id":"engram-b1b5","title":"Add OAuth authentication to Console","description":"Integrate Better Auth, add middleware.ts for OAuth route protection, share auth config with Observatory","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:19:46.225886-05:00","updated_at":"2025-12-27T16:17:53.289927-05:00","closed_at":"2025-12-27T16:17:53.289927-05:00","dependencies":[{"issue_id":"engram-b1b5","depends_on_id":"engram-oyrw","type":"blocks","created_at":"2025-12-27T04:25:21.304283-05:00","created_by":"ccheney"}]}
{"id":"engram-b2j5","title":"Remove all Node.js from repository, use Bun exclusively","description":"Strip out all Node.js references and dependencies from the entire repository. Bun is now the only JavaScript runtime.\n\n## Reference\nThis is a post-migration cleanup task after Kafka → NATS migration enables Bun compatibility.\n\n## Scope\n\n### Package Management\n- Remove package-lock.json (use bun.lockb only)\n- Update all package.json scripts from node/npm to bun\n- Remove any node_modules references in .gitignore that are Node-specific\n\n### Configuration Files\n- Remove .nvmrc, .node-version if present\n- Update tsconfig.json if Node-specific settings exist\n- Remove any Node.js-specific TypeScript types (@types/node usage review)\n\n### CI/CD\n- Update GitHub Actions to use Bun instead of Node\n- Remove any Node.js version matrices\n- Update Docker build workflows\n\n### Scripts\n- Update all shell scripts that reference node/npm\n- Update turbo.json if it has Node-specific commands\n\n### Documentation\n- Update README.md and AGENTS.md\n- Remove Node.js installation instructions\n- Add Bun installation instructions\n\n## Acceptance Criteria\n- No references to Node.js, npm, or node_modules in codebase\n- All scripts use bun commands\n- CI/CD uses Bun runtime\n- Documentation reflects Bun-only setup\n- Repository works with bun install \u0026\u0026 bun run dev","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-22T00:36:10.175573-05:00","updated_at":"2025-12-22T00:36:10.175573-05:00"}
{"id":"engram-b3yt","title":"Wire ElicitationService to MCP tools","description":"apps/mcp ElicitationService has 5 fully implemented methods (confirm, select, promptText, selectMemory, confirmDestructive) that are never used. Wire selectMemory() to recall for disambiguation when multiple memories match.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:01:06.112621-06:00","updated_at":"2025-12-20T23:07:49.467512-06:00","closed_at":"2025-12-20T23:07:49.467512-06:00"}
{"id":"engram-b6yp","title":"Wire or remove applySearchReplace() from PatchManager","description":"packages/vfs patch.ts:44-51 applySearchReplace() is tested but never used in production. ExecutionService only uses applyUnifiedDiff().\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:42.078763-06:00","updated_at":"2025-12-20T23:23:26.775666-06:00","closed_at":"2025-12-20T23:23:26.775666-06:00"}
{"id":"engram-b99w","title":"Add Console link to Observatory nav dropdown","description":"Add link in Observatory navigation dropdown menu to Console","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:19:52.299589-05:00","updated_at":"2025-12-27T16:31:04.815458-05:00","closed_at":"2025-12-27T16:31:04.815458-05:00","dependencies":[{"issue_id":"engram-b99w","depends_on_id":"engram-oyrw","type":"blocks","created_at":"2025-12-27T04:25:26.428421-05:00","created_by":"ccheney"}]}
{"id":"engram-bc18","title":"Add memory.turn_finalized Kafka event","description":"Modify TurnAggregator to publish complete turn content when a turn is finalized.\n\n## Changes\n- apps/memory/src/turn-aggregator.ts: Add publishTurnFinalized() method\n- Publish to 'memory.turn_finalized' topic with:\n  - id, session_id, sequence_index\n  - user_content (complete)\n  - assistant_content (complete)\n  - reasoning_preview (first 500 chars)\n  - tool_calls (list of names)\n  - files_touched\n  - timestamp\n\n## Acceptance\n- Turn finalization triggers Kafka event\n- Event contains complete aggregated content\n- Existing memory.node_created events unchanged","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:11:10.367291-06:00","updated_at":"2025-12-21T06:35:22.845083-06:00","closed_at":"2025-12-21T06:35:22.845083-06:00"}
{"id":"engram-bc25","title":"Create environment context provider","description":"Create lib/environment.tsx with EnvironmentConfig interface and context for local/prod/custom URL switching","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:07.537777-05:00","updated_at":"2025-12-27T16:15:41.970886-05:00","closed_at":"2025-12-27T16:15:41.970886-05:00","dependencies":[{"issue_id":"engram-bc25","depends_on_id":"engram-oyrw","type":"blocks","created_at":"2025-12-27T04:25:31.548762-05:00","created_by":"ccheney"}]}
{"id":"engram-bcqj","title":"Create scheduler with Croner","description":"Create apps/worker/src/scheduler.ts using Croner library. Define cron jobs that publish to NATS JetStream: engram.jobs.decay-calculation (0 2 * * *), engram.jobs.community-detection (0 3 * * *), engram.jobs.conflict-scan (0 4 * * 0). Support timezone configuration.\n\n## Implementation\n```typescript\nimport { Cron } from 'croner';\n\nexport function setupScheduler(js: JetStreamClient, config: SchedulerConfig) {\n  const jobs = [\n    new Cron(config.decay.schedule, { timezone: config.timezone }, async () =\u003e {\n      await js.publish('engram.jobs.decay-calculation', encode({ triggeredBy: 'cron' }));\n    }),\n    new Cron(config.community.schedule, { timezone: config.timezone }, async () =\u003e {\n      await js.publish('engram.jobs.community-detection', encode({ triggeredBy: 'cron' }));\n    }),\n    new Cron(config.conflict.schedule, { timezone: config.timezone }, async () =\u003e {\n      await js.publish('engram.jobs.conflict-scan', encode({ triggeredBy: 'cron' }));\n    }),\n  ];\n  return jobs;\n}\n```\n\n## Before Implementation\nUse Context7 MCP: `resolve-library-id` for 'croner' then query for timezone and async patterns.\n\n## References\n- Croner docs: https://croner.56k.guru/\n- Croner GitHub: https://github.com/hexagon/croner\n- NATS JetStream publish: packages/storage/src/nats.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:46.269321-06:00","updated_at":"2026-01-01T17:10:20.942408-06:00","dependencies":[{"issue_id":"engram-bcqj","depends_on_id":"engram-lepq","type":"blocks","created_at":"2026-01-01T16:50:51.337762-06:00","created_by":"ccheney"},{"issue_id":"engram-bcqj","depends_on_id":"engram-urnx","type":"blocks","created_at":"2026-01-01T16:51:03.330389-06:00","created_by":"ccheney"}]}
{"id":"engram-bd2uk","title":"Memory Decay","description":"Soft decay of memory relevance over time. Reduces retrieval score based on recency, access frequency, and memory type. Decisions never decay, context decays fastest. Does not delete memories.\n\n## Decay Formula\ndecay_score = type_weight × recency_factor × access_factor\n\n- type_weight: decision=1.0, preference=0.9, insight=0.8, fact=0.7, context=0.5, turn=0.3\n- recency_factor: exp(-λ × days) where λ=0.01 (half-life ~70 days)\n- access_factor: 1 + log(1 + access_count) × 0.1\n\n## Research Background\nInspired by human memory decay and Generative Agents paper scoring system:\n- Recency × Importance × Relevance\n- Rehearsal boost (access_factor) prevents frequently-used memories from decaying\n\n## Before Implementation\nUse web search:\n- 'memory decay scoring LLM agent systems 2025'\n- 'Generative Agents memory retrieval recency importance'\n\n## References\n- Generative Agents paper: https://arxiv.org/abs/2304.03442\n- Memory in LLM Agents survey: https://arxiv.org/abs/2512.13564\n- Mem0 architecture: https://arxiv.org/abs/2504.19413","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:50:38.3676-06:00","updated_at":"2026-01-01T17:06:24.380196-06:00","dependencies":[{"issue_id":"engram-bd2uk","depends_on_id":"engram-bdhk","type":"parent-child","created_at":"2026-01-01T16:51:48.735871-06:00","created_by":"ccheney"}]}
{"id":"engram-bdhk","title":"Intelligence Layer","description":"Proactive maintenance layer for community detection, periodic summarization, memory decay, and background conflict scanning. Keeps the knowledge graph healthy without user intervention.\n\n## Problem Statement\nEngram accumulates knowledge but lacks mechanisms to:\n1. Synthesize high-level understanding from hundreds of related memories\n2. Decay stale context that clutters recall results  \n3. Detect historical conflicts in existing data\n4. Surface patterns across projects\n\n## Research References\n- Memory decay in LLM agents: https://arxiv.org/abs/2304.03442 (Generative Agents)\n- Graphiti knowledge graphs: https://github.com/getzep/graphiti\n- Label propagation: https://en.wikipedia.org/wiki/Label_propagation_algorithm\n\n## Before Implementation\nUse Context7 MCP to fetch current docs for: NATS.js, Croner, FalkorDB Cypher\nUse web search to review latest patterns in LLM memory systems (Mem0, MemGPT, A-MEM)","status":"in_progress","priority":2,"issue_type":"epic","created_at":"2026-01-01T16:48:11.797147-06:00","updated_at":"2026-01-01T17:27:04.057098-06:00"}
{"id":"engram-bgma","title":"Multi-Tenancy Phase 4: Admin Access \u0026 Testing","description":"Super-admin cross-tenant access, audit logging, and comprehensive testing for multi-tenancy.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Phase 4: Admin Access and Testing Strategy sections\n\n## Overview\n- Admin scope (admin:read) for cross-tenant access\n- Admin endpoints for org management and analytics\n- Org selection UI in Observatory\n- Audit logging for cross-tenant access\n- Comprehensive unit, integration, E2E, and security tests\n\n## Dependencies\nDepends on Phases 1-3 being complete.\n\n## Agent Instructions\nSecurity is critical. All cross-tenant access must be logged and auditable.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T22:07:46.04616-06:00","updated_at":"2025-12-30T04:05:18.491757-06:00","closed_at":"2025-12-30T04:05:18.491757-06:00","dependencies":[{"issue_id":"engram-bgma","depends_on_id":"engram-csx9","type":"blocks","created_at":"2025-12-29T22:13:03.002042-06:00","created_by":"ccheney"},{"issue_id":"engram-bgma","depends_on_id":"engram-yl86","type":"blocks","created_at":"2025-12-29T22:13:09.81424-06:00","created_by":"ccheney"},{"issue_id":"engram-bgma","depends_on_id":"engram-abtx","type":"blocks","created_at":"2025-12-29T22:13:16.500532-06:00","created_by":"ccheney"},{"issue_id":"engram-bgma","depends_on_id":"engram-0p4e","type":"blocks","created_at":"2025-12-29T22:13:22.620025-06:00","created_by":"ccheney"}]}
{"id":"engram-bjmv","title":"Write OpenTofu tests","description":"Create HCL test files for infrastructure validation.\n\n## Files to create\n```\npackages/infra/tests/\n├── server.tftest.hcl      # Server config unit tests\n├── firewall.tftest.hcl    # Firewall rule tests\n└── integration.tftest.hcl # Full apply tests\n```\n\n## Test examples\n\n### Unit test (plan only)\n```hcl\nrun \"server_config_valid\" {\n  command = plan\n  assert {\n    condition     = hcloud_server.engram.server_type == \"cpx31\"\n    error_message = \"Server type should be cpx31\"\n  }\n}\n```\n\n### Integration test (apply)\n```hcl\nrun \"full_deployment\" {\n  command = apply\n  assert {\n    condition     = hcloud_server.engram.status == \"running\"\n    error_message = \"Server should be running\"\n  }\n}\n```\n\n## Acceptance Criteria\n- `tofu test` passes for unit tests\n- Integration tests can be run manually","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:49:52.197248-06:00","updated_at":"2025-12-21T15:49:52.197248-06:00","dependencies":[{"issue_id":"engram-bjmv","depends_on_id":"engram-ksqn","type":"blocks","created_at":"2025-12-21T15:51:15.785969-06:00","created_by":"ccheney"}]}
{"id":"engram-bmqv","title":"Add NATS dependencies to package.json","description":"Add NATS client dependencies and remove Kafka dependencies.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 6: Dependencies\n\n## Implementation\nAdd to packages/storage/package.json:\n- @nats-io/transport-node ^3.0.0\n- @nats-io/jetstream ^3.0.0\n\nRemove:\n- @confluentinc/kafka-javascript\n\n## Acceptance Criteria\n- npm install succeeds\n- No Kafka dependencies remain\n- NATS packages available for import","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:25:52.797985-05:00","updated_at":"2025-12-22T00:39:47.795138-05:00","closed_at":"2025-12-22T00:39:47.795138-05:00"}
{"id":"engram-bp8b","title":"[MEDIUM] Information disclosure in error objects","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:24:03.348206-06:00","updated_at":"2025-12-21T00:09:56.475337-06:00","closed_at":"2025-12-21T00:09:56.475337-06:00"}
{"id":"engram-brmg","title":"Create types generator (codegen)","description":"Implement TypeScript type generation from schema in packages/graph/src/codegen/types-generator.ts\n\n## Overview\nThe types generator produces TypeScript interface definitions from the schema. These interfaces are used throughout the codebase for type-safe query results and input validation.\n\n## Requirements\n- Generate TypeScript interfaces for each node type\n- Include bitemporal fields (vt_start, vt_end, tt_start, tt_end) in all interfaces\n- Handle optional/required fields correctly based on field modifiers\n- Generate edge types with properties\n- Generate union types for enums\n- Support type inference helpers ($inferSelect, $inferInsert patterns)\n\n## Example Output\n```typescript\n// AUTO-GENERATED - DO NOT EDIT\n// Generated from schema at 2025-01-01T00:00:00.000Z\n\nimport type { BaseNode, BitemporalFields } from '@engram/graph/models';\n\nexport type MemoryType = 'decision' | 'context' | 'insight' | 'preference' | 'fact' | 'turn';\n\nexport interface Memory extends BaseNode {\n  content: string;\n  content_hash: string;\n  type: MemoryType;\n  tags: string[];\n  source_session_id?: string;\n  source?: 'user' | 'auto' | 'import';\n  embedding?: number[];\n}\n\nexport type CreateMemoryInput = Omit\u003cMemory, 'id' | keyof BitemporalFields\u003e;\nexport type UpdateMemoryInput = Partial\u003cCreateMemoryInput\u003e;\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'InferSelectModel InferInsertModel type inference')`\n- `query-docs('/prisma/docs', 'generated types client')`\n\nUse web search for:\n- 'TypeScript code generation best practices'\n- 'ts-morph interface generation'\n- 'Prisma client generated types structure'\n- 'TypeScript template literal code generation'\n\n## Technical Approach Options\n1. **Template literals**: Simple string concatenation\n2. **ts-morph**: Full AST manipulation with formatting\n3. **TypeScript Compiler API**: Lower-level but more control\n\nRecommend starting with template literals for simplicity, upgrade to ts-morph if needed.\n\n## Files\n- packages/graph/src/codegen/types-generator.ts (NEW)\n\n## References\n- ts-morph: https://ts-morph.com/\n- TypeScript Compiler API: https://github.com/microsoft/TypeScript/wiki/Using-the-Compiler-API\n- Drizzle type inference: https://orm.drizzle.team/docs/goodies#type-api\n- Plan: docs/plans/compiled-query-layer.md lines 611-613","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:31.381299-06:00","updated_at":"2026-01-01T17:08:28.531661-06:00","dependencies":[{"issue_id":"engram-brmg","depends_on_id":"engram-0v41","type":"blocks","created_at":"2026-01-01T16:54:51.056951-06:00","created_by":"ccheney"}]}
{"id":"engram-brxz","title":"[HIGH] Redis publisher never disconnected in apps/control","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:06.645297-06:00","updated_at":"2025-12-20T23:57:48.167568-06:00","closed_at":"2025-12-20T23:57:48.167568-06:00"}
{"id":"engram-btwg","title":"[MEDIUM] Incomplete metrics aggregation in benchmark","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:29.977839-06:00","updated_at":"2025-12-21T00:09:56.478563-06:00","closed_at":"2025-12-21T00:09:56.478563-06:00"}
{"id":"engram-bucb","title":"Remove simulated metrics from DatabaseStatusPanels.tsx","description":"Remove simulated metrics generation from DatabaseStatusPanels (lines 49+, 294+). Use real health check data only, show 'No metrics' when data unavailable.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:54:09.756847-05:00","updated_at":"2025-12-27T20:04:22.768587-05:00","closed_at":"2025-12-27T20:04:22.768587-05:00"}
{"id":"engram-bvvp","title":"[CRITICAL] Rate limiter budget bug in apps/search","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:59.631227-06:00","updated_at":"2025-12-20T23:35:43.814735-06:00","closed_at":"2025-12-20T23:35:43.814735-06:00"}
{"id":"engram-bwwl","title":"[HIGH] Bitemporal param collision in multi-alias queries","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:44.796312-06:00","updated_at":"2025-12-20T23:58:50.320181-06:00","closed_at":"2025-12-20T23:58:50.320181-06:00"}
{"id":"engram-bxbjw","title":"Update recall to apply decay weighting","description":"Modify recall in apps/api/src/services/memory.ts to multiply vector scores by decay_score. Re-sort results by weighted score. Oversample by 2x then filter to limit.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:10.369154-06:00","updated_at":"2026-01-01T16:51:10.369154-06:00","dependencies":[{"issue_id":"engram-bxbjw","depends_on_id":"engram-okfbx","type":"blocks","created_at":"2026-01-01T16:52:12.619767-06:00","created_by":"ccheney"}]}
{"id":"engram-c2ap","title":"MCP Session Self-Instrumentation","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-24T01:18:00.520262-05:00","updated_at":"2025-12-24T01:24:31.728441-05:00","closed_at":"2025-12-24T01:24:31.728441-05:00"}
{"id":"engram-c3hu","title":"Add Community node schema to graph package","description":"Add CommunityNodeSchema to packages/graph/src/models/nodes.ts with fields: id, name, summary, keywords[], member_count, memory_count, last_updated, embedding, plus bitemporal fields. Add MEMBER_OF edge type.\n\n## Schema Definition\n```typescript\nexport const CommunityNodeSchema = z.object({\n  id: z.string(),                    // ULID\n  name: z.string(),                  // LLM-generated (2-4 words)\n  summary: z.string(),               // LLM-generated (2-3 sentences)\n  keywords: z.array(z.string()),     // 3-5 keywords for search\n  member_count: z.number(),          // Number of entities\n  memory_count: z.number(),          // Total memories mentioning members\n  last_updated: z.number(),          // When summary was regenerated\n  embedding: z.array(z.number()).optional(), // For semantic search\n  project: z.string().optional(),\n  org_id: z.string().optional(),\n  // Bitemporal\n  vt_start: z.number(),\n  vt_end: z.number(),\n  tt_start: z.number(),\n  tt_end: z.number(),\n});\n\n// New edge type\nexport const MEMBER_OF = 'MEMBER_OF'; // Entity -[:MEMBER_OF]-\u003e Community\n```\n\n## Before Implementation\nReview existing node schemas: packages/graph/src/models/nodes.ts\nFollow bitemporal patterns from MemoryNodeSchema.\n\n## References\n- Graph models: packages/graph/src/models/nodes.ts\n- Edge types: packages/graph/src/models/edges.ts\n- Graphiti community model: https://github.com/getzep/graphiti","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:08.027606-06:00","updated_at":"2026-01-01T17:08:37.535318-06:00"}
{"id":"engram-c5jh","title":"Create edge definition DSL (edge.ts)","description":"Implement edge definition for the Schema DSL in packages/graph/src/schema/edge.ts\n\n## Overview\nEdge definitions describe relationships between nodes in the graph. Edges connect a source node type to a target node type and can optionally carry properties. All edges support bitemporal tracking.\n\n## Requirements\n- edge() function accepting from/to node type references\n- Optional temporal flag (default: true for bitemporal support)\n- Optional edge properties using field types\n- Type-safe from/to node references (compile-time validation)\n- Support for edge cardinality hints (one-to-many, many-to-many)\n\n## API Design\n```typescript\nimport { edge, field } from '@engram/graph/schema';\n\n// Simple edge\nexport const HasTurn = edge({\n  from: 'Session',\n  to: 'Turn',\n  temporal: true,\n});\n\n// Edge with properties\nexport const Mentions = edge({\n  from: 'Memory',\n  to: 'Entity',\n  temporal: true,\n  properties: {\n    context: field.string().optional(),\n    confidence: field.float().optional(),\n  },\n});\n\n// Self-referential edge\nexport const Replaces = edge({\n  from: 'Memory',\n  to: 'Memory',\n  temporal: true,\n});\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'relations foreign key definition')`\n\nUse web search for:\n- 'Neo4j Cypher relationship types properties'\n- 'Graph database edge modeling patterns'\n- 'TypeScript string literal types from array'\n- 'FalkorDB relationship property support'\n\n## Technical Considerations\n- Edge types should reference node types by string name (not direct import) to avoid circular dependencies\n- Consider generating EdgeSource\u003cE\u003e and EdgeTarget\u003cE\u003e type helpers for traversal typing\n- Validate from/to references against schema at build time\n\n## Files\n- packages/graph/src/schema/edge.ts (NEW)\n\n## References\n- Drizzle relations: https://orm.drizzle.team/docs/relations\n- Neo4j relationships: https://neo4j.com/docs/cypher-manual/current/patterns/concepts/\n- FalkorDB relationships: https://docs.falkordb.com/\n- Plan: docs/plans/compiled-query-layer.md lines 573-586","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:48:53.131605-06:00","updated_at":"2026-01-01T17:45:06.810032-06:00","closed_at":"2026-01-01T17:45:06.810032-06:00","dependencies":[{"issue_id":"engram-c5jh","depends_on_id":"engram-hd79","type":"blocks","created_at":"2026-01-01T16:54:07.888977-06:00","created_by":"ccheney"}]}
{"id":"engram-canf","title":"Update remaining FalkorDB repositories","description":"Update ReasoningRepository, ToolUseRepository, RelationshipRepository, EventRepository for tenant context.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - mentions 8 repositories need updates\n\n## Files to Modify\n- packages/graph/src/repositories/falkor-reasoning.ts\n- packages/graph/src/repositories/falkor-tooluse.ts (if exists)\n- packages/graph/src/repositories/falkor-relationship.ts (if exists)\n- packages/graph/src/repositories/falkor-event.ts (if exists)\n\n## Agent Instructions\nFirst use Glob to find all falkor-*.ts files in repositories folder.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:14.568108-06:00","updated_at":"2025-12-29T23:11:10.136348-06:00","closed_at":"2025-12-29T23:11:10.136348-06:00","dependencies":[{"issue_id":"engram-canf","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:38.413189-06:00","created_by":"ccheney"}]}
{"id":"engram-cb2z","title":"Create worker configuration schema","description":"Create apps/worker/src/config.ts with IntelligenceConfig interface covering communityDetection, summarization, decay, and conflictScan settings with defaults.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:03.682074-06:00","updated_at":"2026-01-01T18:17:53.720345-06:00","closed_at":"2026-01-01T18:17:53.720345-06:00","dependencies":[{"issue_id":"engram-cb2z","depends_on_id":"engram-py2a","type":"blocks","created_at":"2026-01-01T16:51:07.06383-06:00","created_by":"ccheney"}]}
{"id":"engram-cchc","title":"Wire TemporalQueryEnhancer in EngramRetriever","description":"Add temporal filtering for TR questions using existing TemporalQueryEnhancer. File: packages/benchmark/src/engram_benchmark/longmemeval/retriever.py","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T15:45:23.520878-05:00","updated_at":"2025-12-27T15:57:35.63312-05:00","closed_at":"2025-12-27T15:57:35.63312-05:00"}
{"id":"engram-cfcug","title":"Create ConflictReportRepository","description":"Create packages/graph/src/repositories/conflict-report.repository.ts with findById, findByProject, findPending, create, createMany, resolve, dismiss methods. Implement FalkorConflictReportRepository.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:26.208774-06:00","updated_at":"2026-01-01T16:51:26.208774-06:00","dependencies":[{"issue_id":"engram-cfcug","depends_on_id":"engram-l1stx","type":"blocks","created_at":"2026-01-01T16:52:49.563755-06:00","created_by":"ccheney"}]}
{"id":"engram-cgk8","title":"Create device-auth library for Observatory","description":"Create apps/observatory/lib/device-auth.ts with helper functions: generateDeviceCode(), generateUserCode() (XXXX-XXXX format excluding ambiguous chars 0OI1L), verifyUserCode(), pollDeviceCode(), generateOAuthTokens() (SHA-256 hashed), refreshAccessToken(). See docs/design/oauth-device-flow.md 'Token Format' and database schema sections.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:20:06.760119-05:00","updated_at":"2025-12-25T02:30:54.018259-05:00","closed_at":"2025-12-25T02:30:54.018259-05:00","dependencies":[{"issue_id":"engram-cgk8","depends_on_id":"engram-g0sx","type":"blocks","created_at":"2025-12-25T02:20:52.673778-05:00","created_by":"ccheney"},{"issue_id":"engram-cgk8","depends_on_id":"engram-kf57","type":"blocks","created_at":"2025-12-25T02:20:57.795719-05:00","created_by":"ccheney"}]}
{"id":"engram-ch8w","title":"Test coverage: packages/parser/src/extractors/base.ts (98%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:55.599443-06:00","updated_at":"2025-12-21T04:07:03.756612-06:00","closed_at":"2025-12-21T04:07:03.756612-06:00"}
{"id":"engram-ch9r","title":"[HIGH] Executor resource leak in apps/search","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:20.358066-06:00","updated_at":"2025-12-20T23:57:48.168729-06:00","closed_at":"2025-12-20T23:57:48.168729-06:00"}
{"id":"engram-chws","title":"Remove unused mock resource types from infra testing","description":"packages/infra testing.ts:171-193 defines mock handlers for Cloud Run, Storage, Service Accounts, IAM that are never created. Remove dead code paths.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:16:38.740053-06:00","updated_at":"2025-12-20T23:20:48.625046-06:00","closed_at":"2025-12-20T23:20:48.625046-06:00"}
{"id":"engram-ckyg","title":"Add tests for apps/ingestion/src/auth.ts (12.3% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:26.642316-05:00","updated_at":"2025-12-27T01:58:26.642316-05:00"}
{"id":"engram-cmbx","title":"Add GitHub Actions workflow for Hetzner deployment","description":"Create CI/CD pipeline to auto-deploy to Hetzner on main branch pushes.\n\n## Workflow file\n`.github/workflows/deploy-hetzner.yml`\n\n## Triggers\n- Push to main branch\n- Manual workflow_dispatch\n\n## Steps\n1. Checkout code\n2. Set up SSH key (from GitHub secrets)\n3. rsync code to Hetzner server\n4. SSH and run docker compose build/up\n5. Health check endpoints\n\n## Required secrets\n- HETZNER_SSH_KEY: Private SSH key for server access\n- HETZNER_HOST: Server IP (178.156.216.88)\n\n## Considerations\n- Only deploy on successful tests\n- Rolling deployment to minimize downtime\n- Slack/Discord notification on deploy","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T16:52:06.920308-06:00","updated_at":"2025-12-21T16:52:06.920308-06:00"}
{"id":"engram-cmzk","title":"[HIGH] Buffer data corruption on read in vfs","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:20.717322-06:00","updated_at":"2025-12-20T23:59:12.687991-06:00","closed_at":"2025-12-20T23:59:12.687991-06:00"}
{"id":"engram-cq83y","title":"Background Conflict Scanner","description":"Weekly scan of all memories to detect contradictions and superseded information. Uses vector similarity to find candidates, LLM classification to confirm conflicts, creates ConflictReport nodes for review. Does not auto-invalidate.\n\n## Conflict Detection Pipeline\n1. Load active memories per project (partition by org_id)\n2. Vector search for candidates (similarity \u003e 0.7, top 5 per memory)\n3. Batch LLM classification: CONTRADICTION, SUPERSEDES, INDEPENDENT\n4. Create ConflictReport nodes with status=pending_review\n5. Notify via webhook (if configured)\n\n## Classification Strategy\nUse gemini-3-flash-preview for batch processing. Group candidates into batches of 20 for efficiency.\n\n## Before Implementation\nUse web search:\n- 'contradiction detection LLM memory systems'\n- 'semantic similarity conflict resolution knowledge graphs'\n\nReview existing conflict detection: engram-t4ms (ConflictDetectorService)\n\n## References\n- Existing conflict types: packages/common/src/types (ConflictRelation)\n- Zep temporal knowledge graphs: https://arxiv.org/abs/2501.13956\n- Search service: apps/search/src/search/retrieval/retriever.py","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:51:13.145594-06:00","updated_at":"2026-01-01T17:16:01.408036-06:00"}
{"id":"engram-cqo6t","title":"Implement FalkorDBEntityRepository","description":"Create packages/graph/src/repositories/falkor-entity.repository.ts implementing EntityRepository.\n\n## Implementation Details\n\n### Extend FalkorBaseRepository\n- Use generateId() for ULIDs\n- Use createBitemporal(validFrom?) for temporal fields\n- Use query\u003cT\u003e(cypher, params) for tenant-aware queries\n- Use buildPropertyString() for Cypher property construction\n\n### Key Cypher Patterns\n\n#### Find by embedding (vector similarity)\n```cypher\nCALL db.idx.vector.queryNodes('Entity', 'embedding', $limit, vecf32($embedding))\nYIELD node, score\nWHERE score \u003e $threshold\nRETURN node\n```\n\n#### Graph traversal (BFS)\n```cypher\nMATCH (e:Entity {id: $id})-[:RELATED_TO|DEPENDS_ON*1..$depth]-(related:Entity)\nWHERE related.vt_end = $maxDate\nRETURN DISTINCT related\n```\n\n### Bitemporal Edge Creation\nAll edges must include vt_start, vt_end, tt_start, tt_end fields.\n\n## Implementation Reference\n- Follow FalkorMemoryRepository in packages/graph/src/repositories/falkor-memory.repository.ts\n- Use QueryBuilder from packages/graph/src/queries/builder.ts\n\n## Research\n- FalkorDB vector queries: Use Context7 MCP `query-docs` with '/websites/falkordb' for 'vector index query similarity'\n- Graph traversal patterns: Use Context7 MCP `query-docs` with '/falkordb/docs' for 'variable length path BFS'\n- Web search: 'FalkorDB Cypher graph traversal depth limit 2025'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:30.907891-06:00","updated_at":"2026-01-01T18:23:23.612446-06:00","closed_at":"2026-01-01T18:23:23.612446-06:00","dependencies":[{"issue_id":"engram-cqo6t","depends_on_id":"engram-o8f2j","type":"blocks","created_at":"2026-01-01T16:54:02.708689-06:00","created_by":"ccheney"},{"issue_id":"engram-cqo6t","depends_on_id":"engram-ksphq","type":"blocks","created_at":"2026-01-01T16:54:08.853426-06:00","created_by":"ccheney"},{"issue_id":"engram-cqo6t","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:38.134369-06:00","created_by":"ccheney"}]}
{"id":"engram-cs8w","title":"Test coverage: packages/graph/src/queries/builder.ts (branches 80%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:53.86896-06:00","updated_at":"2025-12-21T04:07:03.756846-06:00","closed_at":"2025-12-21T04:07:03.756846-06:00"}
{"id":"engram-csx9","title":"Implement audit logging for cross-tenant access","description":"Log all cross-tenant admin access for compliance and security.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Super-Admin Queries' section (line 544)\n\n## Implementation\nCreate audit logging:\n- Log: userId, action, targetOrgId, timestamp, IP, userAgent\n- Store in PostgreSQL audit_logs table\n- Include in admin endpoints and any cross-tenant operations\n- Add retention policy\n\n## Files to Create\n- apps/observatory/src/db/schema.ts (add audit_logs table)\n- packages/common/src/audit.ts (logging utilities)\n\n## Agent Instructions\nSecurity critical. Logs must be tamper-resistant and retained per compliance requirements.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:42.135314-06:00","updated_at":"2025-12-29T23:43:29.229245-06:00","closed_at":"2025-12-29T23:43:29.229245-06:00","dependencies":[{"issue_id":"engram-csx9","depends_on_id":"engram-azoe","type":"blocks","created_at":"2025-12-29T22:12:24.818731-06:00","created_by":"ccheney"}]}
{"id":"engram-ctgv","title":"Delete scripts/seed-api-key.sql and scripts/seed-tofu-token.ts","description":"Delete two legacy database seeding scripts that are no longer needed after the OAuth migration: (1) scripts/seed-api-key.sql - SQL script that inserted sample API keys into the old api_keys PostgreSQL table for local development, and (2) scripts/seed-tofu-token.ts - TypeScript script that generated and seeded development tokens into the database. These scripts are obsolete because the new authentication system uses OAuth 2.1 device flow with egm_oauth_* and egm_refresh_* tokens managed by the Observatory service, not PostgreSQL-backed API keys.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:55:05.834819-06:00","updated_at":"2025-12-29T17:07:05.360608-06:00","closed_at":"2025-12-29T17:07:05.360608-06:00","dependencies":[{"issue_id":"engram-ctgv","depends_on_id":"engram-izya","type":"blocks","created_at":"2025-12-29T16:02:05.521446-06:00","created_by":"ccheney"}]}
{"id":"engram-cubk","title":"Add REPLACES edge creation logic","description":"Extend invalidate() in FalkorMemoryRepository to create bitemporal REPLACES edge from new memory to old: (new)-[:REPLACES {tt_start, tt_end, vt_start, vt_end}]-\u003e(old)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:00.006849-06:00","updated_at":"2026-01-01T17:45:06.811186-06:00","closed_at":"2026-01-01T17:45:06.811186-06:00","dependencies":[{"issue_id":"engram-cubk","depends_on_id":"engram-sc6d","type":"blocks","created_at":"2026-01-01T16:45:16.258241-06:00","created_by":"ccheney"}]}
{"id":"engram-cx4u","title":"Add Qdrant tiered multitenancy support","description":"Implement shard promotion for large tenants using Qdrant 1.16+ tiered multitenancy.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Qdrant Tiered Multitenancy' section (lines 453-468)\n\n## Implementation\n```python\nasync def promote_tenant_to_dedicated_shard(\n    client: QdrantClient,\n    collection_name: str,\n    org_id: str,\n) -\u003e None:\n    await client.create_shard_key(\n        collection_name=collection_name,\n        shard_key=org_id,\n    )\n```\n\nThis is called for tenants exceeding a vector count threshold.\n\n## Files to Create/Modify\n- apps/search/src/services/shard_manager.py (NEW)\n\n## Agent Instructions\nWeb search 'Qdrant 1.16 create_shard_key tiered multitenancy'. This is a P2 optimization.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T22:10:23.154741-06:00","updated_at":"2025-12-29T22:10:23.154741-06:00"}
{"id":"engram-d0td","title":"Improve engram_context tool description","description":"Update apps/mcp/src/tools/context.ts with improved descriptions. Changes:\n- Main description: 'Assemble comprehensive context for a task by combining: semantic memory search, past decisions, and file modification history. Use at the START of complex tasks to prime yourself with institutional knowledge.'\n- task param: Guide on specificity for better semantic search\n- files param: Explain file history retrieval value\n- depth param: Explain when to use shallow/medium/deep with concrete guidance\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_context","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:00.006141-05:00","updated_at":"2025-12-25T00:58:05.966198-05:00","closed_at":"2025-12-25T00:58:05.966198-05:00"}
{"id":"engram-d2th","title":"[MAJOR] Fire-and-forget WebSocket promises in apps/memory","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:12.486372-06:00","updated_at":"2025-12-20T23:58:00.497423-06:00","closed_at":"2025-12-20T23:58:00.497423-06:00"}
{"id":"engram-d3xe","title":"Configure local dev environment for full OAuth flow via local Observatory","description":"Configure local development environment for full OAuth flow via Observatory. Update /Users/ccheney/Projects/engram/docker-compose.dev.yml to include Observatory service on port 6178. All services (API, Search, Ingestion, Memory) must authenticate via client credentials flow - no auth bypass flags anywhere (remove AUTH_ENABLED=false, no internal network auth bypass in Python middleware). Services should use ENGRAM_AUTH_SERVER_URL=http://observatory:6178 and register as OAuth clients during startup. Environment variables: OAUTH_CLIENT_ID, OAUTH_CLIENT_SECRET for each service. Full production parity in development - if it works locally, it works in prod. Reference /Users/ccheney/Projects/engram/apps/observatory/lib/client-registration.ts for client registration flow and /Users/ccheney/Projects/engram/apps/search/src/middleware/auth.py for current auth bypass patterns to remove.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:56:08.912756-06:00","updated_at":"2025-12-29T17:07:05.361873-06:00","closed_at":"2025-12-29T17:07:05.361873-06:00","dependencies":[{"issue_id":"engram-d3xe","depends_on_id":"engram-izya","type":"blocks","created_at":"2025-12-29T16:03:34.860907-06:00","created_by":"ccheney"}]}
{"id":"engram-d7pz","title":"Add visual indicator for invalidated memories in recall","description":"Extend recall response: add invalidated: boolean, invalidatedAt: timestamp, replacedBy: id. Format with ~~strikethrough~~ in MCP response when displaying invalidated memories","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:56.277446-06:00","updated_at":"2026-01-01T18:09:28.054394-06:00","closed_at":"2026-01-01T18:09:28.054394-06:00","dependencies":[{"issue_id":"engram-d7pz","depends_on_id":"engram-8gr3","type":"blocks","created_at":"2026-01-01T16:46:12.648291-06:00","created_by":"ccheney"}]}
{"id":"engram-da07","title":"Create Pulumi turbo-cache.ts for Cloud Run + GCS infrastructure","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-20T23:07:45.581552-06:00","updated_at":"2025-12-21T03:50:24.61737-06:00","closed_at":"2025-12-21T03:50:24.61737-06:00"}
{"id":"engram-de8r","title":"Set vt_end/tt_end when turns finalize","description":"Close temporal window when turn is finalized by setting vt_end/tt_end.\n\nFile: apps/memory/src/handlers/usage.handler.ts (finalizeTurn method)\n\nAdd to SET clause:\n```cypher\nSET t.vt_end = $now, t.tt_end = $now\n```\n\nPer bitemporal patterns: ending columns close the temporal interval when fact is no longer active.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T11:26:10.891075-05:00","updated_at":"2025-12-27T15:52:40.223073-05:00","closed_at":"2025-12-27T15:52:40.223073-05:00","dependencies":[{"issue_id":"engram-de8r","depends_on_id":"engram-yebg","type":"blocks","created_at":"2025-12-27T15:45:54.42982-05:00","created_by":"ccheney"}]}
{"id":"engram-dj45","title":"Add Hetzner Cloud API integration","description":"lib/hetzner.ts - CPU, memory, disk I/O, network traffic, bandwidth consumption, server info, monthly cost","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:59.268848-05:00","updated_at":"2025-12-27T04:20:59.268848-05:00"}
{"id":"engram-djy7","title":"[CRITICAL] HTTP response desync in apps/ingestion","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:58.658075-06:00","updated_at":"2025-12-20T23:35:43.813397-06:00","closed_at":"2025-12-20T23:35:43.813397-06:00"}
{"id":"engram-dkb1","title":"Test coverage: packages/storage/src/consumer-readiness.ts (4%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:53.849528-06:00","updated_at":"2025-12-21T04:07:03.757084-06:00","closed_at":"2025-12-21T04:07:03.757084-06:00"}
{"id":"engram-dlwdd","title":"Create CommunityRepository","description":"Create packages/graph/src/repositories/community.repository.ts with findById, findByProject, getMembers, create, update, findExistingByMemberOverlap methods. Implement FalkorCommunityRepository.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:14.306988-06:00","updated_at":"2026-01-01T16:50:14.306988-06:00","dependencies":[{"issue_id":"engram-dlwdd","depends_on_id":"engram-c3hu","type":"blocks","created_at":"2026-01-01T16:51:11.791721-06:00","created_by":"ccheney"}]}
{"id":"engram-docr","title":"[Benchmark-Py] Phase 4: Extended Benchmarks","description":"Add support for standard embedding and retrieval benchmarks beyond LongMemEval. MTEB integration for embedding evaluation across diverse NLP tasks. BEIR integration for zero-shot IR evaluation on 18 datasets. Custom benchmark support for Engram-specific evaluations.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 6: Extended Benchmarks)\n\nDeliverables:\n- src/engram_benchmark/benchmarks/mteb.py - MTEB wrapper\n- src/engram_benchmark/benchmarks/beir.py - BEIR wrapper\n- 'engram-benchmark mteb' command\n- 'engram-benchmark beir' command\n- Results compatible with public leaderboards\n- Comparative analysis tools","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:24:37.200613-06:00","updated_at":"2025-12-20T09:59:58.856421-06:00","closed_at":"2025-12-20T09:59:58.856421-06:00","dependencies":[{"issue_id":"engram-docr","depends_on_id":"engram-4hd8","type":"blocks","created_at":"2025-12-20T07:25:35.916502-06:00","created_by":"ccheney"}]}
{"id":"engram-dsxq","title":"[Console Redesign] Migrate Tools page to shadcn","description":"## Overview\nMigrate the Tools page with Graph Query, Vector Search, and Cache Controls panels.\n\n## Target Page\n- apps/console/app/(dashboard)/tools/page.tsx\n\n## Components to Migrate\n\n### Graph Query Panel\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eGraph Query\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent className=\"space-y-4\"\u003e\n    {/* Query Editor - keep custom syntax highlighting */}\n    \u003cdiv className=\"relative\"\u003e\n      \u003cTextarea\n        value={query}\n        onChange={(e) =\u003e setQuery(e.target.value)}\n        className=\"font-mono min-h-[150px] bg-muted\"\n        placeholder=\"MATCH (n) RETURN n LIMIT 10\"\n      /\u003e\n    \u003c/div\u003e\n    \n    {/* Example Queries */}\n    \u003cdiv className=\"flex gap-2 flex-wrap\"\u003e\n      {examples.map((ex) =\u003e (\n        \u003cButton \n          key={ex.name} \n          variant=\"outline\" \n          size=\"sm\"\n          onClick={() =\u003e setQuery(ex.query)}\n        \u003e\n          {ex.name}\n        \u003c/Button\u003e\n      ))}\n    \u003c/div\u003e\n    \n    \u003cButton onClick={executeQuery} disabled={isLoading}\u003e\n      {isLoading \u0026\u0026 \u003cSpinner className=\"mr-2\" /\u003e}\n      Execute\n    \u003c/Button\u003e\n    \n    {/* Results Table */}\n    {results \u0026\u0026 (\n      \u003cTable\u003e\n        \u003cTableHeader\u003e\n          {columns.map((col) =\u003e (\n            \u003cTableHead key={col}\u003e{col}\u003c/TableHead\u003e\n          ))}\n        \u003c/TableHeader\u003e\n        \u003cTableBody\u003e\n          {results.map((row, i) =\u003e (\n            \u003cTableRow key={i}\u003e\n              {columns.map((col) =\u003e (\n                \u003cTableCell key={col} className=\"font-mono text-sm\"\u003e\n                  {JSON.stringify(row[col])}\n                \u003c/TableCell\u003e\n              ))}\n            \u003c/TableRow\u003e\n          ))}\n        \u003c/TableBody\u003e\n      \u003c/Table\u003e\n    )}\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n### Vector Search Panel\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eVector Search\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent className=\"space-y-4\"\u003e\n    \u003cdiv className=\"grid gap-4 md:grid-cols-3\"\u003e\n      \u003cdiv className=\"space-y-2\"\u003e\n        \u003cLabel\u003eSearch Query\u003c/Label\u003e\n        \u003cInput \n          value={searchQuery} \n          onChange={(e) =\u003e setSearchQuery(e.target.value)}\n          placeholder=\"Enter search query...\"\n        /\u003e\n      \u003c/div\u003e\n      \n      \u003cdiv className=\"space-y-2\"\u003e\n        \u003cLabel\u003eStrategy\u003c/Label\u003e\n        \u003cSelect value={strategy} onValueChange={setStrategy}\u003e\n          \u003cSelectTrigger\u003e\n            \u003cSelectValue /\u003e\n          \u003c/SelectTrigger\u003e\n          \u003cSelectContent\u003e\n            \u003cSelectItem value=\"dense\"\u003eDense\u003c/SelectItem\u003e\n            \u003cSelectItem value=\"sparse\"\u003eSparse\u003c/SelectItem\u003e\n            \u003cSelectItem value=\"hybrid\"\u003eHybrid\u003c/SelectItem\u003e\n          \u003c/SelectContent\u003e\n        \u003c/Select\u003e\n      \u003c/div\u003e\n      \n      \u003cdiv className=\"space-y-2\"\u003e\n        \u003cLabel\u003eReranker\u003c/Label\u003e\n        \u003cSelect value={reranker} onValueChange={setReranker}\u003e\n          \u003cSelectTrigger\u003e\n            \u003cSelectValue /\u003e\n          \u003c/SelectTrigger\u003e\n          \u003cSelectContent\u003e\n            \u003cSelectItem value=\"none\"\u003eNone\u003c/SelectItem\u003e\n            \u003cSelectItem value=\"fast\"\u003eFast (FlashRank)\u003c/SelectItem\u003e\n            \u003cSelectItem value=\"accurate\"\u003eAccurate (BGE)\u003c/SelectItem\u003e\n            \u003cSelectItem value=\"code\"\u003eCode (Jina)\u003c/SelectItem\u003e\n            \u003cSelectItem value=\"llm\"\u003eLLM (Gemini)\u003c/SelectItem\u003e\n          \u003c/SelectContent\u003e\n        \u003c/Select\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n    \n    \u003cdiv className=\"space-y-2\"\u003e\n      \u003cdiv className=\"flex justify-between\"\u003e\n        \u003cLabel\u003eLimit\u003c/Label\u003e\n        \u003cspan className=\"text-sm text-muted-foreground\"\u003e{limit}\u003c/span\u003e\n      \u003c/div\u003e\n      \u003cSlider \n        value={[limit]} \n        onValueChange={([v]) =\u003e setLimit(v)}\n        min={1}\n        max={50}\n        step={1}\n      /\u003e\n    \u003c/div\u003e\n    \n    \u003cButton onClick={executeSearch}\u003eSearch\u003c/Button\u003e\n    \n    {/* Results */}\n    \u003cdiv className=\"space-y-2\"\u003e\n      {results.map((result) =\u003e (\n        \u003cCard key={result.id}\u003e\n          \u003cCardContent className=\"p-4\"\u003e\n            \u003cdiv className=\"flex items-center justify-between\"\u003e\n              \u003cspan className=\"font-mono text-sm\"\u003e{result.content.slice(0, 100)}...\u003c/span\u003e\n              \u003cBadge variant=\"secondary\"\u003e{result.score.toFixed(3)}\u003c/Badge\u003e\n            \u003c/div\u003e\n          \u003c/CardContent\u003e\n        \u003c/Card\u003e\n      ))}\n    \u003c/div\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n### Cache Controls Panel\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eCache Controls\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent className=\"space-y-4\"\u003e\n    \u003cdiv className=\"grid gap-4 md:grid-cols-2\"\u003e\n      {caches.map((cache) =\u003e (\n        \u003cCard key={cache.name} className=\"border-dashed\"\u003e\n          \u003cCardContent className=\"p-4\"\u003e\n            \u003cdiv className=\"flex items-center justify-between\"\u003e\n              \u003cdiv\u003e\n                \u003ch4 className=\"font-medium\"\u003e{cache.name}\u003c/h4\u003e\n                \u003cp className=\"text-xs text-muted-foreground\"\u003e\n                  {cache.entries} entries • {cache.size}\n                \u003c/p\u003e\n              \u003c/div\u003e\n              \u003cAlertDialog\u003e\n                \u003cAlertDialogTrigger asChild\u003e\n                  \u003cButton variant=\"destructive\" size=\"sm\"\u003eClear\u003c/Button\u003e\n                \u003c/AlertDialogTrigger\u003e\n                \u003cAlertDialogContent\u003e\n                  \u003cAlertDialogHeader\u003e\n                    \u003cAlertDialogTitle\u003eClear {cache.name}?\u003c/AlertDialogTitle\u003e\n                    \u003cAlertDialogDescription\u003e\n                      This will clear all {cache.entries} entries from the cache.\n                      This action cannot be undone.\n                    \u003c/AlertDialogDescription\u003e\n                  \u003c/AlertDialogHeader\u003e\n                  \u003cAlertDialogFooter\u003e\n                    \u003cAlertDialogCancel\u003eCancel\u003c/AlertDialogCancel\u003e\n                    \u003cAlertDialogAction onClick={() =\u003e clearCache(cache.name)}\u003e\n                      Clear Cache\n                    \u003c/AlertDialogAction\u003e\n                  \u003c/AlertDialogFooter\u003e\n                \u003c/AlertDialogContent\u003e\n              \u003c/AlertDialog\u003e\n            \u003c/div\u003e\n          \u003c/CardContent\u003e\n        \u003c/Card\u003e\n      ))}\n    \u003c/div\u003e\n    \n    {/* Stream Management */}\n    \u003cdiv className=\"space-y-2\"\u003e\n      \u003cLabel\u003eNATS Stream\u003c/Label\u003e\n      \u003cdiv className=\"flex gap-2\"\u003e\n        \u003cSelect value={selectedStream} onValueChange={setSelectedStream}\u003e\n          \u003cSelectTrigger className=\"flex-1\"\u003e\n            \u003cSelectValue placeholder=\"Select stream...\" /\u003e\n          \u003c/SelectTrigger\u003e\n          \u003cSelectContent\u003e\n            {streams.map((s) =\u003e (\n              \u003cSelectItem key={s} value={s}\u003e{s}\u003c/SelectItem\u003e\n            ))}\n          \u003c/SelectContent\u003e\n        \u003c/Select\u003e\n        \u003cButton variant=\"outline\"\u003eView Info\u003c/Button\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n## Components to Use\n- Card (panel containers)\n- Textarea (query input)\n- Input (search input)\n- Select (dropdowns)\n- Slider (limit control)\n- Button (actions)\n- Table (query results)\n- Badge (scores)\n- AlertDialog (cache clear confirmation)\n- Label\n\n## Acceptance Criteria\n- [ ] Graph query panel with syntax highlighting preserved\n- [ ] Example query buttons\n- [ ] Query results table\n- [ ] Vector search with all options\n- [ ] Slider for limit control\n- [ ] Search results with scores\n- [ ] Cache controls with clear confirmation\n- [ ] Stream selector","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:49:45.512134-06:00","updated_at":"2025-12-28T17:40:32.020699-06:00","closed_at":"2025-12-28T17:40:32.020699-06:00","dependencies":[{"issue_id":"engram-dsxq","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:53.941855-06:00","created_by":"ccheney"}]}
{"id":"engram-dtbw","title":"Implement base job consumer class","description":"Create BaseJobConsumer abstract class with NATS JetStream subscription, message acknowledgment, error handling with retries, and dead letter queue support. Located at apps/worker/src/jobs/base.ts\n\n## Base Class Design\n```typescript\nabstract class BaseJobConsumer\u003cT\u003e {\n  abstract readonly subject: string;\n  abstract readonly consumerName: string;\n  abstract process(job: T): Promise\u003cvoid\u003e;\n  \n  // Provided by base class\n  subscribe(): Promise\u003cvoid\u003e;\n  private handleMessage(msg: JsMsg): Promise\u003cvoid\u003e;\n  private handleError(err: Error, msg: JsMsg): Promise\u003cvoid\u003e;\n}\n```\n\n## Error Handling Strategy\n- Retry with exponential backoff (10ms, 100ms, 1s)\n- Max 3 retries before DLQ\n- Publish to dlq.worker.{subject} on final failure\n- Log structured errors with job context\n\n## Before Implementation\nUse Context7 MCP: Query '@nats-io/jetstream' for consumer.consume(), msg.ack(), msg.nak() patterns.\n\nUse web search: 'NATS JetStream consumer error handling dead letter queue TypeScript'\n\n## References\n- Existing NATS patterns: packages/storage/src/nats.ts\n- DLQ subjects: packages/storage/src/nats.ts (DLQ stream)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:51.611136-06:00","updated_at":"2026-01-01T18:09:28.055788-06:00","closed_at":"2026-01-01T18:09:28.055788-06:00","dependencies":[{"issue_id":"engram-dtbw","depends_on_id":"engram-py2a","type":"blocks","created_at":"2026-01-01T16:50:55.301438-06:00","created_by":"ccheney"}]}
{"id":"engram-dtszf","title":"Integration tests: End-to-end query","description":"Create integration tests for full query lifecycle\n\n## Overview\nThese integration tests validate the complete workflow: define schema → generate code → execute query → verify results. They run against a real FalkorDB instance.\n\n## Test Scenarios\n\n### 1. Schema to Query Execution\n- Define test schema with nodes and edges\n- Generate code from schema\n- Create test data in FalkorDB\n- Execute generated query builder\n- Verify results match expected\n\n### 2. Time-Travel Query\n- Create node at time T1\n- Update node at time T2 (creates new version)\n- Query asOf(T1) returns original\n- Query asOf(T2) returns updated\n- Query whereCurrent() returns latest\n\n### 3. Traversal Query\n- Create nodes with relationships\n- Use traversal builder to follow edges\n- Verify correct nodes returned\n\n### 4. Repository CRUD\n- Create node via generated repository\n- Find by ID\n- Update node\n- Delete node\n- Verify all operations work\n\n## Test Setup\n```typescript\nimport { describe, test, expect, beforeAll, afterAll } from 'bun:test';\nimport { FalkorClient } from '@engram/storage';\nimport { generate } from '../codegen/generator';\n\ndescribe('Integration: Query Lifecycle', () =\u003e {\n  let client: FalkorClient;\n\n  beforeAll(async () =\u003e {\n    client = new FalkorClient({\n      host: process.env.FALKORDB_HOST || 'localhost',\n      port: 6179,\n    });\n    await client.connect();\n    \n    // Generate code\n    await generate({ schema: testSchema });\n  });\n\n  afterAll(async () =\u003e {\n    await client.disconnect();\n  });\n\n  test('create and query node', async () =\u003e {\n    const TestNode = await import('../generated/query-builders').then(m =\u003e m.TestNode);\n    \n    // Create\n    const created = await TestNode.create({ name: 'test' });\n    expect(created.id).toBeDefined();\n    \n    // Query\n    const found = await TestNode.findById(created.id);\n    expect(found?.name).toBe('test');\n  });\n});\n```\n\n## Requirements\n- Use FalkorDB test container or local instance\n- Seed test data before each test\n- Clean up after tests\n- Verify Cypher correctness against real DB\n\n## Research Required\nUse web search for:\n- 'FalkorDB Docker test container'\n- 'Integration testing graph database'\n- 'Bun test beforeAll setup'\n\n## Files\n- packages/graph/src/integration/query.integration.test.ts\n\n## References\n- Plan: docs/plans/compiled-query-layer.md lines 887-893\n- docker-compose.dev.yml for FalkorDB container","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:52:40.917265-06:00","updated_at":"2026-01-01T17:12:48.77814-06:00","dependencies":[{"issue_id":"engram-dtszf","depends_on_id":"engram-svaf6","type":"blocks","created_at":"2026-01-01T16:56:44.527161-06:00","created_by":"ccheney"}]}
{"id":"engram-dwv4x","title":"Document Gastown workflow in CLAUDE.md","description":"Add section to CLAUDE.md explaining how to use gt commands, formulas, convoys, and slings for multi-agent work","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:43:28.813159-06:00","updated_at":"2026-01-01T18:54:46.744951-06:00","closed_at":"2026-01-01T18:54:46.744951-06:00","dependencies":[{"issue_id":"engram-dwv4x","depends_on_id":"engram-acypa","type":"blocks","created_at":"2026-01-01T18:43:50.458879-06:00","created_by":"ccheney"},{"issue_id":"engram-dwv4x","depends_on_id":"engram-7fk61","type":"blocks","created_at":"2026-01-01T18:43:55.621031-06:00","created_by":"ccheney"}]}
{"id":"engram-dxdf","title":"[Console Redesign] Migrate Login page to shadcn","description":"## Overview\nMigrate the login page using login-03 block pattern (muted background).\n\n## Target Page\n- apps/console/app/(auth)/login/page.tsx\n\n## Current Implementation\n- Google OAuth button\n- Centered card layout\n- Logo display\n\n## Target Implementation (login-03 pattern)\n```tsx\n\u003cdiv className=\"flex min-h-svh flex-col items-center justify-center gap-6 bg-muted p-6 md:p-10\"\u003e\n  \u003cdiv className=\"flex w-full max-w-sm flex-col gap-6\"\u003e\n    \u003ca href=\"/\" className=\"flex items-center gap-2 self-center font-medium\"\u003e\n      \u003cTerminal className=\"h-6 w-6\" /\u003e\n      \u003cspan className=\"text-lg font-bold\"\u003eEngram Console\u003c/span\u003e\n    \u003c/a\u003e\n    \u003cCard\u003e\n      \u003cCardHeader className=\"text-center\"\u003e\n        \u003cCardTitle className=\"text-xl\"\u003eWelcome back\u003c/CardTitle\u003e\n        \u003cCardDescription\u003e\n          Sign in to your account to continue\n        \u003c/CardDescription\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cdiv className=\"grid gap-6\"\u003e\n          \u003cButton \n            variant=\"outline\" \n            className=\"w-full\"\n            onClick={() =\u003e signIn.social({ provider: \"google\", callbackURL: \"/\" })}\n          \u003e\n            \u003csvg className=\"h-4 w-4 mr-2\" viewBox=\"0 0 24 24\"\u003e\n              {/* Google icon SVG */}\n            \u003c/svg\u003e\n            Continue with Google\n          \u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n    \u003cdiv className=\"text-center text-xs text-muted-foreground\"\u003e\n      By signing in, you agree to our{\" \"}\n      \u003ca href=\"#\" className=\"underline underline-offset-4 hover:text-primary\"\u003e\n        Terms of Service\n      \u003c/a\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## Components to Use\n- Card (CardHeader, CardTitle, CardDescription, CardContent)\n- Button (OAuth button)\n- Custom logo component\n\n## Auth Integration\n- Uses better-auth client: `import { authClient } from \"@/lib/auth-client\"`\n- `signIn.social({ provider: \"google\", callbackURL: \"/\" })`\n- Callback URL from searchParams\n\n## Reference\n- login-03 block: https://ui.shadcn.com/blocks/login-03\n- Better Auth Next.js: https://www.better-auth.com/docs/integrations/next\n- Current: apps/console/app/(auth)/login/page.tsx\n\n## Acceptance Criteria\n- [ ] Muted background styling\n- [ ] Centered card layout\n- [ ] Logo displayed\n- [ ] Google OAuth button works\n- [ ] Callback URL preserved\n- [ ] Error state handling\n- [ ] Loading state on button","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:49:50.804006-06:00","updated_at":"2025-12-28T17:28:26.229214-06:00","closed_at":"2025-12-28T17:28:26.229214-06:00","dependencies":[{"issue_id":"engram-dxdf","depends_on_id":"engram-p0ks","type":"blocks","created_at":"2025-12-28T16:53:04.223152-06:00","created_by":"ccheney"}]}
{"id":"engram-dxr5","title":"Refactor console to use shadcn default styles","description":"The console app currently uses many custom CSS variables (--console-cyan, --console-purple, --console-amber, etc.) and inline styles that override shadcn defaults. This makes the codebase harder to maintain and inconsistent with shadcn patterns.\n\n## Goals\n- Replace custom color variables with shadcn theme tokens (--primary, --secondary, --muted, etc.)\n- Use shadcn component variants instead of inline style overrides\n- Simplify the tailwind config to rely on shadcn's built-in theming\n- Remove redundant CSS custom properties from globals.css\n\n## Files to review\n- apps/console/app/globals.css\n- apps/console/tailwind.config.ts\n- All page.tsx files in apps/console/app/(dashboard)/\n- Component files with inline style= attributes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T12:19:20.937776-06:00","updated_at":"2025-12-29T13:02:57.124118-06:00","closed_at":"2025-12-29T13:02:57.124118-06:00"}
{"id":"engram-e2g8","title":"Test coverage: apps/memory/src/turn-aggregator.ts (95%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:46.675457-06:00","updated_at":"2025-12-21T04:07:03.759553-06:00","closed_at":"2025-12-21T04:07:03.759553-06:00"}
{"id":"engram-e5s8","title":"Wire SessionAwareRetriever to search API","description":"SessionAwareRetriever in apps/search/src/retrieval/session.py implements two-stage hierarchical retrieval but is never instantiated. Add to app lifespan and create /search/session-aware endpoint.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:00:47.015018-06:00","updated_at":"2025-12-20T23:07:49.466852-06:00","closed_at":"2025-12-20T23:07:49.466852-06:00"}
{"id":"engram-eacx","title":"Implement benchmark evaluate CLI command","description":"packages/benchmark cli.py:218-277 has evaluate() command that shows 'Not yet implemented' warning. Either implement or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:16:06.688636-06:00","updated_at":"2025-12-20T23:25:40.671888-06:00","closed_at":"2025-12-20T23:25:40.671888-06:00"}
{"id":"engram-eb42w","title":"Create Bun build plugin for codegen","description":"Implement Bun build plugin in packages/graph/src/codegen/bun-plugin.ts\n\n## Overview\nThe Bun build plugin integrates code generation into the build process. It generates code on build start and validates raw Cypher queries against the schema during module loading.\n\n## Requirements\n- Plugin runs on build.onStart() to generate code\n- Generate code from schema to packages/graph/src/generated/\n- Validate raw Cypher queries in source files via build.onLoad()\n- Fail build on schema violations with clear error messages\n- Include file path and line number in error messages\n\n## Plugin Implementation\n```typescript\nimport { plugin } from 'bun';\nimport { generate } from './generator';\nimport { schema } from '../schema';\n\nexport const engramSchemaPlugin = plugin({\n  name: 'engram-schema',\n  setup(build) {\n    // Generate on build start\n    build.onStart(async () =\u003e {\n      console.log('[engram-schema] Generating code from schema...');\n      const result = await generate({ schema });\n      console.log(`[engram-schema] Generated ${result.files.length} files`);\n    });\n\n    // Validate Cypher queries at build time\n    build.onLoad({ filter: /\\.ts$/ }, async (args) =\u003e {\n      const contents = await Bun.file(args.path).text();\n      \n      // Find raw Cypher queries\n      const cypherPattern = /falkor\\.query\\(`([^`]+)`/g;\n      let match;\n      while ((match = cypherPattern.exec(contents)) !== null) {\n        const query = match[1];\n        const errors = validateCypherAgainstSchema(query, schema);\n        if (errors.length \u003e 0) {\n          const line = contents.substring(0, match.index).split('\\n').length;\n          throw new Error(\n            `Invalid Cypher in ${args.path}:${line}:\\n${errors.join('\\n')}`\n          );\n        }\n      }\n\n      return { contents, loader: 'ts' };\n    });\n  },\n});\n```\n\n## Cypher Validation\n- Extract node labels from query patterns like (n:Label)\n- Validate labels exist in schema.nodes\n- Extract property accesses like n.propertyName\n- Validate properties exist on the node type\n- Check edge types in relationship patterns\n\n## Research Required\nUse web search for:\n- 'Bun build plugin onStart onLoad'\n- 'Bun plugin code generation example'\n- 'Cypher query parser JavaScript'\n- 'TypeScript build time validation patterns'\n\n## Technical Considerations\n- Handle multi-line Cypher queries\n- Support template literal queries with parameters\n- Consider caching parsed queries for performance\n- Provide helpful error messages with suggestions\n\n## Files\n- packages/graph/src/codegen/bun-plugin.ts (NEW)\n\n## References\n- Bun plugins: https://bun.sh/docs/bundler/plugins\n- Bun plugin hooks: https://bun.sh/docs/bundler/plugins#lifecycle-hooks\n- Plan: docs/plans/compiled-query-layer.md lines 481-544","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:32.89876-06:00","updated_at":"2026-01-01T17:10:40.160513-06:00","dependencies":[{"issue_id":"engram-eb42w","depends_on_id":"engram-o0y7p","type":"blocks","created_at":"2026-01-01T16:55:59.051606-06:00","created_by":"ccheney"}]}
{"id":"engram-eek6","title":"Remove unused graph query exports from interface","description":"apps/interface lib/graph-queries.ts exports getFalkorClient(), ensureConnection(), getSessionsForWebSocket() but none are ever imported.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:15:15.976677-06:00","updated_at":"2025-12-20T23:21:43.980369-06:00","closed_at":"2025-12-20T23:21:43.980369-06:00"}
{"id":"engram-efm5","title":"[MEDIUM] Missing bitemporal fields in SessionInitializer","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:20.992909-06:00","updated_at":"2025-12-21T00:09:56.479024-06:00","closed_at":"2025-12-21T00:09:56.479024-06:00"}
{"id":"engram-efsf","title":"[Console Redesign] Migrate Sidebar component to shadcn","description":"## Overview\nReplace the custom Sidebar component with shadcn's sidebar-07 block pattern (collapses to icons).\n\n## Current Implementation\n- apps/console/app/components/Sidebar.tsx\n- Fixed left navigation (240px)\n- Logo + navigation items + system status footer\n- Custom nav-item styling with active state\n\n## Target Implementation (sidebar-07 pattern)\n```tsx\n\u003cSidebarProvider\u003e\n  \u003cSidebar collapsible=\"icon\"\u003e\n    \u003cSidebarHeader\u003e\n      \u003cSidebarMenu\u003e\n        \u003cSidebarMenuItem\u003e\n          \u003cSidebarMenuButton\u003e\n            \u003cLogo /\u003e\n            \u003cspan\u003eConsole Engram\u003c/span\u003e\n          \u003c/SidebarMenuButton\u003e\n        \u003c/SidebarMenuItem\u003e\n      \u003c/SidebarMenu\u003e\n    \u003c/SidebarHeader\u003e\n    \u003cSidebarContent\u003e\n      \u003cNavMain items={navItems} /\u003e\n      \u003cNavSecondary items={secondaryItems} className=\"mt-auto\" /\u003e\n    \u003c/SidebarContent\u003e\n    \u003cSidebarFooter\u003e\n      \u003cSystemStatus /\u003e\n    \u003c/SidebarFooter\u003e\n  \u003c/Sidebar\u003e\n  \u003cSidebarInset\u003e\n    {children}\n  \u003c/SidebarInset\u003e\n\u003c/SidebarProvider\u003e\n```\n\n## New Files to Create\n- components/layout/app-sidebar.tsx\n- components/layout/nav-main.tsx\n- components/layout/nav-user.tsx (optional for footer)\n\n## Navigation Items (from current Sidebar)\n- Overview (home icon)\n- Services (server icon)\n- Infrastructure (database icon)\n- Deployments (rocket icon)\n- Logs (scroll icon)\n- Performance (activity icon)\n- Alerts (bell icon)\n- Tools (wrench icon)\n\n## Reference\n- shadcn sidebar docs: https://ui.shadcn.com/docs/components/sidebar\n- sidebar-07 block: collapsible to icons with tooltip support\n- Keyboard shortcut: cmd+b / ctrl+b for collapse toggle\n\n## Acceptance Criteria\n- [ ] Sidebar collapses to icon mode\n- [ ] All navigation items preserved\n- [ ] Active state highlighting works\n- [ ] System status footer preserved\n- [ ] Keyboard shortcut works\n- [ ] Mobile responsive (sheet on mobile)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:45:06.755532-06:00","updated_at":"2025-12-28T17:22:48.149589-06:00","closed_at":"2025-12-28T17:22:48.149589-06:00","dependencies":[{"issue_id":"engram-efsf","depends_on_id":"engram-p0ks","type":"blocks","created_at":"2025-12-28T16:51:50.302662-06:00","created_by":"ccheney"}]}
{"id":"engram-efvj","title":"Add session auth to Observatory API routes","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T22:21:15.755524-05:00","updated_at":"2025-12-22T22:24:35.10803-05:00","closed_at":"2025-12-22T22:24:35.10803-05:00"}
{"id":"engram-eg03","title":"Test coverage: packages/graph/src/repositories/falkor-base.ts (46%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:59.918846-06:00","updated_at":"2025-12-21T04:07:03.754991-06:00","closed_at":"2025-12-21T04:07:03.754991-06:00"}
{"id":"engram-eh9p","title":"task","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:59.629456-06:00","updated_at":"2026-01-01T16:49:59.629456-06:00"}
{"id":"engram-elfe","title":"Update token introspection to return client_id for service tokens","description":"Update token introspection endpoint (RFC 7662) to return client_id and grant_type in the introspection response for OAuth service tokens.\n\n**File to modify**: /Users/ccheney/Projects/engram/apps/observatory/app/api/auth/introspect/route.ts\n\n**Current behavior**: Token introspection returns active, sub, scope, email, name, exp, iat, iss, aud, and token_type fields. The client_id field is fetched from the database (line 127, 173) but NOT included in the response.\n\n**Required changes**:\n1. Add client_id field to IntrospectionResponse interface (line 43)\n2. Add grant_type field to IntrospectionResponse interface (enum: 'authorization_code' | 'device_code' | 'client_credentials' | 'refresh_token')\n3. Include client_id in the response object (line 173) - already fetched from DB, just add to response\n4. Include grant_type in the response object - requires adding grant_type column to oauth_tokens table first (see dependency)\n\n**RFC 7662 Reference**: https://datatracker.ietf.org/doc/html/rfc7662#section-2.2\n- client_id: OPTIONAL - Identifier for the client that requested this token\n- grant_type: NOT in RFC 7662 but common extension for debugging/auditing\n\n**Use case**: Resource servers (API, Search, Tuner, Ingestion) need to distinguish between user tokens (device_code grant) and service tokens (client_credentials grant) for authorization logic. For example, service-to-service calls with client_credentials should bypass user-specific rate limits.\n\n**Testing**: After changes, introspect a client_credentials token and verify response includes:\n\n\n**Dependencies**: This task is BLOCKED by engram-qiua (create client credentials grant endpoint) and engram-vl37 (add grant_type column to oauth_tokens table). The grant_type field cannot be returned until the database migration adds the column.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:54:08.974951-06:00","updated_at":"2025-12-29T16:35:35.126643-06:00","closed_at":"2025-12-29T16:35:35.126643-06:00","dependencies":[{"issue_id":"engram-elfe","depends_on_id":"engram-qiua","type":"blocks","created_at":"2025-12-29T16:00:15.176771-06:00","created_by":"ccheney"}]}
{"id":"engram-enso","title":"Test coverage: packages/storage/src/falkor.ts (85%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:59.77849-06:00","updated_at":"2025-12-21T04:07:03.755366-06:00","closed_at":"2025-12-21T04:07:03.755366-06:00"}
{"id":"engram-eora","title":"Unit tests for memory repository invalidation","description":"Test: invalidate() closes vt_end and tt_end, REPLACES edge created with replacedById, findReplacements() traverses correctly, invalidated memories excluded from findActive()","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:44:23.915643-06:00","updated_at":"2026-01-01T18:00:55.976679-06:00","closed_at":"2026-01-01T18:00:55.976679-06:00","dependencies":[{"issue_id":"engram-eora","depends_on_id":"engram-cubk","type":"blocks","created_at":"2026-01-01T16:46:36.218961-06:00","created_by":"ccheney"},{"issue_id":"engram-eora","depends_on_id":"engram-gwgg","type":"blocks","created_at":"2026-01-01T16:46:41.344617-06:00","created_by":"ccheney"}]}
{"id":"engram-ettk","title":"Test coverage: packages/parser/src/redactor.ts (96%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:49.719131-06:00","updated_at":"2025-12-21T04:07:03.758219-06:00","closed_at":"2025-12-21T04:07:03.758219-06:00"}
{"id":"engram-evdz","title":"Migrate memory service to NATS","description":"Update memory service to use NATS instead of Kafka.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 4: Service Migration\n\n## Topic Mapping\n- parsed_events → events.parsed (subscribe)\n- memory.turn_finalized → memory.turns.finalized (publish)\n- memory.node_created → memory.nodes.created (publish)\n- memory.dead_letter → dlq.memory (publish on error)\n\n## Consumer\n- Stream: EVENTS  \n- Durable name: memory\n\n## Implementation\n- Import createNatsClient from @engram/storage\n- Replace Kafka producer/consumer with NATS\n- Update environment variable from REDPANDA_BROKERS to NATS_URL\n\n## Acceptance Criteria\n- Service starts and connects to NATS\n- Subscribes to events.parsed\n- Publishes to memory.turns.finalized\n- Dead letter queue working","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:26:36.919919-05:00","updated_at":"2025-12-22T00:49:14.131381-05:00","closed_at":"2025-12-22T00:49:14.131381-05:00","dependencies":[{"issue_id":"engram-evdz","depends_on_id":"engram-qgcm","type":"blocks","created_at":"2025-12-22T00:29:19.581364-05:00","created_by":"ccheney"},{"issue_id":"engram-evdz","depends_on_id":"engram-3xez","type":"blocks","created_at":"2025-12-22T00:29:24.712667-05:00","created_by":"ccheney"}]}
{"id":"engram-exnd","title":"Upload SSH key to Hetzner","description":"Generate and upload SSH key for server access.\n\n## Steps\n1. Generate key (if needed): `ssh-keygen -t ed25519 -C 'engram-server'`\n2. Upload to Hetzner: `hcloud ssh-key create --name engram-key --public-key-from-file ~/.ssh/id_ed25519.pub`\n3. Verify: `hcloud ssh-key list`\n\n## Acceptance Criteria\n- SSH key is uploaded to Hetzner\n- Key appears in `hcloud ssh-key list`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:30:39.042854-06:00","updated_at":"2025-12-21T15:48:26.552071-06:00","closed_at":"2025-12-21T15:48:26.552071-06:00","dependencies":[{"issue_id":"engram-exnd","depends_on_id":"engram-1tw9","type":"blocks","created_at":"2025-12-21T15:33:02.081042-06:00","created_by":"ccheney"},{"issue_id":"engram-exnd","depends_on_id":"engram-whvx","type":"blocks","created_at":"2025-12-21T15:33:07.223802-06:00","created_by":"ccheney"}]}
{"id":"engram-eydx","title":"Include all search space parameters in tuner presets","description":"packages/tuner spaces/engram.ts defines parameters like search.minScore.sparse that are not in any preset. Full preset should include all defined parameters.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:15:59.769383-06:00","updated_at":"2025-12-20T23:20:12.875742-06:00","closed_at":"2025-12-20T23:20:12.875742-06:00"}
{"id":"engram-ez7r","title":"Backfill turn embeddings from FalkorDB","description":"Create migration script to backfill turn-level embeddings from existing FalkorDB Turn nodes into new engram_turns collection.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:12:15.028122-06:00","updated_at":"2025-12-21T07:01:57.646982-06:00","closed_at":"2025-12-21T07:01:57.646982-06:00","dependencies":[{"issue_id":"engram-ez7r","depends_on_id":"engram-zxlp","type":"blocks","created_at":"2025-12-21T06:13:39.53547-06:00","created_by":"ccheney"}]}
{"id":"engram-ezn34","title":"Add EntityNodeSchema to graph models","description":"Add EntityTypeEnum and EntityNodeSchema to packages/graph/src/models/nodes.ts.\n\n## Entity Types\n- tool (pytest, Docker, Kubernetes)\n- concept (authentication, caching, testing)\n- pattern (repository pattern, CQRS, event sourcing)\n- file (src/auth.ts - links to FileTouch nodes)\n- person (team members, contributors)\n- project (repository, package, service)\n- technology (PostgreSQL, Redis, React)\n\n## Schema Fields\n- name: string (canonical name)\n- aliases: string[] (alternative names)\n- type: EntityTypeEnum\n- description: string (LLM-generated)\n- mention_count: number (statistics)\n- embedding: number[] (for similarity search)\n- project: string (scoping)\n- Extends BaseNodeSchema (includes bitemporal fields)\n\n## Implementation Reference\nSee existing node patterns in packages/graph/src/models/nodes.ts (SessionNode, MemoryNode).\n\n## Research\n- Graphiti EntityNode design: https://github.com/getzep/graphiti\n- Use Context7 MCP: `resolve-library-id` for 'graphiti' then `query-docs` for 'entity node schema types'\n- Web search: 'knowledge graph entity types taxonomy 2025'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:11.430219-06:00","updated_at":"2026-01-01T17:31:02.520936-06:00","closed_at":"2026-01-01T17:31:02.520936-06:00"}
{"id":"engram-f377","title":"Update API auth middleware to accept OAuth tokens","description":"Modify apps/api/src/middleware/auth.ts to accept engram_oauth_ prefixed tokens alongside existing API keys. Update token pattern regex to include oauth prefix. Add lookup in oauth_tokens table when token matches OAuth pattern. Create unified AuthContext that works for both API keys and OAuth tokens. See docs/design/oauth-device-flow.md 'Token Format' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:37.253114-05:00","updated_at":"2025-12-25T02:30:54.019788-05:00","closed_at":"2025-12-25T02:30:54.019788-05:00","dependencies":[{"issue_id":"engram-f377","depends_on_id":"engram-g0sx","type":"blocks","created_at":"2025-12-25T02:21:24.142013-05:00","created_by":"ccheney"},{"issue_id":"engram-f377","depends_on_id":"engram-kf57","type":"blocks","created_at":"2025-12-25T02:21:29.264927-05:00","created_by":"ccheney"}]}
{"id":"engram-f4v8","title":"[CRITICAL] Undefined method call in benchmark key_expansion.py","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:49.467457-06:00","updated_at":"2025-12-20T23:45:30.479923-06:00","closed_at":"2025-12-20T23:45:30.479923-06:00"}
{"id":"engram-f5xd","title":"Update API auth middleware for tenant context","description":"Extract orgId/orgSlug from introspection and create TenantContext in API middleware.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'API Service' section (lines 511-515)\n\n## Implementation\nUpdate apps/api/src/middleware/auth.ts:\n- Parse org_id, org_slug from introspection response\n- Create TenantContext using createTenantContext()\n- Attach to request context (c.set('tenant', tenantContext))\n\n## Files to Modify\n- apps/api/src/middleware/auth.ts\n\n## Agent Instructions\nUse Context7 MCP for Hono middleware patterns. Ensure backward compatibility during transition.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:07:59.93937-06:00","updated_at":"2025-12-29T22:54:39.88712-06:00","closed_at":"2025-12-29T22:54:39.88712-06:00","dependencies":[{"issue_id":"engram-f5xd","depends_on_id":"engram-nnmx","type":"blocks","created_at":"2025-12-29T22:12:03.277703-06:00","created_by":"ccheney"}]}
{"id":"engram-f712","title":"Migrate Observatory pub/sub from Redis to NATS","description":"Replace Redis pub/sub with NATS native pub/sub for Observatory real-time updates.\n\n## Current State\n- Redis is used for real-time pub/sub to Observatory WebSockets\n- Publishers: apps/control, apps/memory, apps/ingestion\n- Subscriber: apps/observatory/lib/websocket-server.ts\n- Channels: session:{id}:updates, sessions:updates, consumers:status\n\n## Goal\nEliminate Redis dependency entirely. Use pure NATS + JetStream.\n\n## Files to Update\n- packages/storage/src/redis.ts → remove or replace with NATS pub/sub wrapper\n- apps/observatory/lib/websocket-server.ts → subscribe via NATS\n- apps/memory/src/index.ts → publish via NATS\n- apps/ingestion/src/index.ts → publish via NATS  \n- apps/control/src/index.ts → publish via NATS\n- docker-compose.dev.yml → remove redis service\n- docker-compose.prod.yml → remove redis service\n\n## Notes\n- NATS core pub/sub is ephemeral (no persistence needed for UI updates)\n- Use NATS subjects instead of Redis channels\n- Consider using NATS request/reply for consumer status if needed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T02:13:53.215847-05:00","updated_at":"2025-12-22T02:45:04.442736-05:00","closed_at":"2025-12-22T02:45:04.442736-05:00"}
{"id":"engram-fad4","title":"[CRITICAL] Missing bitemporal tt_start/tt_end in apps/memory handlers","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:09.452833-06:00","updated_at":"2025-12-20T23:45:30.483415-06:00","closed_at":"2025-12-20T23:45:30.483415-06:00"}
{"id":"engram-fady","title":"[HIGH] No React error boundary in observatory","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:20.401722-06:00","updated_at":"2025-12-20T23:56:07.534526-06:00","closed_at":"2025-12-20T23:56:07.534526-06:00"}
{"id":"engram-fae0","title":"task","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:05.538002-06:00","updated_at":"2026-01-01T16:50:05.538002-06:00"}
{"id":"engram-fb9s","title":"Test coverage: packages/infra/src/gke.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:35.423095-06:00","updated_at":"2025-12-21T04:07:03.762305-06:00","closed_at":"2025-12-21T04:07:03.762305-06:00"}
{"id":"engram-fbeh","title":"[Console Redesign] Configure shadcn theme with mission-control aesthetic","description":"## Overview\nMap existing console CSS variables to shadcn's variable system while preserving the mission-control color palette.\n\n## Tasks\n1. Map CSS variables from apps/console/app/globals.css to shadcn format\n2. Configure dark theme as default\n3. Map status colors (cyan, green, amber, red, purple) \n4. Configure sidebar-specific CSS variables\n5. Set up chart colors (--chart-1 through --chart-5)\n\n## CSS Variable Mapping (from redesign plan)\n```css\n--background: var(--console-void);\n--foreground: var(--text-primary);\n--card: var(--console-panel);\n--primary: var(--console-cyan);\n--secondary: var(--console-purple);\n--muted: var(--console-surface);\n--destructive: var(--console-red);\n--sidebar-background: var(--console-panel);\n--sidebar-primary: var(--console-cyan);\n```\n\n## Reference Files\n- apps/console/app/globals.css (existing theme)\n- docs/console-ui-redesign-plan.md (Theme Configuration section)\n\n## Acceptance Criteria\n- [ ] All console colors mapped to shadcn variables\n- [ ] Dark mode working as default\n- [ ] Mission-control aesthetic preserved\n- [ ] Custom glow effects for cards/buttons configured","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:44:28.528906-06:00","updated_at":"2025-12-28T17:17:50.190385-06:00","closed_at":"2025-12-28T17:17:50.190385-06:00","dependencies":[{"issue_id":"engram-fbeh","depends_on_id":"engram-806h","type":"blocks","created_at":"2025-12-28T16:51:39.076441-06:00","created_by":"ccheney"}]}
{"id":"engram-fdd9","title":"Add API key auth to MCP HTTP ingest routes","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T22:21:03.834145-05:00","updated_at":"2025-12-22T22:27:14.097798-05:00","closed_at":"2025-12-22T22:27:14.097798-05:00"}
{"id":"engram-ffia","title":"Wire VFS createSnapshot() or remove","description":"packages/vfs vfs.ts:105-108 createSnapshot() is never called. Snapshots created via vfs.root serialization instead. Consolidate approach or remove unused method.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:35.843976-06:00","updated_at":"2025-12-20T23:23:20.598991-06:00","closed_at":"2025-12-20T23:23:20.598991-06:00"}
{"id":"engram-fhjlv","title":"Migrate existing queries to generated builders","description":"Replace hand-written Cypher queries with generated query builders\n\n## Overview\nThis migration replaces raw Cypher strings in repository implementations with type-safe generated query builders. This is the final step that delivers the compile-time safety benefits.\n\n## Scope\n- packages/graph/src/repositories/*.ts\n- apps/mcp/src/tools/query.ts\n- apps/memory/src/\n\n## Migration Strategy\n\n### Step 1: Identify Raw Queries\nSearch for all `falkor.query()` calls and `this.query()` calls in repositories.\n\n### Step 2: Map to Query Builders\nFor each raw query, determine the equivalent query builder pattern:\n\n| Raw Query Pattern | Query Builder Equivalent |\n|-------------------|-------------------------|\n| `MATCH (m:Memory {id: $id})` | `Memory.findById(id)` |\n| `MATCH (m:Memory) WHERE m.type = $type` | `Memory.where({ type }).execute()` |\n| `MATCH (m:Memory) WHERE m.tt_end = MAX_DATE` | `Memory.where({}).whereCurrent().execute()` |\n| Time-travel query | `Memory.asOf(id, timestamp)` |\n\n### Step 3: Replace Incrementally\n- Replace one repository at a time\n- Run tests after each replacement\n- Compare Cypher output to verify equivalence\n\n### Step 4: Remove Duplicates\n- Remove old Zod schemas that are now generated\n- Update imports to use @engram/graph/generated\n- Clean up unused type definitions\n\n## Example Migration\n\n### Before:\n```typescript\nasync findByType(type: MemoryType): Promise\u003cMemory[]\u003e {\n  const results = await this.query\u003c{ m: FalkorNode\u003cMemoryNodeProps\u003e }\u003e(\n    `MATCH (m:Memory {type: $type}) WHERE m.tt_end = ${this.maxDate} RETURN m ORDER BY m.vt_start DESC`,\n    { type }\n  );\n  return results.map(r =\u003e this.mapToMemory(r.m));\n}\n```\n\n### After:\n```typescript\nasync findByType(type: MemoryType): Promise\u003cMemory[]\u003e {\n  return Memory\n    .where({ type })\n    .whereCurrent()\n    .orderBy('vt_start', 'DESC')\n    .execute();\n}\n```\n\n## Validation\n- Run all existing tests before and after migration\n- Compare generated Cypher with original queries\n- Ensure no runtime behavior changes\n- Verify type inference works in IDE\n\n## Research Required\nReview existing implementations:\n- packages/graph/src/repositories/falkor-session.repository.ts\n- packages/graph/src/repositories/falkor-turn.repository.ts\n- packages/graph/src/repositories/falkor-memory.repository.ts\n\nUse web search for:\n- 'ORM migration best practices'\n- 'Incremental code migration patterns'\n\n## Files to Migrate\n- packages/graph/src/repositories/falkor-session.repository.ts\n- packages/graph/src/repositories/falkor-turn.repository.ts\n- packages/graph/src/repositories/falkor-memory.repository.ts\n- packages/graph/src/repositories/falkor-reasoning.repository.ts\n- packages/graph/src/repositories/falkor-tool-call.repository.ts\n- packages/graph/src/repositories/falkor-file-touch.repository.ts\n\n## References\n- Plan: docs/plans/compiled-query-layer.md (rollout step 6)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:53:17.687937-06:00","updated_at":"2026-01-01T17:14:12.047843-06:00","dependencies":[{"issue_id":"engram-fhjlv","depends_on_id":"engram-dtszf","type":"blocks","created_at":"2026-01-01T16:56:55.710683-06:00","created_by":"ccheney"}]}
{"id":"engram-fpr1","title":"[Benchmark-Py] Phase 1: Foundation","description":"Project scaffolding for Python benchmark suite. Create pyproject.toml with dependencies (Typer, Pydantic, LiteLLM, ranx, RAGAS). Set up Typer CLI with Rich integration. Implement Pydantic models for LongMemEval types (Instance, Session, Turn, etc.). Create dataset loader with validation. Basic test infrastructure.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 1: Foundation)\n\nDeliverables:\n- pyproject.toml with all dependencies\n- src/engram_benchmark/cli.py - Typer CLI skeleton\n- src/engram_benchmark/config.py - Pydantic settings\n- src/engram_benchmark/longmemeval/types.py - Pydantic models\n- src/engram_benchmark/longmemeval/loader.py - Dataset loading\n- 'engram-benchmark validate' command working\n- pytest infrastructure with fixtures","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:23:23.341942-06:00","updated_at":"2025-12-20T07:47:29.635271-06:00","closed_at":"2025-12-20T07:47:29.635271-06:00"}
{"id":"engram-fr9p","title":"Test coverage: packages/parser/src/parser/gemini.ts (87%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:23.223642-06:00","updated_at":"2025-12-21T04:07:03.765168-06:00","closed_at":"2025-12-21T04:07:03.765168-06:00"}
{"id":"engram-frn0","title":"Integrate conflict detection into remember tool","description":"Update apps/mcp/src/tools/remember.ts: after deduplication check, call searchClient.findConflictCandidates(), enrich with graph data, call conflictDetector.detectConflicts(), log decisions, call invalidateMemory() for conflicts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:21.504944-06:00","updated_at":"2026-01-01T18:09:28.051956-06:00","closed_at":"2026-01-01T18:09:28.051956-06:00","dependencies":[{"issue_id":"engram-frn0","depends_on_id":"engram-t4ms","type":"blocks","created_at":"2026-01-01T16:45:28.220001-06:00","created_by":"ccheney"},{"issue_id":"engram-frn0","depends_on_id":"engram-42up","type":"blocks","created_at":"2026-01-01T16:45:33.355124-06:00","created_by":"ccheney"},{"issue_id":"engram-frn0","depends_on_id":"engram-cubk","type":"blocks","created_at":"2026-01-01T16:45:38.485126-06:00","created_by":"ccheney"}]}
{"id":"engram-fs5a","title":"Add HF configuration to Settings","description":"Add Hugging Face configuration options to search service Settings class.\n\n## Location\n`apps/search/src/config.py`\n\n## New settings\n```python\n# Hugging Face\nhf_api_token: str = Field(default=\"\", description=\"Hugging Face API token\")\nembedder_backend: str = Field(default=\"local\", description=\"Embedder backend: local or huggingface\")\nreranker_backend: str = Field(default=\"local\", description=\"Reranker backend: local or huggingface\")\n```\n\n## Environment variables\n- HF_API_TOKEN\n- EMBEDDER_BACKEND\n- RERANKER_BACKEND\n\n## Acceptance Criteria\n- Settings class loads new env vars\n- Defaults to 'local' for backward compatibility\n- Validation that HF_API_TOKEN is set when backend=huggingface","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:29:26.6024-06:00","updated_at":"2025-12-21T16:10:46.979294-06:00","closed_at":"2025-12-21T16:10:46.979294-06:00"}
{"id":"engram-fuco","title":"Update README.md MCP Tools table","description":"Update apps/mcp/README.md (or root README.md MCP section) to reflect the improved tool descriptions. The table should include richer descriptions that help developers understand when to use each tool proactively.\n\nReference: docs/plans/mcp-tool-descriptions.md#phase-4-documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:53:05.471567-05:00","updated_at":"2025-12-25T01:02:50.628156-05:00","closed_at":"2025-12-25T01:02:50.628156-05:00","dependencies":[{"issue_id":"engram-fuco","depends_on_id":"engram-qyx3","type":"blocks","created_at":"2025-12-25T00:53:35.84404-05:00","created_by":"ccheney"},{"issue_id":"engram-fuco","depends_on_id":"engram-0ojf","type":"blocks","created_at":"2025-12-25T00:53:40.965129-05:00","created_by":"ccheney"},{"issue_id":"engram-fuco","depends_on_id":"engram-d0td","type":"blocks","created_at":"2025-12-25T00:53:46.092178-05:00","created_by":"ccheney"},{"issue_id":"engram-fuco","depends_on_id":"engram-1m9i","type":"blocks","created_at":"2025-12-25T00:53:51.225287-05:00","created_by":"ccheney"},{"issue_id":"engram-fuco","depends_on_id":"engram-je9d","type":"blocks","created_at":"2025-12-25T00:53:56.355718-05:00","created_by":"ccheney"},{"issue_id":"engram-fuco","depends_on_id":"engram-rv18","type":"blocks","created_at":"2025-12-25T00:54:01.487085-05:00","created_by":"ccheney"},{"issue_id":"engram-fuco","depends_on_id":"engram-x7fj","type":"blocks","created_at":"2025-12-25T00:54:06.61789-05:00","created_by":"ccheney"}]}
{"id":"engram-fwvb","title":"Remove legacy API params from observatory search","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:12:44.628963-05:00","updated_at":"2025-12-24T02:20:00.238179-05:00","closed_at":"2025-12-24T02:20:00.238179-05:00"}
{"id":"engram-fxxg","title":"Add turn_finalized consumer in search service","description":"Add Kafka consumer handler for memory.turn_finalized events in apps/search/src/indexing/consumer.py. Build complete content from user + assistant + reasoning fields.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:11:29.395209-06:00","updated_at":"2025-12-21T06:44:20.580807-06:00","closed_at":"2025-12-21T06:44:20.580807-06:00","dependencies":[{"issue_id":"engram-fxxg","depends_on_id":"engram-bc18","type":"blocks","created_at":"2025-12-21T06:13:27.87701-06:00","created_by":"ccheney"},{"issue_id":"engram-fxxg","depends_on_id":"engram-zxlp","type":"blocks","created_at":"2025-12-21T06:13:32.999986-06:00","created_by":"ccheney"}]}
{"id":"engram-fyoa","title":"Add tests for packages/tuner/src/executor/evaluation-adapter.ts (23.5% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:57.646701-05:00","updated_at":"2025-12-27T01:58:57.646701-05:00"}
{"id":"engram-g0sx","title":"Create OAuth device flow database migration","description":"Create scripts/migrate-device-auth.sql with device_codes and oauth_tokens tables. See docs/design/oauth-device-flow.md 'Database Schema Changes' section for table definitions including indexes. Tables store device codes (pending/authorized/denied/expired/used status), user linkage, and OAuth tokens with SHA-256 hashed storage.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:34.6312-05:00","updated_at":"2025-12-25T02:25:51.431946-05:00","closed_at":"2025-12-25T02:25:51.431946-05:00"}
{"id":"engram-g2nx","title":"Create /activate device verification page","description":"Create apps/observatory/app/activate/page.tsx - User-facing page to enter device code. Simple form with XXXX-XXXX code input, pre-fills from ?code= query param. Redirects to login if not authenticated, shows success/error after verification. IMPORTANT: Use the frontend-design skill (/frontend-design) for this UI task to ensure high design quality. See docs/design/oauth-device-flow.md 'User Verification Page' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:59.9388-05:00","updated_at":"2025-12-25T02:35:24.159095-05:00","closed_at":"2025-12-25T02:35:24.159095-05:00","dependencies":[{"issue_id":"engram-g2nx","depends_on_id":"engram-kprv","type":"blocks","created_at":"2025-12-25T02:21:18.292715-05:00","created_by":"ccheney"}]}
{"id":"engram-g3d7","title":"Improve /e recap prompt description","description":"Update apps/mcp/src/prompts/e-recap.ts with improved description:\n- Main description: 'Review what happened in a previous session. Returns: session timeline, turns with user/assistant exchanges, files modified, and tool calls made. Use when: resuming work after a break, reviewing what was accomplished yesterday, or understanding context before continuing someone elses work.'\n\nReference: docs/plans/mcp-tool-descriptions.md#prompt-e-recap","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:39.147032-05:00","updated_at":"2025-12-25T01:00:51.720929-05:00","closed_at":"2025-12-25T01:00:51.720929-05:00"}
{"id":"engram-g3ke","title":"[Console Redesign] Migrate ServiceHealthGrid to shadcn Cards","description":"## Overview\nReplace ServiceHealthGrid with shadcn Card grid with Badge status indicators.\n\n## Current Implementation\n- apps/console/app/components/ServiceHealthGrid.tsx\n- Polls health every 5s\n- Shows apps and infrastructure sections\n- Status dots (online/warning/offline) with pulse animation\n- Latency display\n\n## Target Implementation\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\"\u003e\n  {services.map((service) =\u003e (\n    \u003cCard key={service.name} className=\"hover:border-primary/50 transition-colors\"\u003e\n      \u003cCardHeader className=\"flex flex-row items-center justify-between pb-2\"\u003e\n        \u003cCardTitle className=\"text-sm font-medium flex items-center gap-2\"\u003e\n          \u003cservice.icon className=\"h-4 w-4\" /\u003e\n          {service.name}\n        \u003c/CardTitle\u003e\n        \u003cBadge variant={getStatusVariant(service.status)}\u003e\n          {service.status}\n        \u003c/Badge\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cdiv className=\"text-xs text-muted-foreground\"\u003e\n          Latency: {service.latency}ms\n        \u003c/div\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  ))}\n\u003c/div\u003e\n```\n\n## Badge Variants to Create\n```tsx\n// In components/ui/badge.tsx or custom\nconst statusVariants = {\n  online: \"bg-green-500/10 text-green-500 border-green-500/20\",\n  warning: \"bg-amber-500/10 text-amber-500 border-amber-500/20\", \n  offline: \"bg-red-500/10 text-red-500 border-red-500/20\",\n}\n```\n\n## Components to Use\n- Card, CardHeader, CardTitle, CardContent\n- Badge (with custom status variants)\n- Skeleton (loading state)\n- Tooltip (for additional info)\n\n## New Files\n- components/dashboard/service-grid.tsx\n- components/shared/status-badge.tsx (custom Badge variants)\n\n## Reference\n- Current: apps/console/app/components/ServiceHealthGrid.tsx\n\n## Acceptance Criteria\n- [ ] Services displayed in card grid\n- [ ] Status badges with correct colors\n- [ ] Latency displayed\n- [ ] Polling works (5s interval)\n- [ ] Loading skeletons\n- [ ] Error state handling","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:46:44.378463-06:00","updated_at":"2025-12-28T17:28:26.228743-06:00","closed_at":"2025-12-28T17:28:26.228743-06:00","dependencies":[{"issue_id":"engram-g3ke","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:16.849277-06:00","created_by":"ccheney"}]}
{"id":"engram-g3m4","title":"Implement semantic chunker for long turns","description":"Create SemanticChunker class that splits text at semantic boundaries using embedding similarity. For turns exceeding 2000 chars, create sub-chunks while preserving context.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:11:51.975854-06:00","updated_at":"2025-12-21T06:58:17.942356-06:00","closed_at":"2025-12-21T06:58:17.942356-06:00","dependencies":[{"issue_id":"engram-g3m4","depends_on_id":"engram-fxxg","type":"blocks","created_at":"2025-12-21T06:13:52.214218-06:00","created_by":"ccheney"}]}
{"id":"engram-g4yf","title":"[HIGH] PostgreSQL connection validation in packages/storage","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:19.387268-06:00","updated_at":"2025-12-20T23:58:50.321669-06:00","closed_at":"2025-12-20T23:58:50.321669-06:00"}
{"id":"engram-g65i","title":"Register engram-search OAuth client (scopes: memory:read, query:read)","description":"Register engram-search as OAuth client for Search service M2M auth.\n\n**Prerequisites:** Run seed-oauth-clients.ts script from engram-h44m\n\n**Client configuration:**\n- client_id: engram-search\n- scopes: memory:read, query:read\n- grant_types: client_credentials\n- token_endpoint_auth_method: client_secret_basic\n\n**Environment variables to set:**\n```bash\n# In apps/search/.env or docker-compose\nENGRAM_CLIENT_ID=engram-search\nENGRAM_CLIENT_SECRET=\u003cfrom seed script output\u003e\nENGRAM_AUTH_URL=http://localhost:6178\n```\n\n**Search service usage (Python):**\nThe search FastAPI service will authenticate incoming requests AND may need to call other services.\n\n**Files to update:**\n- `apps/search/.env.example` - add new env vars\n- `docker-compose.dev.yml` - add search service env\n\n**Subagent instructions:**\n- Verify seed script ran successfully first\n- Check client exists in database\n- Update Python .env.example","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:52:48.088628-06:00","updated_at":"2025-12-29T16:41:52.613115-06:00","closed_at":"2025-12-29T16:41:52.613115-06:00","dependencies":[{"issue_id":"engram-g65i","depends_on_id":"engram-h44m","type":"blocks","created_at":"2025-12-29T15:58:14.039192-06:00","created_by":"ccheney"}]}
{"id":"engram-g6ab","title":"Remove mock data from performance/page.tsx","description":"Remove generateMockData function and mock performance metrics from Performance page (lines 448-545, 553-554). Replace with proper loading/error states.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:53:50.991352-05:00","updated_at":"2025-12-27T20:04:22.767686-05:00","closed_at":"2025-12-27T20:04:22.767686-05:00"}
{"id":"engram-g9n0","title":"Update API memory routes to pass TenantContext","description":"Pass TenantContext from middleware to all memory route handlers.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 560)\n\n## Implementation\nUpdate apps/api/src/routes/memory.ts:\n- Extract tenant context: const tenant = c.get('tenant')\n- Pass to all service calls\n- Update /v1/memory/* endpoints to scope to tenant\n\n## Files to Modify\n- apps/api/src/routes/memory.ts\n\n## Agent Instructions\nEnsure all 4 endpoints (remember, recall, query, context) receive TenantContext.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:12.088173-06:00","updated_at":"2025-12-29T23:17:09.18922-06:00","closed_at":"2025-12-29T23:17:09.18922-06:00","dependencies":[{"issue_id":"engram-g9n0","depends_on_id":"engram-f5xd","type":"blocks","created_at":"2025-12-29T22:12:09.5905-06:00","created_by":"ccheney"}]}
{"id":"engram-gbem","title":"Create validators generator (codegen)","description":"Implement Zod validator generation from schema in packages/graph/src/codegen/validators-generator.ts\n\n## Overview\nThe validators generator creates Zod schemas that match the generated TypeScript types. These validators are used for runtime input validation in API endpoints and MCP tools.\n\n## Requirements\n- Generate Zod schemas for each node type\n- Generate CreateXXXInputSchema (omitting id and bitemporal fields)\n- Generate UpdateXXXInputSchema (partial of create input)\n- Match existing Zod patterns in packages/graph/src/models/\n- Handle all field types (string, int, enum, array, etc.)\n\n## Example Output\n```typescript\n// AUTO-GENERATED - DO NOT EDIT\n\nimport { z } from 'zod';\nimport { BitemporalSchema } from '../models/base';\n\nexport const MemoryTypeSchema = z.enum([\n  'decision', 'context', 'insight', 'preference', 'fact', 'turn'\n]);\n\nexport const MemorySchema = z.object({\n  id: z.string(),\n  content: z.string(),\n  content_hash: z.string(),\n  type: MemoryTypeSchema,\n  tags: z.array(z.string()),\n  source_session_id: z.string().optional(),\n  source: z.enum(['user', 'auto', 'import']).default('user'),\n  embedding: z.array(z.number()).optional(),\n}).merge(BitemporalSchema);\n\nexport const CreateMemoryInputSchema = MemorySchema.omit({\n  id: true,\n  vt_start: true,\n  vt_end: true,\n  tt_start: true,\n  tt_end: true,\n});\n\nexport const UpdateMemoryInputSchema = CreateMemoryInputSchema.partial();\n\nexport type MemoryType = z.infer\u003ctypeof MemoryTypeSchema\u003e;\nexport type Memory = z.infer\u003ctypeof MemorySchema\u003e;\nexport type CreateMemoryInput = z.infer\u003ctypeof CreateMemoryInputSchema\u003e;\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `resolve-library-id('zod')` then `query-docs` for 'schema definition validation'\n\nUse web search for:\n- 'Zod schema code generation'\n- 'zod-to-ts type inference'\n- 'Prisma Zod generator'\n- 'TypeScript to Zod converter'\n\n## Technical Considerations\n- Map field.string() → z.string()\n- Map field.int() → z.number().int()\n- Map field.enum([...]) → z.enum([...])\n- Map field.array(inner) → z.array(inner.toZod())\n- Handle .optional() and .default() modifiers\n\n## Files\n- packages/graph/src/codegen/validators-generator.ts (NEW)\n\n## References\n- Current validators: packages/graph/src/models/nodes.ts\n- Zod docs: https://zod.dev/\n- zod-prisma: https://github.com/CarterGrimmeworthy/zod-prisma","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:07.651763-06:00","updated_at":"2026-01-01T17:09:34.624391-06:00","dependencies":[{"issue_id":"engram-gbem","depends_on_id":"engram-0v41","type":"blocks","created_at":"2026-01-01T16:54:56.235384-06:00","created_by":"ccheney"}]}
{"id":"engram-gcmr","title":"Integration tests for tenant isolation","description":"Create integration tests verifying complete tenant isolation.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Testing Strategy section (lines 640-646)\n\n## Test Scenarios\n- Create org → create user → auth → store memory → recall\n- Org A cannot query Org B graph (FalkorDB isolation)\n- Org A cannot retrieve Org B vectors (Qdrant isolation)\n- Admin with admin:read can access both orgs\n- RLS policies prevent bypass\n\n## Files to Create\n- tests/integration/multi-tenancy.test.ts\n\n## Agent Instructions\nRequires running infrastructure. Use test orgs created in setup fixtures.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:22.230415-06:00","updated_at":"2025-12-30T00:02:05.813929-06:00","closed_at":"2025-12-30T00:02:05.813929-06:00","dependencies":[{"issue_id":"engram-gcmr","depends_on_id":"engram-jekc","type":"blocks","created_at":"2025-12-29T22:12:43.706747-06:00","created_by":"ccheney"}]}
{"id":"engram-gdai","title":"[CRITICAL] Resource leaks in MemoryStore (apps/mcp)","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:58.885415-06:00","updated_at":"2025-12-20T23:35:43.81378-06:00","closed_at":"2025-12-20T23:35:43.81378-06:00"}
{"id":"engram-gfj4","title":"Test coverage: packages/parser/src/parser/schemas.ts (86%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:35.521393-06:00","updated_at":"2025-12-21T04:07:03.762071-06:00","closed_at":"2025-12-21T04:07:03.762071-06:00"}
{"id":"engram-gfjs","title":"[MEDIUM] Turn update doesn't follow bitemporal versioning","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:51.297217-06:00","updated_at":"2025-12-21T00:09:56.477798-06:00","closed_at":"2025-12-21T00:09:56.477798-06:00"}
{"id":"engram-gkcl","title":"Add org_id/org_slug to oauth_tokens table","description":"Update oauth_tokens table with organization fields and RLS policies.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'OAuth Tokens (with RLS)' section (lines 232-270)\n\n## Implementation\nUpdate oauth_tokens table:\n- Add orgId: text('org_id').references(() =\u003e organizations.id).notNull()\n- Add orgSlug: text('org_slug').notNull() (denormalized for fast graph naming)\n- Enable RLS with pgTable.withRLS()\n- Add tenant isolation and service bypass policies\n\n## Files to Modify\n- apps/observatory/src/db/schema.ts\n\n## Agent Instructions\nUse Context7 MCP for Drizzle. Ensure denormalized org_slug is documented for query performance.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:02.38509-06:00","updated_at":"2025-12-29T22:26:39.615825-06:00","closed_at":"2025-12-29T22:26:39.615825-06:00","dependencies":[{"issue_id":"engram-gkcl","depends_on_id":"engram-qnh3","type":"blocks","created_at":"2025-12-29T22:12:08.258511-06:00","created_by":"ccheney"}]}
{"id":"engram-gkvw","title":"Update FileRepository for tenant context","description":"Update FileRepository to use tenant-scoped graph.\n\n## Files to Modify\n- packages/graph/src/repositories/falkor-file.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:02.595926-06:00","updated_at":"2025-12-29T23:11:10.135992-06:00","closed_at":"2025-12-29T23:11:10.135992-06:00","dependencies":[{"issue_id":"engram-gkvw","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:32.235061-06:00","created_by":"ccheney"}]}
{"id":"engram-gl3u","title":"Delete Pulumi files and state","description":"Remove Pulumi configuration after GCP resources are destroyed.\n\n## Files to delete\n```\npackages/infra/\n├── src/                    # DELETE all TypeScript\n├── Pulumi.yaml             # DELETE\n├── Pulumi.dev.yaml         # DELETE\n└── .pulumi/                # DELETE (local state)\n```\n\n## Steps\n1. `cd packages/infra`\n2. `pulumi stack rm dev --yes`\n3. `rm -rf src/ Pulumi.yaml Pulumi.*.yaml .pulumi/`\n\n## Acceptance Criteria\n- All Pulumi files removed\n- Pulumi stack deleted\n- Directory ready for OpenTofu files","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:49:02.37828-06:00","updated_at":"2025-12-21T15:49:02.37828-06:00","dependencies":[{"issue_id":"engram-gl3u","depends_on_id":"engram-j91q","type":"blocks","created_at":"2025-12-21T15:50:55.206344-06:00","created_by":"ccheney"}]}
{"id":"engram-glc5","title":"[Observatory Auth] Configure environment variables","description":"Configure Better Auth and Google OAuth environment variables for Observatory. Reference: docs/observatory-auth-implementation-plan.md Step 2. Files: apps/observatory/.env, docker-compose.prod.yml. Add BETTER_AUTH_SECRET, BETTER_AUTH_URL, GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, AUTH_DATABASE_URL. Generate secret with: openssl rand -base64 32. This can be done in parallel with dependency updates.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:39:55.04635-05:00","updated_at":"2025-12-22T00:51:52.639446-05:00","closed_at":"2025-12-22T00:51:52.639446-05:00"}
{"id":"engram-gmi8","title":"[Console Redesign] Migrate request volume chart to shadcn Chart","description":"## Overview\nReplace Tremor AreaChart with shadcn ChartContainer + recharts AreaChart.\n\n## Current Implementation\n- apps/console/app/components/ServerMetricsChart.tsx (likely)\n- Tremor AreaChart for request volume\n- Time range selector\n\n## Target Implementation\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader className=\"flex flex-row items-center justify-between\"\u003e\n    \u003cCardTitle\u003eRequest Volume\u003c/CardTitle\u003e\n    \u003cToggleGroup type=\"single\" value={timeRange} onValueChange={setTimeRange}\u003e\n      \u003cToggleGroupItem value=\"1h\"\u003e1H\u003c/ToggleGroupItem\u003e\n      \u003cToggleGroupItem value=\"24h\"\u003e24H\u003c/ToggleGroupItem\u003e\n      \u003cToggleGroupItem value=\"7d\"\u003e7D\u003c/ToggleGroupItem\u003e\n    \u003c/ToggleGroup\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent\u003e\n    \u003cChartContainer config={chartConfig} className=\"h-[300px]\"\u003e\n      \u003cAreaChart data={chartData}\u003e\n        \u003cdefs\u003e\n          \u003clinearGradient id=\"fillRequests\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\"\u003e\n            \u003cstop offset=\"5%\" stopColor=\"var(--chart-1)\" stopOpacity={0.8}/\u003e\n            \u003cstop offset=\"95%\" stopColor=\"var(--chart-1)\" stopOpacity={0.1}/\u003e\n          \u003c/linearGradient\u003e\n        \u003c/defs\u003e\n        \u003cCartesianGrid strokeDasharray=\"3 3\" /\u003e\n        \u003cXAxis dataKey=\"time\" /\u003e\n        \u003cYAxis /\u003e\n        \u003cChartTooltip content={\u003cChartTooltipContent /\u003e} /\u003e\n        \u003cArea \n          type=\"monotone\" \n          dataKey=\"requests\" \n          stroke=\"var(--chart-1)\" \n          fill=\"url(#fillRequests)\" \n        /\u003e\n      \u003c/AreaChart\u003e\n    \u003c/ChartContainer\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n## Components to Use\n- Card, CardHeader, CardTitle, CardContent\n- ChartContainer, ChartTooltip, ChartTooltipContent\n- ToggleGroup (time range selector)\n- recharts: AreaChart, Area, CartesianGrid, XAxis, YAxis\n\n## New Files\n- components/dashboard/metrics-chart.tsx\n- components/dashboard/chart-area-interactive.tsx\n\n## Reference\n- shadcn chart docs: https://ui.shadcn.com/docs/components/chart\n- chart-area-interactive example\n\n## Acceptance Criteria\n- [ ] Area chart displays request volume\n- [ ] Time range toggle works (1H/24H/7D)\n- [ ] Tooltip on hover\n- [ ] Gradient fill effect\n- [ ] Responsive sizing","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:46:49.657504-06:00","updated_at":"2025-12-28T17:40:32.019555-06:00","closed_at":"2025-12-28T17:40:32.019555-06:00","dependencies":[{"issue_id":"engram-gmi8","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:21.987045-06:00","created_by":"ccheney"}]}
{"id":"engram-gmtp","title":"Add community summaries to recall","description":"Update recall in apps/mcp/src/tools/recall.ts to optionally include relevant community summaries via includeCommunities option. Search community embeddings, prepend high-scoring summaries to results.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:04.450122-06:00","updated_at":"2026-01-01T16:50:04.450122-06:00","dependencies":[{"issue_id":"engram-gmtp","depends_on_id":"engram-q344","type":"blocks","created_at":"2026-01-01T16:50:57.965458-06:00","created_by":"ccheney"}]}
{"id":"engram-gnpr","title":"Clean up low-quality test memories","description":"Remove transient test log memories that violate quality guidelines: 01KDF8E23YZ5DXBJ6XE0GN21A8, 01KDF57RGTXPDEEQED0JE4XEPY, 01KDA8EA9H7A2P445SG3KR961V","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T01:43:37.677533-05:00","updated_at":"2025-12-27T01:47:44.015099-05:00","closed_at":"2025-12-27T01:47:44.015099-05:00"}
{"id":"engram-gp04","title":"Integrate Qdrant for vector search in memory service","description":"apps/api/src/services/memory.ts:187 - Currently only using keyword search in recall() method, needs hybrid vector search via Qdrant","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T16:22:21.245861-06:00","updated_at":"2025-12-20T19:18:04.834729-06:00","closed_at":"2025-12-20T19:18:04.834729-06:00"}
{"id":"engram-gp6h","title":"Wire MultiQueryRetriever to search API","description":"MultiQueryRetriever in apps/search/src/retrieval/multi_query.py is fully implemented with LLM-based query expansion and RRF fusion but never instantiated. Add to app lifespan and create /search/multi-query endpoint.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:00:36.790831-06:00","updated_at":"2025-12-20T23:07:49.466583-06:00","closed_at":"2025-12-20T23:07:49.466583-06:00"}
{"id":"engram-gw46c","title":"Create traversal builder runtime","description":"Implement graph traversal builder in packages/graph/src/runtime/traversal.ts\n\n## Overview\nThe TraversalBuilder enables type-safe graph traversals across relationships. It generates Cypher path patterns and maintains type safety as you traverse from one node type to another via edges.\n\n## Requirements\n- TraversalBuilder\u003cTSource, TCurrent\u003e class with generic types\n- out\u003cE extends EdgeType\u003e(edgeType) for outgoing edge traversal\n- in\u003cE extends EdgeType\u003e(edgeType) for incoming edge traversal\n- filter(predicate) for inline node filtering\n- asOf(timestamp) for temporal traversals\n- collect() → Promise\u003cTCurrent[]\u003e for execution\n- toCypher() to generate path pattern\n\n## API Design\n```typescript\n// Type-safe traversal with automatic type inference\nconst relatedEntities = await Memory\n  .where({ id: memoryId })\n  .mentions()          // -[:MENTIONS]-\u003e Entity (type changes to Entity)\n  .out('RELATED_TO')   // -[:RELATED_TO]-\u003e Entity\n  .filter(e =\u003e e.type === 'tool')\n  .collect();\n\n// Generated Cypher:\n// MATCH (m:Memory {id: $id})-[:MENTIONS]-\u003e(e1:Entity)-[:RELATED_TO]-\u003e(e2:Entity)\n// WHERE e2.type = 'tool'\n// RETURN e2\n```\n\n## Type Safety\n- EdgeTarget\u003cE\u003e extracts target node type from edge definition\n- EdgeSource\u003cE\u003e extracts source node type from edge definition\n- Return type changes based on edge direction\n- Full inference chain through traversal steps\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'relations query traversal')`\n\nUse web search for:\n- 'Neo4j Cypher path pattern variable length'\n- 'TypeScript generic type transformation chain'\n- 'Graph traversal API design patterns'\n- 'Gremlin traversal TypeScript'\n\n## Technical Considerations\n- Traversal steps should be lazy (build pattern, execute on collect)\n- Consider variable-length paths: out('FOLLOWS', 1, 3)\n- Handle cycles in traversal paths\n- Optimize generated Cypher for performance\n\n## Files\n- packages/graph/src/runtime/traversal.ts (NEW)\n\n## References\n- Neo4j path patterns: https://neo4j.com/docs/cypher-manual/current/patterns/\n- Gremlin: https://tinkerpop.apache.org/gremlin.html\n- Plan: docs/plans/compiled-query-layer.md lines 716-772","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:53.345102-06:00","updated_at":"2026-01-01T17:08:21.19375-06:00","dependencies":[{"issue_id":"engram-gw46c","depends_on_id":"engram-ojqv3","type":"blocks","created_at":"2026-01-01T16:54:37.882581-06:00","created_by":"ccheney"}]}
{"id":"engram-gwgg","title":"Add findReplacements() method to memory repository","description":"Add method to FalkorMemoryRepository: MATCH (m:Memory)-[:REPLACES]-\u003e(:Memory {id: }) WHERE m.tt_end = MAX_DATE RETURN m","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:43:05.90011-06:00","updated_at":"2026-01-01T17:45:06.808908-06:00","closed_at":"2026-01-01T17:45:06.808908-06:00","dependencies":[{"issue_id":"engram-gwgg","depends_on_id":"engram-sc6d","type":"blocks","created_at":"2026-01-01T16:45:21.39311-06:00","created_by":"ccheney"}]}
{"id":"engram-gyik","title":"Create production .env template","description":"Create .env template file with all required environment variables for production.\n\n## Required variables\n- POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_DB\n- HF_API_TOKEN\n- EMBEDDER_BACKEND=huggingface\n\n## Location\n`.env.production.example` in repo root\n\n## Acceptance Criteria\n- Template includes all required variables\n- Secure defaults where appropriate\n- Comments explaining each variable","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:29:06.893326-06:00","updated_at":"2025-12-21T16:10:46.978224-06:00","closed_at":"2025-12-21T16:10:46.978224-06:00"}
{"id":"engram-gyiu","title":"RBAC: Read user role from Better Auth session metadata","description":"apps/observatory/lib/rbac.ts:32 - TODO comment to read role from session.user metadata when implemented. Currently hardcoded role needs to be replaced with dynamic role lookup from Better Auth session.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T04:02:40.937446-05:00","updated_at":"2025-12-22T04:10:37.290733-05:00","closed_at":"2025-12-22T04:10:37.290733-05:00","dependencies":[{"issue_id":"engram-gyiu","depends_on_id":"engram-xu6b","type":"blocks","created_at":"2025-12-22T04:03:30.970041-05:00","created_by":"ccheney"}]}
{"id":"engram-gzjiv","title":"Unit tests: Query builder runtime","description":"Create unit tests for query builder runtime\n\n## Overview\nThese tests validate the query builder runtime classes produce correct Cypher queries with proper parameter handling and bitemporal constraints.\n\n## Test Coverage\n\n### BaseQueryBuilder (base-query-builder.test.ts)\n- where() generates correct Cypher conditions\n- whereCurrent() adds tt_end = MAX_DATE\n- whereValid() adds vt_end = MAX_DATE\n- asOf() adds all four bitemporal constraints\n- limit() generates LIMIT clause\n- orderBy() generates ORDER BY clause\n- Parameter naming avoids collisions\n- toCypher() output is valid Cypher\n\n### TraversalBuilder (traversal.test.ts)\n- out() generates outgoing edge pattern\n- in() generates incoming edge pattern\n- Chained traversals generate path patterns\n- filter() generates WHERE conditions\n- asOf() on traversal adds temporal constraints\n- Type inference changes through traversal\n\n## Test Examples\n```typescript\nimport { describe, test, expect } from 'bun:test';\nimport { BaseQueryBuilder } from './base-query-builder';\n\nclass TestQueryBuilder extends BaseQueryBuilder\u003c{ id: string; name: string; count: number }\u003e {\n  protected nodeLabel = 'Test';\n}\n\ndescribe('BaseQueryBuilder', () =\u003e {\n  test('where generates correct conditions', () =\u003e {\n    const qb = new TestQueryBuilder().where({ name: 'foo' });\n    const cypher = qb.toCypher();\n    \n    expect(cypher).toContain('MATCH (t:Test)');\n    expect(cypher).toContain('WHERE t.name = $p0');\n    expect(qb.params.p0).toBe('foo');\n  });\n\n  test('whereCurrent adds tt_end constraint', () =\u003e {\n    const qb = new TestQueryBuilder().whereCurrent();\n    const cypher = qb.toCypher();\n    \n    expect(cypher).toContain('t.tt_end = 253402300799000');\n  });\n\n  test('asOf adds all bitemporal constraints', () =\u003e {\n    const timestamp = Date.now();\n    const qb = new TestQueryBuilder().asOf(timestamp);\n    const cypher = qb.toCypher();\n    \n    expect(cypher).toContain('t.vt_start \u003c=');\n    expect(cypher).toContain('t.vt_end \u003e');\n    expect(cypher).toContain('t.tt_start \u003c=');\n    expect(cypher).toContain('t.tt_end \u003e');\n  });\n\n  test('parameter names are unique', () =\u003e {\n    const qb = new TestQueryBuilder()\n      .where({ name: 'foo' })\n      .where({ count: 5 });\n    \n    expect(qb.params).toHaveProperty('p0', 'foo');\n    expect(qb.params).toHaveProperty('p1', 5);\n  });\n});\n```\n\n## Research Required\nUse web search for:\n- 'Cypher query testing patterns'\n- 'Neo4j query builder unit tests'\n- 'Testing fluent API builder pattern'\n\nReview existing tests:\n- packages/graph/src/queries/builder.test.ts\n\n## Files\n- packages/graph/src/runtime/base-query-builder.test.ts\n- packages/graph/src/runtime/traversal.test.ts\n\n## References\n- Existing tests: packages/graph/src/queries/builder.test.ts\n- Plan: docs/plans/compiled-query-layer.md lines 880-885","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:52:34.220371-06:00","updated_at":"2026-01-01T17:12:42.235479-06:00","dependencies":[{"issue_id":"engram-gzjiv","depends_on_id":"engram-ojqv3","type":"blocks","created_at":"2026-01-01T16:56:33.313395-06:00","created_by":"ccheney"},{"issue_id":"engram-gzjiv","depends_on_id":"engram-gw46c","type":"blocks","created_at":"2026-01-01T16:56:38.44715-06:00","created_by":"ccheney"}]}
{"id":"engram-h09jt","title":"Create EntityExtractorService","description":"Create apps/mcp/src/services/entity-extractor.ts for LLM-based entity extraction.\n\n## Service Design\n\n### Primary Method\n```typescript\nasync extract(\n  content: string,\n  memoryType: string,\n  existingEntities?: string[]\n): Promise\u003cEntityExtractionResult\u003e\n```\n\n### Extraction Strategy\n1. Try SamplingService first (uses MCP client's LLM)\n2. Fall back to gemini-3-flash-preview if sampling unavailable\n3. Return structured JSON with entities and relationships\n\n### Output Format\n```typescript\ninterface EntityExtractionResult {\n  entities: ExtractedEntity[];  // {name, type, context, confidence}\n  relationships: Array\u003c{from, to, type}\u003e;  // RELATED_TO, DEPENDS_ON, etc.\n  took_ms: number;\n  model_used: 'sampling' | 'gemini';\n}\n```\n\n## Implementation Reference\n- Follow SamplingService patterns in apps/mcp/src/capabilities/sampling.ts\n- See existing tool implementations in apps/mcp/src/tools/\n\n## Research\n- Graphiti entity extraction: Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'extract entities LLM structured output'\n- LLM structured output: Web search 'LLM entity extraction structured JSON output 2025'\n- Neo4j LLM Graph Builder: https://neo4j.com/labs/genai-ecosystem/llm-graph-builder/\n- KGGen multi-stage extraction: https://arxiv.org/html/2502.09956v1","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:43.040077-06:00","updated_at":"2026-01-01T18:18:17.562996-06:00","closed_at":"2026-01-01T18:18:17.562996-06:00","dependencies":[{"issue_id":"engram-h09jt","depends_on_id":"engram-ezn34","type":"blocks","created_at":"2026-01-01T16:53:50.268535-06:00","created_by":"ccheney"},{"issue_id":"engram-h09jt","depends_on_id":"engram-7flux","type":"blocks","created_at":"2026-01-01T16:53:56.332614-06:00","created_by":"ccheney"},{"issue_id":"engram-h09jt","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:48.431132-06:00","created_by":"ccheney"}]}
{"id":"engram-h2o8","title":"Add ConflictCandidateResponse schema to search service","description":"Create Pydantic schema in apps/search/src/api/schemas.py for conflict candidate response: id, content, type, score, vt_start","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:15.633689-06:00","updated_at":"2026-01-01T17:45:06.80623-06:00","closed_at":"2026-01-01T17:45:06.80623-06:00"}
{"id":"engram-h44m","title":"Create scripts/seed-oauth-clients.ts for service client registration","description":"Create seed script to register OAuth service clients in database.\n\n**File to create:** `scripts/seed-oauth-clients.ts`\n\n**Service clients to register:**\n\n| Client ID | Scopes | Auth Method |\n|-----------|--------|-------------|\n| engram-tuner | tuner:read, tuner:write | client_secret_basic |\n| engram-search | memory:read, query:read | client_secret_basic |\n| engram-console | * (admin) | client_secret_basic |\n| engram-ingestion | ingest:write, memory:write | client_secret_basic |\n\n**Script implementation:**\n```typescript\nimport { Pool } from 'pg';\nimport { generateClientSecret, hashSecret } from '../apps/observatory/lib/device-auth';\n\nconst clients = [\n  { id: 'engram-tuner', scopes: ['tuner:read', 'tuner:write'] },\n  { id: 'engram-search', scopes: ['memory:read', 'query:read'] },\n  { id: 'engram-console', scopes: ['*'] },\n  { id: 'engram-ingestion', scopes: ['ingest:write', 'memory:write'] },\n];\n\nasync function seedClients() {\n  const pool = new Pool({ connectionString: process.env.DATABASE_URL });\n  \n  for (const client of clients) {\n    const secret = generateClientSecret();\n    const hash = hashSecret(secret);\n    \n    await pool.query(`\n      INSERT INTO oauth_clients (client_id, client_secret_hash, grant_types, scope)\n      VALUES ($1, $2, ARRAY['client_credentials'], $3)\n      ON CONFLICT (client_id) DO UPDATE SET client_secret_hash = $2\n    `, [client.id, hash, client.scopes.join(' ')]);\n    \n    console.log(`${client.id}: ${secret}`);\n  }\n}\n```\n\n**Output format:**\n```\nengram-tuner: \u003csecret\u003e\nengram-search: \u003csecret\u003e\nengram-console: \u003csecret\u003e\nengram-ingestion: \u003csecret\u003e\n\nCopy these secrets to your .env files!\n```\n\n**Usage:**\n```bash\nDATABASE_URL=postgres://... bun run scripts/seed-oauth-clients.ts\n```\n\n**Database table:** `oauth_clients` (schema in `apps/api/src/db/init.sql`)\n\n**References:**\n- RFC 7591 Dynamic Client Registration: https://datatracker.ietf.org/doc/html/rfc7591\n- OAuth client credentials security: https://www.authgear.com/post/the-complete-guide-to-machine-to-machine-m2m-authentication\n\n**Subagent instructions:**\n- Read `apps/observatory/lib/client-registration.ts` for client patterns\n- Read `apps/api/src/db/init.sql` for oauth_clients schema\n- Web search \"OAuth 2.0 client secret generation best practices 2025\"\n- Test script locally before committing","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:52:35.692677-06:00","updated_at":"2025-12-29T16:35:50.041036-06:00","closed_at":"2025-12-29T16:35:50.041036-06:00","dependencies":[{"issue_id":"engram-h44m","depends_on_id":"engram-qiua","type":"blocks","created_at":"2025-12-29T15:58:02.628077-06:00","created_by":"ccheney"}]}
{"id":"engram-h5gu","title":"Add Hetzner provider to OpenTofu infrastructure","description":"Extend OpenTofu/Terraform configuration to provision Hetzner VPS alongside existing GCP resources.\n\n## Location\n`packages/infra/` (existing Pulumi → OpenTofu migration)\n\n## Hetzner provider config\n```hcl\nterraform {\n  required_providers {\n    hcloud = {\n      source  = \"opentofu/hcloud\"\n      version = \"~\u003e 1.53\"\n    }\n  }\n}\n\nprovider \"hcloud\" {\n  token = var.hcloud_token\n}\n```\n\n## Resources to create\n- hcloud_ssh_key (engram-key)\n- hcloud_server (CPX31, Ashburn VA)\n- hcloud_firewall (SSH, HTTP, HTTPS)\n\n## Benefits\n- Infrastructure as code for Hetzner\n- Single `tofu apply` to provision everything\n- Easy teardown with `tofu destroy`\n- Can manage both GCP and Hetzner from same codebase\n\n## References\n- https://search.opentofu.org/provider/opentofu/hcloud/latest\n- https://github.com/hetznercloud/terraform-provider-hcloud\n\n## Acceptance Criteria\n- OpenTofu can provision Hetzner VPS\n- Firewall rules are applied\n- SSH key is uploaded\n- Server IP is output for use in deployment","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:40:19.250088-06:00","updated_at":"2025-12-21T15:52:03.983895-06:00","closed_at":"2025-12-21T15:52:03.983895-06:00","dependencies":[{"issue_id":"engram-h5gu","depends_on_id":"engram-77hp","type":"blocks","created_at":"2025-12-21T15:40:34.697482-06:00","created_by":"ccheney"}]}
{"id":"engram-h7wd","title":"[CRITICAL] Silent search error in observatory","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:06.646531-06:00","updated_at":"2025-12-20T23:45:30.483975-06:00","closed_at":"2025-12-20T23:45:30.483975-06:00"}
{"id":"engram-hc8t","title":"Update build scripts to use tsgo","description":"Update turbo.json and package.json scripts to use tsgo instead of tsc for type checking and builds","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:37:58.198468-06:00","updated_at":"2025-12-20T22:31:41.65309-06:00","closed_at":"2025-12-20T22:31:41.65309-06:00","dependencies":[{"issue_id":"engram-hc8t","depends_on_id":"engram-q2v2","type":"blocks","created_at":"2025-12-20T21:39:11.881314-06:00","created_by":"ccheney"}]}
{"id":"engram-hd79","title":"Create field type primitives (field.ts)","description":"Implement field type definitions for the Schema DSL in packages/graph/src/schema/field.ts\n\n## Overview\nThis is the foundational building block of the compiled query layer. Field types define the primitive data types that can be used in node and edge definitions, similar to how Drizzle ORM defines column types.\n\n## Requirements\n- String field type with optional max length constraint\n- Int field type with optional min/max constraints\n- Float field type for decimal numbers\n- Boolean field type\n- Timestamp field type for epoch milliseconds\n- Array field type with generic inner type support\n- Enum field type accepting const array of string values\n- Vector field type with dimension parameter (for embeddings)\n- Chainable modifiers: .optional(), .default(value), .max(n), .min(n)\n\n## API Design\n```typescript\nexport const field = {\n  string: () =\u003e new StringField(),\n  int: () =\u003e new IntField(),\n  float: () =\u003e new FloatField(),\n  boolean: () =\u003e new BooleanField(),\n  timestamp: () =\u003e new TimestampField(),\n  array: \u003cT\u003e(inner: Field\u003cT\u003e) =\u003e new ArrayField(inner),\n  enum: \u003cT extends string\u003e(values: readonly T[]) =\u003e new EnumField(values),\n  vector: (dimensions: number) =\u003e new VectorField(dimensions),\n};\n```\n\n## Research Required\nBefore implementing, use Context7 MCP to review:\n- Drizzle ORM column types: `resolve-library-id('drizzle-orm')` then `query-docs` for 'column types field definitions'\n- Prisma field types: `resolve-library-id('prisma')` then `query-docs` for 'schema field types'\n\nUse web search for:\n- 'TypeScript builder pattern chainable methods'\n- 'TypeScript generic type inference field definitions'\n- 'Drizzle ORM column type implementation source code'\n\n## Files\n- packages/graph/src/schema/field.ts (NEW)\n- packages/graph/src/schema/types.ts (NEW - shared type definitions)\n- packages/graph/src/schema/index.ts (barrel export)\n\n## References\n- Drizzle column types: https://orm.drizzle.team/docs/column-types/pg\n- Drizzle source: https://github.com/drizzle-team/drizzle-orm/tree/main/drizzle-orm/src/pg-core/columns\n- Plan: docs/plans/compiled-query-layer.md lines 553-564\n- TypeScript handbook - Generics: https://www.typescriptlang.org/docs/handbook/2/generics.html","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:48:25.087187-06:00","updated_at":"2026-01-01T17:34:35.537734-06:00","closed_at":"2026-01-01T17:34:35.537734-06:00"}
{"id":"engram-hd7p","title":"Test coverage: packages/graph/src/merger.ts (70%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:41.733736-06:00","updated_at":"2025-12-21T04:07:03.760253-06:00","closed_at":"2025-12-21T04:07:03.760253-06:00"}
{"id":"engram-he30","title":"Implement API key validation against database","description":"apps/api/src/middleware/auth.ts:75-77 - apiKeyAuth() middleware currently accepts any properly formatted key. Need to: look up key in database, check expiry, get user/scopes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T16:22:27.294457-06:00","updated_at":"2025-12-20T19:18:04.835153-06:00","closed_at":"2025-12-20T19:18:04.835153-06:00"}
{"id":"engram-hedw","title":"Fix probabilistic content preview updates","description":"apps/memory content.handler.ts:30 triggers preview updates on modulo 500 chars which is probabilistic based on chunk boundaries. Should use debounce or threshold instead.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:15:28.593919-06:00","updated_at":"2025-12-20T23:23:17.262316-06:00","closed_at":"2025-12-20T23:23:17.262316-06:00"}
{"id":"engram-hgid","title":"[Observatory Auth] Delete Clerk-specific tests","description":"Delete Clerk-specific test file that will no longer be valid. Reference: docs/observatory-auth-implementation-plan.md Files to Delete section. File: apps/observatory/lib/auth.test.ts (DELETE). This test file contains Clerk-specific mocks and assertions. Delete it and optionally create new tests for Better Auth. DEPENDS ON: engram-7d6p (server config), engram-rgll (RBAC update).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:42:42.299879-05:00","updated_at":"2025-12-22T01:00:00.790092-05:00","closed_at":"2025-12-22T01:00:00.790092-05:00","dependencies":[{"issue_id":"engram-hgid","depends_on_id":"engram-7d6p","type":"blocks","created_at":"2025-12-22T00:44:18.708117-05:00","created_by":"ccheney"},{"issue_id":"engram-hgid","depends_on_id":"engram-rgll","type":"blocks","created_at":"2025-12-22T00:44:23.841952-05:00","created_by":"ccheney"}]}
{"id":"engram-hkyu","title":"Create Cost Tracking components","description":"Monthly infra cost, reranker API costs, cost per 1000 requests breakdown. MUST use frontend-design skill for UI implementation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:12.056152-05:00","updated_at":"2025-12-27T04:23:12.056152-05:00","dependencies":[{"issue_id":"engram-hkyu","depends_on_id":"engram-dj45","type":"blocks","created_at":"2025-12-27T04:28:51.078049-05:00","created_by":"ccheney"}]}
{"id":"engram-hq89","title":"Update search service Python auth middleware","description":"Extract org_id from token introspection in search service middleware.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Search Service' section (lines 527-531)\n\n## Implementation\nUpdate apps/search/src/middleware/auth.py:\n- Parse org_id, org_slug from introspection response\n- Create TenantContext equivalent in Python\n- Attach to request.state for route handlers\n\n## Files to Modify\n- apps/search/src/middleware/auth.py\n\n## Agent Instructions\nUse Context7 MCP for FastAPI middleware patterns. Create Python equivalent of TenantContext.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:16.094278-06:00","updated_at":"2025-12-29T22:48:53.87182-06:00","closed_at":"2025-12-29T22:48:53.87182-06:00","dependencies":[{"issue_id":"engram-hq89","depends_on_id":"engram-nnmx","type":"blocks","created_at":"2025-12-29T22:12:53.306354-06:00","created_by":"ccheney"}]}
{"id":"engram-hr0d","title":"[Console Redesign] Migrate Deployments page to shadcn","description":"## Overview\nMigrate the Deployments page with table, active deployment card, and environment tabs.\n\n## Target Page\n- apps/console/app/(dashboard)/deployments/page.tsx\n\n## Components to Migrate\n\n### Active Deployment Card\n```tsx\n{activeDeployment \u0026\u0026 (\n  \u003cCard className=\"border-primary/50\"\u003e\n    \u003cCardHeader\u003e\n      \u003cdiv className=\"flex items-center justify-between\"\u003e\n        \u003cCardTitle className=\"text-lg\"\u003eActive Deployment\u003c/CardTitle\u003e\n        \u003cBadge variant=\"secondary\"\u003e{activeDeployment.environment}\u003c/Badge\u003e\n      \u003c/div\u003e\n    \u003c/CardHeader\u003e\n    \u003cCardContent className=\"space-y-4\"\u003e\n      \u003cdiv className=\"space-y-2\"\u003e\n        \u003cdiv className=\"flex justify-between text-sm\"\u003e\n          \u003cspan\u003eProgress\u003c/span\u003e\n          \u003cspan\u003e{activeDeployment.progress}%\u003c/span\u003e\n        \u003c/div\u003e\n        \u003cProgress value={activeDeployment.progress} /\u003e\n      \u003c/div\u003e\n      \u003cdiv className=\"flex gap-2\"\u003e\n        \u003cButton variant=\"destructive\" size=\"sm\"\u003eCancel\u003c/Button\u003e\n        \u003cButton variant=\"outline\" size=\"sm\"\u003eView Logs\u003c/Button\u003e\n      \u003c/div\u003e\n    \u003c/CardContent\u003e\n  \u003c/Card\u003e\n)}\n```\n\n### Environment Tabs\n```tsx\n\u003cTabs value={environment} onValueChange={setEnvironment}\u003e\n  \u003cTabsList\u003e\n    \u003cTabsTrigger value=\"all\"\u003eAll\u003c/TabsTrigger\u003e\n    \u003cTabsTrigger value=\"production\"\u003eProduction\u003c/TabsTrigger\u003e\n    \u003cTabsTrigger value=\"staging\"\u003eStaging\u003c/TabsTrigger\u003e\n    \u003cTabsTrigger value=\"development\"\u003eDevelopment\u003c/TabsTrigger\u003e\n  \u003c/TabsList\u003e\n\u003c/Tabs\u003e\n```\n\n### Deployment Table\n```tsx\n\u003cTable\u003e\n  \u003cTableHeader\u003e\n    \u003cTableRow\u003e\n      \u003cTableHead\u003eVersion\u003c/TableHead\u003e\n      \u003cTableHead\u003eEnvironment\u003c/TableHead\u003e\n      \u003cTableHead\u003eStatus\u003c/TableHead\u003e\n      \u003cTableHead\u003eDeployed By\u003c/TableHead\u003e\n      \u003cTableHead\u003eTime\u003c/TableHead\u003e\n      \u003cTableHead\u003e\u003c/TableHead\u003e\n    \u003c/TableRow\u003e\n  \u003c/TableHeader\u003e\n  \u003cTableBody\u003e\n    {deployments.map((d) =\u003e (\n      \u003cTableRow key={d.id}\u003e\n        \u003cTableCell className=\"font-mono\"\u003e{d.version}\u003c/TableCell\u003e\n        \u003cTableCell\u003e\u003cBadge variant=\"outline\"\u003e{d.environment}\u003c/Badge\u003e\u003c/TableCell\u003e\n        \u003cTableCell\u003e\u003cBadge variant={getStatusVariant(d.status)}\u003e{d.status}\u003c/Badge\u003e\u003c/TableCell\u003e\n        \u003cTableCell\u003e{d.deployedBy}\u003c/TableCell\u003e\n        \u003cTableCell\u003e{formatTime(d.deployedAt)}\u003c/TableCell\u003e\n        \u003cTableCell\u003e\n          \u003cDropdownMenu\u003e\n            \u003cDropdownMenuTrigger asChild\u003e\n              \u003cButton variant=\"ghost\" size=\"sm\"\u003e\n                \u003cMoreHorizontal className=\"h-4 w-4\" /\u003e\n              \u003c/Button\u003e\n            \u003c/DropdownMenuTrigger\u003e\n            \u003cDropdownMenuContent align=\"end\"\u003e\n              \u003cDropdownMenuItem\u003eView Details\u003c/DropdownMenuItem\u003e\n              \u003cDropdownMenuItem\u003eView Logs\u003c/DropdownMenuItem\u003e\n              \u003cDropdownMenuSeparator /\u003e\n              \u003cDropdownMenuItem className=\"text-destructive\"\u003eRollback\u003c/DropdownMenuItem\u003e\n            \u003c/DropdownMenuContent\u003e\n          \u003c/DropdownMenu\u003e\n        \u003c/TableCell\u003e\n      \u003c/TableRow\u003e\n    ))}\n  \u003c/TableBody\u003e\n\u003c/Table\u003e\n```\n\n## Components to Use\n- Card (active deployment)\n- Progress (deployment progress)\n- Tabs, TabsList, TabsTrigger (environment filter)\n- Table (deployment history)\n- Badge (status/environment indicators)\n- DropdownMenu (row actions)\n- Button (actions)\n\n## Status Badge Variants\n- success: \"bg-green-500/10 text-green-500\"\n- pending: \"bg-amber-500/10 text-amber-500\"\n- failed: \"bg-red-500/10 text-red-500\"\n- cancelled: \"bg-gray-500/10 text-gray-500\"\n\n## Acceptance Criteria\n- [ ] Active deployment card with progress\n- [ ] Environment tabs filter deployments\n- [ ] Deployment table with sorting\n- [ ] Row actions dropdown\n- [ ] Status badges with correct colors\n- [ ] Rollback confirmation dialog","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:48:13.287549-06:00","updated_at":"2025-12-28T17:40:32.020323-06:00","closed_at":"2025-12-28T17:40:32.020323-06:00","dependencies":[{"issue_id":"engram-hr0d","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:38.511483-06:00","created_by":"ccheney"}]}
{"id":"engram-hs09","title":"Update RerankerRouter for HF backend","description":"Modify RerankerRouter to support HuggingFace rerankers for accurate and code tiers.\n\n## Location\n`apps/search/src/rerankers/router.py`\n\n## Changes\n1. Check settings.reranker_backend for 'accurate' and 'code' tiers\n2. If backend='huggingface':\n   - Use HuggingFaceReranker instead of CrossEncoderReranker\n3. Keep 'fast' tier local (FlashRank is CPU-optimized anyway)\n4. Keep 'llm' tier as-is (uses litellm)\n\n## Acceptance Criteria\n- Router returns correct reranker based on RERANKER_BACKEND\n- Fallback chain still works\n- No breaking changes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:32:12.362712-06:00","updated_at":"2025-12-21T16:13:51.62891-06:00","closed_at":"2025-12-21T16:13:51.62891-06:00","dependencies":[{"issue_id":"engram-hs09","depends_on_id":"engram-wyw4","type":"blocks","created_at":"2025-12-21T15:33:36.342439-06:00","created_by":"ccheney"},{"issue_id":"engram-hs09","depends_on_id":"engram-fs5a","type":"blocks","created_at":"2025-12-21T15:33:41.473363-06:00","created_by":"ccheney"}]}
{"id":"engram-htec","title":"Multi-Tenancy Phase 1: Foundation","description":"Database schema, OAuth token enhancement, and organization CRUD for multi-tenant support.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Phase 1: Foundation section\n\n## Overview\nEstablish the foundational data structures and authentication changes needed for multi-tenancy:\n- PostgreSQL organizations table with RLS\n- OAuth tokens enhanced with org_id/org_slug\n- TenantContext type definition\n- Organization CRUD endpoints\n\n## Dependencies\nThis is the first phase - all subsequent phases depend on this foundation.\n\n## Agent Instructions\nBefore implementation, use Context7 MCP to get latest Drizzle ORM documentation for RLS support. Web search for 'Drizzle ORM RLS 2025' and 'PostgreSQL Row Level Security best practices'.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T22:07:46.495256-06:00","updated_at":"2025-12-29T23:48:10.824831-06:00","closed_at":"2025-12-29T23:48:10.824831-06:00","dependencies":[{"issue_id":"engram-htec","depends_on_id":"engram-ood4","type":"blocks","created_at":"2025-12-29T22:13:48.375757-06:00","created_by":"ccheney"},{"issue_id":"engram-htec","depends_on_id":"engram-vldw","type":"blocks","created_at":"2025-12-29T22:13:57.741628-06:00","created_by":"ccheney"}]}
{"id":"engram-htgl2","title":"Create CommunityDetector job handler","description":"Create apps/worker/src/jobs/community-detector.ts. Load entity graph from FalkorDB, run label propagation, create/update Community nodes, trigger summarization for updated communities. Subscribe to engram.jobs.community-detection NATS subject.\n\n## Job Flow\n1. Load entity graph for project/org\n   - Query: MATCH (e:Entity)-[r:RELATED_TO|DEPENDS_ON]-\u003e(e2:Entity) WHERE e.vt_end = $MAX_DATE\n2. Build adjacency list for label propagation\n3. Run LPA algorithm\n4. For each community with 3+ members:\n   - Check for existing community by member overlap (\u003e50% = same)\n   - Create new or update existing Community node\n5. Publish summarization jobs for updated communities\n\n## Job Message Schema\n```typescript\ninterface CommunityDetectionJob {\n  project: string;\n  orgId: string;\n  triggeredBy: 'cron' | 'threshold' | 'manual';\n}\n```\n\n## Before Implementation\nUse Context7 MCP: Query FalkorDB for graph traversal patterns.\n\nReview EntityRepository for entity loading patterns.\n\n## References\n- Entity model: packages/graph/src/models/nodes.ts\n- Graph client: packages/storage/src/falkor.ts\n- NATS publish: packages/storage/src/nats.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:26.125599-06:00","updated_at":"2026-01-01T17:09:32.086932-06:00","dependencies":[{"issue_id":"engram-htgl2","depends_on_id":"engram-dlwdd","type":"blocks","created_at":"2026-01-01T16:51:17.973543-06:00","created_by":"ccheney"},{"issue_id":"engram-htgl2","depends_on_id":"engram-y2rur","type":"blocks","created_at":"2026-01-01T16:51:23.103004-06:00","created_by":"ccheney"},{"issue_id":"engram-htgl2","depends_on_id":"engram-dtbw","type":"blocks","created_at":"2026-01-01T17:08:21.619174-06:00","created_by":"ccheney"},{"issue_id":"engram-htgl2","depends_on_id":"engram-cqo6t","type":"blocks","created_at":"2026-01-01T17:10:03.493428-06:00","created_by":"ccheney"}]}
{"id":"engram-hvit","title":"Logger: Remove legacy createLogger export and update all references","description":"packages/logger/src/index.ts:10 - Legacy createLogger is re-exported for backward compatibility. Per project policy, we do not support backward compatibility. Delete the legacy export and update all consumers to use createNodeLogger directly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T04:03:11.473722-05:00","updated_at":"2025-12-22T04:10:10.741125-05:00","closed_at":"2025-12-22T04:10:10.741125-05:00"}
{"id":"engram-hwck","title":"Test coverage: apps/control/src/session/manager.ts (62%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:28.581867-06:00","updated_at":"2025-12-21T04:07:03.764327-06:00","closed_at":"2025-12-21T04:07:03.764327-06:00"}
{"id":"engram-hxct","title":"Implement late chunking for context-aware embeddings","description":"Add LateChunker that embeds entire document first, then applies mean pooling per chunk. Each chunk embedding retains full document context. Based on Jina AI paper.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:11:57.889991-06:00","updated_at":"2025-12-21T07:10:53.970885-06:00","closed_at":"2025-12-21T07:10:53.970885-06:00","dependencies":[{"issue_id":"engram-hxct","depends_on_id":"engram-g3m4","type":"blocks","created_at":"2025-12-21T06:14:03.487973-06:00","created_by":"ccheney"}]}
{"id":"engram-hxht","title":"Wire EngramRetriever to benchmark CLI","description":"packages/benchmark EngramRetriever (retriever.py:284-405) fully implemented with Engram search-py integration but CLI always uses ChromaRetriever. No CLI flag to switch providers.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:10:00.391859-06:00","updated_at":"2025-12-20T23:22:15.435922-06:00","closed_at":"2025-12-20T23:22:15.435922-06:00"}
{"id":"engram-hytgz","title":"Create codegen CLI","description":"Implement CLI for manual code generation in packages/graph/src/codegen/cli.ts\n\n## Overview\nThe CLI provides a standalone command for manually triggering code generation. This is useful during development, CI/CD pipelines, and when the build plugin isn't being used.\n\n## Requirements\n- Standalone script runnable via `bun run`\n- Accept schema file path or use default\n- Support --dry-run flag for testing\n- Support --output for custom output directory\n- Pretty print generated file paths\n- Show generation statistics\n\n## CLI Interface\n```bash\n# Basic usage\nbun run packages/graph/src/codegen/cli.ts\n\n# With options\nbun run packages/graph/src/codegen/cli.ts --dry-run\nbun run packages/graph/src/codegen/cli.ts --output ./custom-output\nbun run packages/graph/src/codegen/cli.ts --schema ./path/to/schema.ts\n\n# Via package.json script\nbun run generate\n```\n\n## CLI Implementation\n```typescript\n#!/usr/bin/env bun\n\nimport { parseArgs } from 'util';\nimport { generate } from './generator';\nimport { schema } from '../schema';\n\nconst { values } = parseArgs({\n  args: Bun.argv.slice(2),\n  options: {\n    'dry-run': { type: 'boolean', default: false },\n    output: { type: 'string', default: 'src/generated' },\n    schema: { type: 'string' },\n    help: { type: 'boolean', short: 'h' },\n  },\n});\n\nif (values.help) {\n  console.log(`\nUsage: bun run cli.ts [options]\n\nOptions:\n  --dry-run     Preview generated files without writing\n  --output      Output directory (default: src/generated)\n  --schema      Path to schema file\n  -h, --help    Show this help message\n`);\n  process.exit(0);\n}\n\nconst result = await generate({\n  schema,\n  outputDir: values.output,\n  dryRun: values['dry-run'],\n});\n\nconsole.log('\\n✨ Code generation complete!');\nconsole.log(`   Files: ${result.files.length}`);\nconsole.log(`   Types: ${result.summary.types}`);\nconsole.log(`   Query Builders: ${result.summary.queryBuilders}`);\nconsole.log(`   Repositories: ${result.summary.repositories}`);\n```\n\n## Research Required\nUse web search for:\n- 'Bun CLI argument parsing'\n- 'Prisma generate CLI implementation'\n- 'Drizzle-kit CLI commands'\n- 'Node.js util.parseArgs'\n\n## Files\n- packages/graph/src/codegen/cli.ts (NEW)\n\n## References\n- Bun argv: https://bun.sh/docs/api/utils#bun-argv\n- Node.js parseArgs: https://nodejs.org/api/util.html#utilparseargsconfig\n- Plan: docs/plans/compiled-query-layer.md line 841","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:38.973473-06:00","updated_at":"2026-01-01T17:10:46.399779-06:00","dependencies":[{"issue_id":"engram-hytgz","depends_on_id":"engram-o0y7p","type":"blocks","created_at":"2026-01-01T16:56:04.190165-06:00","created_by":"ccheney"}]}
{"id":"engram-i05bi","title":"Create Entity graph indexes in FalkorDB","description":"Add FalkorDB indexes for Entity nodes and semantic edges.\n\n## Node Indexes\n\n### Entity name (exact + full-text)\n```cypher\nCREATE INDEX FOR (e:Entity) ON (e.name)\nCREATE FULLTEXT INDEX FOR (e:Entity) ON (e.name, e.description)\n```\n\n### Entity type\n```cypher\nCREATE INDEX FOR (e:Entity) ON (e.type)\n```\n\n### Entity embedding (vector)\n```cypher\nCREATE VECTOR INDEX FOR (e:Entity) ON (e.embedding)\nOPTIONS {dimension: 384, similarityFunction: 'cosine'}\n```\n\n## Edge Indexes\n\n### Temporal queries on edges\n```cypher\nCREATE INDEX FOR ()-[m:MENTIONS]-() ON (m.vt_start)\nCREATE INDEX FOR ()-[r:RELATED_TO]-() ON (r.vt_start)\n```\n\n## Implementation Notes\n- Use 384 dimensions for BGE embeddings (same as memory embeddings)\n- Create indexes in migration or initialization script\n- Verify with GRAPH.EXPLAIN that indexes are used\n\n## Research\n- FalkorDB indexing: Use Context7 MCP `query-docs` with '/websites/falkordb' for 'CREATE INDEX vector fulltext'\n- Vector index configuration: Web search 'FalkorDB vector index dimension similarity function 2025'\n- Index verification: Use Context7 MCP for 'GRAPH.EXPLAIN index scan'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:36.962372-06:00","updated_at":"2026-01-01T18:33:49.378373-06:00","closed_at":"2026-01-01T18:33:49.378373-06:00","dependencies":[{"issue_id":"engram-i05bi","depends_on_id":"engram-cqo6t","type":"blocks","created_at":"2026-01-01T16:54:21.1545-06:00","created_by":"ccheney"},{"issue_id":"engram-i05bi","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:43.288513-06:00","created_by":"ccheney"}]}
{"id":"engram-i2pd","title":"Create Infrastructure Panel page","description":"Main infrastructure page aggregating server stats, containers, databases. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:21:47.387244-05:00","updated_at":"2025-12-27T17:07:30.952256-05:00","closed_at":"2025-12-27T17:07:30.952256-05:00","dependencies":[{"issue_id":"engram-i2pd","depends_on_id":"engram-wiuf","type":"blocks","created_at":"2025-12-27T04:26:53.935904-05:00","created_by":"ccheney"},{"issue_id":"engram-i2pd","depends_on_id":"engram-4jex","type":"blocks","created_at":"2025-12-27T04:26:59.057165-05:00","created_by":"ccheney"},{"issue_id":"engram-i2pd","depends_on_id":"engram-4suf","type":"blocks","created_at":"2025-12-27T04:27:04.180019-05:00","created_by":"ccheney"}]}
{"id":"engram-i2sd","title":"Define admin:read scope for cross-tenant access","description":"Add admin:read scope to OAuth scope definitions for cross-tenant access.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Super-Admin Queries' section (lines 539-544)\n\n## Implementation\nUpdate scope definitions:\n- Add 'admin:read' scope to allowed scopes\n- Update scope validation logic\n- TenantContext.isAdmin derived from admin:read scope\n\n## Files to Modify\n- packages/common/src/types/auth.ts\n- apps/api/src/middleware/scopes.ts\n\n## Agent Instructions\nThis is a privileged scope - ensure it's only granted to trusted users.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:01.924025-06:00","updated_at":"2025-12-29T22:54:39.888266-06:00","closed_at":"2025-12-29T22:54:39.888266-06:00","dependencies":[{"issue_id":"engram-i2sd","depends_on_id":"engram-4u86","type":"blocks","created_at":"2025-12-29T22:11:59.150221-06:00","created_by":"ccheney"}]}
{"id":"engram-i3qs","title":"Wire logger trace context and tenant context","description":"packages/logger exports withTraceContext() and withTenantContext() (node.ts:111,126) that are tested but have ZERO production usage. Either integrate for distributed tracing or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:10:06.55692-06:00","updated_at":"2025-12-20T23:25:34.357203-06:00","closed_at":"2025-12-20T23:25:34.357203-06:00"}
{"id":"engram-i6ld","title":"Validate ParsedStreamEvent schema at publish time","description":"packages/events ParsedStreamEventSchema is tested but never called during ingestion (index.ts:194-210). Events manually constructed without validation. event_id field never generated.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:10:43.441118-06:00","updated_at":"2025-12-20T23:25:39.080996-06:00","closed_at":"2025-12-20T23:25:39.080996-06:00"}
{"id":"engram-i7ec","title":"Update MCP server initialization for OAuth","description":"Modify apps/mcp/src/index.ts to initialize auth before starting server. Handle stdio mode auth UX - display verification URL and code, show 'Waiting for authentication...' message, display success with user email. See docs/design/oauth-device-flow.md 'stdio Mode (Claude Code)' section for exact UX.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:20:04.94043-05:00","updated_at":"2025-12-25T02:43:59.471826-05:00","closed_at":"2025-12-25T02:43:59.471826-05:00","dependencies":[{"issue_id":"engram-i7ec","depends_on_id":"engram-mcr0","type":"blocks","created_at":"2025-12-25T02:22:21.933149-05:00","created_by":"ccheney"},{"issue_id":"engram-i7ec","depends_on_id":"engram-oy07","type":"blocks","created_at":"2025-12-25T02:22:27.065179-05:00","created_by":"ccheney"}]}
{"id":"engram-ic8y5","title":"Create MCP tool generator (codegen)","description":"Implement MCP tool code generation in packages/graph/src/codegen/mcp-generator.ts\n\n## Overview\nThe MCP generator creates tool registration code from mcp.tool() definitions. It generates JSON Schema for inputs, type-safe handlers, and McpServer.registerTool() calls.\n\n## Requirements\n- Generate MCP tool registration code\n- Generate JSON Schema from mcp.param definitions\n- Generate handler wrapper with input validation\n- Output compatible with McpServer.registerTool()\n- Support both inputSchema and outputSchema\n\n## Example Output\n```typescript\n// AUTO-GENERATED - DO NOT EDIT\n\nimport { McpServer } from '@modelcontextprotocol/sdk';\nimport { z } from 'zod';\n\nexport const rememberInputSchema = z.object({\n  content: z.string().describe('The memory content to store'),\n  type: z.enum(['decision', 'context', 'insight', 'preference', 'fact']).optional(),\n  tags: z.array(z.string()).optional().describe('Keywords for filtering'),\n});\n\nexport const rememberOutputSchema = z.object({\n  id: z.string(),\n  stored: z.boolean(),\n});\n\nexport function registerRememberTool(\n  server: McpServer,\n  memoryStore: IMemoryStore,\n  getSessionContext: () =\u003e SessionContext,\n) {\n  server.registerTool(\n    'remember',\n    {\n      title: 'Remember',\n      description: 'Store a memory for future recall',\n      inputSchema: zodToJsonSchema(rememberInputSchema),\n      outputSchema: zodToJsonSchema(rememberOutputSchema),\n    },\n    async (inputs) =\u003e {\n      const validated = rememberInputSchema.parse(inputs);\n      const context = getSessionContext();\n      const memory = await memoryStore.createMemory({\n        ...validated,\n        source: 'user',\n        source_session_id: context.sessionId,\n      });\n      return {\n        content: [{ type: 'text', text: JSON.stringify({ id: memory.id, stored: true }) }],\n        structuredContent: { id: memory.id, stored: true },\n      };\n    },\n  );\n}\n```\n\n## Research Required\nUse web search for:\n- 'MCP model context protocol tool schema JSON'\n- 'Zod to JSON Schema conversion'\n- 'MCP SDK registerTool TypeScript'\n- 'JSON Schema from TypeScript types'\n\nReview current implementation:\n- apps/mcp/src/tools/remember.ts\n- apps/mcp/src/tools/recall.ts\n- apps/mcp/src/server.ts\n\n## Technical Considerations\n- Use zod-to-json-schema for schema conversion\n- Handle async handlers properly\n- Include error handling in generated code\n- Support structuredContent for typed responses\n\n## Files\n- packages/graph/src/codegen/mcp-generator.ts (NEW)\n\n## References\n- MCP specification: https://modelcontextprotocol.io/specification/2025-06-18/schema\n- Current MCP tools: apps/mcp/src/tools/\n- zod-to-json-schema: https://github.com/StefanTerdell/zod-to-json-schema\n- Plan: docs/plans/compiled-query-layer.md lines 774-808","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:26.682165-06:00","updated_at":"2026-01-01T17:09:40.776582-06:00","dependencies":[{"issue_id":"engram-ic8y5","depends_on_id":"engram-rwtcd","type":"blocks","created_at":"2026-01-01T16:55:01.416305-06:00","created_by":"ccheney"}]}
{"id":"engram-id90","title":"Update token generation with org fields","description":"Update OAuth token generation to include orgId and orgSlug.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'OAuth Token Enhancement' section (lines 482-486)\n\n## Implementation\nUpdate apps/observatory/lib/device-auth.ts:\n- Token generation must include orgId and orgSlug from user's organization\n- Store orgSlug denormalized in token record for fast lookups\n- Update token validation to return org fields\n\n## Files to Modify\n- apps/observatory/lib/device-auth.ts\n\n## Agent Instructions\nReview existing token generation code first. Ensure ULID format for orgId.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:42.386751-06:00","updated_at":"2025-12-29T22:38:45.225843-06:00","closed_at":"2025-12-29T22:38:45.225843-06:00","dependencies":[{"issue_id":"engram-id90","depends_on_id":"engram-4u86","type":"blocks","created_at":"2025-12-29T22:12:44.642936-06:00","created_by":"ccheney"},{"issue_id":"engram-id90","depends_on_id":"engram-gkcl","type":"blocks","created_at":"2025-12-29T22:12:53.674204-06:00","created_by":"ccheney"}]}
{"id":"engram-ieq4","title":"Use async VFS operations in ExecutionService","description":"packages/vfs implements async variants (existsAsync, mkdirAsync, etc.) but ExecutionService uses sync methods only. Consider using async for better performance.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:54.4774-06:00","updated_at":"2025-12-20T23:23:06.600564-06:00","closed_at":"2025-12-20T23:23:06.600564-06:00"}
{"id":"engram-ijfb","title":"Add client credentials token generation to device-auth.ts","description":"Add client credentials token generation function to device-auth library.\n\n**File to modify:** `apps/observatory/lib/device-auth.ts`\n\n**Function to add:**\n```typescript\nexport async function generateClientToken(\n  clientId: string,\n  scopes: string[],\n  dpopJwkThumbprint: string\n): Promise\u003c{\n  accessToken: string;\n  expiresIn: number;\n  tokenType: 'DPoP';\n  scope: string;\n}\u003e\n```\n\n**Implementation details:**\n- Generate token using existing `generateOAuthToken()` pattern but with `egm_client_` prefix\n- Token TTL: 1 hour (3600s) - shorter than user tokens per M2M best practices\n- NO refresh token for client credentials (per RFC 6749 §4.4)\n- Store `dpop_jkt` (JWK thumbprint) in oauth_tokens for binding validation\n- Include `grant_type: 'client_credentials'` in database record\n\n**Existing code to reference:**\n- `generateOAuthToken()` at line ~50\n- `generateTokenChecksum()` for CRC32 calculation\n- `hashToken()` for SHA-256 storage\n\n**Token storage fields:**\n```typescript\n{\n  access_token_hash: hashToken(accessToken),\n  access_token_prefix: accessToken.slice(0, 20),\n  grant_type: 'client_credentials',\n  client_id_ref: clientUuid,  // FK to oauth_clients\n  dpop_jkt: dpopJwkThumbprint,\n  scopes: scopes,\n  access_token_expires_at: new Date(Date.now() + 3600 * 1000),\n  // No refresh token fields\n}\n```\n\n**References:**\n- RFC 6749 §4.4 (no refresh tokens): https://tools.ietf.org/html/rfc6749#section-4.4\n- Azure AD client credentials: https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-client-creds-grant-flow\n- M2M token lifetime best practices: https://www.oauth.com/oauth2-servers/access-tokens/access-token-lifetime/\n\n**Subagent instructions:**\n- Read `apps/observatory/lib/device-auth.ts` thoroughly first\n- Use Context7 MCP with query \"OAuth client credentials token generation\"\n- Web search \"OAuth 2.1 client credentials no refresh token 2025\"\n- Run: `cd apps/observatory \u0026\u0026 bun test`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:51:47.693512-06:00","updated_at":"2025-12-29T16:27:24.190189-06:00","closed_at":"2025-12-29T16:27:24.190189-06:00","dependencies":[{"issue_id":"engram-ijfb","depends_on_id":"engram-47jc","type":"blocks","created_at":"2025-12-29T15:57:34.736187-06:00","created_by":"ccheney"}]}
{"id":"engram-ioi6","title":"Unit tests for ConflictDetectorService","description":"Test: parseResponse() with valid/invalid JSON, sampling fallback to Gemini, classification accuracy with known examples (preference change, fact update, direct contradiction, complementary, duplicate, unrelated)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:44:18.009265-06:00","updated_at":"2026-01-01T18:00:55.976091-06:00","closed_at":"2026-01-01T18:00:55.976091-06:00","dependencies":[{"issue_id":"engram-ioi6","depends_on_id":"engram-t4ms","type":"blocks","created_at":"2026-01-01T16:46:29.895735-06:00","created_by":"ccheney"}]}
{"id":"engram-isbs","title":"Add dotenv-cli and update npm scripts for turbo remote cache","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-20T23:07:39.089212-06:00","updated_at":"2025-12-21T03:50:24.617712-06:00","closed_at":"2025-12-21T03:50:24.617712-06:00"}
{"id":"engram-iszl","title":"Rewrite apps/ingestion/src/auth.ts to OAuth-only (remove dev token bypass)","description":"Rewrite apps/ingestion/src/auth.ts to OAuth-only authentication\n\n**File**: /Users/ccheney/Projects/engram/apps/ingestion/src/auth.ts\n\n**Objective**: Remove dev token bypass logic, migrate to pure OAuth 2.1 bearer token validation with unified token patterns.\n\n**Required Changes**:\n1. Remove dev token bypass:\n   - Delete isDevelopment() function or conditional checks\n   - Remove engram_dev_* pattern matching and validation\n   - Remove any environment-based authentication shortcuts\n\n2. Import unified TOKEN_PATTERNS:\n   - Import TOKEN_PATTERNS from @engram/common (packages/common/src/types/auth.ts)\n   - Replace inline regex patterns with TOKEN_PATTERNS.oauth and TOKEN_PATTERNS.client\n   - Ensure validation matches both egm_oauth_* (user tokens) and egm_client_* (client credentials)\n\n3. PostgreSQL pool-based token lookup:\n   - Use existing pool connection from apps/ingestion (check imports)\n   - Query: SELECT user_id, client_id, grant_type, scopes, expires_at, revoked_at FROM oauth_tokens WHERE token = \n   - Verify expires_at \u003e NOW() and revoked_at IS NULL\n   - Return structured auth context with user_id, client_id, grant_type, scopes\n\n4. Scope validation with ANY semantics:\n   - Accept required_scopes parameter (string array)\n   - Check if user has ANY of the required scopes (OR semantics - differs from API middleware)\n   - PostgreSQL: WHERE scopes \u0026\u0026 ARRAY[, , ...] (array overlap operator)\n   - Return 403 Forbidden with specific message if no scopes match\n\n5. Error handling:\n   - Return 401 Unauthorized for missing/invalid/expired tokens\n   - Return 403 Forbidden for insufficient scopes\n   - Return 500 Internal Server Error for database errors\n   - Include descriptive error messages in response\n\n6. Fire-and-forget last_used_at update:\n   - After successful validation, asynchronously: UPDATE oauth_tokens SET last_used_at = NOW() WHERE token = \n   - Use .catch(() =\u003e {}) to suppress errors\n   - Do not await or block request processing\n\n**Subagent Instructions**:\n1. Read existing apps/ingestion/src/auth.ts to understand current structure\n2. Read packages/common/src/types/auth.ts to see TOKEN_PATTERNS definition\n3. Identify PostgreSQL pool import (likely from packages/storage or local config)\n4. Implement changes preserving function signatures\n5. Run bun run typecheck after changes\n6. Run bun test -- --filter=*ingestion* to run ingestion tests\n7. Check apps/ingestion/src/auth.test.ts exists and update test cases for OAuth-only flow\n8. Remove any test cases for dev tokens or API keys\n9. Add test cases for egm_oauth_* and egm_client_* validation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:53:49.166658-06:00","updated_at":"2025-12-29T16:51:26.230353-06:00","closed_at":"2025-12-29T16:51:26.230353-06:00","dependencies":[{"issue_id":"engram-iszl","depends_on_id":"engram-xq1x","type":"blocks","created_at":"2025-12-29T15:59:30.162662-06:00","created_by":"ccheney"},{"issue_id":"engram-iszl","depends_on_id":"engram-22yx","type":"blocks","created_at":"2025-12-29T15:59:35.298225-06:00","created_by":"ccheney"}]}
{"id":"engram-iyjw","title":"Replace RerankerTier type with OpenAPI spec type","description":"apps/interface/app/components/SearchSettings.tsx:3 - Import RerankerTier type from search OpenAPI spec or shared types instead of local definition","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T16:22:15.121878-06:00","updated_at":"2025-12-20T19:18:04.831672-06:00","closed_at":"2025-12-20T19:18:04.831672-06:00"}
{"id":"engram-izya","title":"Update docker-compose files with ENGRAM_CLIENT_ID/SECRET env vars","description":"Add OAuth 2.1 client credentials environment variables to all services in docker-compose.dev.yml and docker-compose.prod.yml. Remove legacy ENGRAM_API_KEY and ENGRAM_API_TOKEN references.\n\n**Files to modify**:\n1. /Users/ccheney/Projects/engram/docker-compose.dev.yml (symlink to configs/docs/docker-compose.dev.yml)\n2. /Users/ccheney/Projects/engram/docker-compose.prod.yml\n\n**Services requiring OAuth credentials**:\n- **api**: Needs credentials to call Search service for hybrid retrieval\n- **search**: Needs credentials as resource server to validate tokens (AUTH_DATABASE_URL already present)\n- **tuner**: Needs credentials as resource server to validate tokens (AUTH_DATABASE_URL already present)\n- **ingestion**: Needs credentials to call API service for memory writes\n- **memory**: Needs credentials to call API service for graph persistence\n- **console**: Already has ENGRAM_API_TOKEN - migrate to ENGRAM_CLIENT_ID/SECRET\n- **observatory**: Does NOT need service credentials (is the auth server itself)\n\n**Environment variables to add** (each service):\n\n\n**Environment variables to REMOVE**:\n- ENGRAM_API_KEY (currently in console)\n- ENGRAM_API_TOKEN (currently in console at line 256 of docker-compose.prod.yml)\n- Any AUTH_ENABLED=false flags (line 97 in docker-compose.prod.yml ingestion service)\n\n**Production-specific considerations** (docker-compose.prod.yml):\n- Use HTTPS URLs for ENGRAM_AUTH_URL: https://observatory.engram.rawcontext.com\n- Secrets should reference ${ENGRAM_API_CLIENT_SECRET}, ${ENGRAM_SEARCH_CLIENT_SECRET}, etc. from .env\n\n**Dev-specific considerations** (docker-compose.dev.yml):\n- Use HTTP localhost URLs for ENGRAM_AUTH_URL: http://localhost:6178\n- Can use hardcoded dev secrets or local .env file\n\n**Pattern to follow**:\n\n\n**Testing**: After changes, start services with 'docker compose -f docker-compose.dev.yml up' and verify services can authenticate using client credentials grant.\n\n**Dependencies**: Blocked by engram-j6pr, engram-iszl, engram-qeb4, engram-4qcq - all auth middleware rewrites must complete BEFORE adding these env vars, otherwise services will fail to start due to missing auth implementation.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:54:39.998562-06:00","updated_at":"2025-12-29T16:59:27.741454-06:00","closed_at":"2025-12-29T16:59:27.741454-06:00","dependencies":[{"issue_id":"engram-izya","depends_on_id":"engram-j6pr","type":"blocks","created_at":"2025-12-29T16:00:51.525626-06:00","created_by":"ccheney"},{"issue_id":"engram-izya","depends_on_id":"engram-iszl","type":"blocks","created_at":"2025-12-29T16:00:56.660867-06:00","created_by":"ccheney"},{"issue_id":"engram-izya","depends_on_id":"engram-qeb4","type":"blocks","created_at":"2025-12-29T16:01:01.804044-06:00","created_by":"ccheney"},{"issue_id":"engram-izya","depends_on_id":"engram-4qcq","type":"blocks","created_at":"2025-12-29T16:01:06.944644-06:00","created_by":"ccheney"}]}
{"id":"engram-j085","title":"Improve tests for search clients/nats.py (71.8% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:16.865704-05:00","updated_at":"2025-12-27T01:59:16.865704-05:00"}
{"id":"engram-j49a","title":"Make auth DB failure fatal in search/tuner services","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T22:21:21.734601-05:00","updated_at":"2025-12-22T22:29:43.949804-05:00","closed_at":"2025-12-22T22:29:43.949804-05:00"}
{"id":"engram-j6pr","title":"Rewrite apps/api/src/middleware/auth.ts to OAuth-only (remove API key validation)","description":"Rewrite apps/api/src/middleware/auth.ts to OAuth-only authentication\n\n**File**: /Users/ccheney/Projects/engram/apps/api/src/middleware/auth.ts\n\n**Objective**: Remove all API key and dev token logic, migrate to pure OAuth 2.1 bearer token authentication.\n\n**Required Changes**:\n1. Remove API key validation logic:\n   - Delete engram_live_* pattern matching and validation\n   - Delete engram_test_* pattern matching and validation\n   - Remove any associated database lookups for api_keys table\n\n2. Remove dev token bypass:\n   - Delete engram_dev_* pattern matching\n   - Remove isDevelopment() conditional logic\n   - Remove any environment-based authentication shortcuts\n\n3. Import unified TOKEN_PATTERNS:\n   - Import TOKEN_PATTERNS from @engram/common (packages/common/src/types/auth.ts)\n   - Use TOKEN_PATTERNS.oauth and TOKEN_PATTERNS.client for validation\n   - Ensure regex patterns match both egm_oauth_* (user tokens) and egm_client_* (client credentials tokens)\n\n4. OAuth token validation:\n   - Extract Bearer token from Authorization header\n   - Validate token format against TOKEN_PATTERNS\n   - Lookup token in oauth_tokens table (PostgreSQL)\n   - Verify token is not expired (expires_at \u003e NOW())\n   - Verify token is not revoked (revoked_at IS NULL)\n\n5. Enhanced AuthContext:\n   - Include grant_type field (authorization_code, client_credentials, refresh_token, device_code)\n   - Include client_id field from oauth_tokens.client_id\n   - Include user_id field (nullable for client_credentials)\n   - Include scopes array from oauth_tokens.scopes\n\n6. Fire-and-forget last_used_at update:\n   - After successful validation, asynchronously update oauth_tokens.last_used_at = NOW()\n   - Use .catch() to suppress errors (fire-and-forget pattern)\n   - Do not block request processing\n\n7. Scope validation:\n   - Accept required_scopes parameter in auth middleware\n   - Validate user has ALL required scopes (AND semantics)\n   - Return 403 Forbidden if scopes insufficient\n\n**Reference**: https://oauth.net/2/bearer-tokens/ (RFC 6750)\n\n**Subagent Instructions**:\n1. BEFORE coding: Call Context7 MCP resolve-library-id for '/honojs/hono', then query-docs with query='bearer token authentication middleware pattern'\n2. BEFORE coding: Web search 'Hono bearer auth middleware 2025' for current patterns\n3. Read existing apps/api/src/middleware/auth.ts to understand current structure\n4. Read packages/common/src/types/auth.ts to see TOKEN_PATTERNS and AuthContext type\n5. Implement changes preserving Hono middleware signature\n6. Run bun run typecheck after changes\n7. Run bun run lint after changes\n8. Test with curl -H 'Authorization: Bearer egm_oauth_...' http://localhost:6174/v1/memory/recall","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:53:43.092061-06:00","updated_at":"2025-12-29T16:51:26.229135-06:00","closed_at":"2025-12-29T16:51:26.229135-06:00","dependencies":[{"issue_id":"engram-j6pr","depends_on_id":"engram-xq1x","type":"blocks","created_at":"2025-12-29T15:59:02.375482-06:00","created_by":"ccheney"},{"issue_id":"engram-j6pr","depends_on_id":"engram-uxh4","type":"blocks","created_at":"2025-12-29T15:59:07.522378-06:00","created_by":"ccheney"},{"issue_id":"engram-j6pr","depends_on_id":"engram-g65i","type":"blocks","created_at":"2025-12-29T15:59:12.654399-06:00","created_by":"ccheney"},{"issue_id":"engram-j6pr","depends_on_id":"engram-46ks","type":"blocks","created_at":"2025-12-29T15:59:17.798958-06:00","created_by":"ccheney"},{"issue_id":"engram-j6pr","depends_on_id":"engram-22yx","type":"blocks","created_at":"2025-12-29T15:59:22.93025-06:00","created_by":"ccheney"}]}
{"id":"engram-j6uo","title":"Remove legacy fallback_to_legacy tests from search","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:13:08.006779-05:00","updated_at":"2025-12-24T02:13:53.972726-05:00","closed_at":"2025-12-24T02:13:53.972726-05:00"}
{"id":"engram-j91q","title":"Destroy GCP infrastructure with Pulumi","description":"Remove all GCP resources before migrating to OpenTofu/Hetzner.\n\n## Steps\n1. `cd packages/infra`\n2. `pulumi destroy --yes`\n3. Verify all resources deleted in GCP Console\n\n## Resources being destroyed\n- GKE Autopilot cluster\n- VPC network, subnets, NAT\n- Secret Manager secrets\n- GCS backup bucket\n- All Kubernetes workloads\n\n## Acceptance Criteria\n- `pulumi destroy` completes successfully\n- No resources remain in GCP project\n- No ongoing billing for GCP resources","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:48:56.12892-06:00","updated_at":"2025-12-21T15:48:56.12892-06:00"}
{"id":"engram-j9n1","title":"Run ts5to6 migration tool to fix baseUrl deprecation","description":"Run npx @andrewbranch/ts5to6 --fixBaseUrl on all tsconfig files to remove deprecated baseUrl option","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:37:28.059879-06:00","updated_at":"2025-12-20T22:28:59.123636-06:00","closed_at":"2025-12-20T22:28:59.123636-06:00","dependencies":[{"issue_id":"engram-j9n1","depends_on_id":"engram-5jiq","type":"blocks","created_at":"2025-12-20T21:38:37.960809-06:00","created_by":"ccheney"}]}
{"id":"engram-jav35","title":"Update memory access tracking","description":"Modify recall in apps/mcp/src/tools/recall.ts and apps/api/src/services/memory.ts to update last_accessed and increment access_count when memories are returned. Batch update after recall completes.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:50.765281-06:00","updated_at":"2026-01-01T16:50:50.765281-06:00","dependencies":[{"issue_id":"engram-jav35","depends_on_id":"engram-okfbx","type":"blocks","created_at":"2026-01-01T16:51:54.50998-06:00","created_by":"ccheney"}]}
{"id":"engram-jbyux","title":"Unit tests: Schema DSL","description":"Create unit tests for schema definition DSL\n\n## Overview\nThese tests validate that the schema DSL correctly defines field types, nodes, edges, and schema composition. They ensure type inference works and validation catches errors.\n\n## Test Coverage\n\n### Field Types (field.test.ts)\n- String field with/without max length\n- Int field with min/max constraints\n- Float field\n- Boolean field\n- Timestamp field\n- Array field with inner types\n- Enum field with const values\n- Vector field with dimensions\n- Optional modifier\n- Default value modifier\n- Chained modifiers\n\n### Node Definition (node.test.ts)\n- Node with all field types\n- Type inference from node definition\n- Bitemporal field injection\n- Required vs optional fields\n\n### Edge Definition (edge.test.ts)\n- Simple edge between nodes\n- Edge with properties\n- Self-referential edge\n- Temporal flag configuration\n- Type inference for from/to\n\n### Schema Composition (schema.test.ts)\n- Combining nodes and edges\n- Validation of edge references\n- Type inference for full schema\n- Error on invalid edge references\n\n## Test Examples\n```typescript\nimport { describe, test, expect } from 'bun:test';\nimport { field, node, edge, defineSchema } from '../schema';\n\ndescribe('field types', () =\u003e {\n  test('string field with max length', () =\u003e {\n    const f = field.string().max(100);\n    expect(f.type).toBe('string');\n    expect(f.constraints.maxLength).toBe(100);\n  });\n\n  test('enum field with values', () =\u003e {\n    const f = field.enum(['a', 'b', 'c'] as const);\n    expect(f.type).toBe('enum');\n    expect(f.values).toEqual(['a', 'b', 'c']);\n  });\n});\n\ndescribe('node definition', () =\u003e {\n  test('infers types from fields', () =\u003e {\n    const TestNode = node({\n      name: field.string(),\n      count: field.int().optional(),\n    });\n    \n    type Inferred = typeof TestNode.infer;\n    // Type test: Inferred should have { name: string; count?: number }\n  });\n});\n```\n\n## Research Required\nUse web search for:\n- 'TypeScript type testing patterns'\n- 'Bun test snapshot testing'\n- 'Testing type inference TypeScript'\n- 'tsd type testing library'\n\n## Files\n- packages/graph/src/schema/field.test.ts\n- packages/graph/src/schema/node.test.ts\n- packages/graph/src/schema/edge.test.ts\n- packages/graph/src/schema/schema.test.ts\n\n## References\n- Bun test: https://bun.sh/docs/cli/test\n- tsd (type testing): https://github.com/SamVerschueren/tsd\n- Plan: docs/plans/compiled-query-layer.md lines 866-871","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:52:07.825998-06:00","updated_at":"2026-01-01T17:11:43.756395-06:00","dependencies":[{"issue_id":"engram-jbyux","depends_on_id":"engram-0v41","type":"blocks","created_at":"2026-01-01T16:56:23.048654-06:00","created_by":"ccheney"}]}
{"id":"engram-je9d","title":"Improve engram_summarize tool description","description":"Update apps/mcp/src/tools/summarize.ts with improved descriptions. Changes:\n- Main description: 'Condense long text into key points using the MCP client LLM. Use before storing memories to create compact, searchable summaries. Also useful for: distilling verbose error logs, compressing context that exceeds limits, or creating session recaps.'\n- text param: Guide on what works best and chunking advice\n- maxWords param: Provide guidance for different use cases (10-30 for titles, 50-100 for content, 200-500 for recaps)\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_summarize","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:12.523308-05:00","updated_at":"2025-12-25T00:59:29.539705-05:00","closed_at":"2025-12-25T00:59:29.539705-05:00"}
{"id":"engram-jekc","title":"Multi-Tenancy Phase 3: Service Integration","description":"Integrate tenant context across all Engram services: API, Ingestion, Memory, Search, MCP.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Phase 3: Service Integration section\n\n## Overview\nPropagate TenantContext through the entire request/event pipeline:\n- API: Extract from introspection, create TenantContext, pass to handlers\n- Ingestion: Extract from token, include in NATS events\n- Memory: Receive from NATS, select tenant graph\n- Search: Enforce org_id filter on all queries\n- MCP: Pass through all tools, scope queries\n\n## Data Flow\nExternal Agent → Ingestion (orgId extracted) → NATS (orgId in payload) → Memory (tenant graph) → Search (org_id filter)\n\n## Dependencies\nDepends on Phase 1 (TenantContext, introspection) and Phase 2 (storage layer)\n\n## Agent Instructions\nUse Context7 MCP for Hono framework docs. Ensure consistent TenantContext propagation patterns.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T22:07:47.911618-06:00","updated_at":"2025-12-29T23:48:10.825937-06:00","closed_at":"2025-12-29T23:48:10.825937-06:00","dependencies":[{"issue_id":"engram-jekc","depends_on_id":"engram-r083","type":"blocks","created_at":"2025-12-29T22:13:33.269318-06:00","created_by":"ccheney"},{"issue_id":"engram-jekc","depends_on_id":"engram-yvhi","type":"blocks","created_at":"2025-12-29T22:13:39.499775-06:00","created_by":"ccheney"},{"issue_id":"engram-jekc","depends_on_id":"engram-7x73","type":"blocks","created_at":"2025-12-29T22:13:45.771036-06:00","created_by":"ccheney"},{"issue_id":"engram-jekc","depends_on_id":"engram-p7nt","type":"blocks","created_at":"2025-12-29T22:13:52.402276-06:00","created_by":"ccheney"}]}
{"id":"engram-jf4tq","title":"Create edge temporality migration script","description":"Create packages/graph/src/migrations/add-edge-temporality.ts to migrate existing edges.\n\n## Edges to Migrate\n- HAS_TURN (Session → Turn)\n- HAS_REASONING (Turn → Reasoning)\n- HAS_TOOL_CALL (Turn → ToolCall)\n- TOUCHES_FILE (ToolCall → FileTouch)\n- CREATED_IN (Memory → Session)\n- REPLACES (Node versioning)\n- NEXT (Turn → Turn sequential)\n\n## Migration Logic\n```typescript\nexport async function migrateEdgesToBitemporal(falkor: FalkorClient): Promise\u003cvoid\u003e {\n  const now = Date.now();\n  const maxDate = 253402300799999; // MAX_DATE\n\n  const edgeTypes = [\n    'HAS_TURN', 'HAS_REASONING', 'HAS_TOOL_CALL',\n    'TOUCHES_FILE', 'CREATED_IN', 'REPLACES', 'NEXT'\n  ];\n\n  for (const edgeType of edgeTypes) {\n    await falkor.query(`\n      MATCH ()-[e:${edgeType}]-\u003e()\n      WHERE e.vt_start IS NULL\n      SET e.vt_start = $now,\n          e.vt_end = $maxDate,\n          e.tt_start = $now,\n          e.tt_end = $maxDate\n    `, { now, maxDate });\n  }\n}\n```\n\n## Idempotency\n- Check `WHERE e.vt_start IS NULL` to skip already-migrated edges\n- Safe to run multiple times\n\n## Tenant Awareness\n- Run migration per tenant graph\n- Or run on all graphs if using global migration\n\n## Verification\n```cypher\nMATCH ()-[e]-\u003e() WHERE e.vt_start IS NULL RETURN count(e)\n-- Should return 0 after migration\n```\n\n## Research\n- FalkorDB SET on edges: Use Context7 MCP `query-docs` with '/websites/falkordb' for 'SET relationship property'\n- Bitemporal migration patterns: Web search 'graph database edge migration bitemporal'","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:32.624789-06:00","updated_at":"2026-01-01T17:09:25.083145-06:00","dependencies":[{"issue_id":"engram-jf4tq","depends_on_id":"engram-ksphq","type":"blocks","created_at":"2026-01-01T16:54:52.245859-06:00","created_by":"ccheney"},{"issue_id":"engram-jf4tq","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:24.45698-06:00","created_by":"ccheney"}]}
{"id":"engram-jjan","title":"[HIGH] Silent error suppression in parsers","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:14.457188-06:00","updated_at":"2025-12-20T23:59:50.557231-06:00","closed_at":"2025-12-20T23:59:50.557231-06:00"}
{"id":"engram-jkke","title":"[Cleanup] Remove apps/search (TypeScript)","description":"Remove deprecated TypeScript search service after Python migration is complete and traffic is fully migrated.\n\nNO BACKWARDS COMPATIBILITY - clean removal.\n\nDeliverables:\n- Delete apps/search/ directory\n- Remove from turbo.json\n- Remove from docker-compose.dev.yml\n- Remove @engram/search workspace from package.json\n- Update any CI/CD pipelines\n- Remove from deployment manifests\n\nVerify before removal:\n- All traffic on Python service (engram-684i complete)\n- No errors in Python service for 1 week\n- Monitoring confirms parity","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T07:30:11.648586-06:00","updated_at":"2025-12-20T09:35:34.144173-06:00","closed_at":"2025-12-20T09:35:34.144173-06:00","dependencies":[{"issue_id":"engram-jkke","depends_on_id":"engram-684i","type":"blocks","created_at":"2025-12-20T07:30:53.058969-06:00","created_by":"ccheney"}]}
{"id":"engram-jroc","title":"Define ConflictRelation types and interfaces","description":"Create TypeScript types for CONTRADICTION, SUPERSEDES, AUGMENTS, DUPLICATE, INDEPENDENT relations. Define ConflictCandidate and ConflictDetectionResult interfaces in apps/mcp/src/services/conflict-detector.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:03.047264-06:00","updated_at":"2026-01-01T17:31:22.620991-06:00","closed_at":"2026-01-01T17:31:22.620991-06:00"}
{"id":"engram-jtyk","title":"Delete apps/api/API_KEYS.md documentation file","description":"Delete the legacy API key documentation file at apps/api/API_KEYS.md. This documentation described the old PostgreSQL-based API key authentication system, including the engram_live_* and engram_test_* token formats, the api_keys and api_usage tables, rate limiting implementation, and the /v1/keys management endpoints. This documentation is now obsolete because the API has migrated to OAuth 2.1 device flow authentication using egm_oauth_* access tokens and egm_refresh_* refresh tokens. The new authentication system is documented elsewhere and uses token introspection against the Observatory service rather than database lookups.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:55:11.907247-06:00","updated_at":"2025-12-29T17:07:05.360966-06:00","closed_at":"2025-12-29T17:07:05.360966-06:00","dependencies":[{"issue_id":"engram-jtyk","depends_on_id":"engram-izya","type":"blocks","created_at":"2025-12-29T16:02:10.670486-06:00","created_by":"ccheney"}]}
{"id":"engram-jxgz","title":"Add GitHub Actions API integration","description":"lib/github.ts - Workflow runs, deployments, workflow dispatch trigger, deployment approvals","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:21:53.590428-05:00","updated_at":"2025-12-27T04:21:53.590428-05:00"}
{"id":"engram-jzc1","title":"Test coverage: packages/common/src/testing/index.ts (98%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:58.27836-06:00","updated_at":"2025-12-21T04:07:03.756379-06:00","closed_at":"2025-12-21T04:07:03.756379-06:00"}
{"id":"engram-k0we","title":"Add dark/light theme toggle","description":"Theme switcher with system preference detection, persist preference. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:44.100082-05:00","updated_at":"2025-12-27T16:28:50.431915-05:00","closed_at":"2025-12-27T16:28:50.431915-05:00","dependencies":[{"issue_id":"engram-k0we","depends_on_id":"engram-oyrw","type":"blocks","created_at":"2025-12-27T04:28:57.446538-05:00","created_by":"ccheney"}]}
{"id":"engram-k1lb","title":"[CRITICAL] Unsafe array indexing in apps/tuner","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:57.622284-06:00","updated_at":"2025-12-20T23:35:43.812263-06:00","closed_at":"2025-12-20T23:35:43.812263-06:00"}
{"id":"engram-k725","title":"Test coverage: packages/common/src/errors/domain.ts (35%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:52.310478-06:00","updated_at":"2025-12-21T04:07:03.757995-06:00","closed_at":"2025-12-21T04:07:03.757995-06:00"}
{"id":"engram-kbrm","title":"Create production docker-compose.yml for Hetzner","description":"Create Docker Compose configuration for production deployment on Hetzner VPS.\n\n## Services to include\n- redpanda (Kafka-compatible event streaming)\n- qdrant (vector database)\n- falkordb (graph database)\n- postgres (API keys + Optuna)\n- ingestion (TypeScript)\n- memory (TypeScript)\n- search (Python)\n- api (TypeScript)\n- tuner (Python)\n\n## Key differences from dev compose\n- No exposed ports for databases (internal network only)\n- Production resource limits\n- Health checks for all services\n- Volume mounts for persistent data\n- Environment variable substitution from .env\n\n## Location\n`docker-compose.prod.yml` in repo root\n\n## Acceptance Criteria\n- All services defined with proper dependencies\n- Health checks configured\n- Data volumes persist across restarts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:29:00.669025-06:00","updated_at":"2025-12-21T16:10:46.975782-06:00","closed_at":"2025-12-21T16:10:46.975782-06:00"}
{"id":"engram-kccw","title":"Benchmark: Implement fact extraction heuristics","description":"packages/benchmark/src/engram_benchmark/longmemeval/key_expansion.py:166 - Placeholder for fact extraction using heuristics. Method needs proper implementation beyond placeholder logic.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T04:02:59.55374-05:00","updated_at":"2025-12-22T04:10:10.74049-05:00","closed_at":"2025-12-22T04:10:10.74049-05:00"}
{"id":"engram-kcjg","title":"Create node definition DSL (node.ts)","description":"Implement node definition for the Schema DSL in packages/graph/src/schema/node.ts\n\n## Overview\nNode definitions describe the structure of graph nodes (vertices) in FalkorDB. Each node type has a set of typed fields and automatically includes bitemporal metadata (vt_start, vt_end, tt_start, tt_end).\n\n## Requirements\n- node() function that accepts a record of field definitions\n- Automatic bitemporal field injection via _bitemporal flag\n- Full TypeScript type inference from field definitions\n- Support for all field types from field.ts\n- Generate both runtime metadata and compile-time types\n\n## API Design\n```typescript\nimport { node, field } from '@engram/graph/schema';\n\nexport const MemoryNode = node({\n  content: field.string(),\n  content_hash: field.string(),\n  type: field.enum(['decision', 'context', 'insight', 'preference', 'fact', 'turn']),\n  tags: field.array(field.string()),\n  embedding: field.vector(1024).optional(),\n});\n\n// Type inference: typeof MemoryNode.infer → { content: string; type: MemoryType; ... }\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'table definition schema inference TypeScript')`\n- `query-docs('/prisma/docs', 'model definition type generation')`\n\nUse web search for:\n- 'TypeScript infer type from object definition'\n- 'Drizzle pgTable implementation pattern'\n- 'TypeScript mapped types conditional inference'\n\n## Technical Considerations\n- Use TypeScript's `infer` keyword for field type extraction\n- Consider using a class-based approach for better IDE support\n- Ensure field metadata is available at runtime for code generation\n\n## Files\n- packages/graph/src/schema/node.ts (NEW)\n\n## References\n- Drizzle table definition: https://orm.drizzle.team/docs/sql-schema-declaration\n- TypeScript mapped types: https://www.typescriptlang.org/docs/handbook/2/mapped-types.html\n- Plan: docs/plans/compiled-query-layer.md lines 565-571","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:48:46.73561-06:00","updated_at":"2026-01-01T17:45:06.809468-06:00","closed_at":"2026-01-01T17:45:06.809468-06:00","dependencies":[{"issue_id":"engram-kcjg","depends_on_id":"engram-hd79","type":"blocks","created_at":"2026-01-01T16:54:02.727307-06:00","created_by":"ccheney"}]}
{"id":"engram-kf57","title":"Add OAuth auth types to common package","description":"Create packages/common/src/types/auth.ts with TypeScript types for OAuth device flow. Include DeviceCodeRequest, DeviceCodeResponse, TokenRequest, TokenResponse, and OAuthTokenContext (similar to existing ApiKeyContext). See docs/design/oauth-device-flow.md 'API Endpoint Specifications' section for request/response shapes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:41.714125-05:00","updated_at":"2025-12-25T02:25:51.433388-05:00","closed_at":"2025-12-25T02:25:51.433388-05:00"}
{"id":"engram-kjo0","title":"Test coverage: apps/memory/src/handlers/content.handler.ts (88%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:52.899913-06:00","updated_at":"2025-12-21T04:07:03.757544-06:00","closed_at":"2025-12-21T04:07:03.757544-06:00"}
{"id":"engram-kofa","title":"Test coverage: packages/vfs/src/memory-fs.ts (96%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:00.152055-06:00","updated_at":"2025-12-21T01:44:00.14248-06:00","closed_at":"2025-12-21T01:44:00.14248-06:00"}
{"id":"engram-kp1j","title":"[EPIC] Streaming Content Indexing Strategy","description":"Implement turn-level indexing to replace fragment-level streaming event indexing.\n\n## Problem\nCurrent indexing pipeline indexes individual streaming events (token-level fragments) instead of complete conversation turns, leading to:\n- Fragmented content (2-3 word chunks)\n- Low retrieval scores (0.05-0.07)\n- Reranking failures (0 scores)\n\n## Solution\nShift to turn-level indexing with semantic chunking for long responses.\n\n## Phases\n1. Turn-Level Indexing (High Impact)\n2. Semantic Chunking (Medium Impact)\n3. Multi-Collection Architecture\n4. Hybrid Retrieval Enhancement\n\nSee: docs/streaming-indexing-strategy.md","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-21T06:10:55.568466-06:00","updated_at":"2025-12-21T07:11:57.373983-06:00","closed_at":"2025-12-21T07:11:57.373983-06:00"}
{"id":"engram-kprv","title":"Implement POST /api/auth/device/verify endpoint","description":"Create apps/observatory/app/api/auth/device/verify/route.ts - POST handler that links user_code to the current Better Auth session user. Looks up device_code by user_code, verifies not expired, updates status to 'authorized', and sets user_id. See docs/design/oauth-device-flow.md 'Verify User Code' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:47.299687-05:00","updated_at":"2025-12-25T02:32:44.624514-05:00","closed_at":"2025-12-25T02:32:44.624514-05:00","dependencies":[{"issue_id":"engram-kprv","depends_on_id":"engram-cgk8","type":"blocks","created_at":"2025-12-25T02:21:08.043505-05:00","created_by":"ccheney"}]}
{"id":"engram-kq26","title":"Test coverage: packages/vfs/src/vfs.ts (88%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:18.659642-06:00","updated_at":"2025-12-21T01:43:44.663578-06:00","closed_at":"2025-12-21T01:43:44.663578-06:00"}
{"id":"engram-kr52","title":"Update base tsconfig target to ESNext","description":"Update packages/tsconfig/base.json target from es2022 to ESNext (ES2025 not yet available in TS). Update lib accordingly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:37:40.053445-06:00","updated_at":"2025-12-20T22:29:23.722011-06:00","closed_at":"2025-12-20T22:29:23.722011-06:00","dependencies":[{"issue_id":"engram-kr52","depends_on_id":"engram-j9n1","type":"blocks","created_at":"2025-12-20T21:38:49.139429-06:00","created_by":"ccheney"},{"issue_id":"engram-kr52","depends_on_id":"engram-askd","type":"blocks","created_at":"2025-12-20T21:38:54.252582-06:00","created_by":"ccheney"}]}
{"id":"engram-ksphq","title":"Create BitemporalEdgeSchema and semantic edge types","description":"Create or extend packages/graph/src/models/edges.ts with bitemporal edge schemas.\n\n## Base Schema\nBitemporalEdgeSchema with:\n- vt_start/vt_end (valid time - when relationship is/was true)\n- tt_start/tt_end (transaction time - when we recorded it)\n\n## Edge Types\n\n### MentionsEdgeSchema (Memory → Entity)\n- type: 'MENTIONS'\n- context: string (how entity appears in memory)\n\n### RelatedToEdgeSchema (Entity → Entity)\n- type: 'RELATED_TO'\n- relationship: string (nature of relationship)\n- strength: number 0-1 (confidence)\n\n### DependsOnEdgeSchema (Entity → Entity)\n- type: 'DEPENDS_ON'\n- dependency_type: 'runtime' | 'build' | 'optional'\n\n### ImplementsEdgeSchema, PartOfEdgeSchema\n- Similar patterns for implementation and containment relationships\n\n## Implementation Reference\n- See existing edge patterns in packages/graph/src/models/edges.ts\n- Follow FalkorBaseRepository.createBitemporal() pattern\n\n## Research\n- Graphiti edge model: Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'EntityEdge valid_at created_at temporal'\n- FalkorDB edge properties: Use Context7 MCP `query-docs` with '/websites/falkordb' for 'relationship properties index'\n- Web search: 'knowledge graph edge types semantic relationships'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:18.615957-06:00","updated_at":"2026-01-01T18:17:48.636347-06:00","closed_at":"2026-01-01T18:17:48.636347-06:00","dependencies":[{"issue_id":"engram-ksphq","depends_on_id":"engram-ezn34","type":"blocks","created_at":"2026-01-01T16:53:36.917784-06:00","created_by":"ccheney"},{"issue_id":"engram-ksphq","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:27.853479-06:00","created_by":"ccheney"}]}
{"id":"engram-ksq5","title":"[MEDIUM] Incomplete secrets redaction in parsers","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:32.769885-06:00","updated_at":"2025-12-21T00:09:56.478328-06:00","closed_at":"2025-12-21T00:09:56.478328-06:00"}
{"id":"engram-ksqn","title":"Write OpenTofu Hetzner server resources","description":"Create HCL files for Hetzner VPS provisioning.\n\n## Files to create\n\n### ssh.tf\n```hcl\nresource \"hcloud_ssh_key\" \"engram\" {\n  name       = \"engram-key\"\n  public_key = file(var.ssh_public_key_path)\n}\n```\n\n### server.tf\n- hcloud_server resource (CPX31, Ubuntu 24.04, Ashburn VA)\n- cloud-init user_data for:\n  - Create engram user with sudo\n  - Install Docker and docker-compose-plugin\n  - Configure UFW firewall\n  - Create /opt/engram directory\n\n### firewall.tf\n- hcloud_firewall with rules for SSH, HTTP, HTTPS\n- hcloud_firewall_attachment to server\n\n## Acceptance Criteria\n- `tofu validate` passes\n- `tofu plan` shows expected resources\n\nDepends on (1):\n  → engram-nr5u: Create OpenTofu project structure [P2]\n\nBlocks (2):\n  ← engram-atad: Run tofu apply to provision Hetzner VPS [P2]\n  ← engram-bjmv: Write OpenTofu tests [P2]\n\n## Additional Requirements\n\n### DNS Management\nOpenTofu should manage all DNS records for statient.com via the Vercel provider:\n- api.statient.com -\u003e Hetzner IP\n- search.statient.com -\u003e Hetzner IP  \n- tuner.statient.com -\u003e Hetzner IP\n\nUse vercel_dns_record resource for each subdomain.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:49:46.048924-06:00","updated_at":"2025-12-21T18:01:44.11219-06:00","dependencies":[{"issue_id":"engram-ksqn","depends_on_id":"engram-nr5u","type":"blocks","created_at":"2025-12-21T15:51:10.642761-06:00","created_by":"ccheney"}]}
{"id":"engram-kve0y","title":"Implement graph-aware recall","description":"Update apps/mcp/src/tools/recall.ts to add graph-aware retrieval.\n\n## New Options\n```typescript\ninterface RecallOptions {\n  // ... existing options\n  graphDepth?: number;      // Max hops for expansion (default: 2)\n  includeEntities?: boolean; // Enable graph expansion (default: true)\n}\n```\n\n## Retrieval Flow\n\n### Step 1: Vector Search\n```typescript\nconst vectorResults = await searchClient.search({\n  query: input.query,\n  limit: input.limit * 2,  // Oversample for graph expansion\n  filters: input.filters,\n});\n```\n\n### Step 2: Entity Extraction from Query\n```typescript\nconst queryEntities = await entityExtractor.extract(input.query, 'query');\n```\n\n### Step 3: Find Matching Entities\n```typescript\nfor (const qe of queryEntities.entities) {\n  const matches = await entityRepo.findByEmbedding(\n    await embed(qe.name), 3, 0.8\n  );\n  entityMatches.push(...matches);\n}\n```\n\n### Step 4: Graph Expansion (BFS)\nTwo expansion paths:\n1. Vector results → MENTIONS → entities → RELATED_TO → entities → MENTIONS → memories\n2. Query entities → RELATED_TO → entities → MENTIONS → memories\n\n### Step 5: Combine and Deduplicate\nMerge vector results with graph-expanded results, remove duplicates.\n\n### Step 6: Rerank with Graph Distance\nScore includes: relevance + graph_distance + recency\n\n## Research\n- HybridRAG: https://arxiv.org/abs/2408.04948\n- LightRAG one-hop traversal: https://github.com/HKUDS/LightRAG\n- Graph-aware retrieval: Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'hybrid search graph traversal'\n- Web search: 'graph-aware RAG retrieval vector knowledge graph 2025'","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:19.927227-06:00","updated_at":"2026-01-01T17:09:13.114516-06:00","dependencies":[{"issue_id":"engram-kve0y","depends_on_id":"engram-cqo6t","type":"blocks","created_at":"2026-01-01T16:55:13.303613-06:00","created_by":"ccheney"},{"issue_id":"engram-kve0y","depends_on_id":"engram-o1qml","type":"blocks","created_at":"2026-01-01T16:55:20.089018-06:00","created_by":"ccheney"},{"issue_id":"engram-kve0y","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:14.187842-06:00","created_by":"ccheney"}]}
{"id":"engram-kvo4","title":"Remove mock data from tools/page.tsx","description":"Remove all mock data fallbacks from Admin Tools page:\n- Lines 273-285: Mock graph query results\n- Lines 485-521: Mock vector search results\n- Lines 735-742: Mock NATS streams\n- Lines 772-783: Mock cache operation success\n\nReplace with proper 'No Data' or error states when API calls fail.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:51:15.225939-05:00","updated_at":"2025-12-27T20:04:22.765281-05:00","closed_at":"2025-12-27T20:04:22.765281-05:00"}
{"id":"engram-kwmo","title":"Update Qdrant retriever with mandatory org_id filter","description":"Enforce org_id filter on ALL Qdrant queries - no bypass allowed.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 568)\n\n## Implementation\nUpdate apps/search/src/retrieval/retriever.py:\n- Always include org_id in _build_qdrant_filter()\n- Reject queries without org_id (raise error)\n- No admin bypass at retriever level (handle at service layer)\n\n## Files to Modify\n- apps/search/src/retrieval/retriever.py\n\n## Agent Instructions\nThis is a critical security boundary. Ensure no path can skip tenant filtering.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:55.755653-06:00","updated_at":"2025-12-29T22:48:32.955042-06:00","closed_at":"2025-12-29T22:48:32.955042-06:00","dependencies":[{"issue_id":"engram-kwmo","depends_on_id":"engram-r3v6","type":"blocks","created_at":"2025-12-29T22:13:11.298458-06:00","created_by":"ccheney"}]}
{"id":"engram-l10f","title":"Create Performance Analytics Charts","description":"Latency histogram, search strategy comparison, p50/p95/p99 percentiles. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:06.057961-05:00","updated_at":"2025-12-27T17:17:31.207288-05:00","closed_at":"2025-12-27T17:17:31.207288-05:00","dependencies":[{"issue_id":"engram-l10f","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:28:34.84068-05:00","created_by":"ccheney"}]}
{"id":"engram-l1stx","title":"Add ConflictReport node schema","description":"Add ConflictReportSchema to packages/graph/src/models/nodes.ts with fields: id, source_memory_id, target_memory_id, relation (CONTRADICTION|SUPERSEDES|INDEPENDENT), reason, detected_at, status (pending_review|resolved|dismissed), resolved_by, resolved_at, project, org_id.\n\n## Schema Definition\n```typescript\nexport const ConflictReportSchema = z.object({\n  id: z.string(),                          // ULID\n  source_memory_id: z.string(),            // Memory that triggered scan\n  target_memory_id: z.string(),            // Conflicting memory\n  relation: z.enum(['CONTRADICTION', 'SUPERSEDES', 'INDEPENDENT']),\n  reason: z.string(),                      // LLM explanation\n  detected_at: z.number(),                 // Scan timestamp\n  status: z.enum(['pending_review', 'resolved', 'dismissed']),\n  resolved_by: z.string().optional(),      // User who resolved\n  resolved_at: z.number().optional(),\n  resolution_action: z.enum(['invalidate_source', 'invalidate_target', 'keep_both']).optional(),\n  project: z.string(),\n  org_id: z.string(),\n  // Bitemporal\n  vt_start: z.number(),\n  vt_end: z.number(),\n  tt_start: z.number(),\n  tt_end: z.number(),\n});\n```\n\n## Before Implementation\nReview existing conflict types: engram-jroc (ConflictRelation types)\nFollow patterns from MemoryNodeSchema.\n\n## References\n- Existing conflict types: packages/common/src/types\n- Graph models: packages/graph/src/models/nodes.ts\n- ConflictDetectorService: engram-t4ms","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:19.138184-06:00","updated_at":"2026-01-01T17:09:26.810583-06:00"}
{"id":"engram-l2cf","title":"[HIGH] hashObject type safety with null values","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:51.20554-06:00","updated_at":"2025-12-20T23:59:09.151393-06:00","closed_at":"2025-12-20T23:59:09.151393-06:00"}
{"id":"engram-l51rv","title":"Gastown Multi-Agent Orchestration Integration","description":"","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T18:48:38.757895-06:00","updated_at":"2026-01-01T18:52:31.763806-06:00","closed_at":"2026-01-01T18:52:31.763806-06:00","dependencies":[{"issue_id":"engram-l51rv","depends_on_id":"engram-r2099","type":"blocks","created_at":"2026-01-01T18:49:24.569272-06:00","created_by":"ccheney"},{"issue_id":"engram-l51rv","depends_on_id":"engram-68fpa","type":"blocks","created_at":"2026-01-01T18:49:29.740016-06:00","created_by":"ccheney"},{"issue_id":"engram-l51rv","depends_on_id":"engram-vr355","type":"blocks","created_at":"2026-01-01T18:49:34.916073-06:00","created_by":"ccheney"},{"issue_id":"engram-l51rv","depends_on_id":"engram-xf5b0","type":"blocks","created_at":"2026-01-01T18:49:40.089008-06:00","created_by":"ccheney"}]}
{"id":"engram-l533","title":"[HIGH] Unbounded buffer growth in parsers","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:20.458984-06:00","updated_at":"2025-12-20T23:59:50.556084-06:00","closed_at":"2025-12-20T23:59:50.556084-06:00"}
{"id":"engram-l57g","title":"Define BenchmarkMetrics type from Python API response","description":"packages/tuner/tests/evaluation-adapter.test.ts:8 - Type is manually defined, should be based on official Python benchmark API response schema","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T16:22:45.387077-06:00","updated_at":"2025-12-20T19:18:04.835998-06:00","closed_at":"2025-12-20T19:18:04.835998-06:00"}
{"id":"engram-l5bu","title":"Test coverage: apps/memory/src/handlers/thought.handler.ts (90%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:10.254809-06:00","updated_at":"2025-12-21T04:07:03.76933-06:00","closed_at":"2025-12-21T04:07:03.76933-06:00"}
{"id":"engram-l7xa","title":"Delete apps/api/src/db/api-keys.ts file","description":"Delete the legacy API key repository file at apps/api/src/db/api-keys.ts. This file contains the old PostgreSQL-based API key management implementation (ApiKeyRepository class with methods like create, findByKey, findByUserId, revoke, listByUserId). Remove all imports of this file from other modules (likely in apps/api/src/middleware/auth.ts or similar auth-related files). After deletion, run 'bun run typecheck' to identify any remaining references that need to be cleaned up. This is part of the migration away from the old api_keys/api_usage PostgreSQL tables to the new OAuth 2.1 device flow authentication system.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:54:58.750858-06:00","updated_at":"2025-12-29T17:07:05.360241-06:00","closed_at":"2025-12-29T17:07:05.360241-06:00","dependencies":[{"issue_id":"engram-l7xa","depends_on_id":"engram-izya","type":"blocks","created_at":"2025-12-29T16:02:00.371365-06:00","created_by":"ccheney"}]}
{"id":"engram-ldnb","title":"Wire SamplingService methods to MCP tools","description":"apps/mcp SamplingService has extractFacts() and enrichMemory() that are never called. Wire enrichMemory() to remember tool for auto-tagging. Wire extractFacts() to recall for structured results.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:00:59.787345-06:00","updated_at":"2025-12-20T23:07:49.467293-06:00","closed_at":"2025-12-20T23:07:49.467293-06:00"}
{"id":"engram-lepq","title":"Add manual job trigger endpoints","description":"Create apps/worker/src/api.ts with Hono HTTP server on port 6186. Add POST endpoints: /jobs/decay, /jobs/community-detection, /jobs/summarization, /jobs/conflict-scan for manual triggering. Require admin auth.\n\n## Endpoints\n- POST /jobs/decay - Trigger decay calculation\n- POST /jobs/community-detection - Trigger community detection  \n- POST /jobs/summarization - Trigger specific community summarization\n- POST /jobs/conflict-scan - Trigger conflict scanning\n- GET /health - Health check\n- GET /metrics - Prometheus metrics\n\n## Authentication\nRequire admin scope OAuth token for job triggers. Health/metrics are public.\n\n## Before Implementation\nUse Context7 MCP: Query 'hono' for middleware and route patterns.\n\nReview existing API patterns: apps/api/src/routes/\n\n## References\n- Hono docs: https://hono.dev/\n- Auth middleware: apps/api/src/middleware/auth.ts\n- Existing API: apps/api/src/index.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:52.415042-06:00","updated_at":"2026-01-01T18:33:49.381251-06:00","closed_at":"2026-01-01T18:33:49.381251-06:00","dependencies":[{"issue_id":"engram-lepq","depends_on_id":"engram-n7ja","type":"blocks","created_at":"2026-01-01T16:50:57.285792-06:00","created_by":"ccheney"}]}
{"id":"engram-lgwc","title":"Unit tests for label propagation algorithm","description":"Create apps/worker/src/algorithms/__tests__/label-propagation.test.ts. Test: convergence on known graphs (3-node triangle, disconnected components), singleton handling, empty graph, large random graphs, iteration limit.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:07.321629-06:00","updated_at":"2026-01-01T16:50:07.321629-06:00","dependencies":[{"issue_id":"engram-lgwc","depends_on_id":"engram-y2rur","type":"blocks","created_at":"2026-01-01T16:52:16.403758-06:00","created_by":"ccheney"}]}
{"id":"engram-lkijv","title":"Add tests for packages/tuner CLI and executor","description":"Missing tests for tuner package (11+ files):\n- cli/commands/*.ts (best, delete, importance, list, optimize, pareto, status)\n- client/tuner-client.ts\n- executor/trial-runner.ts, cache.ts, config-mapper.ts\n- spaces/engram.ts\n\nPriority: MEDIUM - Optimization tooling","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:21:02.327553-06:00","updated_at":"2026-01-01T17:21:02.327553-06:00"}
{"id":"engram-llff","title":"Migrate observatory to NATS","description":"Update observatory API route to use NATS instead of Kafka.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 4: Service Migration\n\n## Topic Mapping\n- raw_events → events.raw (publish only)\n\n## Implementation\n- Import createNatsClient from @engram/storage\n- Replace Kafka producer with NATS in /api/ingest route\n- Update environment variable from REDPANDA_BROKERS to NATS_URL\n\n## Acceptance Criteria\n- POST /api/ingest publishes to events.raw\n- Messages received by ingestion service","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:26:49.183132-05:00","updated_at":"2025-12-22T00:49:14.132228-05:00","closed_at":"2025-12-22T00:49:14.132228-05:00","dependencies":[{"issue_id":"engram-llff","depends_on_id":"engram-qgcm","type":"blocks","created_at":"2025-12-22T00:29:42.517751-05:00","created_by":"ccheney"},{"issue_id":"engram-llff","depends_on_id":"engram-3xez","type":"blocks","created_at":"2025-12-22T00:29:47.64998-05:00","created_by":"ccheney"}]}
{"id":"engram-llpq","title":"[Search-Py] Phase 2b: Rerankers","description":"Implement reranking tiers using rerankers library and sentence-transformers. Fast tier: FlashRank (ms-marco-MiniLM, ~10ms). Accurate tier: BGE-reranker-v2-m3 (~50ms). Code tier: jina-reranker-v2 (~50ms). ColBERT tier: RAGatouille rerank(). LLM tier: litellm with grok-4-1-fast-reasoning. Implement RerankerRouter for tier selection based on query complexity.\n\nReference: docs/plans/search-python-migration.md (Phase 3: Rerankers)\n\nDeliverables:\n- src/search/rerankers/base.py - Abstract reranker\n- src/search/rerankers/cross_encoder.py - FlashRank + BGE implementations\n- src/search/rerankers/colbert.py - RAGatouille MaxSim\n- src/search/rerankers/llm.py - LiteLLM listwise reranker\n- src/search/rerankers/router.py - Tier selection logic\n- src/search/utils/rate_limiter.py - LLM tier rate limiting\n- Unit tests for each reranker\n- Latency benchmarks (fast \u003c20ms, accurate \u003c100ms)\n\nCAN BE DEVELOPED IN PARALLEL WITH: [Search-Py] Phase 2a: Embedders","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:21:28.690855-06:00","updated_at":"2025-12-20T08:20:23.44632-06:00","closed_at":"2025-12-20T08:20:23.44632-06:00","dependencies":[{"issue_id":"engram-llpq","depends_on_id":"engram-b0r6","type":"blocks","created_at":"2025-12-20T07:22:41.74089-06:00","created_by":"ccheney"}]}
{"id":"engram-lls6","title":"Improve tests for apps/observatory/lib/websocket-server.ts (72% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:44.697322-05:00","updated_at":"2025-12-27T01:58:44.697322-05:00"}
{"id":"engram-lm57","title":"Improve /e prime prompt description","description":"Update apps/mcp/src/prompts/e-prime.ts with improved descriptions. Changes:\n- Main description: 'Initialize a work session with relevant context from memory. Retrieves: semantic matches to your task, related past decisions, and recent file modification history. Use this at the START of any significant task.'\n- task arg: Guide on specificity\n- depth arg: Match context tool depth descriptions\n\nReference: docs/plans/mcp-tool-descriptions.md#prompt-e-prime","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:32.979366-05:00","updated_at":"2025-12-25T01:00:46.573818-05:00","closed_at":"2025-12-25T01:00:46.573818-05:00"}
{"id":"engram-lo8i","title":"Create Admin Tools Panel","description":"Graph query executor, vector search tester, consumer reset, cache clear. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:32.229856-05:00","updated_at":"2025-12-27T18:19:04.282592-05:00","closed_at":"2025-12-27T18:19:04.282592-05:00","dependencies":[{"issue_id":"engram-lo8i","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:28:45.087702-05:00","created_by":"ccheney"}]}
{"id":"engram-ls6y","title":"[HIGH] Tool call ID type mismatch in events","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:51.144698-06:00","updated_at":"2025-12-20T23:59:09.151692-06:00","closed_at":"2025-12-20T23:59:09.151692-06:00"}
{"id":"engram-lu17","title":"Create deploy.sh script","description":"Create deployment script for pushing code to Hetzner VPS.\n\n## Location\n`scripts/deploy.sh`\n\n## Script content\n```bash\n#!/bin/bash\nset -e\n\nSERVER_IP=$(hcloud server ip engram)\n\nrsync -avz --exclude '.git' --exclude 'node_modules' --exclude '.venv' \\\n  . engram@$SERVER_IP:/opt/engram/\n\nssh engram@$SERVER_IP \u003c\u003c 'EOF'\n  cd /opt/engram\n  docker compose -f docker-compose.prod.yml pull\n  docker compose -f docker-compose.prod.yml build\n  docker compose -f docker-compose.prod.yml up -d\n  docker compose -f docker-compose.prod.yml ps\nEOF\n```\n\n## Acceptance Criteria\n- Script is executable\n- Syncs code to server\n- Builds and starts containers\n- Shows running container status","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:30:57.661812-06:00","updated_at":"2025-12-21T16:11:27.93255-06:00","closed_at":"2025-12-21T16:11:27.93255-06:00","dependencies":[{"issue_id":"engram-lu17","depends_on_id":"engram-kbrm","type":"blocks","created_at":"2025-12-21T15:33:13.392193-06:00","created_by":"ccheney"},{"issue_id":"engram-lu17","depends_on_id":"engram-gyik","type":"blocks","created_at":"2025-12-21T15:33:18.526013-06:00","created_by":"ccheney"}]}
{"id":"engram-lu2y","title":"[HIGH] Off-by-one in diff boundaries","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:38.950073-06:00","updated_at":"2025-12-20T23:59:12.686919-06:00","closed_at":"2025-12-20T23:59:12.686919-06:00"}
{"id":"engram-lzgs","title":"Create query builder generator (codegen)","description":"Implement query builder generation from schema in packages/graph/src/codegen/query-builder-generator.ts\n\n## Overview\nThis generator creates typed query builder classes for each node type. The generated builders extend BaseQueryBuilder and add node-specific convenience methods.\n\n## Requirements\n- Generate NodeQueryBuilder class for each node type\n- Include typed where() with node-specific conditions\n- Generate findById, asOf convenience static methods\n- Generate field-specific filter methods (whereType, whereTags, etc.)\n- Include traversal method stubs for edges\n- Integrate with generated types\n\n## Example Output\n```typescript\n// AUTO-GENERATED - DO NOT EDIT\n\nimport { BaseQueryBuilder } from '../runtime/base-query-builder';\nimport type { Memory, MemoryType } from './types';\n\nexport class MemoryQueryBuilder extends BaseQueryBuilder\u003cMemory\u003e {\n  protected nodeLabel = 'Memory';\n\n  whereType(type: MemoryType): this {\n    return this.where({ type });\n  }\n\n  whereTags(tag: string): this {\n    this.conditions.push({ field: 'tags', op: 'CONTAINS', value: tag });\n    return this;\n  }\n\n  whereProject(project: string): this {\n    return this.where({ project });\n  }\n\n  // Traversal stubs\n  mentions(): EntityQueryBuilder {\n    return new EntityQueryBuilder(this, 'MENTIONS', 'out');\n  }\n}\n\nexport const Memory = {\n  where(conditions: Partial\u003cMemory\u003e): MemoryQueryBuilder {\n    return new MemoryQueryBuilder().where(conditions);\n  },\n\n  findById(id: string): Promise\u003cMemory | null\u003e {\n    return new MemoryQueryBuilder()\n      .where({ id })\n      .whereCurrent()\n      .first();\n  },\n\n  asOf(id: string, timestamp: number): Promise\u003cMemory | null\u003e {\n    return new MemoryQueryBuilder()\n      .where({ id })\n      .asOf(timestamp)\n      .first();\n  },\n};\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'select query builder methods')`\n\nUse web search for:\n- 'Drizzle ORM query builder source code'\n- 'Kysely typed query builder implementation'\n- 'TypeScript code generation templates'\n- 'Fluent API code generation patterns'\n\n## Technical Considerations\n- Generate methods for each field type (enum gets whereX, array gets hasX)\n- Consider generating JSDoc comments from field descriptions\n- Handle edge traversal method generation\n- Maintain type safety through generics\n\n## Files\n- packages/graph/src/codegen/query-builder-generator.ts (NEW)\n\n## References\n- Drizzle select: https://orm.drizzle.team/docs/select\n- Kysely docs: https://kysely.dev/\n- Plan: docs/plans/compiled-query-layer.md lines 615-617","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:37.37161-06:00","updated_at":"2026-01-01T17:08:34.749526-06:00","dependencies":[{"issue_id":"engram-lzgs","depends_on_id":"engram-brmg","type":"blocks","created_at":"2026-01-01T16:55:07.319499-06:00","created_by":"ccheney"},{"issue_id":"engram-lzgs","depends_on_id":"engram-ojqv3","type":"blocks","created_at":"2026-01-01T16:55:12.453524-06:00","created_by":"ccheney"}]}
{"id":"engram-lzxj","title":"[Observatory Auth] Update dependencies - replace Clerk with Better Auth","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:39:41.44784-05:00","updated_at":"2025-12-22T00:51:52.638255-05:00","closed_at":"2025-12-22T00:51:52.638255-05:00"}
{"id":"engram-m3fk","title":"Wire RAGAS and latency metrics in benchmark pipeline","description":"packages/benchmark has 193 lines of latency metrics (latency.py) and 204 lines of RAGAS integration (ragas.py) that are never called from the pipeline. ragas_enabled config option is dead code.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:09:54.462355-06:00","updated_at":"2025-12-20T23:24:17.60574-06:00","closed_at":"2025-12-20T23:24:17.60574-06:00"}
{"id":"engram-m4ff","title":"[HIGH] Session update race condition in packages/graph","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:57.410046-06:00","updated_at":"2025-12-20T23:59:09.150396-06:00","closed_at":"2025-12-20T23:59:09.150396-06:00"}
{"id":"engram-m61kb","title":"Integration tests for decay calculation","description":"Create apps/worker/src/__tests__/decay-calculator.integration.test.ts. Test: create memories with different ages/types, run decay job, verify scores calculated correctly, verify recall ordering respects decay.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:25.632718-06:00","updated_at":"2026-01-01T16:50:25.632718-06:00","dependencies":[{"issue_id":"engram-m61kb","depends_on_id":"engram-uxiua","type":"blocks","created_at":"2026-01-01T16:52:34.996148-06:00","created_by":"ccheney"}]}
{"id":"engram-mc03f","title":"task","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:11.427267-06:00","updated_at":"2026-01-01T16:50:11.427267-06:00"}
{"id":"engram-mcr0","title":"Update MCP cloud service to use token cache","description":"Modify apps/mcp/src/services/cloud.ts to use TokenCache for auth headers instead of static API key. Trigger device flow if no valid cached token. Handle 401 responses by refreshing token and retrying. See docs/design/oauth-device-flow.md 'MCP Server UX' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:58.853168-05:00","updated_at":"2025-12-25T02:41:55.758902-05:00","closed_at":"2025-12-25T02:41:55.758902-05:00","dependencies":[{"issue_id":"engram-mcr0","depends_on_id":"engram-31wh","type":"blocks","created_at":"2025-12-25T02:22:06.548648-05:00","created_by":"ccheney"},{"issue_id":"engram-mcr0","depends_on_id":"engram-o3mv","type":"blocks","created_at":"2025-12-25T02:22:11.675909-05:00","created_by":"ccheney"},{"issue_id":"engram-mcr0","depends_on_id":"engram-f377","type":"blocks","created_at":"2025-12-25T02:22:16.797518-05:00","created_by":"ccheney"}]}
{"id":"engram-mcxc","title":"Run full test suite after TS7 upgrade","description":"Run npm test to ensure all tests pass after the TypeScript 7 upgrade","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:38:16.498894-06:00","updated_at":"2025-12-20T22:33:07.953588-06:00","closed_at":"2025-12-20T22:33:07.953588-06:00","dependencies":[{"issue_id":"engram-mcxc","depends_on_id":"engram-1p9y","type":"blocks","created_at":"2025-12-20T21:39:29.96086-06:00","created_by":"ccheney"}]}
{"id":"engram-mefkc","title":"Add embedding generation for entity resolution","description":"Integrate embedding generation for entity resolution with the Search service.\n\n## Requirements\n\n### Use Same Embedding Model\n- BGE model (384 dimensions) - same as memory embeddings\n- Ensures comparable similarity scores between entities and memories\n\n### Integration Points\n\n#### Option A: Search Service API\nCall apps/search embedding endpoint:\n```\nPOST /v1/search/embed\n{\"texts\": [\"PostgreSQL\"], \"model\": \"bge\"}\n```\n\n#### Option B: Direct Embedder\nUse EmbedderFactory from apps/search/src/embedders/\n\n### Caching Strategy\n- Store embedding in Entity.embedding field\n- Update embedding when description significantly changes\n- Batch embedding for efficiency (multiple entities at once)\n\n### Embedding Content\nGenerate embedding from concatenated:\n- Entity name\n- Entity description (if available)\n- Entity aliases (joined)\n\n## Implementation Reference\n- Search embedder: apps/search/src/embedders/\n- Search API routes: apps/search/src/api/router.py\n\n## Research\n- Entity embeddings for resolution: Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'embedding entity similarity'\n- BGE embedding model: Web search 'BGE embedding model entity resolution knowledge graph 2025'\n- Batch embedding optimization: Web search 'batch embedding API performance'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:01.810529-06:00","updated_at":"2026-01-01T18:33:49.380004-06:00","closed_at":"2026-01-01T18:33:49.380004-06:00","dependencies":[{"issue_id":"engram-mefkc","depends_on_id":"engram-o8f2j","type":"blocks","created_at":"2026-01-01T16:54:14.958876-06:00","created_by":"ccheney"},{"issue_id":"engram-mefkc","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:58.737299-06:00","created_by":"ccheney"}]}
{"id":"engram-mija","title":"[Benchmark-Py] Phase 5: Documentation \u0026 Release","description":"Complete documentation and prepare for release. CLI documentation with examples for all commands. API documentation for programmatic usage. Example Jupyter notebooks. TypeScript deprecation guide. Migration instructions for existing users.\n\nReference: docs/plans/benchmark-python-migration.md (Phase 7: Documentation)\n\nDeliverables:\n- README.md with quick start\n- CLI --help for all commands\n- API docs (docstrings + examples)\n- Example notebooks in examples/\n- Migration guide from TypeScript\n- CHANGELOG.md\n- PyPI package configuration","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:24:43.43761-06:00","updated_at":"2025-12-20T10:08:16.922846-06:00","closed_at":"2025-12-20T10:08:16.922846-06:00","dependencies":[{"issue_id":"engram-mija","depends_on_id":"engram-docr","type":"blocks","created_at":"2025-12-20T07:25:41.071097-06:00","created_by":"ccheney"}]}
{"id":"engram-mnli","title":"Update EmbedderFactory for HF backend toggle","description":"Modify EmbedderFactory to support switching between local and HuggingFace backends.\n\n## Location\n`apps/search/src/embedders/factory.py`\n\n## Changes\n1. Add backend detection from settings.embedder_backend\n2. If backend='huggingface':\n   - Import HuggingFaceEmbedder from clients.huggingface\n   - Return HF embedder instances instead of local\n3. If backend='local':\n   - Keep existing behavior (SentenceTransformer models)\n\n## Interface\n```python\nasync def get_text_embedder(self) -\u003e BaseEmbedder:\n    if self.settings.embedder_backend == 'huggingface':\n        return HuggingFaceEmbedder(\n            model_id=self.settings.embedder_text_model,\n            api_token=self.settings.hf_api_token\n        )\n    else:\n        return TextEmbedder(...)  # existing\n```\n\n## Acceptance Criteria\n- Factory returns correct embedder type based on EMBEDDER_BACKEND\n- Both backends work correctly\n- No breaking changes to existing API","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:32:06.081928-06:00","updated_at":"2025-12-21T16:13:51.626594-06:00","closed_at":"2025-12-21T16:13:51.626594-06:00","dependencies":[{"issue_id":"engram-mnli","depends_on_id":"engram-1qe2","type":"blocks","created_at":"2025-12-21T15:33:24.919154-06:00","created_by":"ccheney"},{"issue_id":"engram-mnli","depends_on_id":"engram-fs5a","type":"blocks","created_at":"2025-12-21T15:33:30.053056-06:00","created_by":"ccheney"}]}
{"id":"engram-mo3tv","title":"Add tests for apps/mcp tools and resources","description":"Missing tests for MCP server (30+ files):\n- tools/*.ts (remember, recall, context, summarize, etc.)\n- resources/*.ts (file-history, memory, session)\n- prompts/*.ts (decision-history, session-prime, session-recap)\n- auth/*.ts (device-flow, token-cache)\n- dedup/engine.ts\n- transport/http.ts, transport/stdio.ts\n- watcher/*.ts (jsonl-watcher, ingestion-bridge)\n\nPriority: HIGH - MCP server is primary agent interface","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:20:43.863818-06:00","updated_at":"2026-01-01T17:20:43.863818-06:00"}
{"id":"engram-mphj","title":"Add API key auth to ingestion service","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T22:21:09.910958-05:00","updated_at":"2025-12-22T22:28:45.404343-05:00","closed_at":"2025-12-22T22:28:45.404343-05:00"}
{"id":"engram-mrs7","title":"Remove deprecated BlobStore.read() method","description":"packages/storage blob.ts:69-72,184-187 has deprecated read() method. Update tests to use load() and remove read().\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:16.711378-06:00","updated_at":"2025-12-20T23:24:18.889096-06:00","closed_at":"2025-12-20T23:24:18.889096-06:00"}
{"id":"engram-msxe","title":"Remove unused qdrantUrl config from API","description":"apps/api config.ts:10 loads qdrantUrl but it is never used. Search goes through HTTP service at port 5002.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:14:57.575321-06:00","updated_at":"2025-12-20T23:22:12.873974-06:00","closed_at":"2025-12-20T23:22:12.873974-06:00"}
{"id":"engram-mvg7","title":"Remove mock data from ServerMetricsChart.tsx","description":"Remove generateMockData function and mock data fallback from ServerMetricsChart component (lines 73-125, 315-319). Replace with proper loading/error/no-data states.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:53:38.051657-05:00","updated_at":"2025-12-27T20:04:22.766423-05:00","closed_at":"2025-12-27T20:04:22.766423-05:00"}
{"id":"engram-mwha","title":"[CRITICAL] Session result index OOB in apps/search","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:06.641073-06:00","updated_at":"2025-12-20T23:45:30.484234-06:00","closed_at":"2025-12-20T23:45:30.484234-06:00"}
{"id":"engram-mxqa","title":"[CRITICAL] FalkorDB dbPromise never reset after disconnect","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:17.823156-06:00","updated_at":"2025-12-20T23:45:30.483145-06:00","closed_at":"2025-12-20T23:45:30.483145-06:00"}
{"id":"engram-mxs0","title":"Fix recall type filtering bypass","description":"Vector search results in apps/api/src/services/memory.ts:276-299 bypass type filtering. Graph fallback applies filter but has lower priority. Fix: add post-filtering after merge or pass type filter to Qdrant payload filter.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-27T01:43:24.608346-05:00","updated_at":"2025-12-27T01:44:48.112541-05:00","closed_at":"2025-12-27T01:44:48.112541-05:00"}
{"id":"engram-mzg7","title":"[HIGH] Race condition in applySearchReplace","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:26.732878-06:00","updated_at":"2025-12-20T23:59:12.687692-06:00","closed_at":"2025-12-20T23:59:12.687692-06:00"}
{"id":"engram-n40t","title":"Fix type filtering in recall - vector results not filtered","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-27T01:40:31.833538-05:00","updated_at":"2026-01-01T19:46:51.706846-06:00","closed_at":"2026-01-01T19:46:51.706846-06:00"}
{"id":"engram-n7ja","title":"Add job metrics and monitoring","description":"Create apps/worker/src/metrics.ts with Prometheus metrics: job_duration_seconds histogram, job_success_total counter, job_error_total counter, job_last_run_timestamp gauge. Expose on /metrics endpoint.\n\n## Metrics\n```typescript\n// Histogram for job duration\nconst jobDuration = new Histogram({\n  name: 'engram_worker_job_duration_seconds',\n  help: 'Duration of worker jobs',\n  labelNames: ['job_type', 'status'],\n  buckets: [0.1, 0.5, 1, 5, 10, 30, 60, 120],\n});\n\n// Counter for job outcomes\nconst jobTotal = new Counter({\n  name: 'engram_worker_job_total',\n  help: 'Total worker jobs by type and status',\n  labelNames: ['job_type', 'status'],\n});\n\n// Gauge for last run time\nconst lastRun = new Gauge({\n  name: 'engram_worker_job_last_run_timestamp',\n  help: 'Timestamp of last job run',\n  labelNames: ['job_type'],\n});\n```\n\n## Before Implementation\nUse Context7 MCP: Query 'prom-client' for TypeScript metric patterns.\n\n## References\n- prom-client: https://www.npmjs.com/package/prom-client\n- Existing metrics: apps/search/src/utils/metrics.py","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:59.680249-06:00","updated_at":"2026-01-01T18:21:37.440958-06:00","closed_at":"2026-01-01T18:21:37.440958-06:00"}
{"id":"engram-n8rt","title":"Fix Temporal Reasoning in Engram Benchmark","description":"Epic: Achieve \u003e0% accuracy on TR questions by fixing bitemporal persistence and wiring temporal filtering.\n\n## Problem\n- 0% accuracy on Temporal Reasoning questions\n- Bitemporal fields not properly set in FalkorDB\n- EngramRetriever doesn't use temporal filtering\n\n## Solution\n1. Fix persistence pipeline (vt_start/vt_end on Session/Turn nodes)\n2. Wire TemporalQueryEnhancer to EngramRetriever\n3. Preserve vt_start through ingestion\n\nSee: docs/temporal-reasoning-fix.md","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-27T11:24:44.896263-05:00","updated_at":"2025-12-27T11:24:44.896263-05:00"}
{"id":"engram-n9e2","title":"Update Search service auth to accept OAuth tokens","description":"Modify apps/search/src/middleware/auth.py to accept engram_oauth_ prefixed tokens. Mirror the TypeScript API changes - update regex pattern, add oauth_tokens table lookup. Ensure SHA-256 hashing matches TypeScript implementation. See docs/design/oauth-device-flow.md 'Token Format' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:43.761337-05:00","updated_at":"2025-12-25T02:46:16.20329-05:00","closed_at":"2025-12-25T02:46:16.20329-05:00","dependencies":[{"issue_id":"engram-n9e2","depends_on_id":"engram-g0sx","type":"blocks","created_at":"2025-12-25T02:21:34.389336-05:00","created_by":"ccheney"}]}
{"id":"engram-nddy","title":"Add Docker API integration","description":"lib/docker.ts - Container list, stats (CPU/memory/network), restart/stop actions via Unix socket","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:21:14.946454-05:00","updated_at":"2025-12-27T04:21:14.946454-05:00"}
{"id":"engram-nees3","title":"Unit tests for EntityResolverService","description":"Unit tests for EntityResolverService.\n\n## Test Cases\n\n### Exact Name Match\n```typescript\n// Setup: Entity 'PostgreSQL' exists\nconst result = await resolver.resolveOrCreate({name: 'PostgreSQL', type: 'technology'});\nexpect(result.isNew).toBe(false);\nexpect(result.entity.name).toBe('PostgreSQL');\n```\n\n### Alias Match\n```typescript\n// Setup: Entity 'PostgreSQL' with aliases: ['Postgres']\nconst result = await resolver.resolveOrCreate({name: 'pg', type: 'technology'});\n// Should match and add 'pg' to aliases\nexpect(result.isNew).toBe(false);\nexpect(result.entity.aliases).toContain('pg');\n```\n\n### Embedding-Based Resolution\n```typescript\n// Mock embedding similarity \u003e 0.9\nconst result = await resolver.resolveOrCreate({name: 'Postgres DB', type: 'technology'});\n// Should match existing PostgreSQL\nexpect(result.isNew).toBe(false);\n```\n\n### LLM Confirmation\n- Mock ambiguous similarity (0.85-0.9)\n- Verify LLM confirmation is called\n- Test both confirm and reject paths\n\n### New Entity Creation\n```typescript\nconst result = await resolver.resolveOrCreate({name: 'Kubernetes', type: 'tool'});\nexpect(result.isNew).toBe(true);\nexpect(result.entity.name).toBe('Kubernetes');\n```\n\n### Project Scoping\n- Entity 'auth' in project A\n- Different 'auth' in project B\n- Verify isolation\n\n## Mocking\n```typescript\nconst mockEntityRepo = {\n  findByName: vi.fn(),\n  findByEmbedding: vi.fn(),\n  create: vi.fn(),\n  merge: vi.fn(),\n};\n```\n\n## Research\n- Entity resolution testing: Web search 'entity resolution unit test patterns 2025'\n- EAGER test cases: https://arxiv.org/abs/2101.06126","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:45.240424-06:00","updated_at":"2026-01-01T17:09:37.831771-06:00","dependencies":[{"issue_id":"engram-nees3","depends_on_id":"engram-28pq4","type":"blocks","created_at":"2026-01-01T16:55:52.149057-06:00","created_by":"ccheney"},{"issue_id":"engram-nees3","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:34.760198-06:00","created_by":"ccheney"}]}
{"id":"engram-nhc2","title":"[Observatory Auth] Set up Google OAuth credentials","description":"Set up Google OAuth credentials in Google Cloud Console. Reference: docs/observatory-auth-implementation-plan.md Step 14. Steps: 1) Go to Google Cloud Console, 2) Create/select project, 3) Navigate to APIs and Services \u003e Credentials, 4) Create OAuth client ID (Web application), 5) Add authorized redirect URIs: http://localhost:5000/api/auth/callback/google (dev), https://observatory.statient.com/api/auth/callback/google (prod), 6) Copy Client ID and Secret to environment variables. This is a manual setup task that can be done in parallel with code changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:42:28.968946-05:00","updated_at":"2025-12-22T01:00:00.79091-05:00","closed_at":"2025-12-22T01:00:00.79091-05:00"}
{"id":"engram-nkpk","title":"Remove orphaned Qdrant record test-memory-123","description":"Record test-memory-123 exists in Qdrant but not in FalkorDB graph. Indicates dual-write inconsistency.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-27T01:43:31.602058-05:00","updated_at":"2025-12-27T01:45:45.62259-05:00","closed_at":"2025-12-27T01:45:45.62259-05:00"}
{"id":"engram-nmx7","title":"Test coverage: apps/observatory/lib/graph-queries.ts (branches 79%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:28.230909-06:00","updated_at":"2025-12-21T04:07:03.764544-06:00","closed_at":"2025-12-21T04:07:03.764544-06:00"}
{"id":"engram-nnmx","title":"Update token introspection response","description":"Add org_id and org_slug to RFC 7662 introspection response.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'OAuth Token Structure' section (lines 382-396)\n\n## Implementation\nUpdate apps/observatory/app/api/auth/introspect/route.ts:\n- Include org_id in introspection response\n- Include org_slug in introspection response\n- These are custom claims per RFC 7662\n\n## Response Format:\n```json\n{\n  \"active\": true,\n  \"sub\": \"user_id\",\n  \"scope\": \"memory:read memory:write\",\n  \"org_id\": \"01JGXYZ123ABC456DEF789\",\n  \"org_slug\": \"acme\"\n}\n```\n\n## Files to Modify\n- apps/observatory/app/api/auth/introspect/route.ts\n\n## Agent Instructions\nWeb search 'RFC 7662 token introspection custom claims' for compliance guidance.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:54.678957-06:00","updated_at":"2025-12-29T22:41:05.556481-06:00","closed_at":"2025-12-29T22:41:05.556481-06:00","dependencies":[{"issue_id":"engram-nnmx","depends_on_id":"engram-4u86","type":"blocks","created_at":"2025-12-29T22:13:02.717305-06:00","created_by":"ccheney"},{"issue_id":"engram-nnmx","depends_on_id":"engram-gkcl","type":"blocks","created_at":"2025-12-29T22:13:11.853617-06:00","created_by":"ccheney"}]}
{"id":"engram-no8d","title":"Implement recursive mkdir in VFS","description":"packages/vfs/src/vfs.ts:35-37 - Current mkdir() only handles single-level directory creation. Need full path traversal for nested directories","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T16:22:39.376559-06:00","updated_at":"2025-12-20T19:18:04.835742-06:00","closed_at":"2025-12-20T19:18:04.835742-06:00"}
{"id":"engram-npu8","title":"Create Alert Configuration UI","description":"Alert rules CRUD, notification channels config (Slack, email). MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:26.19592-05:00","updated_at":"2025-12-27T18:24:26.105666-05:00","closed_at":"2025-12-27T18:24:26.105666-05:00","dependencies":[{"issue_id":"engram-npu8","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:28:39.96405-05:00","created_by":"ccheney"}]}
{"id":"engram-nr5u","title":"Create OpenTofu project structure","description":"Initialize OpenTofu project with Hetzner provider.\n\n## Files to create\n```\npackages/infra/\n├── versions.tf      # OpenTofu and provider versions\n├── providers.tf     # Hetzner provider config\n├── variables.tf     # Input variables\n├── outputs.tf       # Output values\n└── tests/           # Test directory\n```\n\n## versions.tf\n```hcl\nterraform {\n  required_version = \"\u003e= 1.8.0\"\n  required_providers {\n    hcloud = {\n      source  = \"opentofu/hcloud\"\n      version = \"~\u003e 1.53\"\n    }\n  }\n}\n```\n\n## Steps\n1. Create directory structure\n2. Write versions.tf with Hetzner provider\n3. Write providers.tf\n4. Write variables.tf (hcloud_token, server_name, etc.)\n5. Run `tofu init`\n\n## Acceptance Criteria\n- `tofu init` succeeds\n- `tofu validate` passes","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:49:08.841177-06:00","updated_at":"2025-12-21T15:49:08.841177-06:00","dependencies":[{"issue_id":"engram-nr5u","depends_on_id":"engram-gl3u","type":"blocks","created_at":"2025-12-21T15:51:00.354971-06:00","created_by":"ccheney"}]}
{"id":"engram-nroma","title":"Load tests for intelligence layer","description":"Create apps/worker/src/__tests__/load.test.ts. Test: community detection on 10K entities, decay calculation on 100K memories, conflict scan on 50K memories. Measure and assert latency thresholds.\n\n## Test Scenarios\n```typescript\ndescribe('Load Tests', () =\u003e {\n  test('community detection 10K entities', async () =\u003e {\n    // Setup: Create 10K entities with random relationships\n    // Assert: Completes in \u003c 30 seconds\n    // Assert: Creates reasonable number of communities (100-500)\n  });\n  \n  test('decay calculation 100K memories', async () =\u003e {\n    // Setup: Create 100K memories with varied ages/types\n    // Assert: Completes in \u003c 60 seconds\n    // Assert: All scores calculated correctly\n  });\n  \n  test('conflict scan 50K memories', async () =\u003e {\n    // Setup: Create 50K memories, 5% with conflicts\n    // Assert: Completes in \u003c 5 minutes\n    // Assert: Detects \u003e 90% of seeded conflicts\n  });\n});\n```\n\n## Test Infrastructure\n- Use test FalkorDB instance\n- Seed data generators with configurable size\n- Track memory usage and CPU time\n\n## Before Implementation\nReview existing integration tests: packages/graph/src/__tests__/\nReview Bun test timeout configuration.\n\n## References\n- Bun test runner: https://bun.sh/docs/cli/test\n- Test fixtures: packages/common/src/testing/","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:37.595356-06:00","updated_at":"2026-01-01T17:11:51.525404-06:00","dependencies":[{"issue_id":"engram-nroma","depends_on_id":"engram-htgl2","type":"blocks","created_at":"2026-01-01T16:52:46.891476-06:00","created_by":"ccheney"},{"issue_id":"engram-nroma","depends_on_id":"engram-uxiua","type":"blocks","created_at":"2026-01-01T16:52:52.830711-06:00","created_by":"ccheney"},{"issue_id":"engram-nroma","depends_on_id":"engram-cq83y","type":"blocks","created_at":"2026-01-01T16:52:58.720574-06:00","created_by":"ccheney"}]}
{"id":"engram-nsgt","title":"[HIGH] Race condition in embedder factory","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:13.343578-06:00","updated_at":"2025-12-21T00:00:08.277037-06:00","closed_at":"2025-12-21T00:00:08.277037-06:00"}
{"id":"engram-nsvn","title":"Add Page Visibility API handling to useWebSocket","description":"## Problem\n\nThe `useWebSocket` hook at `apps/interface/app/hooks/useWebSocket.ts` does not handle browser tab visibility changes. When a tab goes to background, browsers may throttle or close WebSocket connections, but the hook doesn't automatically reconnect when the tab becomes visible again.\n\n## Browser Behavior\n\nModern browsers implement resource conservation for background tabs:\n\n1. **Throttling**: Background tabs have reduced timer resolution and may throttle network activity\n2. **Connection drops**: Some users report WebSocket connections dropping regularly (e.g., every 3 minutes) after 5 minutes in background\n3. **No automatic recovery**: When the tab becomes visible, the connection may remain in a stale state\n\nWhile MDN notes that 'tabs running code that's using real-time network connections (WebSockets and WebRTC) go unthrottled,' real-world experience shows connections still drop in background tabs.\n\n## Recommended Solution\n\nUse the Page Visibility API to detect tab visibility changes and trigger reconnection:\n\n```typescript\nuseEffect(() =\u003e {\n  const handleVisibilityChange = () =\u003e {\n    if (document.visibilityState === 'visible') {\n      // Tab became visible - check connection health\n      if (wsRef.current?.readyState !== WebSocket.OPEN) {\n        // Connection is not open, trigger reconnect\n        manualReconnect();\n      }\n    }\n  };\n\n  document.addEventListener('visibilitychange', handleVisibilityChange);\n  return () =\u003e {\n    document.removeEventListener('visibilitychange', handleVisibilityChange);\n  };\n}, [manualReconnect]);\n```\n\n### Optional Enhancement\n\nAdd a small delay before disconnecting when going to background, to avoid unnecessary churn for brief tab switches:\n\n```typescript\n// Don't disconnect immediately - user might return quickly\nconst BACKGROUND_GRACE_PERIOD = 30000; // 30 seconds\n```\n\n## References\n\n- [Page Visibility API - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API)\n- [Supabase Realtime WebSocket background tab issue](https://github.com/supabase/realtime-js/issues/121)\n- [How to Avoid Multiple WebSocket Connections in React](https://getstream.io/blog/websocket-connections-react/)\n- [Panel WebSocket reconnection discussion](https://github.com/holoviz/panel/issues/6584)\n\n## Priority\n\nMedium - Important for applications where users frequently switch tabs but expect real-time updates when returning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T20:41:32.908713-06:00","updated_at":"2025-12-20T23:07:49.465709-06:00","closed_at":"2025-12-20T23:07:49.465709-06:00"}
{"id":"engram-nukwv","title":"Implement conflict webhook notifications","description":"Add notifyConflicts method to ConflictScanner that POSTs to configurable webhook URL when conflicts detected. Include project, count, and conflict summaries. Store webhook URLs per org in config or database.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:38.725278-06:00","updated_at":"2026-01-01T16:51:38.725278-06:00","dependencies":[{"issue_id":"engram-nukwv","depends_on_id":"engram-r5tjq","type":"blocks","created_at":"2026-01-01T16:53:09.574713-06:00","created_by":"ccheney"}]}
{"id":"engram-nyfb","title":"Create Version Matrix component","description":"Grid showing current vs latest versions for all services with update status. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:20.149573-05:00","updated_at":"2025-12-27T17:05:37.439165-05:00","closed_at":"2025-12-27T17:05:37.439165-05:00","dependencies":[{"issue_id":"engram-nyfb","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:27:15.48528-05:00","created_by":"ccheney"}]}
{"id":"engram-nzpj","title":"Test coverage: packages/common/src/errors/base.ts (58%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:46.420336-06:00","updated_at":"2025-12-21T04:07:03.759789-06:00","closed_at":"2025-12-21T04:07:03.759789-06:00"}
{"id":"engram-o0y7p","title":"Create main generator entry point","description":"Implement main code generation entry point in packages/graph/src/codegen/generator.ts\n\n## Overview\nThe main generator orchestrates all code generation from the schema. It coordinates the types, query builders, repositories, validators, and MCP generators to produce a complete set of generated files.\n\n## Requirements\n- Orchestrate all generators (types, query builders, repositories, validators, MCP)\n- Accept schema as input\n- Return generated code as object with file paths and content\n- Support dry-run mode for testing\n- Generate AUTO-GENERATED header comments with timestamps\n- Handle file writing to output directory\n\n## API Design\n```typescript\nimport type { Schema } from '../schema';\n\nexport interface GeneratedFile {\n  path: string;\n  content: string;\n}\n\nexport interface GenerateOptions {\n  schema: Schema;\n  outputDir?: string;\n  dryRun?: boolean;\n}\n\nexport interface GeneratedCode {\n  files: GeneratedFile[];\n  summary: {\n    types: number;\n    queryBuilders: number;\n    repositories: number;\n    validators: number;\n    mcpTools: number;\n  };\n}\n\nexport async function generate(options: GenerateOptions): Promise\u003cGeneratedCode\u003e {\n  const { schema, outputDir = 'src/generated', dryRun = false } = options;\n  \n  const files: GeneratedFile[] = [\n    { path: 'types.ts', content: generateTypes(schema) },\n    { path: 'query-builders.ts', content: generateQueryBuilders(schema) },\n    { path: 'repositories.ts', content: generateRepositories(schema) },\n    { path: 'validators.ts', content: generateValidators(schema) },\n    { path: 'mcp-tools.ts', content: generateMcpTools(schema) },\n    { path: 'index.ts', content: generateBarrelExport(schema) },\n  ];\n  \n  if (!dryRun) {\n    await writeFiles(outputDir, files);\n  }\n  \n  return { files, summary: { ... } };\n}\n```\n\n## Research Required\nUse web search for:\n- 'Prisma generate command implementation'\n- 'Drizzle-kit generate workflow'\n- 'TypeScript code generator architecture'\n- 'Bun file system write patterns'\n\n## Technical Considerations\n- Ensure idempotent generation (same schema → same output)\n- Include checksums to detect manual modifications\n- Consider generating a schema.lock file\n- Support incremental generation if possible\n\n## Files\n- packages/graph/src/codegen/generator.ts (NEW)\n- packages/graph/src/codegen/index.ts (barrel export)\n\n## References\n- Prisma generate: https://www.prisma.io/docs/concepts/components/prisma-client/working-with-prismaclient/generating-prisma-client\n- Drizzle-kit: https://orm.drizzle.team/kit-docs/overview\n- Plan: docs/plans/compiled-query-layer.md lines 600-625","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:13.743385-06:00","updated_at":"2026-01-01T17:10:33.677482-06:00","dependencies":[{"issue_id":"engram-o0y7p","depends_on_id":"engram-brmg","type":"blocks","created_at":"2026-01-01T16:55:31.506464-06:00","created_by":"ccheney"},{"issue_id":"engram-o0y7p","depends_on_id":"engram-lzgs","type":"blocks","created_at":"2026-01-01T16:55:36.65043-06:00","created_by":"ccheney"},{"issue_id":"engram-o0y7p","depends_on_id":"engram-0wlo","type":"blocks","created_at":"2026-01-01T16:55:41.801351-06:00","created_by":"ccheney"},{"issue_id":"engram-o0y7p","depends_on_id":"engram-gbem","type":"blocks","created_at":"2026-01-01T16:55:46.962231-06:00","created_by":"ccheney"},{"issue_id":"engram-o0y7p","depends_on_id":"engram-ic8y5","type":"blocks","created_at":"2026-01-01T16:55:52.1083-06:00","created_by":"ccheney"}]}
{"id":"engram-o1qml","title":"Integrate entity extraction into remember tool","description":"Update apps/mcp/src/tools/remember.ts to integrate entity extraction.\n\n## Integration Point\nAfter memory creation and conflict detection passes, add entity extraction flow.\n\n## Implementation Flow\n\n```typescript\n// 1. Extract entities from memory content\nconst extraction = await entityExtractor.extract(\n  input.content,\n  input.type ?? 'context',\n  await getRecentEntityNames(tenant?.project)\n);\n\n// 2. Resolve and link each entity\nfor (const extracted of extraction.entities) {\n  const { entity, isNew } = await entityResolver.resolveOrCreate(\n    extracted,\n    tenant?.project\n  );\n  \n  // 3. Create MENTIONS edge with bitemporal fields\n  await entityRepo.createMentionsEdge(\n    memory.id,\n    entity.id,\n    extracted.context\n  );\n  \n  // 4. Update statistics\n  await entityRepo.incrementMentionCount(entity.id);\n}\n\n// 5. Create inter-entity relationships\nfor (const rel of extraction.relationships) {\n  // ... create RELATED_TO, DEPENDS_ON edges\n}\n```\n\n## Logging\nAdd structured logging for:\n- entities_extracted: number\n- entities_created: number (isNew = true)\n- entities_linked: number (isNew = false)\n- relationships_created: number\n- extraction_model: 'sampling' | 'gemini'\n- extraction_took_ms: number\n\n## Error Handling\nEntity extraction should NOT fail the remember operation.\nLog errors and continue if extraction fails.\n\n## Implementation Reference\n- Current remember tool: apps/mcp/src/tools/remember.ts\n- Logging patterns: packages/logger/\n\n## Research\n- Graphiti add_episode flow: Use Context7 MCP `query-docs` with '/getzep/graphiti' for 'add_episode entity extraction'\n- Error handling patterns: Web search 'graceful degradation LLM extraction failure'","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:07.776441-06:00","updated_at":"2026-01-01T17:09:00.352058-06:00","dependencies":[{"issue_id":"engram-o1qml","depends_on_id":"engram-28pq4","type":"blocks","created_at":"2026-01-01T16:54:59.36523-06:00","created_by":"ccheney"},{"issue_id":"engram-o1qml","depends_on_id":"engram-r49xm","type":"blocks","created_at":"2026-01-01T16:55:05.871314-06:00","created_by":"ccheney"},{"issue_id":"engram-o1qml","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:03.873933-06:00","created_by":"ccheney"}]}
{"id":"engram-o3mv","title":"Create MCP device flow client","description":"Create apps/mcp/src/auth/device-flow.ts with functions: startDeviceFlow() to request device code from Observatory, pollForToken() with exponential backoff respecting interval, refreshToken() for token refresh, openBrowser() to open verification URL (macOS: open, Linux: xdg-open, Windows: start). See docs/design/oauth-device-flow.md 'MCP Server UX' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:39.18301-05:00","updated_at":"2025-12-25T02:39:34.178993-05:00","closed_at":"2025-12-25T02:39:34.178993-05:00","dependencies":[{"issue_id":"engram-o3mv","depends_on_id":"engram-oce5","type":"blocks","created_at":"2025-12-25T02:21:46.055962-05:00","created_by":"ccheney"},{"issue_id":"engram-o3mv","depends_on_id":"engram-t6x9","type":"blocks","created_at":"2025-12-25T02:21:51.18182-05:00","created_by":"ccheney"}]}
{"id":"engram-o4hr","title":"Test coverage: apps/mcp/src/capabilities/sampling.ts (97%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:10.71273-06:00","updated_at":"2025-12-21T04:07:03.768924-06:00","closed_at":"2025-12-21T04:07:03.768924-06:00"}
{"id":"engram-o8f2j","title":"Define EntityRepository interface","description":"Create packages/graph/src/repositories/entity.repository.ts interface.\n\n## Required Methods\n\n### CRUD Operations\n- findById(id: string): Promise\u003cEntity | null\u003e\n- findByName(name: string, project?: string): Promise\u003cEntity | null\u003e\n- findByType(type: EntityType, project?: string): Promise\u003cEntity[]\u003e\n- create(input: CreateEntityInput): Promise\u003cEntity\u003e\n- merge(existingId: string, newData: Partial\u003cEntity\u003e): Promise\u003cEntity\u003e\n- incrementMentionCount(id: string): Promise\u003cvoid\u003e\n\n### Similarity Search\n- findByEmbedding(embedding: number[], limit: number, threshold: number): Promise\u003cEntity[]\u003e\n\n### Edge Operations\n- createMentionsEdge(memoryId: string, entityId: string, context?: string): Promise\u003cvoid\u003e\n- createRelationship(fromId: string, toId: string, type: string, props?: Record\u003cstring, any\u003e): Promise\u003cvoid\u003e\n\n### Graph Traversal\n- findRelatedEntities(id: string, depth: number): Promise\u003cEntity[]\u003e\n- findMentioningMemories(id: string): Promise\u003cMemory[]\u003e\n\n## Implementation Reference\n- Follow MemoryRepository pattern in packages/graph/src/repositories/memory.repository.ts\n- Support TenantContext for multi-tenancy\n\n## Research\n- Repository pattern in TypeScript: Web search 'TypeScript repository pattern graph database 2025'\n- Use Context7 MCP for FalkorDB query patterns: `query-docs` with '/websites/falkordb' for 'MATCH RETURN node traversal'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:51:24.595201-06:00","updated_at":"2026-01-01T18:18:12.362541-06:00","closed_at":"2026-01-01T18:18:12.362541-06:00","dependencies":[{"issue_id":"engram-o8f2j","depends_on_id":"engram-ezn34","type":"blocks","created_at":"2026-01-01T16:53:43.447006-06:00","created_by":"ccheney"},{"issue_id":"engram-o8f2j","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:56:32.990147-06:00","created_by":"ccheney"}]}
{"id":"engram-o9sa","title":"Create real-time log streaming","description":"Use @engram/websocket to stream logs from Docker containers to UI via NATS pub/sub","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:38.424765-05:00","updated_at":"2025-12-27T17:28:41.932333-05:00","closed_at":"2025-12-27T17:28:41.932333-05:00","dependencies":[{"issue_id":"engram-o9sa","depends_on_id":"engram-39l8","type":"blocks","created_at":"2025-12-27T04:28:09.618237-05:00","created_by":"ccheney"}]}
{"id":"engram-oce5","title":"Implement POST /api/auth/device endpoint","description":"Create apps/observatory/app/api/auth/device/route.ts - POST handler that generates device_code (32 random chars) and user_code (XXXX-XXXX format). Store in device_codes table with 15-minute expiration. Return RFC 8628 compliant response with verification_uri pointing to /activate. See docs/design/oauth-device-flow.md 'Generate Device Code' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:39.900352-05:00","updated_at":"2025-12-25T02:32:44.623422-05:00","closed_at":"2025-12-25T02:32:44.623422-05:00","dependencies":[{"issue_id":"engram-oce5","depends_on_id":"engram-cgk8","type":"blocks","created_at":"2025-12-25T02:21:02.917998-05:00","created_by":"ccheney"}]}
{"id":"engram-odmj","title":"Test coverage: apps/ingestion/src/index.ts (37%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:52.572114-06:00","updated_at":"2025-12-21T04:07:03.757765-06:00","closed_at":"2025-12-21T04:07:03.757765-06:00"}
{"id":"engram-ofhv","title":"[MEDIUM] No bitemporal fields in event schemas","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:45.084183-06:00","updated_at":"2025-12-21T00:09:56.478078-06:00","closed_at":"2025-12-21T00:09:56.478078-06:00"}
{"id":"engram-ofzcp","title":"Integration tests for semantic enhancement","description":"End-to-end integration tests for semantic enhancement layer.\n\n## Test Scenarios\n\n### Scenario 1: Entity Creation on Remember\n```typescript\n// 1. Create memory mentioning PostgreSQL\nawait mcp.remember({\n  content: 'We use PostgreSQL for the user database',\n  type: 'decision'\n});\n\n// 2. Verify Entity node created\nconst entity = await entityRepo.findByName('PostgreSQL');\nexpect(entity).not.toBeNull();\nexpect(entity.type).toBe('technology');\n\n// 3. Verify MENTIONS edge created\nconst memories = await entityRepo.findMentioningMemories(entity.id);\nexpect(memories.length).toBe(1);\n```\n\n### Scenario 2: Entity Resolution (Deduplication)\n```typescript\n// 1. Create memory with 'PostgreSQL'\nawait mcp.remember({content: 'PostgreSQL is our primary database'});\n\n// 2. Create memory with 'Postgres' (alias)\nawait mcp.remember({content: 'Postgres handles 10k QPS'});\n\n// 3. Verify single entity with alias\nconst entities = await entityRepo.findByType('technology');\nconst pgEntity = entities.find(e =\u003e e.name === 'PostgreSQL');\nexpect(pgEntity.aliases).toContain('Postgres');\nexpect(pgEntity.mention_count).toBe(2);\n```\n\n### Scenario 3: Graph-Aware Recall\n```typescript\n// 1. Create memories about auth and OAuth\nawait mcp.remember({content: 'OAuth 2.0 for authentication'});\nawait mcp.remember({content: 'JWT tokens for session management'});\n\n// 2. Create relationship (OAuth RELATED_TO authentication)\n// (This happens automatically via extraction)\n\n// 3. Query for 'authentication'\nconst results = await mcp.recall({query: 'authentication'});\n\n// 4. Verify OAuth-related memories returned\nexpect(results.some(r =\u003e r.content.includes('OAuth'))).toBe(true);\nexpect(results.some(r =\u003e r.content.includes('JWT'))).toBe(true);\n```\n\n### Scenario 4: Cross-Entity Relationship Discovery\n- Create 'React' mentions\n- Create 'Node.js' mentions with 'React depends on Node.js'\n- Verify DEPENDS_ON edge created\n- Query for 'React' returns Node.js-related memories\n\n## Test Infrastructure\n- Use real FalkorDB (docker-compose.test.yml)\n- Use real Search service or mock\n- Clean database between tests\n\n## Research\n- Integration testing patterns: Web search 'knowledge graph integration testing 2025'\n- MCP testing: Review existing apps/mcp tests","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:57.868806-06:00","updated_at":"2026-01-01T17:09:52.106931-06:00","dependencies":[{"issue_id":"engram-ofzcp","depends_on_id":"engram-o1qml","type":"blocks","created_at":"2026-01-01T16:56:04.886215-06:00","created_by":"ccheney"},{"issue_id":"engram-ofzcp","depends_on_id":"engram-kve0y","type":"blocks","created_at":"2026-01-01T16:56:10.85564-06:00","created_by":"ccheney"},{"issue_id":"engram-ofzcp","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:45.072627-06:00","created_by":"ccheney"}]}
{"id":"engram-ojqv3","title":"Create base query builder runtime","description":"Implement base query builder class in packages/graph/src/runtime/base-query-builder.ts\n\n## Overview\nThe BaseQueryBuilder provides the runtime foundation for all generated query builders. It handles condition accumulation, parameter management, Cypher generation, and query execution against FalkorDB.\n\n## Requirements\n- Abstract BaseQueryBuilder\u003cT\u003e class with node label property\n- where() method accepting typed partial conditions\n- whereCurrent() adding tt_end = MAX_DATE filter\n- whereValid() adding vt_end = MAX_DATE filter\n- asOf(timestamp) for bitemporal point-in-time queries\n- limit(n), offset(n), orderBy(field, direction) methods\n- execute() → Promise\u003cT[]\u003e for query execution\n- first() → Promise\u003cT | null\u003e convenience method\n- count() → Promise\u003cnumber\u003e for counting matches\n- toCypher() → string for debugging/logging\n\n## API Design\n```typescript\nexport abstract class BaseQueryBuilder\u003cT extends BaseNode\u003e {\n  protected abstract nodeLabel: string;\n  protected conditions: Condition[] = [];\n  protected params: Record\u003cstring, unknown\u003e = {};\n  protected _limit?: number;\n  protected _offset?: number;\n  protected _orderBy?: { field: keyof T; direction: 'ASC' | 'DESC' };\n\n  where(conditions: Partial\u003cT\u003e): this { ... }\n  whereCurrent(): this { ... }\n  whereValid(): this { ... }\n  asOf(timestamp: number): this { ... }\n  limit(n: number): this { ... }\n  orderBy(field: keyof T, direction?: 'ASC' | 'DESC'): this { ... }\n  \n  async execute(): Promise\u003cT[]\u003e { ... }\n  async first(): Promise\u003cT | null\u003e { ... }\n  async count(): Promise\u003cnumber\u003e { ... }\n  \n  protected toCypher(): string { ... }\n  protected toCountCypher(): string { ... }\n}\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- `query-docs('/drizzle-team/drizzle-orm-docs', 'query builder select where')`\n\nUse web search for:\n- 'TypeScript fluent API builder pattern'\n- 'Kysely query builder implementation'\n- 'Cypher query builder JavaScript'\n- 'Neo4j JavaScript driver parameterized queries'\n- '@neo4j/cypher-builder npm'\n\nReview existing code:\n- packages/graph/src/queries/builder.ts (current QueryBuilder)\n- packages/graph/src/repositories/falkor-base.ts (base repository)\n\n## Technical Considerations\n- Use unique parameter names to avoid collisions (e.g., $p0, $p1)\n- Handle null/undefined in conditions appropriately\n- Support both equality and comparison operators\n- Integrate with TenantAwareFalkorClient for multi-tenancy\n- Consider lazy client initialization\n\n## Files\n- packages/graph/src/runtime/base-query-builder.ts (NEW)\n- packages/graph/src/runtime/types.ts (NEW - Condition, etc.)\n- packages/graph/src/runtime/index.ts (barrel export)\n\n## References\n- Existing QueryBuilder: packages/graph/src/queries/builder.ts\n- Drizzle query builder: https://orm.drizzle.team/docs/select\n- Kysely: https://kysely.dev/docs/category/query-builder\n- cypher-query-builder: https://github.com/jamesfer/cypher-query-builder\n- Plan: docs/plans/compiled-query-layer.md lines 627-714","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:47.13763-06:00","updated_at":"2026-01-01T17:07:30.194153-06:00"}
{"id":"engram-okfbx","title":"Add decay metadata fields to Memory model","description":"Update MemoryNodeSchema in packages/graph/src/models/nodes.ts to add: last_accessed (timestamp), access_count (number), decay_score (0-1), decay_updated_at (timestamp), pinned (boolean). Defaults: access_count=0, decay_score=1.0, pinned=false.\n\n## Schema Changes\n```typescript\nexport const MemoryNodeSchema = z.object({\n  // ... existing fields ...\n  \n  // NEW: Decay metadata\n  last_accessed: z.number().optional(),      // Last recall timestamp\n  access_count: z.number().default(0),       // Times returned in recall\n  decay_score: z.number().min(0).max(1).default(1.0), // 0=fully decayed, 1=fresh\n  decay_updated_at: z.number().optional(),   // Last decay calculation\n  pinned: z.boolean().default(false),        // Exempt from decay\n});\n```\n\n## Migration Strategy\n- New fields are optional/have defaults - no migration needed for existing data\n- decay_score defaults to 1.0 (fresh) for existing memories\n- First decay job will calculate scores for all memories\n\n## Before Implementation\nReview MemoryNodeSchema: packages/graph/src/models/nodes.ts\nCheck FalkorDB property handling for new fields.\n\n## References\n- Memory model: packages/graph/src/models/nodes.ts\n- Repository: packages/graph/src/repositories/falkor-memory.repository.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:44.570846-06:00","updated_at":"2026-01-01T17:08:43.794027-06:00"}
{"id":"engram-olof","title":"Temporal: Implement missing tool replay handlers","description":"packages/temporal/src/replay.ts:148 - Error message indicates tool replay is not implemented for some tools. Need to add replay handlers for all supported tools.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T04:03:05.513389-05:00","updated_at":"2025-12-22T04:10:10.740836-05:00","closed_at":"2025-12-22T04:10:10.740836-05:00"}
{"id":"engram-omat","title":"Initial server setup - Docker and firewall","description":"Configure new Hetzner VPS with Docker and security basics.\n\n## Steps\n1. SSH in: `hcloud server ssh engram`\n2. Create user: `adduser engram \u0026\u0026 usermod -aG sudo engram`\n3. Copy SSH keys: `cp -r ~/.ssh /home/engram/ \u0026\u0026 chown -R engram:engram /home/engram/.ssh`\n4. Configure firewall:\n   ```bash\n   ufw allow OpenSSH\n   ufw allow 80/tcp\n   ufw allow 443/tcp\n   ufw enable\n   ```\n5. Install Docker:\n   ```bash\n   curl -fsSL https://get.docker.com | sh\n   usermod -aG docker engram\n   apt install docker-compose-plugin\n   ```\n6. Reboot: `reboot`\n\n## Acceptance Criteria\n- engram user can SSH in\n- Docker is installed and engram user can run docker commands\n- UFW firewall is active with correct rules","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:30:51.377851-06:00","updated_at":"2025-12-21T15:48:31.689995-06:00","closed_at":"2025-12-21T15:48:31.689995-06:00","dependencies":[{"issue_id":"engram-omat","depends_on_id":"engram-rpet","type":"blocks","created_at":"2025-12-21T15:34:27.871074-06:00","created_by":"ccheney"}]}
{"id":"engram-oo6r","title":"Semantic Enhancement Layer","description":"Entity extraction, semantic relationships, bitemporal edges, and graph-aware retrieval.\n\n## Overview\nTransform Engram from flat memory storage to a semantic knowledge graph with:\n- Automatic entity extraction from memories\n- Entity resolution and deduplication\n- Semantic relationship detection\n- Graph-aware hybrid retrieval\n\n## Design Document\nSee docs/plans/semantic-enhancement.md for full architecture.\n\n## Key Research References\n\n### Entity Extraction\n- Graphiti: https://github.com/getzep/graphiti (temporal knowledge graph)\n- Neo4j LLM Graph Builder: https://neo4j.com/labs/genai-ecosystem/llm-graph-builder/\n- KGGen multi-stage extraction: https://arxiv.org/html/2502.09956v1\n\n### Entity Resolution\n- EAGER embedding-assisted resolution: https://arxiv.org/abs/2101.06126\n- Semantic entity resolution: https://towardsdatascience.com/the-rise-of-semantic-entity-resolution/\n\n### Graph-Aware Retrieval\n- HybridRAG (vector + graph): https://arxiv.org/abs/2408.04948\n- LightRAG (EMNLP 2025): https://github.com/HKUDS/LightRAG\n- GraphRAG survey: https://arxiv.org/abs/2408.08921\n\n### FalkorDB\n- Documentation: Use Context7 MCP with '/websites/falkordb'\n- Vector indexes: '/falkordb/docs' for vector similarity queries\n\n## Task Summary (18 tasks)\n\n### Foundation (Level 0) - Start Here\n- engram-ezn34: EntityNodeSchema\n- engram-7flux: Extraction prompt design\n\n### Schema Layer (Level 1)\n- engram-ksphq: BitemporalEdgeSchema\n- engram-o8f2j: EntityRepository interface\n- engram-h09jt: EntityExtractorService\n\n### Infrastructure (Level 2-3)\n- engram-cqo6t: FalkorDB implementation\n- engram-mefkc: Embedding generation\n- engram-i05bi: Graph indexes\n- engram-28pq4: EntityResolverService\n- engram-r49xm: Configuration\n- engram-jf4tq: Edge migration\n\n### Integration (Level 4-5)\n- engram-o1qml: Remember tool integration\n- engram-kve0y: Graph-aware recall\n- engram-9xcao: Graph reranking\n\n### Testing (Level 3-6)\n- engram-qmecl: Extractor tests\n- engram-nees3: Resolver tests\n- engram-4kifs: Repository tests\n- engram-ofzcp: Integration tests\n\n## How to Use Context7 MCP\n```\n1. resolve-library-id: 'graphiti' or 'falkordb'\n2. query-docs with library ID for specific topics\n```\n\n## Metrics to Track\n- Entities created per day\n- Entity resolution rate (existing vs new)\n- Graph expansion contribution to recall\n- Extraction latency (sampling vs Gemini)","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2026-01-01T16:50:04.497848-06:00","updated_at":"2026-01-01T17:26:57.775398-06:00"}
{"id":"engram-ood4","title":"Create Organization CRUD endpoints","description":"Add organization management endpoints to Observatory API.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Organization CRUD' section (lines 487-492)\n\n## Implementation\nAdd to Observatory API:\n- POST /api/orgs - Create organization\n- GET /api/orgs - List organizations (admin only)\n- GET /api/orgs/:id - Get organization details\n- PATCH /api/orgs/:id - Update organization\n- DELETE /api/orgs/:id - Delete organization\n\nEach operation should:\n- Validate slug uniqueness (max 32 chars, alphanumeric lowercase)\n- Generate ULID for id\n- Trigger FalkorDB graph creation on org creation\n- Trigger Qdrant tenant index setup on org creation\n\n## Files to Create\n- apps/observatory/app/api/orgs/route.ts\n- apps/observatory/app/api/orgs/[id]/route.ts\n\n## Agent Instructions\nUse Context7 MCP for Next.js App Router API routes. Model after existing Observatory patterns.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:10:11.050066-06:00","updated_at":"2025-12-29T23:21:29.039863-06:00","closed_at":"2025-12-29T23:21:29.039863-06:00","dependencies":[{"issue_id":"engram-ood4","depends_on_id":"engram-qnh3","type":"blocks","created_at":"2025-12-29T22:13:21.733307-06:00","created_by":"ccheney"},{"issue_id":"engram-ood4","depends_on_id":"engram-id90","type":"blocks","created_at":"2025-12-29T22:13:30.388072-06:00","created_by":"ccheney"},{"issue_id":"engram-ood4","depends_on_id":"engram-nnmx","type":"blocks","created_at":"2025-12-29T22:13:39.466048-06:00","created_by":"ccheney"}]}
{"id":"engram-owhi","title":"[Console Redesign] Migrate DatabaseStatusPanels to shadcn","description":"## Overview\nReplace DatabaseStatusPanels with shadcn Card + Progress components.\n\n## Current Implementation\n- apps/console/app/components/DatabaseStatusPanels.tsx\n- Shows FalkorDB, Qdrant, NATS, PostgreSQL status\n- Memory/connections progress bars\n- Health status indicators\n\n## Target Implementation\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-2\"\u003e\n  {databases.map((db) =\u003e (\n    \u003cCard key={db.name}\u003e\n      \u003cCardHeader className=\"flex flex-row items-center justify-between pb-2\"\u003e\n        \u003cCardTitle className=\"text-sm font-medium flex items-center gap-2\"\u003e\n          \u003cdb.icon className=\"h-4 w-4\" /\u003e\n          {db.name}\n        \u003c/CardTitle\u003e\n        \u003cBadge variant={getStatusVariant(db.status)}\u003e\n          {db.status}\n        \u003c/Badge\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent className=\"space-y-4\"\u003e\n        \u003cdiv className=\"space-y-2\"\u003e\n          \u003cdiv className=\"flex justify-between text-xs\"\u003e\n            \u003cspan\u003eMemory\u003c/span\u003e\n            \u003cspan\u003e{db.memoryUsed}MB / {db.memoryTotal}MB\u003c/span\u003e\n          \u003c/div\u003e\n          \u003cProgress value={(db.memoryUsed / db.memoryTotal) * 100} /\u003e\n        \u003c/div\u003e\n        \u003cdiv className=\"space-y-2\"\u003e\n          \u003cdiv className=\"flex justify-between text-xs\"\u003e\n            \u003cspan\u003eConnections\u003c/span\u003e\n            \u003cspan\u003e{db.connections} / {db.maxConnections}\u003c/span\u003e\n          \u003c/div\u003e\n          \u003cProgress value={(db.connections / db.maxConnections) * 100} /\u003e\n        \u003c/div\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  ))}\n\u003c/div\u003e\n```\n\n## Components to Use\n- Card (CardHeader, CardTitle, CardContent)\n- Progress (with color variants based on threshold)\n- Badge (status indicator)\n\n## Progress Color Variants\n```tsx\n// Custom Progress with color based on value\n\u003cProgress \n  value={percentage}\n  className={cn(\n    percentage \u003e 90 \u0026\u0026 \"bg-red-500\",\n    percentage \u003e 70 \u0026\u0026 percentage \u003c= 90 \u0026\u0026 \"bg-amber-500\",\n    percentage \u003c= 70 \u0026\u0026 \"bg-green-500\"\n  )}\n/\u003e\n```\n\n## Reference\n- Current: apps/console/app/components/DatabaseStatusPanels.tsx\n- Infrastructure page: apps/console/app/(dashboard)/infrastructure/page.tsx\n\n## Acceptance Criteria\n- [ ] All database panels displayed\n- [ ] Progress bars with threshold colors\n- [ ] Status badges\n- [ ] Real-time updates","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:46:56.291996-06:00","updated_at":"2025-12-28T17:40:32.017097-06:00","closed_at":"2025-12-28T17:40:32.017097-06:00","dependencies":[{"issue_id":"engram-owhi","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:27.127418-06:00","created_by":"ccheney"}]}
{"id":"engram-oy07","title":"Update MCP config for OAuth device flow","description":"Modify apps/mcp/src/config.ts to remove ENGRAM_API_KEY requirement for cloud mode. Add device flow initialization logic on startup. Keep API key support as fallback/override. See docs/design/oauth-device-flow.md 'File-by-File Implementation Plan' Phase 4 section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:52.166781-05:00","updated_at":"2025-12-25T02:40:51.740031-05:00","closed_at":"2025-12-25T02:40:51.740031-05:00","dependencies":[{"issue_id":"engram-oy07","depends_on_id":"engram-31wh","type":"blocks","created_at":"2025-12-25T02:22:01.428006-05:00","created_by":"ccheney"}]}
{"id":"engram-oydy","title":"Wire OAuth session token to API client","description":"Pass the authenticated session token from better-auth to the API client so it can make authenticated calls to the Engram API endpoints. The console already has OAuth configured but the token isn't being passed to API requests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:51:08.967907-05:00","updated_at":"2025-12-27T20:04:22.76365-05:00","closed_at":"2025-12-27T20:04:22.76365-05:00"}
{"id":"engram-oyrw","title":"Create Console Next.js app skeleton","description":"Set up apps/console with Next.js 16, Tremor, Tailwind, basic layout structure","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:19:40.35078-05:00","updated_at":"2025-12-27T16:09:45.56733-05:00","closed_at":"2025-12-27T16:09:45.56733-05:00"}
{"id":"engram-p0ks","title":"[Console Redesign] Install core shadcn components","description":"## Overview\nInstall the core shadcn/ui components needed for the console redesign.\n\n## Components to Install\n```bash\nbunx shadcn@latest add sidebar card button badge avatar dropdown-menu dialog alert-dialog select input label form tabs table chart skeleton spinner sonner switch slider toggle-group progress scroll-area separator tooltip command popover sheet breadcrumb\n```\n\n## Component Categories\n### Layout\n- sidebar (with SidebarProvider, SidebarInset)\n- sheet (mobile navigation)\n- separator\n\n### Data Display\n- card (with CardHeader, CardTitle, CardDescription, CardContent)\n- badge (status indicators)\n- table (with sorting support)\n- progress (resource gauges)\n- skeleton (loading states)\n- chart (recharts integration)\n\n### Forms \u0026 Input\n- button, input, label, select\n- form (react-hook-form + zod)\n- switch, slider, toggle-group\n- command (searchable combobox)\n- popover\n\n### Feedback\n- dialog, alert-dialog\n- dropdown-menu\n- sonner (toast notifications)\n- spinner\n- tooltip\n\n### Navigation\n- breadcrumb\n\n## Reference\n- shadcn/ui blocks: https://ui.shadcn.com/blocks\n- dashboard-01 block uses: @dnd-kit/core, @tanstack/react-table, zod\n\n## Acceptance Criteria\n- [ ] All core components installed in components/ui/\n- [ ] No TypeScript errors\n- [ ] Components render correctly with theme","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:45:00.427265-06:00","updated_at":"2025-12-28T17:17:50.192108-06:00","closed_at":"2025-12-28T17:17:50.192108-06:00","dependencies":[{"issue_id":"engram-p0ks","depends_on_id":"engram-806h","type":"blocks","created_at":"2025-12-28T16:51:44.207608-06:00","created_by":"ccheney"}]}
{"id":"engram-p744","title":"Remove or use childLogger() function","description":"packages/logger node.ts:97-103 exports childLogger() that is tested but never called in production. Either integrate or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:03.604933-06:00","updated_at":"2025-12-20T23:21:03.08627-06:00","closed_at":"2025-12-20T23:21:03.08627-06:00"}
{"id":"engram-p7nt","title":"Auto-scope MCP query tool Cypher to tenant","description":"MCP query tool must automatically scope Cypher queries to tenant graph.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 571)\n\n## Implementation\nUpdate apps/mcp/src/tools/query.ts:\n- Use TenantAwareFalkorClient with user's TenantContext\n- Query executes against tenant-specific graph\n- No cross-tenant query possible via query tool\n\n## Files to Modify\n- apps/mcp/src/tools/query.ts\n\n## Agent Instructions\nUsers should not need to know about tenant isolation - it should be transparent.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:56.768677-06:00","updated_at":"2025-12-29T22:41:05.558346-06:00","closed_at":"2025-12-29T22:41:05.558346-06:00","dependencies":[{"issue_id":"engram-p7nt","depends_on_id":"engram-xysp","type":"blocks","created_at":"2025-12-29T22:13:19.050509-06:00","created_by":"ccheney"},{"issue_id":"engram-p7nt","depends_on_id":"engram-9fhs","type":"blocks","created_at":"2025-12-29T22:13:26.100239-06:00","created_by":"ccheney"}]}
{"id":"engram-pi8b","title":"Test coverage: packages/parser/src/parser/claude-code.ts (92%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:05.073226-06:00","updated_at":"2025-12-21T04:07:03.770199-06:00","closed_at":"2025-12-21T04:07:03.770199-06:00"}
{"id":"engram-plkt","title":"Test coverage: packages/common/src/utils/env.ts (0%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:03.933741-06:00","updated_at":"2025-12-21T04:07:03.771016-06:00","closed_at":"2025-12-21T04:07:03.771016-06:00"}
{"id":"engram-plpi","title":"Implement DPoP OAuth client credentials for Console","description":"Console needs ENGRAM_CLIENT_TOKEN to authenticate API calls, but the current OAuth system requires DPoP client credentials flow which is not implemented in Console.\n\nCurrent state:\n- Console logs: 'No ENGRAM_CLIENT_TOKEN configured - API calls will fail'\n- Server's oauth_clients table is empty - no OAuth clients registered\n- Server .env has empty client secrets: ENGRAM_CONSOLE_CLIENT_SECRET=\n\nRequired work:\n1. Implement DPoP client credentials flow in Console (similar to Observatory)\n2. Register OAuth clients in database for Console service\n3. Configure client secrets in production .env\n4. Test end-to-end API calls from Console\n\nReference: apps/api/src/middleware/auth.ts for OAuth validation\nReference: apps/observatory for existing OAuth implementation patterns","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T15:48:55.29205-06:00","updated_at":"2026-01-01T17:36:48.006951-06:00","closed_at":"2026-01-01T17:36:48.006951-06:00"}
{"id":"engram-pxwa","title":"Community Summarization","description":"LLM-generated summaries for detected communities. Uses gemini-3-flash-preview for cost-effective batch processing. Generates community name, summary, keywords, and embedding for search.\n\n## Summarization Approach\nAbstractive summarization with source linking:\n- Gather member entities and their memories (limit 50/entity, 100 total)\n- Generate: name (2-4 words), summary (2-3 sentences), keywords (3-5)\n- Store embedding for semantic search\n\n## Cost Optimization\nGemini 3 Flash Batch API offers discount vs synchronous.\nStructured output with response_schema for reliable JSON.\n\n## Before Implementation\nUse Context7 MCP: `resolve-library-id` for '@google/generative-ai' then query for structured output and batch API patterns.\n\nUse web search: 'Gemini 3 Flash batch API JSON structured output TypeScript'\n\n## References\n- Gemini Structured Output: https://ai.google.dev/gemini-api/docs/structured-output\n- Gemini Batch API: https://ai.google.dev/gemini-api/docs/batch-api\n- GraphRAG community summaries: https://microsoft.github.io/graphrag/","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:49:40.606062-06:00","updated_at":"2026-01-01T17:16:25.437252-06:00","dependencies":[{"issue_id":"engram-pxwa","depends_on_id":"engram-bdhk","type":"blocks","created_at":"2026-01-01T16:50:40.374596-06:00","created_by":"ccheney"}]}
{"id":"engram-py2a","title":"Create apps/worker directory structure","description":"Create apps/worker/ with package.json, tsconfig.json, src/index.ts entrypoint. Configure as bun workspace. Add build and dev scripts.\n\n## Directory Structure\n```\napps/worker/\n├── package.json          # @engram/worker, deps: @engram/storage, @engram/graph\n├── tsconfig.json         # extends packages/tsconfig/base.json\n├── src/\n│   ├── index.ts          # Main entrypoint, NATS connection, job registration\n│   ├── config.ts         # IntelligenceConfig with env var mapping\n│   ├── scheduler.ts      # Croner cron jobs\n│   ├── api.ts            # Hono HTTP server for manual triggers\n│   ├── metrics.ts        # Prometheus metrics\n│   ├── algorithms/       # Pure functions (label-propagation.ts, decay.ts)\n│   ├── jobs/             # Job handlers (community-detector.ts, etc.)\n│   └── prompts/          # LLM prompt templates\n└── Dockerfile\n```\n\n## Before Implementation\nReview existing app structures: apps/memory/, apps/api/, apps/mcp/\n\nUse web search: 'bun workspace monorepo TypeScript app structure'\n\n## References\n- Workspace config: package.json (root)\n- TypeScript config: packages/tsconfig/base.json\n- Docker patterns: apps/api/Dockerfile","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:45.769504-06:00","updated_at":"2026-01-01T18:00:55.977812-06:00","closed_at":"2026-01-01T18:00:55.977812-06:00"}
{"id":"engram-pyeq","title":"Test coverage: packages/common/src/utils/hash.ts (0%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:15.967898-06:00","updated_at":"2025-12-21T04:07:03.767762-06:00","closed_at":"2025-12-21T04:07:03.767762-06:00"}
{"id":"engram-q0o8","title":"Migrate deprecated Kafka createConsumer() calls","description":"packages/storage createConsumer() deprecated (kafka.ts:79-82) but still used by ingestion, memory, and control apps. Migrate to getConsumer() pattern.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:10:18.717318-06:00","updated_at":"2025-12-20T23:25:28.850266-06:00","closed_at":"2025-12-20T23:25:28.850266-06:00"}
{"id":"engram-q1et","title":"[HIGH] Unsafe type assertions in all parsers","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:07.173569-06:00","updated_at":"2025-12-20T23:59:50.557622-06:00","closed_at":"2025-12-20T23:59:50.557622-06:00"}
{"id":"engram-q2v2","title":"Remove typescript 5.x from all package.json files","description":"Remove typescript ^5.9.3 devDependency from all workspace package.json files. Packages: root, temporal, tuner, vfs, logger, graph, parser, storage, common, events, observatory, mcp, api","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:37:52.083317-06:00","updated_at":"2025-12-20T22:30:38.779907-06:00","closed_at":"2025-12-20T22:30:38.779907-06:00","dependencies":[{"issue_id":"engram-q2v2","depends_on_id":"engram-4lde","type":"blocks","created_at":"2025-12-20T21:39:06.024849-06:00","created_by":"ccheney"}]}
{"id":"engram-q344","title":"Community Detection","description":"Detect clusters of related entities using label propagation algorithm. Creates Community nodes with auto-generated summaries. Runs daily via cron or on entity count threshold.\n\n## Algorithm\nLabel Propagation Algorithm (LPA):\n- O(E) complexity, handles incremental updates\n- Initialize each node with unique label\n- Iterate: adopt most common neighbor label\n- Converge when labels stabilize\n- Filter communities with \u003c3 members\n\n## Before Implementation\nUse Context7 MCP: Query for FalkorDB graph traversal patterns and Cypher community detection.\n\nUse web search: \n- 'label propagation community detection TypeScript implementation'\n- 'Graphiti community detection Python' (for reference implementation)\n\n## References\n- Label Propagation: https://en.wikipedia.org/wiki/Label_propagation_algorithm\n- Graphiti communities: https://github.com/getzep/graphiti/blob/main/graphiti_core/utils/community.py\n- NetworkX LPA: https://networkx.org/documentation/stable/reference/algorithms/generated/networkx.algorithms.community.label_propagation.label_propagation_communities.html","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:50:01.423467-06:00","updated_at":"2026-01-01T17:05:47.045972-06:00","dependencies":[{"issue_id":"engram-q344","depends_on_id":"engram-bdhk","type":"blocks","created_at":"2026-01-01T16:51:05.576646-06:00","created_by":"ccheney"}]}
{"id":"engram-q4aj","title":"Fix observatory auth middleware crash","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T01:56:45.540936-05:00","updated_at":"2025-12-22T01:57:54.764988-05:00","closed_at":"2025-12-22T01:57:54.764988-05:00"}
{"id":"engram-q89v","title":"[CRITICAL] Private API usage in apps/tuner","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:03.583654-06:00","updated_at":"2025-12-20T23:45:30.485153-06:00","closed_at":"2025-12-20T23:45:30.485153-06:00"}
{"id":"engram-q9ar","title":"Unit tests for TenantContext and graph naming","description":"Create unit tests for TenantContext utilities and graph naming functions.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Testing Strategy section (lines 633-638)\n\n## Test Cases\n- getTenantGraphName() produces correct format\n- createTenantContext() correctly maps AuthContext\n- validateTenantAccess() throws for cross-tenant\n- validateTenantAccess() allows for admin\n\n## Files to Create\n- packages/common/src/types/tenant.test.ts\n\n## Agent Instructions\nUse Bun test runner. Cover edge cases: empty slug, special characters, null values.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:55.429997-06:00","updated_at":"2025-12-29T22:26:46.104855-06:00","closed_at":"2025-12-29T22:26:46.104855-06:00","dependencies":[{"issue_id":"engram-q9ar","depends_on_id":"engram-1pwm","type":"blocks","created_at":"2025-12-29T22:12:31.07015-06:00","created_by":"ccheney"}]}
{"id":"engram-qalz","title":"Update docker-compose with correct embedder config","description":"Fix docker-compose.dev.yml embedder configuration: set EMBEDDER_TEXT_MODEL to match collection dimensions, update QDRANT_COLLECTION to engram_turns.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:12:59.463559-06:00","updated_at":"2025-12-21T06:38:50.144381-06:00","closed_at":"2025-12-21T06:38:50.144381-06:00","dependencies":[{"issue_id":"engram-qalz","depends_on_id":"engram-6slo","type":"blocks","created_at":"2025-12-21T06:14:18.860481-06:00","created_by":"ccheney"}]}
{"id":"engram-qc0v","title":"Test HuggingFace reranker integration locally","description":"Verify HuggingFace reranker works correctly with search service.\n\n## Test scenarios\n1. Unit tests for HuggingFaceReranker class\n2. Integration test with router (RERANKER_BACKEND=huggingface)\n3. End-to-end rerank test via /search endpoint with rerank=true\n\n## Test commands\n```bash\ncd apps/search\nexport HF_API_TOKEN=your_token\nexport RERANKER_BACKEND=huggingface\nuv run pytest tests/test_huggingface.py\n```\n\n## Acceptance Criteria\n- All unit tests pass\n- Reranking works with accurate and code tiers\n- Fallback to fast tier works on timeout","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:32:24.904193-06:00","updated_at":"2025-12-21T15:32:24.904193-06:00"}
{"id":"engram-qc5a","title":"Test coverage: apps/control/src/session/initializer.ts (70%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:22.710665-06:00","updated_at":"2025-12-21T04:07:03.765583-06:00","closed_at":"2025-12-21T04:07:03.765583-06:00"}
{"id":"engram-qeb4","title":"Rewrite apps/search/src/middleware/auth.py to OAuth-only with DPoP support","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:53:55.176183-06:00","updated_at":"2025-12-29T16:51:26.230824-06:00","closed_at":"2025-12-29T16:51:26.230824-06:00","dependencies":[{"issue_id":"engram-qeb4","depends_on_id":"engram-xq1x","type":"blocks","created_at":"2025-12-29T15:59:41.863857-06:00","created_by":"ccheney"},{"issue_id":"engram-qeb4","depends_on_id":"engram-g65i","type":"blocks","created_at":"2025-12-29T15:59:46.990653-06:00","created_by":"ccheney"},{"issue_id":"engram-qeb4","depends_on_id":"engram-vb58","type":"blocks","created_at":"2025-12-29T15:59:52.134538-06:00","created_by":"ccheney"}]}
{"id":"engram-qfda","title":"Add mobile responsive design","description":"Ensure all dashboard components work on mobile/tablet viewports. MUST use frontend-design skill for UI implementation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:38.071589-05:00","updated_at":"2025-12-27T04:23:38.071589-05:00"}
{"id":"engram-qgcm","title":"Create NatsClient in storage package","description":"Create NATS JetStream client implementation in packages/storage.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 2: Storage Package\n\n## Implementation\n- Create packages/storage/src/nats.ts\n- Implement NatsClient class with:\n  - connect() - establish connection and JetStream context\n  - publish(subject, data, key?) - publish with optional dedup key\n  - subscribe(stream, consumer, subjects, handler) - durable consumer\n  - disconnect() - drain and close\n- Export createNatsClient factory function\n- Update packages/storage/src/index.ts exports\n\n## Dependencies\n- @nats-io/transport-node\n- @nats-io/jetstream\n\n## Acceptance Criteria\n- NatsClient connects to NATS server\n- Can publish messages to subjects\n- Can subscribe with durable consumers\n- Proper TypeScript types exported","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:25:46.39716-05:00","updated_at":"2025-12-22T00:42:57.6383-05:00","closed_at":"2025-12-22T00:42:57.6383-05:00","dependencies":[{"issue_id":"engram-qgcm","depends_on_id":"engram-bmqv","type":"blocks","created_at":"2025-12-22T00:28:53.027685-05:00","created_by":"ccheney"}]}
{"id":"engram-qht9","title":"Test coverage: packages/infra/src/k8s/qdrant.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:11.349301-06:00","updated_at":"2025-12-21T04:07:03.768259-06:00","closed_at":"2025-12-21T04:07:03.768259-06:00"}
{"id":"engram-qiua","title":"Create POST /api/auth/token endpoint for client credentials grant with DPoP","description":"Create the client credentials grant endpoint with mandatory DPoP.\n\n**File to create:** `apps/observatory/app/api/auth/token/route.ts`\n\n**Endpoint:** POST /api/auth/token\n\n**Request format:**\n```\nContent-Type: application/x-www-form-urlencoded\nDPoP: \u003csigned JWT proof\u003e\n\ngrant_type=client_credentials\n\u0026client_id=engram-tuner\n\u0026client_secret=secret123\n\u0026scope=memory:read memory:write\n```\n\n**Response format:**\n```json\n{\n  \"access_token\": \"egm_client_...\",\n  \"token_type\": \"DPoP\",\n  \"expires_in\": 3600,\n  \"scope\": \"memory:read memory:write\"\n}\n```\n\n**Validation flow:**\n1. Parse form-urlencoded body\n2. Verify grant_type is \"client_credentials\"\n3. Validate DPoP header exists (REQUIRED per our plan)\n4. Call `validateDPoPProof()` from `lib/dpop.ts`\n5. Verify client_id exists in oauth_clients table\n6. Verify client_secret hash matches stored hash\n7. Validate requested scopes against client's allowed scopes\n8. Generate client token with DPoP JWK thumbprint binding\n9. Store token in oauth_tokens with grant_type='client_credentials'\n\n**Error responses (RFC 6749):**\n- `invalid_request` (400): Missing required params\n- `invalid_client` (401): Bad client credentials\n- `invalid_scope` (400): Requested scope exceeds allowed\n- `use_dpop_nonce` (400): If nonce required (future)\n\n**Existing patterns to follow:**\n- `apps/observatory/app/api/auth/device/token/route.ts` - token endpoint structure\n- `apps/observatory/lib/client-registration.ts` - client validation\n\n**References:**\n- RFC 6749 §4.4: https://tools.ietf.org/html/rfc6749#section-4.4\n- RFC 9449 DPoP with token endpoint: https://datatracker.ietf.org/doc/html/rfc9449#section-5\n- OAuth 2.0 token endpoint errors: https://www.oauth.com/oauth2-servers/access-tokens/access-token-response/\n\n**Subagent instructions:**\n- Use Context7 MCP with `/honojs/hono` for Next.js route handler patterns (uses similar Web APIs)\n- Web search \"OAuth 2.0 client credentials endpoint implementation 2025\"\n- Web search \"DPoP token endpoint validation RFC 9449\"\n- Read existing routes in `apps/observatory/app/api/auth/` for patterns\n- Test with curl after implementation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:52:23.547182-06:00","updated_at":"2025-12-29T16:32:11.629338-06:00","closed_at":"2025-12-29T16:32:11.629338-06:00","dependencies":[{"issue_id":"engram-qiua","depends_on_id":"engram-vb58","type":"blocks","created_at":"2025-12-29T15:57:46.284439-06:00","created_by":"ccheney"},{"issue_id":"engram-qiua","depends_on_id":"engram-vl37","type":"blocks","created_at":"2025-12-29T15:57:51.425401-06:00","created_by":"ccheney"},{"issue_id":"engram-qiua","depends_on_id":"engram-ijfb","type":"blocks","created_at":"2025-12-29T15:57:56.567881-06:00","created_by":"ccheney"}]}
{"id":"engram-qjsu","title":"Improve tests for search rerankers/router.py (78.3% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:29.041225-05:00","updated_at":"2025-12-27T01:59:29.041225-05:00"}
{"id":"engram-qle6","title":"[Console Redesign] Migrate Logs page filter bar and display","description":"## Overview\nMigrate the Logs page filter bar and log entries display to shadcn components.\n\n## Target Page\n- apps/console/app/(dashboard)/logs/page.tsx\n\n## Components to Migrate\n\n### Filter Bar\n```tsx\n\u003cdiv className=\"flex items-center gap-2 mb-4\"\u003e\n  \u003cDropdownMenu\u003e\n    \u003cDropdownMenuTrigger asChild\u003e\n      \u003cButton variant=\"outline\" size=\"sm\"\u003e\n        \u003cFilter className=\"h-4 w-4 mr-2\" /\u003e\n        Services\n      \u003c/Button\u003e\n    \u003c/DropdownMenuTrigger\u003e\n    \u003cDropdownMenuContent\u003e\n      {services.map((s) =\u003e (\n        \u003cDropdownMenuCheckboxItem\n          key={s}\n          checked={selectedServices.includes(s)}\n          onCheckedChange={() =\u003e toggleService(s)}\n        \u003e\n          {s}\n        \u003c/DropdownMenuCheckboxItem\u003e\n      ))}\n    \u003c/DropdownMenuContent\u003e\n  \u003c/DropdownMenu\u003e\n  \n  \u003cSelect value={timeRange} onValueChange={setTimeRange}\u003e\n    \u003cSelectTrigger className=\"w-[120px]\"\u003e\n      \u003cSelectValue placeholder=\"Time range\" /\u003e\n    \u003c/SelectTrigger\u003e\n    \u003cSelectContent\u003e\n      \u003cSelectItem value=\"15m\"\u003eLast 15m\u003c/SelectItem\u003e\n      \u003cSelectItem value=\"1h\"\u003eLast 1h\u003c/SelectItem\u003e\n      \u003cSelectItem value=\"24h\"\u003eLast 24h\u003c/SelectItem\u003e\n    \u003c/SelectContent\u003e\n  \u003c/Select\u003e\n  \n  \u003cdiv className=\"relative flex-1\"\u003e\n    \u003cSearch className=\"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground\" /\u003e\n    \u003cInput placeholder=\"Search logs...\" className=\"pl-8\" /\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n### Log Display\n```tsx\n\u003cScrollArea className=\"h-[600px]\"\u003e\n  {logs.map((log) =\u003e (\n    \u003cdiv key={log.id} className=\"flex items-start gap-2 py-2 border-b\"\u003e\n      \u003cBadge variant={getLevelVariant(log.level)}\u003e{log.level}\u003c/Badge\u003e\n      \u003cspan className=\"text-xs text-muted-foreground font-mono\"\u003e\n        {formatTimestamp(log.timestamp)}\n      \u003c/span\u003e\n      \u003cspan className=\"flex-1 font-mono text-sm\"\u003e{log.message}\u003c/span\u003e\n    \u003c/div\u003e\n  ))}\n\u003c/ScrollArea\u003e\n```\n\n## Components to Use\n- DropdownMenu with DropdownMenuCheckboxItem (multi-select filters)\n- Select (time range)\n- Input (search with icon)\n- ScrollArea (log container)\n- Badge (log level: info/warn/error/debug)\n- Button (play/pause streaming, clear)\n- Switch (auto-scroll toggle)\n\n## Streaming Controls\n```tsx\n\u003cdiv className=\"flex items-center gap-4\"\u003e\n  \u003cButton variant=\"outline\" size=\"sm\" onClick={toggleStreaming}\u003e\n    {isStreaming ? \u003cPause /\u003e : \u003cPlay /\u003e}\n    {isStreaming ? 'Pause' : 'Resume'}\n  \u003c/Button\u003e\n  \u003cdiv className=\"flex items-center gap-2\"\u003e\n    \u003cSwitch checked={autoScroll} onCheckedChange={setAutoScroll} /\u003e\n    \u003cLabel\u003eAuto-scroll\u003c/Label\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## Reference\n- DropdownMenu docs: https://ui.shadcn.com/docs/components/dropdown-menu\n- ScrollArea for virtualized scrolling\n\n## Acceptance Criteria\n- [ ] Filter dropdowns work (services, levels)\n- [ ] Time range selector works\n- [ ] Search input filters logs\n- [ ] Log entries display with correct level badges\n- [ ] Streaming controls work\n- [ ] Auto-scroll toggle\n- [ ] Good scroll performance","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:48:08.001971-06:00","updated_at":"2025-12-28T17:40:32.019976-06:00","closed_at":"2025-12-28T17:40:32.019976-06:00","dependencies":[{"issue_id":"engram-qle6","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:33.362166-06:00","created_by":"ccheney"}]}
{"id":"engram-qmecl","title":"Unit tests for EntityExtractorService","description":"Unit tests for EntityExtractorService.\n\n## Test Cases\n\n### Extraction from Memory Types\n- Decision memory: 'Chose PostgreSQL over MySQL for ACID compliance'\n  - Expected: PostgreSQL (technology), MySQL (technology), ACID (concept)\n- Insight memory: 'The flaky test was caused by timezone assumptions'\n  - Expected: flaky test (concept), timezone (concept)\n- Preference memory: 'Always use pytest for Python testing'\n  - Expected: pytest (tool), Python (technology)\n\n### Relationship Detection\n- 'OAuth implements authentication'\n  - Expected: {from: 'OAuth', to: 'authentication', type: 'IMPLEMENTS'}\n- 'React depends on Node.js'\n  - Expected: {from: 'React', to: 'Node.js', type: 'DEPENDS_ON'}\n\n### Fallback Behavior\n- Mock SamplingService to return null\n- Verify fallback to Gemini API\n- Track model_used in result\n\n### Edge Cases\n- Empty content: return empty entities array\n- Minimal content: 'Yes' → no entities\n- maxEntitiesPerMemory limit respected\n\n### Mocking\n```typescript\nconst mockSampling = {\n  createMessage: vi.fn().mockResolvedValue({\n    content: [{type: 'text', text: JSON.stringify({entities: [...]})}]\n  })\n};\n```\n\n## Implementation Reference\n- Existing test patterns: packages/graph/src/repositories/*.test.ts\n- Bun test runner: bunfig.toml\n\n## Research\n- LLM testing patterns: Web search 'unit testing LLM extraction mock 2025'\n- Bun test mocking: Use Context7 MCP for 'bun test mock vi.fn'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:38.992154-06:00","updated_at":"2026-01-01T18:33:49.380681-06:00","closed_at":"2026-01-01T18:33:49.380681-06:00","dependencies":[{"issue_id":"engram-qmecl","depends_on_id":"engram-h09jt","type":"blocks","created_at":"2026-01-01T16:55:46.212485-06:00","created_by":"ccheney"},{"issue_id":"engram-qmecl","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:29.603246-06:00","created_by":"ccheney"}]}
{"id":"engram-qnh3","title":"Create PostgreSQL organizations table","description":"Add organizations table to PostgreSQL schema using Drizzle ORM.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'PostgreSQL (Observatory) - Drizzle ORM Schema' section (lines 155-195)\n\n## Implementation\nAdd to apps/observatory/src/db/schema.ts (or create if needed):\n- organizations table with id (ULID), slug, name, createdAt, updatedAt\n- Unique index on slug\n- Drizzle relations setup\n\n## Key Schema:\n```typescript\nexport const organizations = pgTable(\n  'organizations',\n  {\n    id: text('id').primaryKey(),\n    slug: text('slug').unique().notNull(),\n    name: text('name').notNull(),\n    createdAt: timestamp('created_at', { withTimezone: true }).defaultNow().notNull(),\n    updatedAt: timestamp('updated_at', { withTimezone: true }).defaultNow().notNull(),\n  },\n  (table) =\u003e [\n    uniqueIndex('idx_organizations_slug').on(table.slug),\n  ]\n);\n```\n\n## Files to Create/Modify\n- apps/observatory/src/db/schema.ts (create or update)\n\n## Agent Instructions\nUse Context7 MCP for Drizzle ORM documentation. Search for 'drizzle-orm pgTable 2025' for latest patterns. Check existing schema patterns in apps/api/src/db/init.sql for consistency.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:33.831343-06:00","updated_at":"2025-12-29T22:21:55.834796-06:00","closed_at":"2025-12-29T22:21:55.834796-06:00"}
{"id":"engram-qqa9","title":"[Cleanup] Remove packages/benchmark (TypeScript)","description":"Remove deprecated TypeScript benchmark package after Python migration is complete.\n\nNO BACKWARDS COMPATIBILITY - clean removal.\n\nDeliverables:\n- Delete packages/benchmark/ directory\n- Remove from turbo.json\n- Remove @engram/benchmark from all package.json dependencies\n- Remove CLI entry from root package.json\n- Update any scripts that reference engram-benchmark\n- Remove from root package.json workspaces","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T07:30:24.346788-06:00","updated_at":"2025-12-20T10:18:04.905404-06:00","closed_at":"2025-12-20T10:18:04.905404-06:00","dependencies":[{"issue_id":"engram-qqa9","depends_on_id":"engram-mija","type":"blocks","created_at":"2025-12-20T07:31:08.56293-06:00","created_by":"ccheney"}]}
{"id":"engram-quat","title":"[Console Redesign] Update dashboard layout with SidebarProvider","description":"## Overview\nRestructure the dashboard layout to use SidebarProvider + SidebarInset pattern.\n\n## Current Implementation\n- apps/console/app/(dashboard)/layout.tsx\n- Fixed sidebar (240px margin-left on main)\n- Fixed header (64px padding-top)\n\n## Target Implementation\n```tsx\nimport { SidebarProvider, SidebarInset } from \"@/components/ui/sidebar\"\nimport { AppSidebar } from \"@/components/layout/app-sidebar\"\nimport { SiteHeader } from \"@/components/layout/site-header\"\n\nexport default function DashboardLayout({ children }) {\n  return (\n    \u003cSidebarProvider\n      style={{\n        \"--sidebar-width\": \"240px\",\n        \"--sidebar-width-mobile\": \"280px\",\n      }}\n    \u003e\n      \u003cAppSidebar /\u003e\n      \u003cSidebarInset\u003e\n        \u003cSiteHeader /\u003e\n        \u003cmain className=\"flex flex-1 flex-col gap-4 p-4\"\u003e\n          {children}\n        \u003c/main\u003e\n      \u003c/SidebarInset\u003e\n    \u003c/SidebarProvider\u003e\n  )\n}\n```\n\n## Key Changes\n1. Wrap with SidebarProvider\n2. Replace fixed positioning with SidebarInset\n3. Move header inside SidebarInset\n4. Content flows naturally with sidebar\n\n## CSS Variables\n```tsx\nstyle={{\n  \"--sidebar-width\": \"calc(var(--spacing) * 60)\",  // 240px\n  \"--header-height\": \"calc(var(--spacing) * 16)\",  // 64px\n}}\n```\n\n## Reference\n- Current layout: apps/console/app/(dashboard)/layout.tsx\n- shadcn layout pattern: https://ui.shadcn.com/docs/components/sidebar\n\n## Acceptance Criteria\n- [ ] SidebarProvider wraps dashboard\n- [ ] Sidebar responsive collapse works\n- [ ] Mobile navigation works (sheet)\n- [ ] No layout shifts during transition\n- [ ] Sidebar state persisted (cookie)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:45:54.334596-06:00","updated_at":"2025-12-28T17:23:20.156862-06:00","closed_at":"2025-12-28T17:23:20.156862-06:00","dependencies":[{"issue_id":"engram-quat","depends_on_id":"engram-efsf","type":"blocks","created_at":"2025-12-28T16:52:00.610394-06:00","created_by":"ccheney"},{"issue_id":"engram-quat","depends_on_id":"engram-wqs7","type":"blocks","created_at":"2025-12-28T16:52:05.743397-06:00","created_by":"ccheney"}]}
{"id":"engram-qwba","title":"[Console Redesign] Migrate MetricsGrid to shadcn Cards","description":"## Overview\nReplace MetricsGrid component with shadcn Card components with sparkline charts.\n\n## Current Implementation\n- apps/console/app/components/MetricsGrid.tsx\n- 4 metric cards (requests, errors, latency, sessions)\n- Sparkline charts using Tremor\n- Change indicators with trend arrows\n\n## Target Implementation\nUse dashboard-01 \"section-cards\" pattern:\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\"\u003e\n  {metrics.map((metric) =\u003e (\n    \u003cCard key={metric.id}\u003e\n      \u003cCardHeader className=\"flex flex-row items-center justify-between pb-2\"\u003e\n        \u003cCardTitle className=\"text-sm font-medium\"\u003e\n          {metric.label}\n        \u003c/CardTitle\u003e\n        \u003cBadge variant={getTrendVariant(metric.change)}\u003e\n          {metric.change \u003e 0 ? '+' : ''}{metric.change}%\n        \u003c/Badge\u003e\n      \u003c/CardHeader\u003e\n      \u003cCardContent\u003e\n        \u003cdiv className=\"text-2xl font-bold\"\u003e{metric.value}\u003c/div\u003e\n        \u003cChartContainer config={chartConfig} className=\"h-[60px]\"\u003e\n          \u003cAreaChart data={metric.history}\u003e\n            \u003cArea dataKey=\"value\" fill=\"var(--chart-1)\" /\u003e\n          \u003c/AreaChart\u003e\n        \u003c/ChartContainer\u003e\n      \u003c/CardContent\u003e\n    \u003c/Card\u003e\n  ))}\n\u003c/div\u003e\n```\n\n## Components to Use\n- Card (CardHeader, CardTitle, CardContent)\n- Badge (for trend indicators)\n- ChartContainer + AreaChart (sparklines)\n\n## New Files\n- components/dashboard/section-cards.tsx\n- components/dashboard/metric-card.tsx (optional extraction)\n\n## Reference\n- Current: apps/console/app/components/MetricsGrid.tsx\n- shadcn chart: https://ui.shadcn.com/docs/components/chart\n- dashboard-01 block for pattern\n\n## Acceptance Criteria\n- [ ] 4 metric cards displayed\n- [ ] Sparkline charts working with recharts\n- [ ] Trend indicators with correct colors\n- [ ] Polling updates work\n- [ ] Loading skeleton states","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:45:59.620241-06:00","updated_at":"2025-12-28T17:28:26.227386-06:00","closed_at":"2025-12-28T17:28:26.227386-06:00","dependencies":[{"issue_id":"engram-qwba","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:11.719369-06:00","created_by":"ccheney"}]}
{"id":"engram-qyx3","title":"Improve engram_remember tool description","description":"Update apps/mcp/src/tools/remember.ts with improved descriptions that encourage proactive use. Changes:\n- Main description: 'Persist valuable information to long-term memory for future sessions. Use proactively when you learn: user preferences, architectural decisions, project conventions, debugging insights, or facts worth preserving.'\n- content param: Include guidance on specificity and avoiding transient info\n- type param: Explain all enum values (decision/preference/insight/fact/context) with examples\n- tags param: Guide on using lowercase, specific terms vs generic ones\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_remember","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:51:47.666489-05:00","updated_at":"2025-12-25T00:57:06.000327-05:00","closed_at":"2025-12-25T00:57:06.000327-05:00"}
{"id":"engram-r083","title":"Update API memory service for tenant scoping","description":"Update memory service to scope all operations to tenant.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 560)\n\n## Implementation\nUpdate apps/api/src/services/memory.ts:\n- Accept TenantContext in all methods\n- Use tenant graph for all FalkorDB queries\n- Include org_id in search service calls\n\n## Files to Modify\n- apps/api/src/services/memory.ts\n\n## Agent Instructions\nThis is a critical security boundary. No query should execute without tenant scoping.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:24.781671-06:00","updated_at":"2025-12-29T23:27:55.031116-06:00","closed_at":"2025-12-29T23:27:55.031116-06:00","dependencies":[{"issue_id":"engram-r083","depends_on_id":"engram-g9n0","type":"blocks","created_at":"2025-12-29T22:12:15.704716-06:00","created_by":"ccheney"},{"issue_id":"engram-r083","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:22.435044-06:00","created_by":"ccheney"}]}
{"id":"engram-r1ax","title":"Create OAuth token management UI","description":"Create apps/observatory/app/settings/tokens/page.tsx - UI to view active OAuth sessions/tokens and revoke them. Show list of authorized devices with last_used_at, user_agent info. Allow revoking individual tokens. IMPORTANT: Use the frontend-design skill (/frontend-design) for this UI task to ensure high design quality. See docs/design/oauth-device-flow.md 'Open Questions' section about token revocation UI.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:41.145167-05:00","updated_at":"2025-12-25T02:58:41.688874-05:00","closed_at":"2025-12-25T02:58:41.688874-05:00","dependencies":[{"issue_id":"engram-r1ax","depends_on_id":"engram-f377","type":"blocks","created_at":"2025-12-25T02:22:38.342095-05:00","created_by":"ccheney"}]}
{"id":"engram-r2099","title":"Install Gastown CLI and initialize rig","description":"Install gt CLI via go install, run gt install, and add engram rig","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:48:54.607845-06:00","updated_at":"2026-01-01T18:51:29.76234-06:00","closed_at":"2026-01-01T18:51:29.76234-06:00"}
{"id":"engram-r3v6","title":"Add org_id to SearchFilters type","description":"Add required org_id field to SearchFilters in Python search service.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 565)\n\n## Implementation\nUpdate apps/search/src/retrieval/types.py:\n```python\nclass SearchFilters(BaseModel):\n    org_id: str  # Required - no optional\n    session_id: Optional[str] = None\n    # ... other filters\n```\n\n## Files to Modify\n- apps/search/src/retrieval/types.py\n\n## Agent Instructions\nMake org_id required, not optional. Update all call sites.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:10:07.983475-06:00","updated_at":"2025-12-29T22:26:52.938829-06:00","closed_at":"2025-12-29T22:26:52.938829-06:00","dependencies":[{"issue_id":"engram-r3v6","depends_on_id":"engram-1pwm","type":"blocks","created_at":"2025-12-29T22:12:51.508284-06:00","created_by":"ccheney"}]}
{"id":"engram-r49xm","title":"Add entity extraction configuration","description":"Add configuration options for entity extraction and graph retrieval.\n\n## Configuration Schemas\n\n### EntityConfig\n```typescript\ninterface EntityConfig {\n  enabled: boolean;           // Enable entity extraction (default: true)\n  resolutionThreshold: number; // Embedding similarity threshold (default: 0.9)\n  maxEntitiesPerMemory: number; // Limit extracted entities (default: 10)\n  detectRelationships: boolean; // Extract inter-entity relationships (default: true)\n}\n```\n\n### GraphRetrievalConfig\n```typescript\ninterface GraphRetrievalConfig {\n  enabled: boolean;    // Enable graph-aware retrieval (default: true)\n  maxDepth: number;    // Maximum BFS hops (default: 2)\n  graphWeight: number; // Weight for graph vs vector results (default: 0.3)\n}\n```\n\n## Environment Variables\n```\nENTITY_EXTRACTION_ENABLED=true\nENTITY_RESOLUTION_THRESHOLD=0.9\nENTITY_MAX_PER_MEMORY=10\nENTITY_DETECT_RELATIONSHIPS=true\nGRAPH_RETRIEVAL_ENABLED=true\nGRAPH_RETRIEVAL_MAX_DEPTH=2\nGRAPH_RETRIEVAL_WEIGHT=0.3\n```\n\n## Integration\n- Add to apps/mcp/src/config.ts\n- Load in MCP server initialization\n- Pass to EntityExtractor and EntityResolver services\n\n## Research\n- Configuration patterns: Review existing apps/mcp/src/config.ts\n- Feature flags best practices: Web search 'feature flag configuration TypeScript 2025'","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T16:52:13.794222-06:00","updated_at":"2026-01-01T18:23:23.613982-06:00","closed_at":"2026-01-01T18:23:23.613982-06:00","dependencies":[{"issue_id":"engram-r49xm","depends_on_id":"engram-h09jt","type":"blocks","created_at":"2026-01-01T16:54:45.680223-06:00","created_by":"ccheney"},{"issue_id":"engram-r49xm","depends_on_id":"engram-oo6r","type":"blocks","created_at":"2026-01-01T16:57:09.036186-06:00","created_by":"ccheney"}]}
{"id":"engram-r5tjq","title":"Create ConflictScanner job handler","description":"Create apps/worker/src/jobs/conflict-scanner.ts. Load active memories per project, vector search for candidates (similarity \u003e 0.7, top 5), batch classify with ConflictDetectorService, create ConflictReport nodes. Subscribe to engram.jobs.conflict-scan NATS subject. Runs weekly.\n\n## Scan Pipeline\n1. Load active memories partitioned by project/org\n2. For each memory:\n   - Call search service /conflict-candidates (engram-42up)\n   - Filter candidates with similarity \u003e 0.7\n   - Limit to top 5 per memory\n3. Batch classify conflicts using ConflictDetectorService\n4. Create ConflictReport nodes for confirmed conflicts\n5. Trigger webhook notifications if configured\n\n## Batch Processing\nGroup candidate pairs into batches of 20 for LLM classification to minimize API calls.\n\n## Before Implementation\nReview ConflictDetectorService: engram-t4ms\nReview search /conflict-candidates: engram-42up\n\n## References\n- ConflictDetectorService: apps/mcp/src/services/conflict-detector.ts (after engram-t4ms)\n- Search retrieval: apps/search/src/search/retrieval/retriever.py\n- Zep conflict patterns: https://arxiv.org/abs/2501.13956","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:32.793526-06:00","updated_at":"2026-01-01T17:11:40.064726-06:00","dependencies":[{"issue_id":"engram-r5tjq","depends_on_id":"engram-cfcug","type":"blocks","created_at":"2026-01-01T16:52:55.46152-06:00","created_by":"ccheney"},{"issue_id":"engram-r5tjq","depends_on_id":"engram-t4ms","type":"blocks","created_at":"2026-01-01T16:53:02.616267-06:00","created_by":"ccheney"},{"issue_id":"engram-r5tjq","depends_on_id":"engram-dtbw","type":"blocks","created_at":"2026-01-01T17:08:11.351259-06:00","created_by":"ccheney"}]}
{"id":"engram-r7wuq","title":"Integration tests for conflict scanning","description":"Create apps/worker/src/__tests__/conflict-scanner.integration.test.ts. Test: create conflicting memories, run scan job, verify ConflictReport nodes created with correct relations.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:31.642603-06:00","updated_at":"2026-01-01T16:50:31.642603-06:00","dependencies":[{"issue_id":"engram-r7wuq","depends_on_id":"engram-cq83y","type":"blocks","created_at":"2026-01-01T16:52:40.926734-06:00","created_by":"ccheney"}]}
{"id":"engram-r826","title":"Add Gemini client to packages/common","description":"Create packages/common/src/clients/gemini.ts with generateStructuredOutput method supporting JSON response_schema. Use @google/generative-ai package. Support both single requests and batch mode.\n\n## Client Interface\n```typescript\ninterface GeminiClient {\n  generateStructuredOutput\u003cT\u003e(options: {\n    prompt: string;\n    schema: z.ZodSchema\u003cT\u003e;\n    model?: string;  // default: 'gemini-3-flash-preview'\n  }): Promise\u003cT\u003e;\n  \n  generateBatch\u003cT\u003e(options: {\n    prompts: string[];\n    schema: z.ZodSchema\u003cT\u003e;\n    model?: string;\n  }): Promise\u003cT[]\u003e;\n}\n```\n\n## Structured Output\nGemini 3 Flash supports response_schema for guaranteed JSON structure:\n- Pass Zod schema converted to JSON Schema\n- Include propertyOrdering for field order\n- Automatic retry on parse failure\n\n## Before Implementation\nUse Context7 MCP: `resolve-library-id` for '@google/generative-ai' then query for:\n- 'structured output response_schema'\n- 'batch API usage'\n\nUse web search: 'Gemini 3 Flash TypeScript structured output Zod schema'\n\n## References\n- Gemini Structured Output: https://ai.google.dev/gemini-api/docs/structured-output\n- Gemini Batch API: https://ai.google.dev/gemini-api/docs/batch-api\n- @google/generative-ai npm: https://www.npmjs.com/package/@google/generative-ai","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:46.52254-06:00","updated_at":"2026-01-01T18:00:55.978358-06:00","closed_at":"2026-01-01T18:00:55.978358-06:00"}
{"id":"engram-rav3","title":"Cron Job Scheduling","description":"Time-based scheduling of background jobs using Croner library. Daily decay calculation at 2am, daily community detection at 3am, weekly conflict scan on Sunday at 4am. All times configurable.\n\n## Cron Schedules\n- engram.jobs.decay-calculation: '0 2 * * *' (daily 2am)\n- engram.jobs.community-detection: '0 3 * * *' (daily 3am)  \n- engram.jobs.conflict-scan: '0 4 * * 0' (Sunday 4am)\n\n## Croner Features\n- Timezone support (UTC default, configurable per-job)\n- No dependencies, works in Bun/Node/Deno\n- Async function support\n- Job enumeration and next-run calculation\n\n## Before Implementation\nUse Context7 MCP: `resolve-library-id` for 'croner' then query for timezone configuration and async job patterns.\n\nUse web search: 'Croner TypeScript cron job best practices 2025'\n\n## References\n- Croner GitHub: https://github.com/hexagon/croner\n- Croner docs: https://croner.56k.guru/\n- NATS JetStream pub: packages/storage/src/nats.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:40.087999-06:00","updated_at":"2026-01-01T18:20:36.749647-06:00","closed_at":"2026-01-01T18:20:36.749647-06:00","dependencies":[{"issue_id":"engram-rav3","depends_on_id":"engram-dtbw","type":"blocks","created_at":"2026-01-01T17:08:26.757751-06:00","created_by":"ccheney"}]}
{"id":"engram-rfg1","title":"Auto-select ColBERT reranker tier for semantic queries","description":"ColBERT reranker is available via tier='colbert' but never auto-selected by classifier. Could be optimal for certain query types. Update _select_reranker_tier() logic.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:01:36.73459-06:00","updated_at":"2025-12-20T23:25:40.229761-06:00","closed_at":"2025-12-20T23:25:40.229761-06:00"}
{"id":"engram-rfmf","title":"Remove deprecated domain types from falkor.ts","description":"packages/storage falkor.ts:189-321 has 9 deprecated type aliases for backward compatibility. Audit usages and remove if safe.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:17:29.477233-06:00","updated_at":"2025-12-20T23:24:25.372932-06:00","closed_at":"2025-12-20T23:24:25.372932-06:00"}
{"id":"engram-rgll","title":"[Observatory Auth] Update RBAC to use Better Auth","description":"Update RBAC module to use Better Auth instead of Clerk. Reference: docs/observatory-auth-implementation-plan.md Step 8. File: apps/observatory/lib/rbac.ts. Replace Clerk auth import with Better Auth. Add getSession() function using auth.api.getSession. Update requireRole() to use Better Auth session. Keep UserRole enum, AuthorizationError, ForbiddenError. Update withRole() to pass session to handler. Add new withAuth() helper for auth-only routes (no role check). DEPENDS ON: engram-7d6p (server config must exist first).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:41:32.638089-05:00","updated_at":"2025-12-22T00:53:45.07873-05:00","closed_at":"2025-12-22T00:53:45.07873-05:00","dependencies":[{"issue_id":"engram-rgll","depends_on_id":"engram-7d6p","type":"blocks","created_at":"2025-12-22T00:43:58.167278-05:00","created_by":"ccheney"}]}
{"id":"engram-rmr1","title":"Update documentation for OAuth device flow","description":"Update CLAUDE.md with new OAuth auth flow for MCP. Update MCP tools documentation. Add troubleshooting guide for common auth issues (token refresh, cache location, re-authentication). Document migration path from API keys. See docs/design/oauth-device-flow.md 'Migration Path from API Keys' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:35.263834-05:00","updated_at":"2025-12-25T02:58:41.687653-05:00","closed_at":"2025-12-25T02:58:41.687653-05:00","dependencies":[{"issue_id":"engram-rmr1","depends_on_id":"engram-i7ec","type":"blocks","created_at":"2025-12-25T02:22:33.207984-05:00","created_by":"ccheney"}]}
{"id":"engram-rnes","title":"[Observatory Auth] Integrate UserMenu into main page header","description":"Add the UserMenu component to the Observatory main page header. Reference: docs/observatory-auth-implementation-plan.md Step 10. File: apps/observatory/app/page.tsx. Import UserMenu from components/UserMenu. Add UserMenu to the header section next to the reranker settings button. Ensure proper positioning and responsive behavior. DEPENDS ON: engram-u6od (UserMenu component must exist first). ⚠️ IMPORTANT: This is a UI task. You MUST use the frontend-design skill (/frontend-design) to implement this integration. NO EXCEPTIONS.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:42:56.145339-05:00","updated_at":"2025-12-22T00:59:23.224663-05:00","closed_at":"2025-12-22T00:59:23.224663-05:00","dependencies":[{"issue_id":"engram-rnes","depends_on_id":"engram-u6od","type":"blocks","created_at":"2025-12-22T00:44:28.978563-05:00","created_by":"ccheney"}]}
{"id":"engram-ro19","title":"Create community summarization prompt","description":"Create apps/worker/src/prompts/community-summary.ts with prompt template that takes entity list and memory excerpts, outputs JSON {name, text, keywords}. Include examples and constraints (2-4 word name, 2-3 sentence summary, 3-5 keywords).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:52.438491-06:00","updated_at":"2026-01-01T18:09:28.057064-06:00","closed_at":"2026-01-01T18:09:28.057064-06:00"}
{"id":"engram-rpet","title":"Create VPS with hcloud","description":"Provision Hetzner Cloud VPS for Engram infrastructure.\n\n## Server specs\n- Type: CPX31 ($18.59/month)\n- 4 vCPU (AMD), 8 GB RAM, 160 GB NVMe\n- Location: Ashburn, VA (ash)\n- Image: Ubuntu 24.04\n\n## Command\n```bash\nhcloud server create \\\n  --name engram \\\n  --type cpx31 \\\n  --image ubuntu-24.04 \\\n  --location ash \\\n  --ssh-key engram-key\n```\n\n## Verification\n- `hcloud server ip engram` returns IP\n- `hcloud server ssh engram` connects successfully\n\n## Acceptance Criteria\n- Server is running\n- SSH access works\n- Server IP is noted for DNS/deployment","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:30:45.194841-06:00","updated_at":"2025-12-21T15:48:21.411578-06:00","closed_at":"2025-12-21T15:48:21.411578-06:00","dependencies":[{"issue_id":"engram-rpet","depends_on_id":"engram-exnd","type":"blocks","created_at":"2025-12-21T15:33:58.024513-06:00","created_by":"ccheney"}]}
{"id":"engram-rr6ot","title":"Gastown Multi-Agent Orchestration Integration","description":"Integrate Gastown (github.com/steveyegge/gastown) multi-agent orchestrator to enable parallel agent execution on beads. Gastown provides: crash-resilient workflow execution, reusable TOML formulas, convoy-based work grouping, hook-based task dispatch, and merge queue coordination via Refinery. This enables scaling from 1 agent to 10-30 parallel workers while maintaining accountability and quality tracking.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-01T18:42:41.587807-06:00","updated_at":"2026-01-01T18:54:46.742861-06:00","closed_at":"2026-01-01T18:54:46.742861-06:00"}
{"id":"engram-rv18","title":"Improve engram_extract_facts tool description","description":"Update apps/mcp/src/tools/extract-facts.ts with improved descriptions. Changes:\n- Main description: 'Parse unstructured text into discrete, atomic facts suitable for storage. Use before engram_remember when processing: documentation, chat logs, meeting notes, or verbose command outputs. Each extracted fact can be stored and searched independently.'\n- text param: Guide on what content types work well\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_extract_facts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:18.72602-05:00","updated_at":"2025-12-25T00:59:34.669971-05:00","closed_at":"2025-12-25T00:59:34.669971-05:00"}
{"id":"engram-rvuy","title":"Remove or use RawStreamEvent metadata fields","description":"packages/events index.ts:18-25 defines source_ip, protocol_version, trace_id that are parsed but never used downstream. Remove from schema or forward to consumers.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:16:19.258684-06:00","updated_at":"2025-12-20T23:21:20.211291-06:00","closed_at":"2025-12-20T23:21:20.211291-06:00"}
{"id":"engram-rwck","title":"Test coverage: apps/mcp/src/capabilities/roots.ts (95%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:04.669734-06:00","updated_at":"2025-12-21T04:07:03.770814-06:00","closed_at":"2025-12-21T04:07:03.770814-06:00"}
{"id":"engram-rwtcd","title":"Create MCP tool annotation DSL","description":"Implement MCP tool annotation in packages/graph/src/schema/mcp.ts\n\n## Overview\nThis DSL allows MCP tools to be defined declaratively alongside the schema. Tools defined here will be automatically generated with proper JSON Schema validation, type-safe handlers, and MCP server registration.\n\n## Requirements\n- mcp.defineTools() for tool collection definition\n- mcp.tool() for individual tool definition\n- mcp.param.string/int/boolean/array/enum for parameters\n- Support for .optional(), .default(value), .describe(text) modifiers\n- Handler function type with typed input and context\n- Automatic JSON Schema generation from param definitions\n\n## API Design\n```typescript\nimport { mcp } from '@engram/graph/schema';\n\nexport const mcpTools = mcp.defineTools({\n  remember: mcp.tool({\n    description: 'Store a memory for future recall',\n    input: {\n      content: mcp.param.string('The memory content to store'),\n      type: mcp.param.enum(MemoryTypeEnum, 'Classification of the memory'),\n      tags: mcp.param.array(mcp.param.string(), 'Keywords for filtering').optional(),\n    },\n    output: {\n      id: mcp.param.string('Created memory ID'),\n      stored: mcp.param.boolean('Success indicator'),\n    },\n    handler: async (input, context) =\u003e {\n      const memory = await Memory.create({\n        ...input,\n        source: 'user',\n        source_session_id: context.sessionId,\n      });\n      return { id: memory.id, stored: true };\n    },\n  }),\n});\n```\n\n## Research Required\nBefore implementing, use Context7 MCP:\n- Search for MCP SDK documentation on tool schemas\n\nUse web search for:\n- 'MCP model context protocol tool schema 2025'\n- 'JSON Schema generation from TypeScript types'\n- 'MCP server registerTool API'\n- 'Zod to JSON Schema conversion'\n\n## Technical Considerations\n- Param definitions should mirror field types but with description support\n- Handler typing should infer input type from param definitions\n- Consider supporting both sync and async handlers\n- Output schema optional but recommended for structured content\n\n## Files\n- packages/graph/src/schema/mcp.ts (NEW)\n\n## References\n- MCP specification: https://modelcontextprotocol.io/specification/2025-06-18/schema\n- MCP tools concept: https://modelcontextprotocol.io/docs/concepts/tools\n- Current MCP tools: apps/mcp/src/tools/\n- Plan: docs/plans/compiled-query-layer.md lines 336-390\n- zod-to-json-schema: https://github.com/StefanTerdell/zod-to-json-schema","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:00.064817-06:00","updated_at":"2026-01-01T17:07:24.315702-06:00","dependencies":[{"issue_id":"engram-rwtcd","depends_on_id":"engram-hd79","type":"blocks","created_at":"2026-01-01T16:54:23.420759-06:00","created_by":"ccheney"}]}
{"id":"engram-s702","title":"[CRITICAL] Malformed CSS in SessionBrowser","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:59.737888-06:00","updated_at":"2025-12-20T23:45:30.486156-06:00","closed_at":"2025-12-20T23:45:30.486156-06:00"}
{"id":"engram-s7qk","title":"Intelligence Layer Testing","description":"Comprehensive test coverage for intelligence layer: unit tests for algorithms, integration tests for job handlers, load tests for scale validation.\n\n## Test Categories\n\n### Unit Tests\n- Label propagation: convergence, singletons, disconnected components, iteration limits\n- Decay calculation: formula correctness, type weights, boundary conditions\n\n### Integration Tests  \n- Community detection: FalkorDB entities → detection → Community nodes\n- Decay calculation: memories with ages → scores → recall ordering\n- Conflict scanning: conflicting memories → ConflictReport nodes\n\n### Load Tests\n- Community detection: 10K entities\n- Decay calculation: 100K memories\n- Conflict scan: 50K memories\n- Assert P95 latency thresholds\n\n## Before Implementation\nUse Context7 MCP: Query for Bun test runner patterns and FalkorDB test fixtures.\n\nReview existing test patterns: packages/graph/src/**/*.test.ts\n\n## References\n- Bun test runner: https://bun.sh/docs/cli/test\n- FalkorDB testing: packages/storage/src/__tests__/falkor.test.ts","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:50:01.296618-06:00","updated_at":"2026-01-01T17:07:07.297464-06:00","dependencies":[{"issue_id":"engram-s7qk","depends_on_id":"engram-bdhk","type":"blocks","created_at":"2026-01-01T16:52:10.41526-06:00","created_by":"ccheney"}]}
{"id":"engram-s814","title":"Test coverage: packages/graph/src/graph.ts (95%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:35.575825-06:00","updated_at":"2025-12-21T04:07:03.761846-06:00","closed_at":"2025-12-21T04:07:03.761846-06:00"}
{"id":"engram-s882","title":"[CRITICAL] isUserError not implemented in temporal","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:44.882601-06:00","updated_at":"2025-12-20T23:45:30.4802-06:00","closed_at":"2025-12-20T23:45:30.4802-06:00"}
{"id":"engram-sc6d","title":"Add invalidate() method to FalkorMemoryRepository","description":"Implement invalidate(id, replacedById?) method: SET vt_end=now, tt_end=now, invalidated_at=now. Closes valid time window to mark fact as no longer true.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:21.598161-06:00","updated_at":"2026-01-01T17:33:01.674734-06:00","closed_at":"2026-01-01T17:33:01.674734-06:00"}
{"id":"engram-sdfl","title":"[Observatory Auth] Create React auth client","description":"Create Better Auth React client for frontend authentication. Reference: docs/observatory-auth-implementation-plan.md Step 4. File: apps/observatory/lib/auth-client.ts (NEW). Use createAuthClient from better-auth/react. Configure baseURL from NEXT_PUBLIC_BETTER_AUTH_URL. Export authClient, signIn, signOut, useSession. DEPENDS ON: engram-7d6p (server config must exist first).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:40:34.644314-05:00","updated_at":"2025-12-22T00:53:45.076935-05:00","closed_at":"2025-12-22T00:53:45.076935-05:00","dependencies":[{"issue_id":"engram-sdfl","depends_on_id":"engram-7d6p","type":"blocks","created_at":"2025-12-22T00:43:27.370133-05:00","created_by":"ccheney"}]}
{"id":"engram-se9o","title":"Update packages/infra Pulumi configs with OAuth client credentials","description":"Update OpenTofu configuration files in packages/infra/ to inject OAuth client credentials as environment variables into deployed services. Note: This project uses OpenTofu (open-source Terraform fork), NOT Pulumi.\n\n**Files to modify**:\nAll .tf files in /Users/ccheney/Projects/engram/packages/infra/:\n- server.tf (line 1-64): cloud-init user_data for Hetzner VPS\n- variables.tf (line 1-61): Add new sensitive variables for OAuth secrets\n- backend.tf: Add secret management configuration (if needed)\n\n**Current architecture**:\n- Hetzner Cloud VPS running Ubuntu 24.04 (server.tf)\n- Docker Compose services deployed via rsync + SSH (see .github/workflows/deploy.yml line 349-375)\n- Environment variables injected via .env file creation (deploy.yml line 364-375)\n- Secrets stored in GitHub Actions secrets and passed to OpenTofu via TF_VAR_ env vars\n\n**Required changes**:\n\n1. Add OAuth client credential variables to variables.tf - one sensitive variable per service (api, search, tuner, ingestion, memory, console)\n\n2. Add outputs to outputs.tf for verification (not the secrets themselves, just a list of configured services)\n\n3. Secret management strategy: Secrets are NOT managed directly in OpenTofu - they are stored in GitHub Actions secrets, passed to OpenTofu via TF_VAR_* environment variables, and injected into server .env file via SSH\n\n**Web search instructions for subagent**:\n- Search: 'OpenTofu sensitive variables best practices 2025'\n- Search: 'OpenTofu secrets management Docker Compose 2025'\n- Search: 'Hetzner Cloud OpenTofu configuration patterns'\n\n**Testing**:\n1. Run 'tofu validate' in packages/infra/\n2. Run 'tofu plan' with dummy TF_VAR_ values\n3. Verify outputs show configured OAuth clients\n4. DO NOT run 'tofu apply' - that requires production secrets\n\n**Dependencies**: \n- Blocked by engram-j6pr (API auth rewrite) and engram-qeb4 (Search auth rewrite)\n- Must complete BEFORE engram-szzn (GitHub Actions secrets) since variables.tf defines what secrets are needed","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:54:46.462141-06:00","updated_at":"2025-12-29T16:16:40.83053-06:00","closed_at":"2025-12-29T16:12:30.767376-06:00","dependencies":[{"issue_id":"engram-se9o","depends_on_id":"engram-j6pr","type":"blocks","created_at":"2025-12-29T16:01:13.322-06:00","created_by":"ccheney"},{"issue_id":"engram-se9o","depends_on_id":"engram-qeb4","type":"blocks","created_at":"2025-12-29T16:01:18.466255-06:00","created_by":"ccheney"}]}
{"id":"engram-sek2","title":"Benchmark: Implement abstention question type mapping","description":"packages/benchmark/src/engram_benchmark/metrics/qa.py:102 - Placeholder comment for abstention (ABS) question type. Currently mapped to SINGLE_SESSION_USER as a placeholder, needs proper implementation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T04:02:53.573108-05:00","updated_at":"2025-12-22T04:10:10.739908-05:00","closed_at":"2025-12-22T04:10:10.739908-05:00"}
{"id":"engram-sfjxb","title":"Compiled Query Layer","description":"Epic for implementing compile-time validated queries, schema DSL, generated TypeScript query builders, and declarative MCP tool generation.\n\n## Problem Statement\n\nEngram currently uses string-based Cypher queries that fail at runtime:\n\n```typescript\n// This typo won't be caught until runtime\nconst result = await falkor.query(\n  \\`MATCH (m:Memry {id: $id}) RETURN m\\`,  // 'Memry' typo\n  { id }\n);\n```\n\nAdditionally:\n- **No type inference**: Query results are untyped `Record\u003cstring, any\u003e`\n- **Duplicate definitions**: Schema exists in Zod (nodes.ts) and implicitly in queries\n- **MCP tools are manual**: Each tool is hand-written, not generated from schema\n- **Refactoring is risky**: Renaming a field requires finding all query strings\n\n## Solution\n\nTypeScript-first schema DSL that generates:\n- Type-safe query builders with full IntelliSense\n- Typed repository implementations\n- Zod validators matching the schema\n- MCP tool registrations with JSON Schema\n\n## Design Decisions\n\n| Decision | Choice | Rationale |\n|----------|--------|-----------|\n| Schema format | TypeScript DSL | Stays in ecosystem, IDE support |\n| Code generation | Build-time via Bun plugin | Zero runtime overhead |\n| Query syntax | Chainable builder | Ergonomic for graph traversals |\n| Cypher generation | Build time, validated | Catch errors before runtime |\n| MCP generation | Derive from annotations | Single source of truth |\n| Runtime overhead | Zero | All validation at compile time |\n\n## Architecture\n\n```\nSchema DSL (field.ts, node.ts, edge.ts)\n         ↓\n   defineSchema()\n         ↓\n    Bun Plugin (onStart)\n         ↓\n   Code Generator\n    ↙     ↓      ↘\nTypes  QueryBuilders  Validators\n         ↓\n   Runtime Execution\n         ↓\n     FalkorDB\n```\n\n## Phases \u0026 Dependencies\n\n### Phase 1: Schema Definition DSL (Ready: engram-hd79)\n- engram-hd79: Field type primitives\n- engram-kcjg: Node definition (depends on hd79)\n- engram-c5jh: Edge definition (depends on hd79)\n- engram-0v41: Schema composition (depends on kcjg, c5jh)\n- engram-41sa: Engram schema definition (depends on 0v41)\n- engram-rwtcd: MCP tool annotations (depends on hd79)\n\n### Phase 2: Code Generator (Blocked)\n- engram-brmg: Types generator (depends on 0v41)\n- engram-lzgs: Query builder generator (depends on brmg, ojqv3)\n- engram-0wlo: Repository generator (depends on lzgs)\n- engram-gbem: Validators generator (depends on 0v41)\n- engram-ic8y5: MCP tool generator (depends on rwtcd)\n- engram-o0y7p: Main generator entry (depends on all above)\n\n### Phase 3 \u0026 4: Runtime (Ready: engram-ojqv3)\n- engram-ojqv3: Base query builder runtime\n- engram-gw46c: Traversal builder (depends on ojqv3)\n\n### Phase 5 \u0026 6: Build Integration (Blocked)\n- engram-eb42w: Bun build plugin (depends on o0y7p)\n- engram-hytgz: Codegen CLI (depends on o0y7p)\n- engram-svaf6: Build configuration (depends on eb42w)\n\n### Testing (Blocked)\n- engram-jbyux: Unit tests for schema DSL\n- engram-tg3r6: Unit tests for code generators\n- engram-gzjiv: Unit tests for query builder runtime\n- engram-dtszf: Integration tests (E2E)\n- engram-50jiz: Integration tests (validation)\n\n### Migration (Blocked)\n- engram-fhjlv: Migrate existing queries\n- engram-xgpd0: Migrate MCP tools\n\n## Research Resources\n\n### Before Starting Any Task, Use:\n\n**Context7 MCP:**\n- \\`resolve-library-id('drizzle-orm')\\` → \\`query-docs\\` for schema patterns\n- \\`resolve-library-id('prisma')\\` → \\`query-docs\\` for code generation\n- \\`resolve-library-id('zod')\\` → \\`query-docs\\` for validation\n\n**Web Search Topics:**\n- 'Drizzle ORM TypeScript schema definition'\n- 'Prisma client code generation'\n- 'Bun build plugin API 2025'\n- 'TypeScript fluent API builder pattern'\n- 'Cypher query builder TypeScript'\n- 'ts-morph code generation'\n- 'MCP tool schema JSON'\n\n### Key Documentation\n- Drizzle ORM: https://orm.drizzle.team/\n- Prisma: https://www.prisma.io/docs\n- Bun plugins: https://bun.sh/docs/bundler/plugins\n- ts-morph: https://ts-morph.com/\n- MCP spec: https://modelcontextprotocol.io/specification/2025-06-18/schema\n- Neo4j Cypher-builder: https://github.com/neo4j/cypher-builder\n\n## Success Metrics\n\n- Build-time validation errors caught before runtime\n- Query builder adoption rate in codebase\n- Type coverage of generated code (100%)\n- Developer experience improvement (IDE autocomplete)\n- Reduced time to refactor schema changes\n\n## References\n- Plan document: docs/plans/compiled-query-layer.md\n- Current graph package: packages/graph/src/\n- Current MCP tools: apps/mcp/src/tools/","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-01T16:53:30.336907-06:00","updated_at":"2026-01-01T17:14:25.676369-06:00"}
{"id":"engram-sq0g","title":"Verify production endpoints","description":"End-to-end verification of deployed Engram services.\n\n## Tests to run\n1. Health checks:\n   - GET /health on search (5002)\n   - GET /v1/health on api (8080)\n\n2. Embedding test:\n   - POST /embed with sample text\n   - Verify embeddings are returned\n\n3. Search test:\n   - Index a test document\n   - POST /search with query\n   - Verify results returned\n\n4. Rerank test:\n   - POST /search with rerank=true\n   - Verify reranking works\n\n## Acceptance Criteria\n- All health endpoints return 200\n- Embeddings generate correctly via HF API\n- Search returns relevant results\n- Reranking improves result order","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:32:37.013229-06:00","updated_at":"2025-12-21T15:32:37.013229-06:00","dependencies":[{"issue_id":"engram-sq0g","depends_on_id":"engram-uadt","type":"blocks","created_at":"2025-12-21T15:35:16.128004-06:00","created_by":"ccheney"}]}
{"id":"engram-ss3h","title":"Test coverage: packages/storage/src/postgres.ts (2%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:10.678744-06:00","updated_at":"2025-12-21T04:07:03.769126-06:00","closed_at":"2025-12-21T04:07:03.769126-06:00"}
{"id":"engram-sssn","title":"Wire control event handler for turn management","description":"apps/memory ControlEventHandler (control.handler.ts:1-44) is a no-op stub that only logs. Turn boundaries detected via user content only. Wire up turn_start/turn_end signals.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:10:24.867419-06:00","updated_at":"2025-12-20T23:23:23.203942-06:00","closed_at":"2025-12-20T23:23:23.203942-06:00"}
{"id":"engram-svaf6","title":"Update build configuration for codegen","description":"Update package.json, bunfig.toml, and tsconfig.json for code generation\n\n## Overview\nThis task updates the build configuration to integrate the code generation plugin and add new scripts for manual generation.\n\n## Requirements\n\n### package.json (packages/graph)\n```json\n{\n  \"scripts\": {\n    \"generate\": \"bun run src/codegen/cli.ts\",\n    \"generate:dry\": \"bun run src/codegen/cli.ts --dry-run\",\n    \"build\": \"bun run generate \u0026\u0026 bun build src/index.ts --outdir dist\",\n    \"prebuild\": \"bun run generate\"\n  }\n}\n```\n\n### bunfig.toml (root)\n```toml\n[build]\nplugins = [\"./packages/graph/src/codegen/bun-plugin.ts\"]\n```\n\n### tsconfig.json (packages/graph)\n```json\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@engram/graph/generated\": [\"./src/generated/*\"],\n      \"@engram/graph/generated/*\": [\"./src/generated/*\"]\n    }\n  },\n  \"include\": [\"src/**/*\", \"src/generated/**/*\"]\n}\n```\n\n### .gitignore additions\n```\n# Generated code (optional - could be committed)\npackages/graph/src/generated/\n!packages/graph/src/generated/.gitkeep\n```\n\n## Research Required\nUse web search for:\n- 'Bun build plugin configuration'\n- 'TypeScript path aliases monorepo'\n- 'Prisma generated files gitignore'\n- 'Drizzle-kit output configuration'\n\n## Decision: Commit Generated Files?\nConsider:\n- **Commit**: Easier to review changes, works without build step, visible in PRs\n- **Don't commit**: Cleaner repo, always fresh, no merge conflicts\n\nRecommendation: Don't commit generated files initially, add later if needed.\n\n## Files\n- packages/graph/package.json\n- bunfig.toml\n- packages/graph/tsconfig.json\n- .gitignore\n\n## References\n- Bun build plugins: https://bun.sh/docs/bundler/plugins\n- TypeScript paths: https://www.typescriptlang.org/tsconfig#paths\n- Plan: docs/plans/compiled-query-layer.md lines 812-860","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:52:01.896469-06:00","updated_at":"2026-01-01T17:11:37.543099-06:00","dependencies":[{"issue_id":"engram-svaf6","depends_on_id":"engram-eb42w","type":"blocks","created_at":"2026-01-01T16:56:09.341229-06:00","created_by":"ccheney"}]}
{"id":"engram-syb7","title":"Remove mock data from alerts/page.tsx","description":"Remove mock data fallback from Alerts page (lines 1053+). Replace with proper 'No Data' state showing that the API is not connected or no alerts exist.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:51:21.420538-05:00","updated_at":"2025-12-27T20:04:22.765669-05:00","closed_at":"2025-12-27T20:04:22.765669-05:00"}
{"id":"engram-szzn","title":"Update GitHub Actions secrets for OAuth service credentials","description":"Add GitHub Actions repository secrets for OAuth client credentials and update workflow files to inject secrets into OpenTofu and production deployment.\n\n**Repository secrets to add** (Settings → Secrets and variables → Actions → New repository secret):\n\n1. ENGRAM_API_CLIENT_SECRET - OAuth client secret for API service (egm_client_*)\n2. ENGRAM_SEARCH_CLIENT_SECRET - OAuth client secret for Search service\n3. ENGRAM_TUNER_CLIENT_SECRET - OAuth client secret for Tuner service\n4. ENGRAM_INGESTION_CLIENT_SECRET - OAuth client secret for Ingestion service\n5. ENGRAM_MEMORY_CLIENT_SECRET - OAuth client secret for Memory service\n6. ENGRAM_CONSOLE_CLIENT_SECRET - OAuth client secret for Console service\n\n**Secrets to REMOVE**:\n- ENGRAM_API_TOKEN (currently used by Console, line 256 of docker-compose.prod.yml)\n- Any other legacy API key secrets\n\n**Files to update**:\n/Users/ccheney/Projects/engram/.github/workflows/deploy.yml:\n\n**1. OpenTofu infrastructure job** (line 111-316):\nAdd secrets to environment variables in 'OpenTofu Plan' step (line 284-296):\n\n\nAlso add to 'OpenTofu Apply' step (line 298-308).\n\n**2. Sync job - .env file creation** (line 364-375):\nReplace ENGRAM_API_TOKEN with OAuth client secrets:\n\n\n**Secret generation process** (for documentation):\n1. Use scripts/seed-oauth-clients.ts to register each service as an OAuth client\n2. Observatory will generate egm_client_* tokens with CRC32 checksums\n3. Store client_secret values in GitHub Actions secrets\n4. Client secrets are hashed with bcrypt before storage in oauth_clients table\n\n**Testing**:\n1. After adding secrets, trigger workflow with workflow_dispatch\n2. Check deployment logs for successful .env file creation\n3. Verify services start successfully with new OAuth credentials\n4. Check service logs for successful token introspection calls\n\n**Dependencies**: \n- Blocked by engram-se9o (OpenTofu variables must be defined first)\n- Should coordinate with scripts/seed-oauth-clients.ts creation to generate actual secret values","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:54:52.661715-06:00","updated_at":"2025-12-29T19:02:03.988265-06:00","closed_at":"2025-12-29T17:07:05.359122-06:00","dependencies":[{"issue_id":"engram-szzn","depends_on_id":"engram-se9o","type":"blocks","created_at":"2025-12-29T16:01:25.157676-06:00","created_by":"ccheney"},{"issue_id":"engram-szzn","depends_on_id":"engram-5034","type":"blocks","created_at":"2025-12-29T16:13:02.317827-06:00","created_by":"ccheney"}]}
{"id":"engram-t0c7","title":"Expose ApiKeyRepository.revoke() and listByUser() via API","description":"apps/api db/api-keys.ts:178-207 has revoke() and listByUser() methods implemented but no endpoints expose them.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:15:03.878062-06:00","updated_at":"2025-12-20T23:26:00.43544-06:00","closed_at":"2025-12-20T23:26:00.43544-06:00"}
{"id":"engram-t1d1","title":"Test coverage: apps/control/src/execution/service.ts (78%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:15.871866-06:00","updated_at":"2025-12-21T04:07:03.768032-06:00","closed_at":"2025-12-21T04:07:03.768032-06:00"}
{"id":"engram-t1n56","title":"Implement decay score calculation","description":"Create apps/worker/src/algorithms/decay.ts. Formula: decay_score = type_weight × recency_factor × access_factor. type_weight: decision=1.0, preference=0.9, insight=0.8, fact=0.7, context=0.5, turn=0.3. recency_factor: exp(-0.01 × days). access_factor: 1 + log(1 + access_count) × 0.1\n\n## Implementation\n```typescript\ninterface DecayInput {\n  type: MemoryType;\n  createdAt: number;      // vt_start timestamp\n  lastAccessed?: number;  // last recall timestamp\n  accessCount: number;    // times returned in recall\n  pinned: boolean;        // never decay if true\n}\n\nfunction calculateDecayScore(input: DecayInput, now: number): number {\n  if (input.pinned) return 1.0;\n  \n  const typeWeight = TYPE_WEIGHTS[input.type] ?? 0.5;\n  const daysSinceCreation = (now - input.createdAt) / MS_PER_DAY;\n  const recencyFactor = Math.exp(-LAMBDA * daysSinceCreation);\n  const accessFactor = 1 + Math.log(1 + input.accessCount) * 0.1;\n  \n  return Math.min(1.0, typeWeight * recencyFactor * accessFactor);\n}\n```\n\n## Research Basis\nBased on Generative Agents memory scoring: Recency × Importance × Relevance\n- Our type_weight maps to Importance\n- recency_factor implements exponential decay (~0.995/hour as in the paper)\n- access_factor provides rehearsal boost (frequently-accessed memories resist decay)\n\n## Before Implementation\nUse web search: 'exponential decay memory retrieval LLM agents formula'\n\n## References\n- Generative Agents: https://arxiv.org/abs/2304.03442 (Section 5.2)\n- Memory in LLM Agents: https://pmc.ncbi.nlm.nih.gov/articles/PMC12092450/","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:57.765387-06:00","updated_at":"2026-01-01T17:08:31.160355-06:00"}
{"id":"engram-t4ms","title":"Implement ConflictDetectorService","description":"Create apps/mcp/src/services/conflict-detector.ts: detectConflicts() method, tryWithSampling() using MCP sampling, classifyWithGemini() fallback via LiteLLM with JSON schema response_format, buildPrompt() and parseResponse() helpers","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:42:47.88022-06:00","updated_at":"2026-01-01T17:45:06.808309-06:00","closed_at":"2026-01-01T17:45:06.808309-06:00","dependencies":[{"issue_id":"engram-t4ms","depends_on_id":"engram-jroc","type":"blocks","created_at":"2026-01-01T16:44:56.647348-06:00","created_by":"ccheney"},{"issue_id":"engram-t4ms","depends_on_id":"engram-0gie","type":"blocks","created_at":"2026-01-01T16:45:01.77935-06:00","created_by":"ccheney"}]}
{"id":"engram-t6jy","title":"Test coverage: packages/parser/src/parser/opencode.ts (92%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:29.248676-06:00","updated_at":"2025-12-21T04:07:03.763871-06:00","closed_at":"2025-12-21T04:07:03.763871-06:00"}
{"id":"engram-t6x9","title":"Implement POST /api/auth/device/token endpoint","description":"Create apps/observatory/app/api/auth/device/token/route.ts - Token polling endpoint supporting grant_type device_code and refresh_token. Returns authorization_pending/slow_down/expired_token errors or success with access_token, refresh_token, user info. See docs/design/oauth-device-flow.md 'Poll for Token' and 'Refresh Token' sections.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T02:19:53.643811-05:00","updated_at":"2025-12-25T02:32:44.624929-05:00","closed_at":"2025-12-25T02:32:44.624929-05:00","dependencies":[{"issue_id":"engram-t6x9","depends_on_id":"engram-cgk8","type":"blocks","created_at":"2025-12-25T02:21:13.169268-05:00","created_by":"ccheney"}]}
{"id":"engram-tg3r6","title":"Unit tests: Code generators","description":"Create unit tests for all code generators\n\n## Overview\nThese tests validate that the code generators produce correct, compilable TypeScript code from schema definitions. Use snapshot testing to detect unexpected changes.\n\n## Test Coverage\n\n### Types Generator (types-generator.test.ts)\n- Generates interface for simple node\n- Handles all field types correctly\n- Includes bitemporal fields\n- Generates enum types\n- Generates Create/Update input types\n\n### Query Builder Generator (query-builder-generator.test.ts)\n- Generates query builder class\n- Includes correct nodeLabel\n- Generates field-specific methods\n- Generates static convenience methods\n- Generates traversal stubs\n\n### Repository Generator (repository-generator.test.ts)\n- Generates repository class\n- Includes all CRUD methods\n- Generates temporal query methods\n- Extends FalkorBaseRepository\n\n### Validators Generator (validators-generator.test.ts)\n- Generates Zod schemas\n- Handles all field types\n- Generates input schemas\n- Correct optional handling\n\n### MCP Generator (mcp-generator.test.ts)\n- Generates tool registration\n- Produces valid JSON Schema\n- Includes handler wrapper\n- Handles input/output schemas\n\n## Test Strategy\n```typescript\nimport { describe, test, expect } from 'bun:test';\nimport { generateTypes } from './types-generator';\nimport { defineSchema, node, field } from '../schema';\n\ndescribe('types generator', () =\u003e {\n  const testSchema = defineSchema({\n    nodes: {\n      TestNode: node({\n        name: field.string(),\n        count: field.int().optional(),\n      }),\n    },\n    edges: {},\n  });\n\n  test('generates correct interface', () =\u003e {\n    const output = generateTypes(testSchema);\n    expect(output).toMatchSnapshot();\n  });\n\n  test('generated code compiles', async () =\u003e {\n    const output = generateTypes(testSchema);\n    // Write to temp file and run tsc --noEmit\n    const tempFile = `/tmp/test-${Date.now()}.ts`;\n    await Bun.write(tempFile, output);\n    const proc = Bun.spawn(['bun', 'run', 'tsc', '--noEmit', tempFile]);\n    const exitCode = await proc.exited;\n    expect(exitCode).toBe(0);\n  });\n});\n```\n\n## Research Required\nUse web search for:\n- 'Bun test snapshot testing'\n- 'TypeScript code generation testing'\n- 'Testing generated code compiles'\n- 'Jest snapshot testing best practices'\n\n## Files\n- packages/graph/src/codegen/types-generator.test.ts\n- packages/graph/src/codegen/query-builder-generator.test.ts\n- packages/graph/src/codegen/repository-generator.test.ts\n- packages/graph/src/codegen/validators-generator.test.ts\n- packages/graph/src/codegen/mcp-generator.test.ts\n\n## References\n- Bun test snapshots: https://bun.sh/docs/cli/test#snapshot-testing\n- Plan: docs/plans/compiled-query-layer.md lines 873-878","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:52:13.896317-06:00","updated_at":"2026-01-01T17:11:50.515745-06:00","dependencies":[{"issue_id":"engram-tg3r6","depends_on_id":"engram-o0y7p","type":"blocks","created_at":"2026-01-01T16:56:28.17956-06:00","created_by":"ccheney"}]}
{"id":"engram-tmrj","title":"[HIGH] No backup policies for databases in infra","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:20.559458-06:00","updated_at":"2025-12-20T23:58:07.71249-06:00","closed_at":"2025-12-20T23:58:07.71249-06:00"}
{"id":"engram-tqfu","title":"[Search-Py] Phase 4: Indexing \u0026 Kafka","description":"Implement Kafka consumer and document indexing using aiokafka. Consumer subscribes to memory.node_created topic. Document indexer generates embeddings (dense + sparse + ColBERT) and upserts to Qdrant. Batch indexing queue for throughput. Redis pub/sub for consumer status (consumer_ready, heartbeat, disconnected). Schema manager for Qdrant collection management.\n\nReference: docs/plans/search-python-migration.md (Phase 5: Indexing \u0026 Kafka)\n\nDeliverables:\n- src/search/indexing/consumer.py - aiokafka consumer\n- src/search/indexing/indexer.py - Document indexing with multi-vector\n- src/search/indexing/batch.py - Batch queue with flush\n- src/search/clients/kafka.py - Kafka client wrapper\n- src/search/clients/redis.py - Redis pub/sub\n- src/search/services/schema_manager.py - Qdrant collection setup\n- Integration tests with Redpanda\n- Consumer lifecycle tests","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:21:56.829224-06:00","updated_at":"2025-12-20T09:06:03.617511-06:00","closed_at":"2025-12-20T09:06:03.617511-06:00","dependencies":[{"issue_id":"engram-tqfu","depends_on_id":"engram-6kci","type":"blocks","created_at":"2025-12-20T07:22:57.188707-06:00","created_by":"ccheney"}]}
{"id":"engram-ttcr","title":"Add auth to Tuner service endpoints","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T23:12:49.030634-05:00","updated_at":"2025-12-21T23:21:26.564104-05:00","closed_at":"2025-12-21T23:21:26.564104-05:00","dependencies":[{"issue_id":"engram-ttcr","depends_on_id":"engram-ws66","type":"blocks","created_at":"2025-12-21T23:13:09.032268-05:00","created_by":"ccheney"}]}
{"id":"engram-tuxd","title":"Preserve vt_start through ingestion pipeline","description":"Ensure vt_start from RawStreamEvent flows through ParsedEvent to memory service. File: apps/ingestion/src/index.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T15:45:17.213237-05:00","updated_at":"2025-12-27T15:56:08.870429-05:00","closed_at":"2025-12-27T15:56:08.870429-05:00"}
{"id":"engram-tvfe","title":"[CRITICAL] Path traversal vulnerability in VirtualFileSystem","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:06.639639-06:00","updated_at":"2025-12-20T23:45:30.484498-06:00","closed_at":"2025-12-20T23:45:30.484498-06:00"}
{"id":"engram-tx3n","title":"[HIGH] runTrials doesn't handle per-trial failures","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:43.531664-06:00","updated_at":"2025-12-20T23:57:31.047251-06:00","closed_at":"2025-12-20T23:57:31.047251-06:00"}
{"id":"engram-u1bj","title":"Test coverage: apps/memory/src/handlers/control.handler.ts (35%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:58.933346-06:00","updated_at":"2025-12-21T04:07:03.755888-06:00","closed_at":"2025-12-21T04:07:03.755888-06:00"}
{"id":"engram-u1ng","title":"Add keyboard shortcuts (vim-style navigation)","description":"Keyboard navigation: j/k for list navigation, g+p for panels, Cmd+E for environment switcher","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:23:56.726856-05:00","updated_at":"2025-12-27T04:23:56.726856-05:00"}
{"id":"engram-u63o","title":"Add tests: DPoP proof signature verification (ES256)","description":"Add comprehensive tests for DPoP proof signature verification using ES256 (ECDSA with P-256 and SHA-256). Create test file: /Users/ccheney/Projects/engram/apps/observatory/lib/dpop.test.ts (currently missing). Test valid ES256 signature verification: generate JWK keypair, create DPoP proof JWT with alg=ES256, verify signature succeeds. Test invalid signature rejection: tamper with proof body after signing, verify rejection. Test expired proof rejection: create proof with exp claim in past, verify rejection. Test replay detection: use same jti (JWT ID) twice, second attempt should fail. Use panva/jose library for JWT operations (see Context7 MCP /panva/jose for patterns). Follow test patterns from /Users/ccheney/Projects/engram/apps/observatory/lib/oauth.test.ts using Bun test runner with mock.module. DPoP implements RFC 9449 for sender-constrained tokens to prevent token theft.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:56:22.343446-06:00","updated_at":"2025-12-29T16:28:11.510658-06:00","closed_at":"2025-12-29T16:28:11.510658-06:00","dependencies":[{"issue_id":"engram-u63o","depends_on_id":"engram-vb58","type":"blocks","created_at":"2025-12-29T16:03:46.925374-06:00","created_by":"ccheney"}]}
{"id":"engram-u6od","title":"[Observatory Auth] Create UserMenu component","description":"Create UserMenu component for displaying authenticated user and sign-out. Reference: docs/observatory-auth-implementation-plan.md Step 9. File: apps/observatory/app/components/UserMenu.tsx (NEW). Features: User avatar (from Google), user name/email display, dropdown menu on click, sign-out button, loading skeleton state, responsive (hide name on mobile). Use useSession hook from auth-client. Style to match Observatory theme. DEPENDS ON: engram-sdfl (auth client). ⚠️ IMPORTANT: This is a UI task. You MUST use the frontend-design skill (/frontend-design) to implement this component. NO EXCEPTIONS.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:41:45.653622-05:00","updated_at":"2025-12-22T00:58:06.932881-05:00","closed_at":"2025-12-22T00:58:06.932881-05:00","dependencies":[{"issue_id":"engram-u6od","depends_on_id":"engram-sdfl","type":"blocks","created_at":"2025-12-22T00:44:03.298352-05:00","created_by":"ccheney"}]}
{"id":"engram-uadt","title":"Deploy to Hetzner VPS","description":"Run initial deployment of Engram to Hetzner VPS.\n\n## Pre-requisites\n- Server is set up with Docker\n- docker-compose.prod.yml is ready\n- .env file is configured with secrets\n- deploy.sh script works\n\n## Steps\n1. Create /opt/engram directory on server\n2. Copy .env file with production secrets\n3. Run deploy.sh\n4. Verify all containers are healthy\n\n## Verification\n```bash\nssh engram@$(hcloud server ip engram)\ncd /opt/engram\ndocker compose -f docker-compose.prod.yml ps\ndocker compose -f docker-compose.prod.yml logs search\ncurl localhost:5002/health\ncurl localhost:8080/v1/health\n```\n\n## Acceptance Criteria\n- All containers running and healthy\n- Health endpoints return 200\n- Logs show no errors","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T15:32:31.054121-06:00","updated_at":"2025-12-21T15:32:31.054121-06:00","dependencies":[{"issue_id":"engram-uadt","depends_on_id":"engram-6g4u","type":"blocks","created_at":"2025-12-21T15:34:59.380008-06:00","created_by":"ccheney"},{"issue_id":"engram-uadt","depends_on_id":"engram-qc0v","type":"blocks","created_at":"2025-12-21T15:35:04.511198-06:00","created_by":"ccheney"},{"issue_id":"engram-uadt","depends_on_id":"engram-atad","type":"blocks","created_at":"2025-12-21T15:51:44.733727-06:00","created_by":"ccheney"}]}
{"id":"engram-ugfn","title":"Implement per-session result aggregation","description":"Add session-aware aggregation that limits results per session and deduplicates across collections. Prevents single session from dominating results.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:12:53.620434-06:00","updated_at":"2025-12-21T06:50:42.311622-06:00","closed_at":"2025-12-21T06:50:42.311622-06:00"}
{"id":"engram-ui9p1","title":"Add tests for packages/storage clients","description":"Missing tests for critical storage clients:\n- falkor.ts (FalkorDB client)\n- nats.ts (NATS pub/sub client)\n- interfaces.ts\n\nPriority: HIGH - Core infrastructure clients","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:20:31.545969-06:00","updated_at":"2026-01-01T17:20:31.545969-06:00"}
{"id":"engram-ul3l","title":"Wire PostgreSQL transaction support","description":"packages/storage PostgresClient.transaction() (postgres.ts:95-112) implemented but never called anywhere. Consider using for atomic API key operations or remove.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:10:12.567978-06:00","updated_at":"2025-12-20T23:25:33.965325-06:00","closed_at":"2025-12-20T23:25:33.965325-06:00"}
{"id":"engram-umb6","title":"Test coverage: packages/infra/src/k8s/namespace.ts (branches 62%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:59.637963-06:00","updated_at":"2025-12-21T04:07:03.755634-06:00","closed_at":"2025-12-21T04:07:03.755634-06:00"}
{"id":"engram-uqrv","title":"[Observatory Auth] Create sign-in page","description":"Create Google OAuth sign-in page for Observatory. Reference: docs/observatory-auth-implementation-plan.md Step 7. File: apps/observatory/app/sign-in/page.tsx (NEW). Features: Google sign-in button with Google logo SVG, loading state, error handling, glass-panel styling matching Observatory theme, ENGRAM branding. Use authClient.signIn.social with provider google and callbackURL /. DEPENDS ON: engram-sdfl (auth client), engram-62xa (middleware). ⚠️ IMPORTANT: This is a UI task. You MUST use the frontend-design skill (/frontend-design) to implement this component. NO EXCEPTIONS.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:41:18.588083-05:00","updated_at":"2025-12-22T00:58:06.931498-05:00","closed_at":"2025-12-22T00:58:06.931498-05:00","dependencies":[{"issue_id":"engram-uqrv","depends_on_id":"engram-sdfl","type":"blocks","created_at":"2025-12-22T00:43:47.899096-05:00","created_by":"ccheney"},{"issue_id":"engram-uqrv","depends_on_id":"engram-62xa","type":"blocks","created_at":"2025-12-22T00:43:53.038796-05:00","created_by":"ccheney"}]}
{"id":"engram-urnx","title":"Add smart scheduling based on activity","description":"Enhance scheduler to track entity creation rate and trigger community detection when threshold exceeded (e.g., 100 new entities since last run). Track in Redis or NATS KV store. Future enhancement marker.\n\n## Activity Tracking\n- Subscribe to memory.node_created events\n- Increment counter for entity creations per project\n- When counter \u003e threshold, publish community-detection job\n- Reset counter after job triggered\n\n## Storage Options\n1. NATS KV Store (preferred - already have NATS)\n2. Redis (if complex queries needed)\n\n## Threshold Configuration\n```typescript\ninterface ActivityThresholds {\n  entityCreationThreshold: number;  // default: 100\n  memoryCreationThreshold: number;  // default: 500\n  cooldownMinutes: number;          // default: 60 (prevent thrashing)\n}\n```\n\n## Before Implementation\nUse Context7 MCP: Query 'nats.js' for KV store patterns.\n\n## References\n- NATS KV: https://docs.nats.io/nats-concepts/jetstream/key-value-store\n- Node events: packages/storage/src/nats.ts (memory.node_created)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:06.590352-06:00","updated_at":"2026-01-01T17:11:05.232945-06:00"}
{"id":"engram-uso8","title":"[MEDIUM] formatBytes array bounds error","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:57.317516-06:00","updated_at":"2025-12-21T00:09:56.47735-06:00","closed_at":"2025-12-21T00:09:56.47735-06:00"}
{"id":"engram-uxh4","title":"Register engram-tuner OAuth client (scopes: tuner:read, tuner:write)","description":"Register engram-tuner as OAuth client for Tuner service M2M auth.\n\n**Prerequisites:** Run seed-oauth-clients.ts script from engram-h44m\n\n**Client configuration:**\n- client_id: engram-tuner\n- scopes: tuner:read, tuner:write\n- grant_types: client_credentials\n- token_endpoint_auth_method: client_secret_basic\n\n**Environment variables to set:**\n```bash\n# In apps/tuner/.env or docker-compose\nENGRAM_CLIENT_ID=engram-tuner\nENGRAM_CLIENT_SECRET=\u003cfrom seed script output\u003e\nENGRAM_AUTH_URL=https://observatory.engram.rawcontext.com\n# For local dev:\nENGRAM_AUTH_URL=http://localhost:6178\n```\n\n**Tuner service usage:**\nThe tuner Python service will use these credentials to:\n1. Request access token from /api/auth/token\n2. Include DPoP proof in request\n3. Use token to call Search service APIs\n4. Re-authenticate when token expires (no refresh)\n\n**Files to update:**\n- `apps/tuner/.env.example` - add new env vars\n- `docker-compose.dev.yml` - add tuner service env\n\n**References:**\n- OAuth client credentials flow: https://auth0.com/docs/get-started/authentication-and-authorization-flow/client-credentials-flow\n\n**Subagent instructions:**\n- Verify seed script ran successfully first\n- Check client exists: `psql -c \"SELECT * FROM oauth_clients WHERE client_id='engram-tuner'\"`\n- Update .env.example files","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:52:42.003332-06:00","updated_at":"2025-12-29T16:41:52.611656-06:00","closed_at":"2025-12-29T16:41:52.611656-06:00","dependencies":[{"issue_id":"engram-uxh4","depends_on_id":"engram-h44m","type":"blocks","created_at":"2025-12-29T15:58:08.902997-06:00","created_by":"ccheney"}]}
{"id":"engram-uxiua","title":"Create DecayCalculator job handler","description":"Create apps/worker/src/jobs/decay-calculator.ts. Load active memories (exclude pinned), calculate decay scores, batch update to FalkorDB. Subscribe to engram.jobs.decay-calculation NATS subject. Runs daily at 2am.\n\n## Job Flow\n1. Load active memories: WHERE tt_end = $MAX_DATE AND vt_end = $MAX_DATE AND pinned = false\n2. Partition by project/org for isolation\n3. Calculate decay_score for each memory using decay algorithm\n4. Batch update (100 at a time) to minimize graph transactions\n5. Log summary: memories processed, avg decay, min/max scores\n\n## Performance Considerations\n- 100K memories target: ~30 seconds with batching\n- Use UNWIND for batch Cypher updates\n- Skip memories where |old_score - new_score| \u003c 0.01 (no meaningful change)\n\n## Job Message Schema\n```typescript\ninterface DecayCalculationJob {\n  project?: string;  // Optional filter, default: all projects\n  orgId: string;\n  triggeredBy: 'cron' | 'manual';\n}\n```\n\n## Before Implementation\nUse Context7 MCP: Query FalkorDB for batch update patterns with UNWIND.\n\n## References\n- Memory repository: packages/graph/src/repositories/falkor-memory.repository.ts\n- Decay algorithm: apps/worker/src/algorithms/decay.ts\n- Batch patterns: packages/graph/src/writer.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:51:03.600823-06:00","updated_at":"2026-01-01T17:10:08.536118-06:00","dependencies":[{"issue_id":"engram-uxiua","depends_on_id":"engram-okfbx","type":"blocks","created_at":"2026-01-01T16:52:00.741888-06:00","created_by":"ccheney"},{"issue_id":"engram-uxiua","depends_on_id":"engram-t1n56","type":"blocks","created_at":"2026-01-01T16:52:06.701611-06:00","created_by":"ccheney"},{"issue_id":"engram-uxiua","depends_on_id":"engram-dtbw","type":"blocks","created_at":"2026-01-01T17:08:16.488002-06:00","created_by":"ccheney"}]}
{"id":"engram-uyts","title":"Test coverage: packages/vfs/src/patch.ts (91%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:12.743926-06:00","updated_at":"2025-12-21T01:43:49.821338-06:00","closed_at":"2025-12-21T01:43:49.821338-06:00"}
{"id":"engram-v4sh","title":"Add NATS JetStream to docker-compose.dev.yml","description":"Add NATS server with JetStream enabled to docker-compose.dev.yml.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 1: Docker Compose Updates\n\n## Implementation\n- Add nats service with image nats:2.12-alpine (latest stable)\n- Enable JetStream with --jetstream flag\n- Configure store_dir for persistence\n- Expose ports 4222 (client) and 8222 (monitoring)\n- Add healthcheck\n- Add nats-data volume\n\n## Acceptance Criteria\n- NATS container starts successfully\n- JetStream is enabled (check http://localhost:8222/jsz)\n- Health check passes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:25:23.872489-05:00","updated_at":"2025-12-22T00:39:47.793853-05:00","closed_at":"2025-12-22T00:39:47.793853-05:00"}
{"id":"engram-v85w","title":"Make tuner objective weights CLI-configurable","description":"packages/tuner ObjectiveConfig.weights and latencyBudgetMs are hardcoded in CLI. Should be exposed as command-line options.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:15:53.050069-06:00","updated_at":"2025-12-20T23:21:02.645461-06:00","closed_at":"2025-12-20T23:21:02.645461-06:00"}
{"id":"engram-vaco","title":"Remove Redpanda from docker-compose","description":"Remove Redpanda service from all docker-compose files.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 8: Files to Delete\n\n## Files to Update\n- docker-compose.dev.yml - remove redpanda service\n- docker-compose.prod.yml - remove redpanda service\n\n## Also Remove\n- redpanda-data volume definition\n- Any depends_on references to redpanda\n- Update service environment variables from REDPANDA_BROKERS to NATS_URL\n\n## Acceptance Criteria\n- No Redpanda references in docker-compose files\n- docker-compose up works without Redpanda\n- All services connect to NATS instead","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:28:07.344735-05:00","updated_at":"2025-12-22T00:50:09.549382-05:00","closed_at":"2025-12-22T00:50:09.549382-05:00","dependencies":[{"issue_id":"engram-vaco","depends_on_id":"engram-vwt9","type":"blocks","created_at":"2025-12-22T00:30:37.054028-05:00","created_by":"ccheney"},{"issue_id":"engram-vaco","depends_on_id":"engram-evdz","type":"blocks","created_at":"2025-12-22T00:30:42.185882-05:00","created_by":"ccheney"},{"issue_id":"engram-vaco","depends_on_id":"engram-1crc","type":"blocks","created_at":"2025-12-22T00:30:47.317427-05:00","created_by":"ccheney"},{"issue_id":"engram-vaco","depends_on_id":"engram-llff","type":"blocks","created_at":"2025-12-22T00:30:52.450103-05:00","created_by":"ccheney"},{"issue_id":"engram-vaco","depends_on_id":"engram-5y7s","type":"blocks","created_at":"2025-12-22T00:30:57.582408-05:00","created_by":"ccheney"}]}
{"id":"engram-vb58","title":"Create DPoP proof validation library (apps/observatory/lib/dpop.ts)","description":"Create DPoP (Demonstrating Proof of Possession) validation library per RFC 9449.\n\n**File to create:** `apps/observatory/lib/dpop.ts`\n\n**Key functions to implement:**\n```typescript\ninterface DPoPProof {\n  jti: string;      // Unique JWT ID (replay prevention)\n  htm: string;      // HTTP method (POST, GET, etc.)\n  htu: string;      // HTTP URI (token endpoint URL)\n  iat: number;      // Issued at timestamp\n}\n\nexport async function validateDPoPProof(\n  dpopHeader: string,\n  expectedMethod: string,\n  expectedUri: string,\n  options?: { maxAge?: number; allowedAlgorithms?: string[] }\n): Promise\u003c{ valid: boolean; jwkThumbprint?: string; error?: string }\u003e\n\nexport function calculateJwkThumbprint(jwk: JWK): string\n```\n\n**Dependencies:**\n- Use `jose` library (already in project): `import * as jose from 'jose'`\n- ES256 (P-256 ECDSA) is the required algorithm per RFC 9449\n\n**DPoP Validation Steps (RFC 9449 §4.3):**\n1. Verify JWT signature using embedded JWK in header\n2. Verify `typ` header is \"dpop+jwt\"\n3. Verify `alg` is ES256 (or allowed algorithm)\n4. Verify `htm` matches request HTTP method\n5. Verify `htu` matches request URI\n6. Verify `iat` is within acceptable time window (default 5 min)\n7. Check `jti` hasn't been seen before (replay prevention)\n8. Calculate JWK thumbprint for token binding\n\n**References:**\n- RFC 9449 DPoP: https://datatracker.ietf.org/doc/html/rfc9449\n- RFC 9700 OAuth Security BCP (Jan 2025): https://datatracker.ietf.org/doc/rfc9700/\n- Auth0 DPoP Guide: https://auth0.com/blog/protect-your-access-tokens-with-dpop/\n- Curity DPoP Overview: https://curity.io/resources/learn/dpop-overview/\n\n**Subagent instructions:**\n- CRITICAL: Use Context7 MCP with `/panva/jose` to get current jose API docs\n- Web search \"DPoP implementation TypeScript 2025\" for latest patterns\n- Web search \"RFC 9449 jwk thumbprint calculation\" for exact algorithm\n- Check `apps/observatory/lib/device-auth.ts` for existing token patterns\n- Run tests: `cd apps/observatory \u0026\u0026 bun test`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:51:41.657972-06:00","updated_at":"2025-12-29T16:23:19.923322-06:00","closed_at":"2025-12-29T16:23:19.923322-06:00"}
{"id":"engram-veww","title":"Add vt_start/tt_start to Session MERGE query","description":"Add bitemporal fields to Session node creation in handlePersistenceMessage.\n\nFile: apps/memory/src/index.ts (lines 305-327)\n\nChange:\n```cypher\nON CREATE SET\n  s.vt_start = $now,\n  s.tt_start = $now,\n  ...existing fields...\n```\n\nFollows bitemporal design pattern: vt_start marks when fact became valid, tt_start marks when recorded.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T11:26:03.540481-05:00","updated_at":"2025-12-27T15:53:31.620657-05:00","closed_at":"2025-12-27T15:53:31.620657-05:00"}
{"id":"engram-vl37","title":"Extend oauth_tokens table with grant_type and client_id_ref columns","description":"Extend oauth_tokens table to support client credentials grant type.\n\n**File to modify:** `apps/api/src/db/init.sql`\n\n**Schema changes (add to existing oauth_tokens table):**\n```sql\n-- Add to oauth_tokens table definition:\ngrant_type TEXT DEFAULT 'device_code',\nclient_id_ref UUID REFERENCES oauth_clients(id) ON DELETE SET NULL,\n\n-- Add index for client credentials lookup:\nCREATE INDEX idx_oauth_tokens_client ON oauth_tokens(client_id_ref)\n  WHERE grant_type = 'client_credentials';\n```\n\n**Grant types to support:**\n- `device_code` (existing, default)\n- `client_credentials` (new, for M2M)\n- `refresh_token` (existing)\n\n**IMPORTANT: Database reset approach (pre-alpha dev only)**\n- Do NOT create migration files\n- Directly modify `apps/api/src/db/init.sql`\n- Reset database after changes: `bun run infra:down \u0026\u0026 bun run infra:up`\n- This is acceptable in pre-alpha dev with no production data\n\n**Current schema location:** `apps/api/src/db/init.sql`\n**OAuth token repository:** `apps/api/src/db/oauth-tokens.ts`\n\n**References:**\n- PostgreSQL UUID: https://www.postgresql.org/docs/current/datatype-uuid.html\n- OAuth grant types: https://oauth.net/2/grant-types/\n\n**Subagent instructions:**\n- Read `apps/api/src/db/init.sql` to understand current schema\n- Read `apps/api/src/db/oauth-tokens.ts` for repository patterns\n- Web search \"PostgreSQL partial index best practices 2025\"\n- After schema update, run: `bun run infra:down \u0026\u0026 bun run infra:up`\n- Verify with: `docker exec -it engram-postgres-1 psql -U engram -d engram -c '\\d oauth_tokens'`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T15:52:29.550762-06:00","updated_at":"2025-12-29T16:23:21.867372-06:00","closed_at":"2025-12-29T16:23:21.867372-06:00"}
{"id":"engram-vldw","title":"Implement tenant context runtime function","description":"Create setTenantContext() function for setting RLS context at runtime.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Setting Tenant Context at Runtime' section (lines 340-361)\n\n## Implementation\nAdd to apps/observatory/lib/db.ts:\n```typescript\nexport async function setTenantContext(orgId: string): Promise\u003cvoid\u003e {\n  await db.execute(sql`SELECT set_config('app.current_org_id', ${orgId}, true)`);\n}\n```\n\nThis function must be called in middleware before any RLS-protected queries.\n\n## Files to Create/Modify\n- apps/observatory/lib/db.ts\n\n## Agent Instructions\nWeb search 'PostgreSQL set_config row level security' for best practices on runtime context setting.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:29.828552-06:00","updated_at":"2025-12-29T23:22:47.741106-06:00","closed_at":"2025-12-29T23:22:47.741106-06:00","dependencies":[{"issue_id":"engram-vldw","depends_on_id":"engram-2u65","type":"blocks","created_at":"2025-12-29T22:12:35.466179-06:00","created_by":"ccheney"}]}
{"id":"engram-vmuq","title":"Implement Redis-backed rate limiting for API","description":"apps/api rate limiter uses in-memory Map instead of Redis (rate-limit.ts:20). Won't work for distributed deployments. redisUrl is passed but never used.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:09:42.246551-06:00","updated_at":"2025-12-20T23:26:18.765147-06:00","closed_at":"2025-12-20T23:26:18.765147-06:00"}
{"id":"engram-vpgi","title":"Update Qdrant indexer payload with org_id","description":"Add org_id field to all indexed document payloads in Qdrant.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 567)\n- Current code at apps/search/src/indexing/indexer.py:170-179\n\n## Implementation\nUpdate payload construction:\n```python\ndef build_payload(doc: Document, tenant_ctx: TenantContext) -\u003e dict:\n    return {\n        'content': doc.content,\n        'org_id': tenant_ctx.org_id,  # Required for tenant filtering\n        'session_id': doc.session_id,\n        **doc.metadata,\n    }\n```\n\n## Files to Modify\n- apps/search/src/indexing/indexer.py\n\n## Agent Instructions\nEnsure all indexing paths include org_id. No document should be indexed without tenant context.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:43.35561-06:00","updated_at":"2025-12-29T22:38:45.226365-06:00","closed_at":"2025-12-29T22:38:45.226365-06:00","dependencies":[{"issue_id":"engram-vpgi","depends_on_id":"engram-am54","type":"blocks","created_at":"2025-12-29T22:12:58.065221-06:00","created_by":"ccheney"},{"issue_id":"engram-vpgi","depends_on_id":"engram-r3v6","type":"blocks","created_at":"2025-12-29T22:13:05.19675-06:00","created_by":"ccheney"}]}
{"id":"engram-vr355","title":"Configure Witness and Refinery agents","description":"Set up Witness lifecycle monitor and Refinery merge queue in gastown.toml","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:49:06.79386-06:00","updated_at":"2026-01-01T18:51:40.072067-06:00","closed_at":"2026-01-01T18:51:40.072067-06:00"}
{"id":"engram-vtca","title":"Multi-Tenancy Phase 2: Storage Layer","description":"FalkorDB multi-graph support and Qdrant tenant filtering for data isolation.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Phase 2: Storage Layer section\n\n## Overview\nImplement tenant isolation at the storage layer:\n- FalkorDB: Graph-per-tenant with dynamic selection\n- Qdrant: Shared collection with is_tenant=true filtering\n- All 8 FalkorDB repositories updated for tenant context\n\n## Architecture\nFrom plan:\n- FalkorDB: engram_{org_slug}_{org_ulid} per tenant (supports 10k+ graphs)\n- Qdrant: Shared engram_memory collection with org_id payload filtering\n- Tiered multitenancy for large tenants (Qdrant 1.16+)\n\n## Dependencies\nDepends on Phase 1 (TenantContext type, org tables)\n\n## Agent Instructions\nUse Context7 MCP for FalkorDB and Qdrant documentation. Web search for 'FalkorDB multi-tenant graph selection 2025' and 'Qdrant is_tenant index multitenancy'.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T22:07:48.960013-06:00","updated_at":"2025-12-29T23:13:11.185423-06:00","closed_at":"2025-12-29T23:13:11.185423-06:00","dependencies":[{"issue_id":"engram-vtca","depends_on_id":"engram-wfr6","type":"blocks","created_at":"2025-12-29T22:13:24.84291-06:00","created_by":"ccheney"},{"issue_id":"engram-vtca","depends_on_id":"engram-14ts","type":"blocks","created_at":"2025-12-29T22:13:33.172952-06:00","created_by":"ccheney"},{"issue_id":"engram-vtca","depends_on_id":"engram-657w","type":"blocks","created_at":"2025-12-29T22:13:39.393425-06:00","created_by":"ccheney"},{"issue_id":"engram-vtca","depends_on_id":"engram-gkvw","type":"blocks","created_at":"2025-12-29T22:13:45.50911-06:00","created_by":"ccheney"},{"issue_id":"engram-vtca","depends_on_id":"engram-canf","type":"blocks","created_at":"2025-12-29T22:13:51.795415-06:00","created_by":"ccheney"},{"issue_id":"engram-vtca","depends_on_id":"engram-kwmo","type":"blocks","created_at":"2025-12-29T22:13:58.654318-06:00","created_by":"ccheney"},{"issue_id":"engram-vtca","depends_on_id":"engram-vpgi","type":"blocks","created_at":"2025-12-29T22:14:04.791977-06:00","created_by":"ccheney"}]}
{"id":"engram-vtfg","title":"Test coverage: packages/common/src/constants/intervals.ts (83%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:40.337638-06:00","updated_at":"2025-12-21T04:07:03.761411-06:00","closed_at":"2025-12-21T04:07:03.761411-06:00"}
{"id":"engram-vwgr","title":"Add tests: Scopes enforced correctly per client registration","description":"Add tests for OAuth scope enforcement per client registration. Test scope validation: register client with scope='mcp:tools mcp:resources', request token, verify token only has registered scopes. Test client can only access registered scopes: create token with scopes=['mcp:tools'], attempt to call endpoint requiring mcp:prompts scope, expect 403 Forbidden. Test scope mismatch rejected: request token with scope not in client registration, expect invalid_scope error. Test scope enforcement in API middleware: verify requireScope() dependency in /Users/ccheney/Projects/engram/apps/api/src/middleware/scopes.test.ts validates token scopes match endpoint requirements. Test scope enforcement in Python middleware: verify require_scope() in /Users/ccheney/Projects/engram/apps/search/src/middleware/auth.py validates scopes. MCP scopes defined in client-registration.ts: mcp:tools, mcp:resources, mcp:prompts. Default scope from DEFAULT_SCOPE constant. Reference RFC 6749 Section 3.3 for scope validation semantics.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:56:46.603028-06:00","updated_at":"2025-12-29T16:59:27.744701-06:00","closed_at":"2025-12-29T16:59:27.744701-06:00","dependencies":[{"issue_id":"engram-vwgr","depends_on_id":"engram-uxh4","type":"blocks","created_at":"2025-12-29T16:04:17.787152-06:00","created_by":"ccheney"},{"issue_id":"engram-vwgr","depends_on_id":"engram-g65i","type":"blocks","created_at":"2025-12-29T16:04:22.926288-06:00","created_by":"ccheney"}]}
{"id":"engram-vwt9","title":"Migrate ingestion service to NATS","description":"Update ingestion service to use NATS instead of Kafka.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Section 4: Service Migration\n\n## Topic Mapping\n- raw_events → events.raw (subscribe)\n- parsed_events → events.parsed (publish)\n- ingestion.dead_letter → dlq.ingestion (publish on error)\n\n## Consumer\n- Stream: EVENTS\n- Durable name: ingestion\n\n## Implementation\n- Import createNatsClient from @engram/storage\n- Replace Kafka producer/consumer with NATS\n- Update environment variable from REDPANDA_BROKERS to NATS_URL\n- Update error handling to use dlq.ingestion subject\n\n## Acceptance Criteria\n- Service starts and connects to NATS\n- Subscribes to events.raw\n- Publishes parsed events to events.parsed\n- Dead letter queue working","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:26:30.802839-05:00","updated_at":"2025-12-22T00:49:14.129849-05:00","closed_at":"2025-12-22T00:49:14.129849-05:00","dependencies":[{"issue_id":"engram-vwt9","depends_on_id":"engram-qgcm","type":"blocks","created_at":"2025-12-22T00:29:07.723202-05:00","created_by":"ccheney"},{"issue_id":"engram-vwt9","depends_on_id":"engram-3xez","type":"blocks","created_at":"2025-12-22T00:29:12.85521-05:00","created_by":"ccheney"}]}
{"id":"engram-w0kv","title":"Add jitter to WebSocket exponential backoff","description":"## Problem\n\nThe current `useWebSocket` hook at `apps/interface/app/hooks/useWebSocket.ts:244-247` implements exponential backoff without jitter:\n\n```typescript\nconst delay = Math.min(\n  baseReconnectDelay * 2 ** reconnectAttemptsRef.current,\n  maxReconnectDelay,\n);\n```\n\nWithout jitter, if the server restarts and N clients reconnect simultaneously, they all attempt reconnection at identical intervals (1s, 2s, 4s, 8s...), causing a 'thundering herd' problem that can overwhelm the server.\n\n## Evidence\n\nAccording to Cloudflare research (2024), adding jitter to exponential backoff demonstrates **up to 42% reduction in simultaneous reconnect attempts** under heavy load.\n\n## Recommended Solution\n\nAdd randomized jitter to the delay calculation:\n\n```typescript\nconst jitter = Math.random() * 1000; // 0-1000ms random jitter\nconst delay = Math.min(\n  baseReconnectDelay * 2 ** reconnectAttemptsRef.current + jitter,\n  maxReconnectDelay,\n);\n```\n\nThe `reconnecting-websocket` library uses a similar pattern with configurable jitter ranges.\n\n## References\n\n- [Robust WebSocket Reconnection Strategies with Exponential Backoff](https://dev.to/hexshift/robust-websocket-reconnection-strategies-in-javascript-with-exponential-backoff-40n1)\n- [reconnecting-websocket library](https://github.com/pladaria/reconnecting-websocket) - Uses `minReconnectionDelay: 1000 + Math.random() * 4000`\n- [Implementing Retry Mechanisms for WebSocket Reconnections](https://peerdh.com/blogs/programming-insights/implementing-retry-mechanisms-for-websocket-reconnections-2)\n\n## Priority\n\nMedium - Important for production deployments with many concurrent clients.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T20:41:20.350961-06:00","updated_at":"2025-12-20T23:07:49.463671-06:00","closed_at":"2025-12-20T23:07:49.463671-06:00"}
{"id":"engram-w17l3","title":"Background Worker Infrastructure","description":"New apps/worker service for running background jobs via NATS JetStream. Includes base infrastructure for job consumers and scheduling.\n\n## Implementation Details\n- Bun workspace with TypeScript\n- NATS JetStream durable consumers with explicit ack\n- Dead letter queue for failed jobs\n- Prometheus metrics for observability\n\n## Before Implementation\nUse Context7 MCP: `resolve-library-id` then `query-docs` for '@nats-io/jetstream' - focus on durable consumers, ack policies, and consumer groups.\n\nUse web search: 'NATS JetStream TypeScript worker pattern 2025' to find production patterns.\n\n## References\n- NATS JetStream docs: https://docs.nats.io/nats-concepts/jetstream\n- Existing NATS client: packages/storage/src/nats.ts","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-01T16:52:50.721877-06:00","updated_at":"2026-01-01T17:05:40.834012-06:00"}
{"id":"engram-w9hl","title":"Re-ingest benchmark data with fixed pipeline","description":"Run benchmark ingest after pipeline fixes to populate Qdrant with vt_start timestamps","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T15:45:29.775279-05:00","updated_at":"2025-12-27T17:32:57.435697-05:00","closed_at":"2025-12-27T17:32:57.435697-05:00","dependencies":[{"issue_id":"engram-w9hl","depends_on_id":"engram-yebg","type":"blocks","created_at":"2025-12-27T15:46:01.477294-05:00","created_by":"ccheney"},{"issue_id":"engram-w9hl","depends_on_id":"engram-veww","type":"blocks","created_at":"2025-12-27T15:46:06.597778-05:00","created_by":"ccheney"},{"issue_id":"engram-w9hl","depends_on_id":"engram-de8r","type":"blocks","created_at":"2025-12-27T15:46:11.72015-05:00","created_by":"ccheney"},{"issue_id":"engram-w9hl","depends_on_id":"engram-tuxd","type":"blocks","created_at":"2025-12-27T15:46:16.842201-05:00","created_by":"ccheney"}]}
{"id":"engram-wc64","title":"Test coverage: apps/control/src/clients/search.ts (0%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:03.608933-06:00","updated_at":"2025-12-21T04:07:03.771444-06:00","closed_at":"2025-12-21T04:07:03.771444-06:00"}
{"id":"engram-wcqb","title":"[Observatory Auth] Create API route handler","description":"Create Better Auth API route handler for Next.js App Router. Reference: docs/observatory-auth-implementation-plan.md Step 5. File: apps/observatory/app/api/auth/[...all]/route.ts (NEW). Use toNextJsHandler from better-auth/next-js. Export GET and POST handlers. Verify tsconfig.json has @/* path alias. DEPENDS ON: engram-7d6p (server config must exist first).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:40:47.917211-05:00","updated_at":"2025-12-22T00:53:45.078243-05:00","closed_at":"2025-12-22T00:53:45.078243-05:00","dependencies":[{"issue_id":"engram-wcqb","depends_on_id":"engram-7d6p","type":"blocks","created_at":"2025-12-22T00:43:32.496267-05:00","created_by":"ccheney"}]}
{"id":"engram-wdkf","title":"[CRITICAL] Unsafe array casting in merger.ts","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:31.568399-06:00","updated_at":"2025-12-20T23:45:30.482255-06:00","closed_at":"2025-12-20T23:45:30.482255-06:00"}
{"id":"engram-wfr6","title":"Update SessionRepository for tenant context","description":"Update SessionRepository to use tenant-scoped graph.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - File Changes section (line 558)\n\n## Implementation\nUpdate packages/graph/src/repositories/falkor-session.ts:\n- Extend from updated FalkorBaseRepository\n- All session queries scoped to tenant graph\n- Ensure session creation uses correct tenant graph\n\n## Files to Modify\n- packages/graph/src/repositories/falkor-session.ts\n\n## Agent Instructions\nCheck existing SessionRepository patterns. Preserve bitemporal field handling.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:08:33.988476-06:00","updated_at":"2025-12-29T23:11:10.133344-06:00","closed_at":"2025-12-29T23:11:10.133344-06:00","dependencies":[{"issue_id":"engram-wfr6","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:13.552707-06:00","created_by":"ccheney"}]}
{"id":"engram-wg7k","title":"Remove unused trace and fatal log levels","description":"packages/logger types.ts:3 defines trace and fatal levels with severity mappings but neither is ever called in production code.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:16:51.110277-06:00","updated_at":"2025-12-20T23:21:15.297567-06:00","closed_at":"2025-12-20T23:21:15.297567-06:00"}
{"id":"engram-whvx","title":"Create Hetzner Cloud account and API token","description":"Set up Hetzner Cloud account and generate API credentials.\n\n## Steps\n1. Go to https://console.hetzner.cloud\n2. Create project (or select existing)\n3. Go to Security → API Tokens\n4. Generate token with Read \u0026 Write permissions\n5. Run `hcloud context create engram` and paste token\n\n## Acceptance Criteria\n- Hetzner account is active\n- API token is generated and saved securely\n- hcloud context is configured and verified with `hcloud context list`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:28:18.370495-06:00","updated_at":"2025-12-21T16:29:34.985403-06:00","closed_at":"2025-12-21T16:29:34.985403-06:00"}
{"id":"engram-wiuf","title":"Create Server Metrics Chart component","description":"Recharts ComposedChart for CPU, memory, disk I/O, network. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:21:20.865763-05:00","updated_at":"2025-12-27T18:36:12.106832-05:00","closed_at":"2025-12-27T18:36:12.106832-05:00","dependencies":[{"issue_id":"engram-wiuf","depends_on_id":"engram-dj45","type":"blocks","created_at":"2025-12-27T04:26:42.394478-05:00","created_by":"ccheney"}]}
{"id":"engram-wjdd","title":"Validate MCP tool description changes","description":"After all tool descriptions are updated:\n1. Run bun run typecheck to ensure no type errors\n2. Run bun test apps/mcp to verify all tests pass\n3. Manually test with Claude Code to verify tool selection improves\n4. Check that all descriptions encourage PROACTIVE use\n\nReference: docs/plans/mcp-tool-descriptions.md#testing","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:53:18.254105-05:00","updated_at":"2025-12-25T01:03:57.970274-05:00","closed_at":"2025-12-25T01:03:57.970274-05:00","dependencies":[{"issue_id":"engram-wjdd","depends_on_id":"engram-fuco","type":"blocks","created_at":"2025-12-25T00:54:34.718983-05:00","created_by":"ccheney"},{"issue_id":"engram-wjdd","depends_on_id":"engram-yhw1","type":"blocks","created_at":"2025-12-25T00:54:39.853524-05:00","created_by":"ccheney"},{"issue_id":"engram-wjdd","depends_on_id":"engram-lm57","type":"blocks","created_at":"2025-12-25T00:54:44.983567-05:00","created_by":"ccheney"},{"issue_id":"engram-wjdd","depends_on_id":"engram-g3d7","type":"blocks","created_at":"2025-12-25T00:54:50.116935-05:00","created_by":"ccheney"},{"issue_id":"engram-wjdd","depends_on_id":"engram-2osk","type":"blocks","created_at":"2025-12-25T00:54:55.252393-05:00","created_by":"ccheney"}]}
{"id":"engram-wqs7","title":"[Console Redesign] Migrate Header component to shadcn","description":"## Overview\nReplace custom Header component with shadcn primitives inside SidebarInset.\n\n## Current Implementation\n- apps/console/app/components/Header.tsx\n- Fixed top navigation (64px)\n- Contains: EnvironmentSwitcher, connection status, UTC timestamp, notifications, theme toggle, user menu\n\n## Target Implementation\n```tsx\n\u003cheader className=\"flex h-16 shrink-0 items-center gap-2 px-4\"\u003e\n  \u003cSidebarTrigger className=\"-ml-1\" /\u003e\n  \u003cSeparator orientation=\"vertical\" className=\"h-4\" /\u003e\n  \u003cBreadcrumb\u003e...\u003c/Breadcrumb\u003e\n  \u003cdiv className=\"ml-auto flex items-center gap-2\"\u003e\n    \u003cEnvironmentSwitcher /\u003e\n    \u003cConnectionStatus /\u003e\n    \u003cThemeToggle /\u003e\n    \u003cUserMenu /\u003e\n  \u003c/div\u003e\n\u003c/header\u003e\n```\n\n## Components to Use\n- SidebarTrigger (collapse toggle)\n- Separator (visual divider)\n- Breadcrumb (page context)\n- DropdownMenu (user menu)\n- Button (theme toggle, notifications)\n- Avatar (user avatar in menu)\n\n## Sub-components to Create/Migrate\n- components/layout/site-header.tsx\n- components/shared/environment-switcher.tsx (migrate existing)\n- components/shared/theme-toggle.tsx (migrate existing)\n- components/shared/user-menu.tsx (extract from Header)\n\n## Reference\n- Current Header: apps/console/app/components/Header.tsx\n- DropdownMenu docs: https://ui.shadcn.com/docs/components/dropdown-menu\n\n## Acceptance Criteria\n- [ ] SidebarTrigger integrated for collapse\n- [ ] All header elements migrated\n- [ ] User menu with logout functionality\n- [ ] Environment switcher preserved\n- [ ] Theme toggle preserved\n- [ ] Breadcrumb shows current page context","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:45:49.044949-06:00","updated_at":"2025-12-28T17:22:48.150968-06:00","closed_at":"2025-12-28T17:22:48.150968-06:00","dependencies":[{"issue_id":"engram-wqs7","depends_on_id":"engram-p0ks","type":"blocks","created_at":"2025-12-28T16:51:55.472006-06:00","created_by":"ccheney"}]}
{"id":"engram-ws66","title":"Create shared Python auth middleware","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T23:12:36.940533-05:00","updated_at":"2025-12-21T23:17:03.059336-05:00","closed_at":"2025-12-21T23:17:03.059336-05:00"}
{"id":"engram-wtif","title":"Make GraphPruner retention policy configurable","description":"apps/memory index.ts:127,163-164 hardcodes 30-day retention and 24-hour prune interval. Should be configurable via environment variables.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:15:34.590131-06:00","updated_at":"2025-12-20T23:23:08.584226-06:00","closed_at":"2025-12-20T23:23:08.584226-06:00"}
{"id":"engram-wv53","title":"Run npm install and verify tsgo works","description":"Run npm install to update dependencies, then run npx tsgo to verify type checking works across the monorepo","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:38:04.274485-06:00","updated_at":"2025-12-20T22:32:19.374853-06:00","closed_at":"2025-12-20T22:32:19.374853-06:00","dependencies":[{"issue_id":"engram-wv53","depends_on_id":"engram-hc8t","type":"blocks","created_at":"2025-12-20T21:39:17.829204-06:00","created_by":"ccheney"}]}
{"id":"engram-wyw4","title":"Create HuggingFaceReranker client class","description":"Implement reranker that calls Hugging Face Inference API for cross-encoder scoring.\n\n## Location\n`apps/search/src/clients/huggingface.py` (same file as embedder)\n\n## Interface\n- Match BaseReranker interface\n- `__init__(model_id, api_token)`\n- `async rerank(query, documents, top_k) -\u003e list[RankedResult]`\n\n## Models to support\n- accurate: BAAI/bge-reranker-v2-m3\n- code: jinaai/jina-reranker-v2-base-multilingual\n\n## Implementation notes\n- Use httpx for async HTTP calls\n- Call HF API with text pairs (query, document)\n- Parse relevance scores from response\n- Sort by score descending\n\n## Acceptance Criteria\n- Class matches BaseReranker interface\n- Unit tests pass\n- Works with HF free tier","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:29:20.134342-06:00","updated_at":"2025-12-21T16:10:46.978979-06:00","closed_at":"2025-12-21T16:10:46.978979-06:00"}
{"id":"engram-wzola","title":"Add tests for packages/websocket client","description":"Missing tests for websocket package:\n- client/index.ts\n- client/types.ts\n- client/useWebSocket.ts (React hook)\n\nPriority: LOW - Utility package","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:21:14.421358-06:00","updated_at":"2026-01-01T17:21:14.421358-06:00"}
{"id":"engram-x2hm","title":"Create Workflow Runs List component","description":"Table of recent workflow runs with status, duration, rerun button. MUST use frontend-design skill for UI implementation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:22:00.174954-05:00","updated_at":"2025-12-27T04:22:00.174954-05:00","dependencies":[{"issue_id":"engram-x2hm","depends_on_id":"engram-jxgz","type":"blocks","created_at":"2025-12-27T04:27:29.38044-05:00","created_by":"ccheney"}]}
{"id":"engram-x7fj","title":"Improve engram_enrich_memory tool description","description":"Update apps/mcp/src/tools/enrich-memory.ts with improved descriptions. Changes:\n- Main description: 'Auto-generate metadata for memory content before storing. Returns: one-line summary, searchable keywords, and suggested category. Recommended workflow: call enrich_memory first, then pass the enriched metadata to engram_remember for better future retrieval.'\n- content param: Explain what the enrichment produces and how to use output\n\nReference: docs/plans/mcp-tool-descriptions.md#tool-engram_enrich_memory","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:52:25.90551-05:00","updated_at":"2025-12-25T00:59:39.79176-05:00","closed_at":"2025-12-25T00:59:39.79176-05:00"}
{"id":"engram-xbc0","title":"Add tests: Client tokens validate correctly in TS and Python services","description":"Add tests for client token validation in both TypeScript and Python services. Test API middleware (/Users/ccheney/Projects/engram/apps/api/src/middleware/auth.ts) accepts client tokens: create client credentials token, make request to /v1/memory/recall endpoint, expect 200. Test Search middleware (/Users/ccheney/Projects/engram/apps/search/src/middleware/auth.py) accepts client tokens: create client credentials token, make request to /v1/search/query endpoint, expect 200. Test token binding validation: DPoP proof must match token thumbprint (cnf claim). Test DPoP proof validation per request: each API request requires fresh DPoP proof with correct htm (HTTP method) and htu (target URL) claims. Create test files: /Users/ccheney/Projects/engram/apps/api/src/middleware/auth.test.ts (extend existing) and /Users/ccheney/Projects/engram/apps/search/tests/test_auth.py (extend existing). Verify cnf claim in token matches jkt (JWK thumbprint) in DPoP proof for sender constraint.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:56:34.424901-06:00","updated_at":"2025-12-29T16:59:27.744085-06:00","closed_at":"2025-12-29T16:59:27.744085-06:00","dependencies":[{"issue_id":"engram-xbc0","depends_on_id":"engram-j6pr","type":"blocks","created_at":"2025-12-29T16:03:57.215165-06:00","created_by":"ccheney"},{"issue_id":"engram-xbc0","depends_on_id":"engram-qeb4","type":"blocks","created_at":"2025-12-29T16:04:02.358588-06:00","created_by":"ccheney"}]}
{"id":"engram-xc13","title":"Test coverage: packages/common/src/utils/format.ts (0%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:10.007994-06:00","updated_at":"2025-12-21T04:07:03.769552-06:00","closed_at":"2025-12-21T04:07:03.769552-06:00"}
{"id":"engram-xeoi","title":"Create systemd service for auto-start","description":"Create systemd unit file so Engram starts on server boot.\n\n## Location (on server)\n`/etc/systemd/system/engram.service`\n\n## Content\n```ini\n[Unit]\nDescription=Engram\nRequires=docker.service\nAfter=docker.service\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nWorkingDirectory=/opt/engram\nExecStart=/usr/bin/docker compose -f docker-compose.prod.yml up -d\nExecStop=/usr/bin/docker compose -f docker-compose.prod.yml down\n\n[Install]\nWantedBy=multi-user.target\n```\n\n## Commands\n```bash\nsudo systemctl daemon-reload\nsudo systemctl enable engram\n```\n\n## Acceptance Criteria\n- Service starts on boot\n- `systemctl status engram` shows active","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:31:04.006132-06:00","updated_at":"2025-12-21T16:15:00.620037-06:00","closed_at":"2025-12-21T16:15:00.620037-06:00","dependencies":[{"issue_id":"engram-xeoi","depends_on_id":"engram-kbrm","type":"blocks","created_at":"2025-12-21T15:34:33.888338-06:00","created_by":"ccheney"}]}
{"id":"engram-xf5b0","title":"Document Gastown workflow in CLAUDE.md","description":"Add Gastown commands, formulas, and workflow patterns to CLAUDE.md for agent reference","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T18:49:12.945748-06:00","updated_at":"2026-01-01T18:52:26.630654-06:00","closed_at":"2026-01-01T18:52:26.630654-06:00"}
{"id":"engram-xgpd0","title":"Migrate MCP tools to generated definitions","description":"Replace hand-written MCP tools with generated tool definitions\n\n## Overview\nThis migration replaces the manually written MCP tool registrations with generated code from the mcp.tool() DSL. This ensures tools stay in sync with the schema and eliminates duplicate definitions.\n\n## Scope\n- apps/mcp/src/tools/remember.ts\n- apps/mcp/src/tools/recall.ts\n- apps/mcp/src/tools/query.ts\n- apps/mcp/src/tools/context.ts\n- apps/mcp/src/tools/summarize.ts\n- apps/mcp/src/tools/extract-facts.ts\n- apps/mcp/src/tools/enrich-memory.ts\n\n## Migration Strategy\n\n### Step 1: Define Tools in Schema\nAdd tool definitions to packages/graph/src/schema/mcp-tools.ts using the mcp.tool() DSL.\n\n### Step 2: Generate Tool Code\nRun code generation to produce tool registration functions.\n\n### Step 3: Update Server\nReplace imports in apps/mcp/src/server.ts to use generated tools.\n\n### Step 4: Verify Compatibility\n- Existing MCP tool tests should pass\n- JSON Schema output should match current schemas\n- Tool behavior should be unchanged\n\n## Example Migration\n\n### Before (apps/mcp/src/tools/remember.ts):\n```typescript\nexport function registerRememberTool(\n  server: McpServer,\n  memoryStore: IMemoryStore,\n  getSessionContext: () =\u003e SessionContext,\n) {\n  server.registerTool(\n    'remember',\n    {\n      title: 'Remember',\n      description: 'Persist valuable information to long-term memory...',\n      inputSchema: {\n        content: z.string().describe('The information to store...'),\n        type: MemoryTypeEnum.optional(),\n        tags: z.array(z.string()).optional(),\n      },\n      outputSchema: { ... },\n    },\n    async (inputs) =\u003e {\n      // Handler implementation\n    },\n  );\n}\n```\n\n### After (packages/graph/src/schema/mcp-tools.ts):\n```typescript\nexport const mcpTools = mcp.defineTools({\n  remember: mcp.tool({\n    description: 'Persist valuable information to long-term memory...',\n    input: {\n      content: mcp.param.string('The information to store...'),\n      type: mcp.param.enum(MemoryTypeEnum).optional(),\n      tags: mcp.param.array(mcp.param.string()).optional(),\n    },\n    output: {\n      id: mcp.param.string('Memory ID'),\n      stored: mcp.param.boolean('Success indicator'),\n    },\n    handler: async (input, context) =\u003e {\n      const memory = await Memory.create({ ...input });\n      return { id: memory.id, stored: true };\n    },\n  }),\n});\n```\n\n## Validation\n- Compare generated JSON Schema with current schemas\n- Run MCP tool tests\n- Test tools manually with Claude Code\n- Verify error handling works\n\n## Research Required\nReview current implementations:\n- apps/mcp/src/tools/remember.ts\n- apps/mcp/src/tools/recall.ts\n- apps/mcp/src/server.ts\n\nUse web search for:\n- 'MCP tool definition best practices'\n- 'Code generation migration testing'\n\n## Files to Migrate\n- apps/mcp/src/tools/remember.ts → generated\n- apps/mcp/src/tools/recall.ts → generated\n- apps/mcp/src/tools/query.ts → generated\n- apps/mcp/src/tools/context.ts → generated\n- apps/mcp/src/tools/summarize.ts → generated\n- apps/mcp/src/tools/extract-facts.ts → generated\n- apps/mcp/src/tools/enrich-memory.ts → generated\n\n## References\n- Current MCP tools: apps/mcp/src/tools/\n- Plan: docs/plans/compiled-query-layer.md lines 336-390","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:53:23.659036-06:00","updated_at":"2026-01-01T17:14:18.277391-06:00","dependencies":[{"issue_id":"engram-xgpd0","depends_on_id":"engram-dtszf","type":"blocks","created_at":"2026-01-01T16:57:00.863585-06:00","created_by":"ccheney"},{"issue_id":"engram-xgpd0","depends_on_id":"engram-ic8y5","type":"blocks","created_at":"2026-01-01T16:57:05.996918-06:00","created_by":"ccheney"}]}
{"id":"engram-xijc","title":"Create API client with environment context","description":"lib/api-client.ts that uses environment context for base URL, handles auth tokens per environment","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:19.781267-05:00","updated_at":"2025-12-27T16:41:51.783941-05:00","closed_at":"2025-12-27T16:41:51.783941-05:00","dependencies":[{"issue_id":"engram-xijc","depends_on_id":"engram-bc25","type":"blocks","created_at":"2025-12-27T04:25:43.643901-05:00","created_by":"ccheney"}]}
{"id":"engram-xixn","title":"Test coverage: packages/infra/src/k8s/rbac.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:17.773301-06:00","updated_at":"2025-12-21T04:07:03.766256-06:00","closed_at":"2025-12-21T04:07:03.766256-06:00"}
{"id":"engram-xm93","title":"Test coverage: packages/vfs/src/node-fs.ts (90%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:06.597462-06:00","updated_at":"2025-12-21T01:43:54.984101-06:00","closed_at":"2025-12-21T01:43:54.984101-06:00"}
{"id":"engram-xq1x","title":"Add unified TOKEN_PATTERNS constant with user/client/refresh patterns","description":"Create unified TOKEN_PATTERNS constant consolidating all valid OAuth token patterns.\n\n**File to modify:** `packages/common/src/types/auth.ts`\n\n**Add unified constant:**\n```typescript\nexport const TOKEN_PATTERNS = {\n  user: /^egm_oauth_[a-f0-9]{32}_[a-zA-Z0-9]{6}$/,\n  client: /^egm_client_[a-f0-9]{32}_[a-zA-Z0-9]{6}$/,\n  refresh: /^egm_refresh_[a-f0-9]{32}_[a-zA-Z0-9]{6}$/,\n} as const;\n\nexport type TokenType = keyof typeof TOKEN_PATTERNS;\n\nexport function identifyTokenType(token: string): TokenType | null {\n  for (const [type, pattern] of Object.entries(TOKEN_PATTERNS)) {\n    if (pattern.test(token)) return type as TokenType;\n  }\n  return null;\n}\n```\n\n**Purpose:**\n- Single source of truth for all valid token patterns\n- Used by all service auth middleware (API, Ingestion, Search, Tuner)\n- Replaces scattered pattern definitions across codebase\n- Enables consistent token type detection\n\n**Export from package:**\n- Update `packages/common/src/index.ts` to export new constants\n\n**Current exports to keep (but deprecated):**\n- `OAUTH_TOKEN_PATTERN` - mark as @deprecated, alias to TOKEN_PATTERNS.user\n- `REFRESH_TOKEN_PATTERN` - mark as @deprecated, alias to TOKEN_PATTERNS.refresh\n\n**Subagent instructions:**\n- Read `packages/common/src/types/auth.ts` for current exports\n- Read `packages/common/src/index.ts` for package exports\n- Run: `bun run typecheck` to verify no import breaks\n- Run: `bun run lint` for code style","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:54:15.363697-06:00","updated_at":"2025-12-29T16:27:29.412839-06:00","closed_at":"2025-12-29T16:27:29.412839-06:00","dependencies":[{"issue_id":"engram-xq1x","depends_on_id":"engram-47jc","type":"blocks","created_at":"2025-12-29T15:57:39.873172-06:00","created_by":"ccheney"}]}
{"id":"engram-xr9b","title":"Create .env.example with TURBO_TOKEN template","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-20T23:07:58.30688-06:00","updated_at":"2025-12-21T03:50:24.616605-06:00","closed_at":"2025-12-21T03:50:24.616605-06:00"}
{"id":"engram-xu6b","title":"RBAC: Implement role storage in Better Auth user metadata","description":"apps/observatory/lib/rbac.ts:60 - TODO comment to implement role storage in Better Auth user metadata. Need to persist user roles in the authentication system.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T04:02:47.372766-05:00","updated_at":"2025-12-22T04:10:10.737582-05:00","closed_at":"2025-12-22T04:10:10.737582-05:00"}
{"id":"engram-xx30","title":"[CRITICAL] Unsafe type assertions in apps/mcp","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:04.857228-06:00","updated_at":"2025-12-20T23:45:30.484816-06:00","closed_at":"2025-12-20T23:45:30.484816-06:00"}
{"id":"engram-xxc2","title":"[Observatory Auth] Update next.config.mjs","description":"Update Next.js config to expose Better Auth URL and add pg to external packages. Reference: docs/observatory-auth-implementation-plan.md Step 11. File: apps/observatory/next.config.mjs. Add env block to expose NEXT_PUBLIC_BETTER_AUTH_URL from BETTER_AUTH_URL. Add pg to serverExternalPackages array for PostgreSQL client. DEPENDS ON: engram-lzxj (dependencies must be updated first).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:42:00.016972-05:00","updated_at":"2025-12-22T00:52:44.713616-05:00","closed_at":"2025-12-22T00:52:44.713616-05:00","dependencies":[{"issue_id":"engram-xxc2","depends_on_id":"engram-lzxj","type":"blocks","created_at":"2025-12-22T00:44:08.434225-05:00","created_by":"ccheney"}]}
{"id":"engram-xxln","title":"[HIGH] Missing NetworkPolicy/RBAC in k8s infra","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:06.64313-06:00","updated_at":"2025-12-20T23:58:07.713686-06:00","closed_at":"2025-12-20T23:58:07.713686-06:00"}
{"id":"engram-xydt","title":"Implement audit logging for conflict decisions","description":"Log all conflict decisions to graph: create ConflictDecision nodes, link to Memory nodes, track modelUsed (sampling/gemini), userConfirmed, actionTaken (invalidated/skipped/no_action)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:44:02.258759-06:00","updated_at":"2026-01-01T16:44:02.258759-06:00","dependencies":[{"issue_id":"engram-xydt","depends_on_id":"engram-frn0","type":"blocks","created_at":"2026-01-01T16:46:18.618228-06:00","created_by":"ccheney"},{"issue_id":"engram-xydt","depends_on_id":"engram-a7tv","type":"blocks","created_at":"2026-01-01T16:46:23.747615-06:00","created_by":"ccheney"}]}
{"id":"engram-xysp","title":"Update MCP tools to pass tenant context","description":"All MCP tools (remember, recall, query, context) must pass tenant context.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'MCP Server' section (lines 532-535)\n\n## Implementation\nUpdate apps/mcp/src/tools/*.ts:\n- Extract TenantContext from session/auth context\n- Pass to all tool implementations\n- Include orgId in session context for remember/recall\n\n## Files to Modify\n- apps/mcp/src/tools/remember.ts\n- apps/mcp/src/tools/recall.ts\n- apps/mcp/src/tools/query.ts\n- apps/mcp/src/tools/context.ts\n\n## Agent Instructions\nMCP tools are the user-facing interface. Ensure seamless tenant scoping without user needing to specify orgId.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:42.50571-06:00","updated_at":"2025-12-29T22:32:21.252537-06:00","closed_at":"2025-12-29T22:32:21.252537-06:00","dependencies":[{"issue_id":"engram-xysp","depends_on_id":"engram-1pwm","type":"blocks","created_at":"2025-12-29T22:13:12.383246-06:00","created_by":"ccheney"}]}
{"id":"engram-y0d5","title":"Add self-hosted code coverage badges per workspace","description":"## Overview\n\nGenerate SVG coverage badges in CI without external services. Display:\n- **Root README**: Aggregate coverage % across all workspaces\n- **Each app README**: That app's coverage %\n- **Each package README**: That package's coverage %\n\n## Implementation\n\n### 1. Coverage Configuration\n\n**vitest.config.ts** - Add coverage reporter:\n```typescript\ncoverage: {\n  provider: 'v8',\n  reporter: ['json-summary', 'text'],\n  reportsDirectory: './coverage'\n}\n```\n\n**Python apps** - pytest with coverage:\n```bash\npytest --cov=src --cov-report=json\n```\n\n### 2. SVG Badge Generator Script\n\nCreate `scripts/generate-coverage-badges.ts`:\n- Read coverage-summary.json from each workspace\n- Calculate aggregate (weighted by lines of code)\n- Generate SVG for each workspace + total\n- Color thresholds: green ≥80%, yellow ≥60%, red \u003c60%\n\n### 3. CI Workflow\n\nAdd to `.github/workflows/ci.yml`:\n1. Run tests with coverage for all workspaces (parallel)\n2. Run badge generator script\n3. Deploy badges to gh-pages branch via actions/deploy-pages\n\n### 4. README Updates\n\nAdd badge markdown to each README:\n- Root: `![coverage](https://ccheney.github.io/engram/badges/total.svg)`\n- Apps: `![coverage](https://ccheney.github.io/engram/badges/apps-{name}.svg)`\n- Packages: `![coverage](https://ccheney.github.io/engram/badges/packages-{name}.svg)`\n\n### 5. GitHub Pages Setup\n\nEnable Pages in repo settings, deploy from gh-pages branch.\n\n## Workspaces\n\n### TypeScript (vitest)\n- apps/api, apps/control, apps/ingestion, apps/mcp, apps/memory, apps/observatory\n- packages/common, packages/events, packages/graph, packages/infra, packages/logger, packages/parser, packages/storage, packages/temporal, packages/tuner, packages/vfs\n\n### Python (pytest)\n- apps/search\n- apps/tuner\n- packages/benchmark\n\n## Files to Create/Modify\n\n- [ ] `scripts/generate-coverage-badges.ts` - SVG generator\n- [ ] `vitest.config.ts` - Add coverage config\n- [ ] `.github/workflows/ci.yml` - Add coverage + badge jobs\n- [ ] `README.md` - Add total coverage badge\n- [ ] `apps/*/README.md` - Add per-app badges\n- [ ] `packages/*/README.md` - Add per-package badges\n\n## Zero External Dependencies\n\n- No Codecov/Coveralls\n- No shields.io\n- All data stays in GitHub (Pages)\n- SVGs generated directly in CI","status":"closed","priority":4,"issue_type":"feature","created_at":"2025-12-21T00:48:28.532032-06:00","updated_at":"2025-12-21T01:27:47.544161-06:00","closed_at":"2025-12-21T01:27:47.544161-06:00"}
{"id":"engram-y2rur","title":"Implement label propagation algorithm","description":"Create apps/worker/src/algorithms/label-propagation.ts implementing LPA: Initialize each node with unique label, iterate until convergence adopting most common neighbor label, filter small communities (\u003c3 members). O(E) complexity, supports incremental updates.\n\n## Algorithm Implementation\n```typescript\ninterface Graph {\n  nodes: Map\u003cstring, Set\u003cstring\u003e\u003e; // nodeId -\u003e neighborIds\n}\n\nfunction labelPropagation(graph: Graph, options?: {\n  maxIterations?: number;  // default: 100\n  minCommunitySize?: number; // default: 3\n}): Record\u003cstring, string[]\u003e {\n  // Returns { label: [nodeIds] }\n}\n```\n\n## Convergence\n- Converges when no node changes label in an iteration\n- Random tie-breaking for equal label counts\n- Deterministic ordering for reproducibility\n\n## Before Implementation\nUse web search:\n- 'label propagation algorithm Python implementation' (for reference)\n- 'asynchronous label propagation community detection'\n\nReview NetworkX implementation for edge cases.\n\n## References\n- Wikipedia: https://en.wikipedia.org/wiki/Label_propagation_algorithm\n- NetworkX source: https://github.com/networkx/networkx/blob/main/networkx/algorithms/community/label_propagation.py\n- Fast LPA paper: https://arxiv.org/abs/2403.01261","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T16:50:20.195165-06:00","updated_at":"2026-01-01T17:07:53.646977-06:00"}
{"id":"engram-y6c5","title":"Create Service Detail page","description":"Dynamic route [service]/page.tsx showing health, resource usage, request metrics, dependencies, logs tail. MUST use frontend-design skill for UI implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T04:20:53.072651-05:00","updated_at":"2025-12-27T17:03:23.707471-05:00","closed_at":"2025-12-27T17:03:23.707471-05:00","dependencies":[{"issue_id":"engram-y6c5","depends_on_id":"engram-xijc","type":"blocks","created_at":"2025-12-27T04:26:00.082916-05:00","created_by":"ccheney"}]}
{"id":"engram-y6cw","title":"[Console Redesign] Cleanup - Remove Tremor and HeadlessUI","description":"## Overview\nFinal cleanup phase - remove deprecated dependencies and unused code.\n\n## Dependencies to Remove\n```bash\nbun remove @tremor/react @headlessui/react\n```\n\n## Files to Review and Clean\n1. **Package.json cleanup**\n   - Remove @tremor/react\n   - Remove @headlessui/react\n   - Verify all shadcn dependencies present\n\n2. **CSS cleanup**\n   - Remove any Tremor-specific CSS\n   - Remove HeadlessUI-specific styles\n   - Consolidate custom CSS with shadcn variables\n   - Remove unused CSS classes\n\n3. **Import cleanup**\n   - Search for any remaining Tremor imports\n   - Search for any remaining HeadlessUI imports\n   - Update all component imports to use shadcn\n\n4. **Component file cleanup**\n   - Delete old component files that were fully replaced\n   - Remove any backup or .old files\n   - Clean up commented-out code\n\n## Verification Commands\n```bash\n# Find remaining Tremor imports\ngrep -r \"@tremor\" apps/console/\n\n# Find remaining HeadlessUI imports\ngrep -r \"@headlessui\" apps/console/\n\n# Run typecheck\nbun run typecheck\n\n# Run lint\nbun run lint\n\n# Run build\nbun run build\n```\n\n## Files to Delete (after migration)\nReview and delete if fully replaced:\n- Any old component backups\n- Unused utility functions\n- Deprecated style files\n\n## Testing Checklist\n- [ ] All pages load without errors\n- [ ] All interactive elements work\n- [ ] Charts render correctly\n- [ ] Forms submit correctly\n- [ ] Navigation works\n- [ ] Mobile responsive\n- [ ] Keyboard navigation\n- [ ] Theme switching works\n\n## Performance Verification\n- [ ] Bundle size check (should decrease)\n- [ ] Lighthouse audit\n- [ ] No console errors\n\n## Acceptance Criteria\n- [ ] @tremor/react removed\n- [ ] @headlessui/react removed\n- [ ] No import errors\n- [ ] All tests pass\n- [ ] Build succeeds\n- [ ] No TypeScript errors\n- [ ] No lint errors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:51:04.403695-06:00","updated_at":"2025-12-28T17:45:28.481148-06:00","closed_at":"2025-12-28T17:45:28.481148-06:00","dependencies":[{"issue_id":"engram-y6cw","depends_on_id":"engram-qwba","type":"blocks","created_at":"2025-12-28T16:53:16.008191-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-g3ke","type":"blocks","created_at":"2025-12-28T16:53:21.151115-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-gmi8","type":"blocks","created_at":"2025-12-28T16:53:26.295096-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-owhi","type":"blocks","created_at":"2025-12-28T16:53:31.437139-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-qle6","type":"blocks","created_at":"2025-12-28T16:53:36.577418-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-hr0d","type":"blocks","created_at":"2025-12-28T16:53:41.7127-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-037a","type":"blocks","created_at":"2025-12-28T16:53:46.842342-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-4eb4","type":"blocks","created_at":"2025-12-28T16:53:51.979338-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-dsxq","type":"blocks","created_at":"2025-12-28T16:53:57.119701-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-dxdf","type":"blocks","created_at":"2025-12-28T16:54:02.256276-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-yl4d","type":"blocks","created_at":"2025-12-28T16:54:07.395684-06:00","created_by":"ccheney"},{"issue_id":"engram-y6cw","depends_on_id":"engram-9a36","type":"blocks","created_at":"2025-12-28T16:54:12.534933-06:00","created_by":"ccheney"}]}
{"id":"engram-y6e8","title":"Test coverage: packages/infra/src/k8s/redpanda.ts (branches 50%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:24.313603-06:00","updated_at":"2025-12-21T04:07:03.764755-06:00","closed_at":"2025-12-21T04:07:03.764755-06:00"}
{"id":"engram-y8am","title":"Improve tests for search scripts/backfill_turns.py (70.2% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:59:41.127846-05:00","updated_at":"2025-12-27T01:59:41.127846-05:00"}
{"id":"engram-y9zt","title":"Add worker service to docker-compose.dev.yml","description":"Add worker service configuration to docker-compose.dev.yml with proper environment variables, depends_on for NATS, health checks, and restart policy.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T16:49:57.624362-06:00","updated_at":"2026-01-01T18:09:28.056436-06:00","closed_at":"2026-01-01T18:09:28.056436-06:00","dependencies":[{"issue_id":"engram-y9zt","depends_on_id":"engram-py2a","type":"blocks","created_at":"2026-01-01T16:51:01.268967-06:00","created_by":"ccheney"}]}
{"id":"engram-ycw5","title":"[Search-Py] Phase 2a: Embedders","description":"Implement all embedding models using sentence-transformers 5.2+. Port TextEmbedder (BAAI/bge-base-en-v1.5, 768d), CodeEmbedder (nomic-embed-text-v1.5, 8192 context with chunking), SparseEmbedder (naver/splade-v3 via SparseEncoder), and ColBERTEmbedder (RAGatouille for late interaction). Implement embedding cache with TTL. Add model preloading in FastAPI lifespan.\n\nReference: docs/plans/search-python-migration.md (Phase 2: Embedders)\n\nDeliverables:\n- src/search/embedders/base.py - Abstract embedder with device detection\n- src/search/embedders/text.py - Dense text embeddings\n- src/search/embedders/code.py - Code embeddings with chunking\n- src/search/embedders/sparse.py - SPLADE sparse vectors\n- src/search/embedders/colbert.py - ColBERT multi-vectors\n- src/search/utils/cache.py - Embedding cache\n- Unit tests for each embedder\n- Parity tests vs TypeScript (cosine sim \u003e 0.95)\n\nCAN BE DEVELOPED IN PARALLEL WITH: [Search-Py] Phase 2b: Rerankers","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T07:21:22.652044-06:00","updated_at":"2025-12-20T08:20:23.443656-06:00","closed_at":"2025-12-20T08:20:23.443656-06:00","dependencies":[{"issue_id":"engram-ycw5","depends_on_id":"engram-b0r6","type":"blocks","created_at":"2025-12-20T07:22:36.593214-06:00","created_by":"ccheney"}]}
{"id":"engram-yd1i","title":"Update CLAUDE.md to document OAuth-only authentication","description":"Update CLAUDE.md to document OAuth-only authentication architecture. Remove all API key documentation sections (engram_live_*, engram_test_* patterns). Remove dev token documentation. Document OAuth 2.1 device flow for user tokens (RFC 8628) with device code grant. Document client credentials flow for M2M authentication (RFC 6749 Section 4.4). Include token format examples: egm_oauth_{random32}_{crc6} for access tokens, egm_refresh_{random32}_{crc6} for refresh tokens. Document DPoP proof binding (RFC 9449) for both user and client tokens. Update Token Format table in CLAUDE.md to reflect OAuth-only architecture. Reference /Users/ccheney/Projects/engram/apps/observatory/lib/device-auth.ts for token generation patterns and /Users/ccheney/Projects/engram/packages/common/src/types/auth.ts for type definitions.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T15:56:02.834398-06:00","updated_at":"2025-12-29T17:07:05.361568-06:00","closed_at":"2025-12-29T17:07:05.361568-06:00","dependencies":[{"issue_id":"engram-yd1i","depends_on_id":"engram-4f18","type":"blocks","created_at":"2025-12-29T16:03:24.56829-06:00","created_by":"ccheney"},{"issue_id":"engram-yd1i","depends_on_id":"engram-ctgv","type":"blocks","created_at":"2025-12-29T16:03:29.714836-06:00","created_by":"ccheney"}]}
{"id":"engram-ydj3","title":"Test coverage: apps/memory/src/handlers/diff.handler.ts (92%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:03.748059-06:00","updated_at":"2025-12-21T04:07:03.771229-06:00","closed_at":"2025-12-21T04:07:03.771229-06:00"}
{"id":"engram-yebc","title":"End-to-end testing of NATS migration","description":"Verify complete data flow through NATS JetStream.\n\n## Reference\nSee docs/NATS_MIGRATION_PLAN.md Checklist\n\n## Test Scenarios\n1. Raw event ingestion via observatory /api/ingest\n2. Ingestion service parses and publishes to events.parsed\n3. Memory service receives and persists to FalkorDB\n4. Memory service publishes to memory.turns.finalized\n5. Search service indexes to Qdrant\n6. Control service receives events and triggers SessionManager\n\n## Verification\n- Check NATS streams have messages (http://localhost:8222/jsz)\n- Verify FalkorDB has new nodes\n- Verify Qdrant has new vectors\n- Check all consumer groups are active\n\n## Acceptance Criteria\n- Full pipeline works end-to-end\n- No message loss\n- All services healthy","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T00:28:13.378915-05:00","updated_at":"2025-12-22T01:03:00.406632-05:00","closed_at":"2025-12-22T01:03:00.406632-05:00","dependencies":[{"issue_id":"engram-yebc","depends_on_id":"engram-5rwj","type":"blocks","created_at":"2025-12-22T00:31:03.741377-05:00","created_by":"ccheney"},{"issue_id":"engram-yebc","depends_on_id":"engram-vaco","type":"blocks","created_at":"2025-12-22T00:31:08.870833-05:00","created_by":"ccheney"},{"issue_id":"engram-yebc","depends_on_id":"engram-0p9h","type":"blocks","created_at":"2025-12-22T00:31:14.005625-05:00","created_by":"ccheney"}]}
{"id":"engram-yebg","title":"Add vt_start to TurnFinalizedPayload interface","description":"Add vt_start: number to TurnFinalizedPayload interface so temporal data flows to search indexer.\n\nFile: apps/memory/src/handlers/handler.interface.ts\n\nThis enables the search service to index turns with proper timestamps for temporal filtering.\n\nReference: LongMemEval paper (ICLR 2025) shows time-aware indexing improves TR by 7-11%","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T11:25:57.107268-05:00","updated_at":"2025-12-27T15:51:53.327138-05:00","closed_at":"2025-12-27T15:51:53.327138-05:00"}
{"id":"engram-yemi","title":"[HIGH] Unsafe type assertions in packages/tuner","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:36.286942-06:00","updated_at":"2025-12-20T23:57:31.048318-06:00","closed_at":"2025-12-20T23:57:31.048318-06:00"}
{"id":"engram-yhw1","title":"Update CLAUDE.md MCP usage guidance","description":"Review and update the MCP Client Usage \u0026 Best Practices section in CLAUDE.md to ensure it aligns with the improved tool descriptions. Focus on:\n1. The Prime pattern (using engram_context at task start)\n2. Enrich \u0026 Remember pattern (enrich_memory → remember workflow)\n3. Extract \u0026 Remember pattern for processing long content\n4. When to use recall vs context vs query\n\nReference: docs/plans/mcp-tool-descriptions.md#phase-4-documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T00:53:12.317292-05:00","updated_at":"2025-12-25T01:02:55.755517-05:00","closed_at":"2025-12-25T01:02:55.755517-05:00","dependencies":[{"issue_id":"engram-yhw1","depends_on_id":"engram-qyx3","type":"blocks","created_at":"2025-12-25T00:54:12.6233-05:00","created_by":"ccheney"},{"issue_id":"engram-yhw1","depends_on_id":"engram-0ojf","type":"blocks","created_at":"2025-12-25T00:54:17.76123-05:00","created_by":"ccheney"},{"issue_id":"engram-yhw1","depends_on_id":"engram-d0td","type":"blocks","created_at":"2025-12-25T00:54:22.892464-05:00","created_by":"ccheney"},{"issue_id":"engram-yhw1","depends_on_id":"engram-lm57","type":"blocks","created_at":"2025-12-25T00:54:28.01998-05:00","created_by":"ccheney"}]}
{"id":"engram-yi8x","title":"Implement per-K retrieval metrics in benchmark","description":"packages/benchmark metrics/retrieval.py:145-186 compute_retrieval_metrics() returns hardcoded zeros for NDCG@K, Recall@K, MRR. Needs per-K tracking implementation.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:16:12.943672-06:00","updated_at":"2025-12-20T23:21:07.687854-06:00","closed_at":"2025-12-20T23:21:07.687854-06:00"}
{"id":"engram-yl22","title":"Populate diff.file field in ingestion","description":"packages/events diff.file is always undefined (ingestion/index.ts:199 hardcodes undefined). Should extract file path from diff content.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:16:32.08475-06:00","updated_at":"2025-12-20T23:25:03.593068-06:00","closed_at":"2025-12-20T23:25:03.593068-06:00"}
{"id":"engram-yl4d","title":"[Console Redesign] Migrate Services detail page to shadcn","description":"## Overview\nMigrate the Services detail page with stats cards, resource gauges, and log display.\n\n## Target Page\n- apps/console/app/(dashboard)/services/[name]/page.tsx\n\n## Components to Migrate\n\n### Service Stats Cards\n```tsx\n\u003cdiv className=\"grid gap-4 md:grid-cols-4\"\u003e\n  \u003cCard\u003e\n    \u003cCardHeader className=\"pb-2\"\u003e\n      \u003cCardTitle className=\"text-sm font-medium\"\u003eStatus\u003c/CardTitle\u003e\n    \u003c/CardHeader\u003e\n    \u003cCardContent\u003e\n      \u003cBadge variant={getStatusVariant(service.status)} className=\"text-lg\"\u003e\n        {service.status}\n      \u003c/Badge\u003e\n    \u003c/CardContent\u003e\n  \u003c/Card\u003e\n  \n  \u003cCard\u003e\n    \u003cCardHeader className=\"pb-2\"\u003e\n      \u003cCardTitle className=\"text-sm font-medium\"\u003eUptime\u003c/CardTitle\u003e\n    \u003c/CardHeader\u003e\n    \u003cCardContent\u003e\n      \u003cdiv className=\"text-2xl font-bold\"\u003e{service.uptime}\u003c/div\u003e\n    \u003c/CardContent\u003e\n  \u003c/Card\u003e\n  \n  \u003cCard\u003e\n    \u003cCardHeader className=\"pb-2\"\u003e\n      \u003cCardTitle className=\"text-sm font-medium\"\u003eRequests/min\u003c/CardTitle\u003e\n    \u003c/CardHeader\u003e\n    \u003cCardContent\u003e\n      \u003cdiv className=\"text-2xl font-bold\"\u003e{service.requestsPerMin}\u003c/div\u003e\n    \u003c/CardContent\u003e\n  \u003c/Card\u003e\n  \n  \u003cCard\u003e\n    \u003cCardHeader className=\"pb-2\"\u003e\n      \u003cCardTitle className=\"text-sm font-medium\"\u003eError Rate\u003c/CardTitle\u003e\n    \u003c/CardHeader\u003e\n    \u003cCardContent\u003e\n      \u003cdiv className=\"text-2xl font-bold\"\u003e{service.errorRate}%\u003c/div\u003e\n    \u003c/CardContent\u003e\n  \u003c/Card\u003e\n\u003c/div\u003e\n```\n\n### Resource Gauges\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eResource Usage\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent className=\"space-y-6\"\u003e\n    \u003cdiv className=\"space-y-2\"\u003e\n      \u003cdiv className=\"flex justify-between text-sm\"\u003e\n        \u003cspan\u003eCPU\u003c/span\u003e\n        \u003cspan\u003e{service.cpu}%\u003c/span\u003e\n      \u003c/div\u003e\n      \u003cProgress value={service.cpu} className={getProgressColor(service.cpu)} /\u003e\n    \u003c/div\u003e\n    \n    \u003cdiv className=\"space-y-2\"\u003e\n      \u003cdiv className=\"flex justify-between text-sm\"\u003e\n        \u003cspan\u003eMemory\u003c/span\u003e\n        \u003cspan\u003e{service.memory}%\u003c/span\u003e\n      \u003c/div\u003e\n      \u003cProgress value={service.memory} className={getProgressColor(service.memory)} /\u003e\n    \u003c/div\u003e\n    \n    \u003cdiv className=\"space-y-2\"\u003e\n      \u003cdiv className=\"flex justify-between text-sm\"\u003e\n        \u003cspan\u003eDisk\u003c/span\u003e\n        \u003cspan\u003e{service.disk}%\u003c/span\u003e\n      \u003c/div\u003e\n      \u003cProgress value={service.disk} className={getProgressColor(service.disk)} /\u003e\n    \u003c/div\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n### Dependencies Display\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eDependencies\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent\u003e\n    \u003cdiv className=\"flex flex-wrap gap-2\"\u003e\n      {service.dependencies.map((dep) =\u003e (\n        \u003cTooltip key={dep.name}\u003e\n          \u003cTooltipTrigger asChild\u003e\n            \u003cBadge \n              variant={getStatusVariant(dep.status)}\n              className=\"cursor-pointer\"\n            \u003e\n              {dep.name}\n            \u003c/Badge\u003e\n          \u003c/TooltipTrigger\u003e\n          \u003cTooltipContent\u003e\n            \u003cp\u003eStatus: {dep.status}\u003c/p\u003e\n            \u003cp\u003eLatency: {dep.latency}ms\u003c/p\u003e\n          \u003c/TooltipContent\u003e\n        \u003c/Tooltip\u003e\n      ))}\n    \u003c/div\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n### Recent Logs\n```tsx\n\u003cCard\u003e\n  \u003cCardHeader\u003e\n    \u003cCardTitle\u003eRecent Logs\u003c/CardTitle\u003e\n  \u003c/CardHeader\u003e\n  \u003cCardContent\u003e\n    \u003cScrollArea className=\"h-[300px]\"\u003e\n      {logs.map((log) =\u003e (\n        \u003cdiv key={log.id} className=\"flex items-start gap-2 py-2 border-b last:border-0\"\u003e\n          \u003cBadge variant={getLevelVariant(log.level)} className=\"shrink-0\"\u003e\n            {log.level}\n          \u003c/Badge\u003e\n          \u003cspan className=\"text-xs text-muted-foreground font-mono\"\u003e\n            {formatTimestamp(log.timestamp)}\n          \u003c/span\u003e\n          \u003cspan className=\"font-mono text-sm\"\u003e{log.message}\u003c/span\u003e\n        \u003c/div\u003e\n      ))}\n    \u003c/ScrollArea\u003e\n  \u003c/CardContent\u003e\n\u003c/Card\u003e\n```\n\n## Components to Use\n- Card (CardHeader, CardTitle, CardContent)\n- Badge (status, dependencies, log levels)\n- Progress (resource gauges)\n- Tooltip (dependency details)\n- ScrollArea (logs container)\n- Skeleton (loading states)\n\n## Reference\n- Current: apps/console/app/(dashboard)/services/[name]/page.tsx\n\n## Acceptance Criteria\n- [ ] Stats cards display correctly\n- [ ] Resource progress bars with color thresholds\n- [ ] Dependencies with tooltips\n- [ ] Recent logs display\n- [ ] Loading states\n- [ ] Error handling","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T16:50:51.853808-06:00","updated_at":"2025-12-28T17:45:28.478965-06:00","closed_at":"2025-12-28T17:45:28.478965-06:00","dependencies":[{"issue_id":"engram-yl4d","depends_on_id":"engram-quat","type":"blocks","created_at":"2025-12-28T16:52:59.0827-06:00","created_by":"ccheney"}]}
{"id":"engram-yl86","title":"Add org selection UI to Observatory","description":"Add organization selector in Observatory console for admins.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Super-Admin Queries' section (line 543)\n\n## Implementation\nAdd to Observatory UI:\n- Org dropdown/selector component\n- Only visible to users with admin:read scope\n- Switches context for viewing different tenant data\n- Persists selection in session\n\n## Files to Create/Modify\n- apps/observatory/components/org-selector.tsx\n- apps/observatory/app/layout.tsx (integrate selector)\n\n## Agent Instructions\nUse Context7 MCP for Next.js App Router patterns. Follow existing Observatory component patterns.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T22:08:27.814284-06:00","updated_at":"2025-12-29T22:08:27.814284-06:00"}
{"id":"engram-ym9e","title":"Remove legacy NATS topic mapping","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T02:12:56.975978-05:00","updated_at":"2025-12-24T02:22:45.420842-05:00","closed_at":"2025-12-24T02:22:45.420842-05:00"}
{"id":"engram-ytth","title":"Test coverage: apps/memory/src/index.ts (11%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:40.662043-06:00","updated_at":"2025-12-21T04:07:03.761188-06:00","closed_at":"2025-12-21T04:07:03.761188-06:00"}
{"id":"engram-yvhi","title":"Update memory service for tenant graph selection","description":"Memory service receives orgId from NATS and selects tenant graph for writes.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - 'Memory Service' section (lines 521-525)\n\n## Implementation\nUpdate apps/memory/src/aggregator.ts:\n- Extract orgId, orgSlug from NATS event payload\n- Create TenantContext from event metadata\n- Use TenantAwareFalkorClient to select tenant graph\n- All writes go to tenant-specific graph\n\n## Files to Modify\n- apps/memory/src/aggregator.ts\n- apps/memory/src/index.ts\n\n## Agent Instructions\nMemory service is a NATS consumer. Ensure all event handlers extract and use tenant context.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:03.270164-06:00","updated_at":"2025-12-29T23:36:09.254638-06:00","closed_at":"2025-12-29T23:36:09.254638-06:00","dependencies":[{"issue_id":"engram-yvhi","depends_on_id":"engram-68bd","type":"blocks","created_at":"2025-12-29T22:12:41.054379-06:00","created_by":"ccheney"},{"issue_id":"engram-yvhi","depends_on_id":"engram-8z2o","type":"blocks","created_at":"2025-12-29T22:12:47.139014-06:00","created_by":"ccheney"}]}
{"id":"engram-ywh2","title":"[CRITICAL] Container images using :latest tag in infra","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:22:59.280952-06:00","updated_at":"2025-12-20T23:35:43.814134-06:00","closed_at":"2025-12-20T23:35:43.814134-06:00"}
{"id":"engram-z3i4","title":"Update GitHub Actions CI with turbo remote cache env vars","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-20T23:08:04.241272-06:00","updated_at":"2025-12-21T03:50:24.614337-06:00","closed_at":"2025-12-21T03:50:24.614337-06:00","dependencies":[{"issue_id":"engram-z3i4","depends_on_id":"engram-da07","type":"blocks","created_at":"2025-12-20T23:08:53.162266-06:00","created_by":"ccheney"}]}
{"id":"engram-z3og5","title":"Add tests for packages/auth-mock","description":"Missing tests for auth-mock package:\n- server.ts\n- tokens.ts\n- cli.ts\n\nPriority: LOW - Testing utility package","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:21:20.347183-06:00","updated_at":"2026-01-01T17:21:20.347183-06:00"}
{"id":"engram-z6vw","title":"Add OpenTelemetry instrumentation","description":"Add OTel traces/spans for API calls, WebSocket connections, external API integrations","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T04:24:02.546595-05:00","updated_at":"2025-12-27T04:24:02.546595-05:00"}
{"id":"engram-z8cu","title":"Add tests: Services re-authenticate when token expires (no refresh tokens)","description":"Add tests for service re-authentication when access token expires. Client credentials grant does NOT issue refresh tokens - services must request new access token when current token expires. Test expired token rejected by middleware: create token with access_token_expires_at in past, make API request, expect 401 with error=invalid_token. Test service requests new token on 401: mock HTTP client that receives 401, automatically calls POST /api/auth/token with client credentials + new DPoP proof, retries request with fresh token. Test token expiration handling in both TypeScript services (API, Ingestion, Memory using fetch) and Python services (Search using httpx). No refresh token flow for client credentials per RFC 6749 Section 4.4.3. Services should implement exponential backoff for token refresh to avoid thundering herd on Observatory. Reference /Users/ccheney/Projects/engram/packages/common/src/types/auth.ts OAuthConfig.ACCESS_TOKEN_EXPIRES_IN (7 days) for token lifetime.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T15:56:40.508173-06:00","updated_at":"2025-12-29T16:59:27.744404-06:00","closed_at":"2025-12-29T16:59:27.744404-06:00","dependencies":[{"issue_id":"engram-z8cu","depends_on_id":"engram-j6pr","type":"blocks","created_at":"2025-12-29T16:04:07.503425-06:00","created_by":"ccheney"},{"issue_id":"engram-z8cu","depends_on_id":"engram-qeb4","type":"blocks","created_at":"2025-12-29T16:04:12.642136-06:00","created_by":"ccheney"}]}
{"id":"engram-z90c","title":"Test coverage: packages/storage/src/kafka.ts (40%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:04.824729-06:00","updated_at":"2025-12-21T04:07:03.77062-06:00","closed_at":"2025-12-21T04:07:03.77062-06:00"}
{"id":"engram-ze66","title":"Implement evaluateWithBenchmark() in tuner","description":"CRITICAL BLOCKER: packages/tuner/src/executor/evaluation-adapter.ts:140-153 throws 'not implemented'. This blocks the entire optimization pipeline from running end-to-end.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:09:35.701313-06:00","updated_at":"2025-12-20T23:24:49.350968-06:00","closed_at":"2025-12-20T23:24:49.350968-06:00"}
{"id":"engram-zgn7","title":"Add sparse vector support to engram_turns","description":"Enable SPLADE sparse vectors in new collection to support hybrid search. Currently only dense vectors are being used.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:12:47.656091-06:00","updated_at":"2025-12-21T06:45:04.249392-06:00","closed_at":"2025-12-21T06:45:04.249392-06:00","dependencies":[{"issue_id":"engram-zgn7","depends_on_id":"engram-zxlp","type":"blocks","created_at":"2025-12-21T06:14:08.611608-06:00","created_by":"ccheney"}]}
{"id":"engram-zinp","title":"[HIGH] Kafka consumer tracking race in packages/storage","description":"","status":"closed","priority":4,"issue_type":"bug","created_at":"2025-12-20T23:23:12.560174-06:00","updated_at":"2025-12-20T23:58:50.321963-06:00","closed_at":"2025-12-20T23:58:50.321963-06:00"}
{"id":"engram-zjqp","title":"Install OpenTofu CLI","description":"Install OpenTofu for infrastructure management.\n\n## Installation (macOS)\n```bash\nbrew install opentofu\n```\n\n## Verification\n```bash\ntofu version\n```\n\n## Add to .tool-versions\n```\nopentofu 1.8.0\n```\n\n## Acceptance Criteria\n- `tofu version` shows 1.8.0+\n- Added to .tool-versions for team consistency","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:50:20.008607-06:00","updated_at":"2025-12-21T15:56:03.461591-06:00","closed_at":"2025-12-21T15:56:03.461591-06:00"}
{"id":"engram-zmyy","title":"Wire bitemporal QueryBuilder.at() for time-travel queries","description":"packages/graph/src/queries/builder.ts exports QueryBuilder.at() for bitemporal constraint injection but it is never imported anywhere. Could enable sophisticated time-travel queries.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:01:24.557416-06:00","updated_at":"2025-12-20T23:25:43.635541-06:00","closed_at":"2025-12-20T23:25:43.635541-06:00"}
{"id":"engram-zngd","title":"Improve tests for apps/ingestion/src/index.ts (75% coverage)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T01:58:32.801606-05:00","updated_at":"2025-12-27T01:58:32.801606-05:00"}
{"id":"engram-zsaz","title":"Unit tests for Qdrant filter building","description":"Create unit tests for Qdrant tenant filter construction.\n\n## Plan Reference\n- docs/plans/multi-tenancy.md - Testing Strategy section (lines 633-638)\n\n## Test Cases\n- _build_qdrant_filter() always includes org_id\n- Filter rejects missing org_id\n- Filter combines with other filters correctly\n- is_tenant index optimization is used\n\n## Files to Create\n- apps/search/tests/unit/test_tenant_filter.py\n\n## Agent Instructions\nUse pytest. Test both valid and invalid filter scenarios.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:09:08.977805-06:00","updated_at":"2025-12-29T22:52:34.282824-06:00","closed_at":"2025-12-29T22:52:34.282824-06:00","dependencies":[{"issue_id":"engram-zsaz","depends_on_id":"engram-kwmo","type":"blocks","created_at":"2025-12-29T22:12:37.500388-06:00","created_by":"ccheney"}]}
{"id":"engram-zsmo","title":"Preserve parsed event metadata in ingestion pipeline","description":"Ingestion pipeline extracts cost, timing, model, stopReason, cache metrics from provider events but discards them. These should be stored in Turn nodes for analytics. See apps/ingestion/src/index.ts:175-210.\n\n---\n**Agent Instructions**: Before implementing, the agent must:\n1. Explore the problem thoroughly in the codebase to understand existing patterns and constraints\n2. Conduct internet research (Context7, web search) for current best practices and library documentation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:01:12.41158-06:00","updated_at":"2025-12-20T23:25:15.787225-06:00","closed_at":"2025-12-20T23:25:15.787225-06:00"}
{"id":"engram-zsvg","title":"Test coverage: packages/infra/src/k8s/backups.ts (branches 60%→100%)","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T01:20:47.561768-06:00","updated_at":"2025-12-21T04:07:03.758962-06:00","closed_at":"2025-12-21T04:07:03.758962-06:00"}
{"id":"engram-zx6yl","title":"Add tests for packages/parser extractors","description":"Missing tests for parser components:\n- extractors/diff.ts\n- extractors/thinking.ts\n- parser/opencode.ts\n- thinking.ts\n\nPriority: MEDIUM - Provider parsing is important but less frequently modified","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T17:20:56.178125-06:00","updated_at":"2026-01-01T17:20:56.178125-06:00"}
{"id":"engram-zxhq","title":"[Cleanup] Final verification \u0026 documentation","description":"Final verification that all TypeScript search/benchmark code is removed and documentation is updated.\n\nDeliverables:\n- Verify no references to removed packages in codebase\n- Run full test suite\n- Update AGENTS.md with new Python services\n- Update ARCHITECTURE.md if exists\n- Update README if needed\n- Verify docker-compose.dev.yml works end-to-end\n- Verify npm run dev starts all services correctly\n- Clean npm install with no missing dependencies","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T07:30:36.45028-06:00","updated_at":"2025-12-20T10:29:53.191569-06:00","closed_at":"2025-12-20T10:29:53.191569-06:00","dependencies":[{"issue_id":"engram-zxhq","depends_on_id":"engram-ahjy","type":"blocks","created_at":"2025-12-20T07:31:18.888591-06:00","created_by":"ccheney"},{"issue_id":"engram-zxhq","depends_on_id":"engram-qqa9","type":"blocks","created_at":"2025-12-20T07:31:24.026163-06:00","created_by":"ccheney"},{"issue_id":"engram-zxhq","depends_on_id":"engram-98eb","type":"blocks","created_at":"2025-12-20T07:31:29.184239-06:00","created_by":"ccheney"}]}
{"id":"engram-zxlp","title":"Create engram_turns Qdrant collection","description":"Create new Qdrant collection for turn-level documents with proper vector configuration. Schema: turn_dense (384), turn_sparse, turn_colbert (128).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T06:11:45.87463-06:00","updated_at":"2025-12-21T06:37:50.233509-06:00","closed_at":"2025-12-21T06:37:50.233509-06:00"}
